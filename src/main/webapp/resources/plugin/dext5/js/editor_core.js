var G_ICON_FULL_SET="new save save_as print undo redo copy cut paste text_paste find replace emoticon setting horizontal_line image_create image_editor image_property image_editor_property flash_create flash_property media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property remove_hyperlink bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail full_screen bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color align_group align_group_detail align_left align_center align_right align_full line_height line_height_inc line_height_dec indent outdent list_number list_bullets detail_list_number detail_list_bullets top_design top_source top_preview top_text design source preview text formatting font_family font_size font_size_inc font_size_dec about select_all insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom template grid tool_replace convert_table_to_text insert_link_media paste_word cell_border cell_bg_color table_indent table_outdent load_auto_save ruler pagebreak layout dirltr dirrtl insert_file file_open format_painter apply_format letter_spacing letter_spacing_inc letter_spacing_dec image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_textarea_property input_select input_select_property input_imagebutton input_same_width input_same_height input_same_width_height accessibility_validation table_copy table_paste intable_paste table_content_paste horizontal_sum vertical_sum horizontal_avg vertical_avg table_selection show_blocks table_lock cell_lock table_lock_property help tool_bar_grouping list_lower_alpha word_transform photo_editor photo_editor_property insert_file_property shortcut detail_font_color detail_font_bg_color detail_cell_bg_color table_border insert_layer element_position order_of_objects order_of_objects_detail insert_datetime detail_insert_datetime conversion personal_data forbidden_word video video_property spell_check calculator zoom zoom_plus zoom_minus mini_photo_editor placeholder chart paragraph_attribute table_adjust insert_table_top_paragraph insert_table_bottom_paragraph".split(" "),
G_FORMATTING=" h1 h2 h3 h4 h5".split(" "),DEXTTOP=parent;try{DEXTTOP.IsCrossDomain=!1}catch(e$$4){alert("cross domain error")}setDEXTWINwindow();setDEXTDOCdocument();DEXTTOP.G_SELECTED_ELEMENT=null;DEXTTOP.G_CURREDITOR=null;DEXTTOP.G_COPIEDTABLE=null;DEXTTOP.G_COPIEDCELLDATA=null;var G_CURSOR_ELEMENT=DEXTTOP.G_SELECTED_IMAGE_ELEMENT=null,G_dextResize_Elem_Flag=!1;DEXTTOP.DEXT5=parent.DEXT5;parent.DEXTTOP=DEXTTOP;
var G_dext5plugIn=null,G_dialogHelper=null,G_SUB_DIALOG=null,G_CURRENT_IFRAME=null,G_CURRENT_IFRAME_HOLDER=null,G_USE_EDITOR_ID=null,G_LAST_CMD=null,G_MAIN_ZINDEX=1E4,G_PutUndoCharCount=20,G_Progress_LoadTime=100,G_TIMEOUT_CNT=0,G_ShortCutClose=!1,G_ShortCutClick=!1,xmlHttpReqeust_Config,SIL=[],Z=[],___=DEXTTOP.DEXTWIN.location,_0_,_1_,_7_,G_BASE_COLOR_PICKER="#ffffff #f7f7f7 #e2e2e2 #c2c2c2 #9c9c9c #858585 #404040 #272727 #000000 #ffb39b #ffd4a7 #fff599 #c5dd9c #7ec89d #85ddff #87c5ff #bd8fbf #f69fc1 #ff0000 #ff9c23 #f4d400 #7bb423 #00a350 #00afef #0076c8 #93338f #f02c8c #9f190d #a46206 #a79a00 #568228 #007036 #0077a4 #0000ff #63155f #a01a5c".split(" "),
_R_O_="c",R=[],T=[],K__="zu",C1=[],C2=[],ALS=[],S1=[],S2=[],M1="UklFbHVkbUZzYVdRZ1VISnZaSFZqZENCTFpYa3VJQT09",M2="UklFeHBZMlZ1YzJVZ1JYaHdhWEpsWkM0Zw==",M3="UklFbHVkbUZzYVdRZ1JHOXRZV2x1TGlBPQ==",M4="UklFbHVkbUZzYVdRZ1ZVa2dUVzlrZFd4bElFeHBZMlZ1YzJVdUlBPT0=",G_DEPlugin={};
function setDEXTWINwindow(){try{topURL=top.location.href,"undefined"==typeof topURL?(DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!0):(DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!1)}catch(a){DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!0}}
function setDEXTDOCdocument(){try{topURL=top.location.href,"undefined"==typeof topURL?(DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!0):(DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!1)}catch(a){DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!0}}SIL[0]="t";K__+="vw";
function DEXT5_EDITOR(a,b,c){G_PutUndoCharCount=b.undoCount;this.ID=a;this.Frame=c;this.FrameStatus="";this.FrameID=c.FrameID;DEXTTOP.DEXT5.DEXTMULTIPLE[c.FrameID]=this;DEXTTOP.G_CURREDITOR=this;this._config=b;this._currentMode="design";this._BODY=this._DOC=null;this._EDITOR={};this._defaultHeight="";this._setting={};this._top_menu_click_flag=!1;this._top_menu_click_id="";this._docType={};this.UndoManager=new UndoManager;this.WordCountUndoManager=new UndoManager;this.baseMenuToolbarHeight=0;this._PageProp=
{};this.remove_item=[];this.remove_context_item=[];this.____={};this._LastRange=null;this._RangeBlurBug=!1;this._defaultWidth=this._defTableWidth=0;this._dextCustomData=[];this._dextframeHasFocus=this._dextCustomDataMode=!1;this.changeMultiValue={valueLength:0};this._FRAMEWIN=window;this._formatPainterList=null;this._contentsClass=["dext5_bookmark"];_R_O_+="/";_R_O_+="=";G_MAIN_ZINDEX=b.zIndex;this.setImageArr=[];this.setElementsArr=[];this.sTextareaArr=[];this.applyEdgeMode=this.violationNode=this._editingCheckedValue=
null;this._configXml=c.configXml;this.ShowBlocks="";this.lastElemForLock=this.dext_dragresize=null;this.Toolbar_group=[[],[]];this.detailSubCmd="list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman list_disc list_circle list_square".split(" ");this.initPaste=!0;this.imageForPhotoEditor=null;this.initSetSize=!0;this.groupingBoxOpen=this.isOccurredResizeEvent=!1;this.dialogWindow=null!=DEXTTOP.DEXT5.config.DialogWindow?DEXTTOP.DEXT5.config.DialogWindow:
null;null!=this.dialogWindow&&(this.dialogWindow.DEXTWIN=DEXTTOP.DEXTWIN,this.dialogWindow.DEXTDOC=DEXTTOP.DEXTDOC,this.dialogWindow.G_CURREDITOR=DEXTTOP.G_CURREDITOR);this.topStatusBarTitleIdx=this.statusBarTitleIdx=0;this.setTextPaste=!1;this.setTextPasteMode="0";this.iconEnableCommandType=this.dextResize=null;this.lockCommand=[];this.toolmenu_bg_resize=function(){return function(a){try{var b="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth,
c="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight,d=DEXTTOP.DEXTDOC.getElementById("dext_toolmenu_background"+_dext_editor.ID);d.firstChild.style.width=b+"px";d.firstChild.style.height=c+"px"}catch(e){}}}();this.topmenu_bg_resize=function(){return function(a){try{var b="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth,c="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?
DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight,d=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+_dext_editor.ID);d.firstChild.style.width=b+"px";d.firstChild.style.height=c+"px"}catch(e){}}}();this.context_bg_resize=function(){return function(a){try{getDialogWindow();var b=getDialogDocument(),c="CSS1Compat"==b.compatMode?b.documentElement.scrollWidth:b.body.scrollWidth,d="CSS1Compat"==b.compatMode?b.documentElement.scrollHeight:b.body.scrollHeight,e=b.getElementById("dext_context_background");
e&&(e.firstChild.style.width=c+"px",e.firstChild.style.height=d+"px")}catch(p){}}}();this.isInitFocusHandler=!0;this.mouseDropPosition={clientX:null,clientY:null};this.ShowTableBorder=!1;this.selectionDextmark=[];this.isUseApplyFormat=!1;this.strOldSaveFileName="";this.pluginInstallGuidePopup=this.beforeOffset=null;this.bTextorHtmlData=this.isInitKeydownForSetApi=!1;this.pasteEvt=this.clipImageBlob=null;this.clipData="";try{"function"===typeof DEXTTOP.DEXTWIN.dext_editor_language_definition_event&&
DEXTTOP.DEXTWIN.dext_editor_language_definition_event(dext5_lang,a)}catch(d){}this.isStopScroll=!1;this.previousScrollTop=0;this.xhr_onprogress=null;if("undefined"==typeof DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG)this.lastDateType=null;else try{this.lastDateType=DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG.dateTime.common_date[0]}catch(e){this.lastDateType=""}this.recentlyColorName="dextRecentlyColor";this.recentlyFontName="dextRecentlyFont";this.DEXT5WordDoc=this.DEXT5WordApp=
null;this.checkEnterKeyTargetTagArr="li h1 h2 h3 h4 h5".split(" ");this.isEnterKeyInTargetTag=!1;this.changeDivTagArr=[];this.isClickedMiniPhoto=this.miniPhotoLastMode=this.dextiframeKeydown=!1;this.defaultTableTemplateTab=this.keydownInputText=this.keydownFontSizeForIOS="";this.isInitBodyAutoFit=!0;this.keydownNodeForTableCaret={tdNode:null,backupRange:null};this.useFocusDivForIOS=DEXTTOP.DEXT5.browser.iOS?!0:!1;this.pasteTableParam={tableNode:null,tableHtml:"",currTableNode:null,currCellNode:null}}
K__+="CDE";
DEXT5_EDITOR.prototype={_Design2Source:function(){var a="table tbody tr td th ol ul li div".split(" ");if("0"==this._config.sourceViewtype||"3"==this._config.sourceViewtype)a=[];var b="";removeFakeLineHeight(this._BODY);setMatchSelectedValue(this._BODY);setMatchInputValue(this._BODY);setEmptyTagWhiteSpace(this);if(this._BODY.hasChildNodes())for(var c=this._BODY.childNodes.length,d=0;d<c;d++){var e=this._BODY.childNodes[d];if(e)if(1===e.nodeType){var f=e.tagName.toLowerCase(),g=e.outerHTML;if("script"==
f)g=g.replace(/<script([^>]+?)>[\s]+/gi,"<script$1>\r\n"),g=g.replace(/\;[\s]+/gi,";\r\n");else if("1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)g=removeCRLFChar(g);if("table"==f||"ol"==f||"ul"==f||"dextmark"==f)b+=g;else{if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&"p"==f&&""==(e.innerText||e.textContent))for(;e=RegExp("(<span[^>]*>)(?:\\s|<br>|<br />|  | |)(</span>)","gim"),g=g.replace(e,"$1"+unescape("%u200B")+"</span>"),0!=e.test(g););b+=(""!=b?"\r\n":
"")+g}}else{g=e.nodeValue;if("1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)g="#comment"!=e.nodeName?removeCRLFChar(g):"0"==this._config.removeComment?void 0!=e.data?"\x3c!--"+e.data+"--\x3e":void 0!=e.nodeValue?"\x3c!--"+e.nodeValue+"--\x3e":"":"";b+=(""!=b?"\r\n":"")+g}else if(b=this._BODY.innerHTML,"1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)b=removeCRLFChar(b)}else if(b=this._BODY.innerHTML,"1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)b=
removeCRLFChar(b);"0"==this._config.applyStyleEmptyTag&&(b=RemoveUnnecessaryChar(b),b=CleanZeroChar(b));b=b.replace(/\t/g,"");"3"==this._config.sourceViewtype&&(b=DEXTTOP.DEXT5.util.pretty.html(b,{indent_with_tabs:!0,unformatted:this._config.sourceViewtype_unformatted}));c="";d=0;for(e=a.length;d<e;d++)c=a[d],g=new RegExp("(<"+c+"(\"[^\"]*\"|'[^']*'|[^'\">])*>)","gi"),f=new RegExp("</"+c+">","ig"),"tbody"==c?(b=b.replace(g,function(a,b){return"\r\n\t"+b+"\r\n"}),b=b.replace(f,"\r\n\t</"+c+">")):"li"==
c?b=b.replace(g,function(a,b){return"\r\n\t"+b}):"tr"==c?(b=b.replace(g,function(a,b){return"\r\n\t\t"+b+""}),b=b.replace(f,"\r\n\t\t</"+c+">")):"td"==c||"th"==c?(b=b.replace(g,function(a,b){return"\r\n\t\t\t"+b+"\r\n\t\t\t\t"}),b=b.replace(f,"\r\n\t\t\t</"+c+">")):"table"==c||"ol"==c||"ul"==c?(b=b.replace(g,function(a,b){return"\r\n"+b+""}),b=b.replace(f,"\r\n</"+c+">\r\n")):b=b.replace(g,function(a,b){return"\r\n"+b+""});b=changeRealTagToReplaceString(b);b=DEXTTOP.DEXT5.browser.ie&&9<=DEXTTOP.DEXT5.browser.ieVersion?
b.replace(/\r?\n?\r?\n/g,"\r\n"):b.replace(/\r?\n?\r?\n/g,"\n");b=changeReplaceStringToRealTag(b);b=DEXTTOP.DEXT5.util.trim(b);"0"==DEXTTOP.G_CURREDITOR._config.viewImgBase64Source&&(b=DEXTTOP.DEXT5.util.ImageSrcConvert(b,!0,DEXTTOP.G_CURREDITOR.ID));"1"==DEXTTOP.G_CURREDITOR._config.xhtml_value&&(b=DEXTTOP.DEXT5.util.html2xhtml(b));this._EDITOR.source.value=b;a=this._EDITOR.source;a.focus();"setSelectionRange"in a?a.setSelectionRange(0,0):"createTextRange"in a&&a.createTextRange().moveStart("character",
0)},_Design2Preview:function(){changeBodyImageProperty(!0);setHtmlToPreview();setFocusTopWindow()},_Design2Text:function(){var a=this._BODY.innerHTML,a=a.replace(/\r/g,""),a=a.replace(/[\n|\t]/g,""),a=a.replace(/[\v|\f]/g,""),a=a.replace(/<p><br><\/p>/gi,"\n"),a=a.replace(/<P>&nbsp;<\/P>/gi,"\n"),a=a.replace(/<br(\s)*\/?>/gi,"\n"),a=a.replace(/<br(\s[^\/]*)?>/gi,"\n"),a=a.replace(/<\/p(\s[^\/]*)?>/gi,"\n"),a=a.replace(/<\/li(\s[^\/]*)?>/gi,"\n"),a=a.replace(/<\/tr(\s[^\/]*)?>/gi,"\n");nIdx=a.lastIndexOf("\n");
-1<nIdx&&"\n"==a.substring(nIdx)&&(a=a.substring(0,nIdx));a=removeStripTags(a,null);a=unhtmlSpecialChars(a);this._EDITOR.text.value=a;a=this._EDITOR.text;try{a.focus()}catch(b){}},getEditorMode:function(){return this._currentMode},setChangeMode:function(a){clearAllFormControlSelected();var b=this.getEditorMode();if(b!=a)if("1"!=this._config.formMode&&"0"!=this._config.userTableLock.use&&IsExistTableLock(this)&&(-1<a.indexOf("text")||-1<a.indexOf("source")))alert(dext5_lang.msg.notChangeMode);else{"1"==
this._config.useSelectionMark&&(-1<b.indexOf("design")&&-1<a.indexOf("source")?makeRangeSelectionMarkInDesign():-1<b.indexOf("source")&&-1<a.indexOf("design")&&makeRangeSelectionMarkInSource(this._EDITOR.source));var c=!0;("top_text"==a||"text"==a)&&DEXTTOP.DEXT5.ShowTextChangeAlert&&(c=confirm(dext5_lang.msg.changeTextMode));if(c){null==this._EDITOR.preview&&(c=document.getElementById("ue_editor_holder_"+this.ID),c=createEditorIframe(this._config,c,"dext5_preview_"+this.ID,dext5_lang.iframe_title.preview,
this._docType[this._setting.doctype],this._setting.encoding,this._setting.lang,this._setting.xmlnsname,this._setting.font_family,this._setting.font_size,this._setting.line_height),c.style.width="0px",c.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(c.style.display="none"),this._EDITOR.preview=document.getElementById("dext5_preview_"+this.ID));ClearDraggingTableCellSelected();Mouse_Status=Mouse_IsPlain;g_findRepalceRange=ActiveCurrTable=DrageStartCell=null;this._iconSelected();for(var d=null,e=["top_design",
"top_source","top_preview","top_text"],c=0,f=e.length;c<f;c++)d=document.getElementById("ue_"+this.ID+e[c]),null!=d&&((0>a.indexOf("top_")?"top_"+a:a)==e[c]?d.className="on":d.className="");var g=null,e=null,d=["design","source","preview","text"];a=a.replace("top_","");"design"!=a&&this._iconEnable("allDisable");c=0;for(f=d.length;c<f;c++)if(g=document.getElementById("ue_"+this.ID+d[c]),e=document.getElementById("dext5_"+d[c]+"_"+this.ID),null!=g){if(a==d[c]){g.className=this._config.style.skinName;
g.getElementsByTagName("A")[0].className="color_on";g.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/ue_btn_bg.gif)";if("source"==a||"text"==a){try{e.focus()}catch(h){}g=this._defaultHeight;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks?g-=5:DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(g-=3);e.style.height=g+"px";e.height=g+"px"}else e.style.height="100%";e.style.width="100%";DEXTTOP.DEXT5.browser.gecko||
(e.style.display="",e.style.overflow="");"design"==a&&(this._LastRange=null,setFocusToBody())}else g.className="",g.getElementsByTagName("A")[0].className="",g.style.backgroundImage="",e.style.width="0px",e.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(e.style.display="none",e.style.overflow="hidden"),e.blur();e=document.getElementById("ue_diabled_div_"+this.ID);"BackCompat"==document.compatMode&&(e.style.height=document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).scrollHeight+"px");document.getElementById("ue_toolbar_"+
G_USE_EDITOR_ID).style.position="relative";e.style.width="design"==a?"0px":document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).scrollWidth+"px"}getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear();"design"==b&&"design"!=a&&DEXTTOP.G_CURREDITOR.ShowTableBorder&&command_showTableBorder(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR);var n=this,c=function(a){null!=n._config.zoomList&&(a?(document.getElementById("zoom_"+n.ID+"_holder").style.display="","1"==
n._config.wordCount.use&&(document.getElementById("word_count_"+n.ID+"_holder").style.textAlign="")):(document.getElementById("zoom_"+n.ID+"_holder").style.display="none","1"==n._config.wordCount.use&&(document.getElementById("word_count_"+n.ID+"_holder").style.textAlign="right")))};switch(b){case "design":setRemoveClass(["td","th"],["DEXT_dot"]);switch(a){case "source":ReplaceImageToRealObject();"1"==this._config.formMode&&ReplaceCustomDataToRealEvent();this._Design2Source();c(!1);break;case "preview":ReplaceImageToRealObject();
"1"==this._config.formMode&&ReplaceCustomDataToRealEvent();this._Design2Preview();break;case "text":this._Design2Text(),c(!1)}break;case "source":_value=this._EDITOR.source.value;_value=_value.replace(/\t/g,"");_value=removeCRLFChar(_value);"1"!=DEXTTOP.G_CURREDITOR._config.plugInUse&&(_value=DEXTTOP.DEXT5.util.removeLocalFileImage(_value));_value=xssReplaceScript(null,_value);"0"==DEXTTOP.G_CURREDITOR._config.viewImgBase64Source&&(_value=DEXTTOP.DEXT5.util.ImageSrcConvert(_value,!1,DEXTTOP.G_CURREDITOR.ID));
DEXTTOP.DEXT5.setBodyValue(_value,"",!0,!0);f=this.Frame;showRuler(f.editor);switch(a){case "design":c(!0);"1"==this._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage();setAddClass(["td","th"],["DEXT_dot"]);break;case "preview":ReplaceImageToRealObject();"1"==this._config.formMode&&ReplaceCustomDataToRealEvent();setRemoveClass(["td","th"],["DEXT_dot"]);this._Design2Preview();c(!0);break;case "text":this._Design2Text()}break;case "preview":f=this.Frame;
showRuler(f.editor);ClearPreViewContent(f.editor);switch(a){case "design":FixFlashError();"1"==this._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage();setAddClass(["td","th"],["DEXT_dot"]);try{this._iconEnable(""),setFocusToBody(),setFocusFirstChildForStyle(this._BODY)}catch(m){}break;case "source":this._Design2Source();c(!1);break;case "text":this._Design2Text(),c(!1)}break;case "text":switch(_value=this._EDITOR.text.value,_value=htmlSpecialChars(_value),
_value=addLineBreaker(this._config.enterTag,_value),DEXTTOP.DEXT5.setBodyValue(_value,"",!0,!0,!0),f=this.Frame,showRuler(f.editor),a){case "design":c(!0);break;case "source":this._Design2Source();break;case "preview":this._Design2Preview(),c(!0)}}this._currentMode=a;null!=n._config.zoomList&&command_zoom(n.ID);"1"==this._config.useSelectionMark&&(-1<b.indexOf("design")&&-1<a.indexOf("source")?setRangeSelectionMarkInSource(this._EDITOR.source):-1<b.indexOf("source")&&-1<a.indexOf("design")&&setRangeSelectionMarkInDesign());
if(-1<a.indexOf("design")){setFocusFirstChildForStyle(DEXTTOP.G_CURREDITOR._BODY);try{contentChangeEventWrapper()}catch(p){}}setTimeout(function(){try{DEXTTOP.DEXTWIN.dext_editor_afterchangemode_event(a,b,DEXTTOP.G_CURREDITOR.ID)}catch(c){}},100)}}},start:function(){var a=this._config,b=a.usePlugin.length,c=0,d=function(){var e=a.usePlugin[c].replace("p_","");loadPluginJs(e,function(){c++;c<b?d():_dext_editor._setEditorIcon()})};0<b?d():_dext_editor._setEditorIcon()},_setEditorIcon:function(){var a=
_dext_editor,b=a._configXml,c=a._config.style.skinName,d=a._config.webPath.image+"skin/"+c,e=DEXTTOP.DEXT5.util.xml.getNode(b,"top_menu"),f=DEXTTOP.DEXT5.util.xml.getNode(b,"tool_bar_1"),g=DEXTTOP.DEXT5.util.xml.getNode(b,"tool_bar_2"),h=DEXTTOP.DEXT5.util.xml.getNode(b,"tool_bar_admin");DEXTTOP.DEXT5.util.xml.getNode(b,"font_size");DEXTTOP.DEXT5.util.xml.getNode(b,"letter_spacing");DEXTTOP.DEXT5.util.xml.getNode(b,"formatting");var n=DEXTTOP.DEXT5.util.xml.getNode(b,"status_bar");""!=DEXTTOP.DEXT5.config.StatusBarInitMode?
a._config.statusBarInitMode=DEXTTOP.DEXT5.config.StatusBarInitMode:n&&n.getAttribute("init_mode")&&""!=n.getAttribute("init_mode")&&(a._config.statusBarInitMode=n.getAttribute("init_mode"));var m=DEXTTOP.DEXT5.util.xml.getNode(b,"setting"),p=DEXTTOP.DEXT5.util.xml.getNode(b,"license");DEXTTOP.DEXT5.util.xml.getNode(b,"font_family");a.____.p=DEXTTOP.DEXT5.util.xml.getNodeValue(p,R[28]+R[21]+R[18]+R[11]+"u"+R[17]+R[14]+"_k"+R[12]+"y");_7_=DEXTTOP.DEXT5.util.xml.getNodeValue(p,"l"+T[10]+R[17]+R[12]+
T[11]+T[4]+"_"+T[5]+"e"+T[7]);""!=DEXTTOP.DEXT5.config[String.fromCharCode(80)+String.fromCharCode(114)+String.fromCharCode(111)+String.fromCharCode(100)+String.fromCharCode(117)+String.fromCharCode(99)+String.fromCharCode(116)+String.fromCharCode(75)+String.fromCharCode(101)+String.fromCharCode(121)]&&(a.____.p=DEXTTOP.DEXT5.config[String.fromCharCode(80)+String.fromCharCode(114)+String.fromCharCode(111)+String.fromCharCode(100)+String.fromCharCode(117)+String.fromCharCode(99)+String.fromCharCode(116)+
String.fromCharCode(75)+String.fromCharCode(101)+String.fromCharCode(121)]);""!=DEXTTOP.DEXT5.config[String.fromCharCode(76)+String.fromCharCode(105)+String.fromCharCode(99)+String.fromCharCode(101)+String.fromCharCode(110)+String.fromCharCode(115)+String.fromCharCode(101)+String.fromCharCode(75)+String.fromCharCode(101)+String.fromCharCode(121)]&&(_7_=DEXTTOP.DEXT5.config[String.fromCharCode(76)+String.fromCharCode(105)+String.fromCharCode(99)+String.fromCharCode(101)+String.fromCharCode(110)+String.fromCharCode(115)+
String.fromCharCode(101)+String.fromCharCode(75)+String.fromCharCode(101)+String.fromCharCode(121)]);a.____.l=_L__.DE(_7_);try{a.____.l=a.____.l.split("|"),_0_=a.____.l,_1_=a.____.p}catch(t){}a._dextSetting(m);"1"==a._config.usePersonalSetting&&DEXTTOP.DEXT5.browser.LocalStorageSupported&&((m=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_personal_setting"))&&""!=m.fontFamily&&(this._setting.font_family=m.fontFamily),m&&""!=m.fontSize&&(this._setting.font_size=m.fontSize),m&&""!=m.lineHeight&&
(this._setting.line_height=m.lineHeight));if(""!=DEXTTOP.DEXT5.config.RemoveItem)a.remove_item=DEXTTOP.DEXT5.config.RemoveItem.split(",");else for(var m=DEXTTOP.DEXT5.util.xml.getNode(b,"remove_item"),p=DEXTTOP.DEXT5.util.xml.count(m,"item"),q=0;q<p;q++)a.remove_item[q]=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(m,"item",q);-1<a._config.disableInsertImage.indexOf(",image,")&&null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)&&
a.remove_item.push("image_create");!getApplyDragResize(a)&&(0==DEXTTOP.DEXT5.browser.ie||11<DEXTTOP.DEXT5.browser.ieVersion)&&a.remove_item.push("table_selection");DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&(a.remove_item.push("format_painter"),a.remove_item.push("apply_format"));a.remove_item.push("grid");"1"==a._config.paste_image_base64_remove&&(a.remove_item.push("paste_to_image"),a.remove_item.push("paste_to_image_detail"));if(""!=DEXTTOP.DEXT5.config.RemoveContextItem)a.remove_context_item=
DEXTTOP.DEXT5.config.RemoveContextItem.split(",");else if(b=DEXTTOP.DEXT5.util.xml.getNode(b,"remove_context_item"),void 0!=b)for(m=DEXTTOP.DEXT5.util.xml.count(b,"item"),q=0;q<m;q++)a.remove_context_item[q]=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(b,"item",q);(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)&&a.remove_item.push("full_screen");DEXTTOP.DEXTWIN!=top&&"1"!=DEXTTOP.G_CURREDITOR._config.frameFullScreen&&a.remove_item.push("full_screen");if(""!=DEXTTOP.G_CURREDITOR._config.xss_remove_tags){b=
DEXTTOP.G_CURREDITOR._config.xss_remove_tags.toLowerCase();m=0;-1<b.indexOf("iframe")&&(a.remove_item.push("iframe_create"),a.remove_item.push("insert_link_media"),m+=1);if(-1<b.indexOf("object")||-1<b.indexOf("embed"))a.remove_item.push("media_create"),a.remove_item.push("flash_create"),m+=1;2<=m&&a.remove_item.push("entity")}"0"==a._setting.auto_save&&a.remove_item.push("load_auto_save");0==a._config.ruler.use&&a.remove_item.push("ruler");if(""!=a._config.custom_code&&(b=DEXTTOP.DEXT5.util.CustomSetting("remove_item",
a._config.custom_code),"undefined"!==typeof b))for(m=b.length,q=0;q<m;q++)a.remove_item.push(b[q]);"0"==a._config.useMiniImageEditor&&a.remove_item.push("mini_photo_editor");"1"==a._config.plugInUse&&"1"==a._config.imageEditorUse&&0!=DEXTTOP.DEXT5.browser.ie||a.remove_item.push("image_editor");("ieplugin"==a._config.runtimes||DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion)&&a.remove_item.push("photo_editor");"1"!=a._config.formMode&&(a.remove_item.push("table_lock"),a.remove_item.push("cell_lock"),
a.remove_item.push("table_lock_property"));"1"!=a._config.plugInUse&&(a.remove_item.push("word_transform"),a.remove_item.push("save_as"));if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion||"Windows"==DEXTTOP.DEXT5.UserAgent.os.name&&DEXTTOP.DEXT5.browser.safari)a.remove_item.push("video"),a.remove_item.push("placeholder"),a.remove_item.push("chart"),a.remove_item.push("chart_property");if(!DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.ie&&11<DEXTTOP.DEXT5.browser.ieVersion)a.remove_item.push("spell_check"),
a.remove_item.push("text_paste");m=q="";p=isViewMode(a);m+='<div id="ue_editor_main_'+a.ID+'" class="DEXT_fiVe_EdiTor" style="z-index:'+G_MAIN_ZINDEX+'; width:100%; "  oncontextmenu="return false">';b=DEXTTOP.DEXT5.util.xml.count(n,"status");0==b&&(a._config.status_bar="1");var u="",u="1"==a._config.top_status_bar||p?u+"height:1px;":u+"height:28px;";if("1"==a._config.top_status_bar||p)u+="display:none;";""!=u&&(u=" style='"+u+"'");m+="<div id='dext_topstatusbar_"+a.ID+"' class='ue_as DEXT_fiVe_EdiTor_TopStatusBar_"+
c+"'"+u+">";m+="    <ul class='"+c+"'>";if(""!=a._config.statusBarItem)for(var v=a._config.statusBarItem.split(","),u=0;u<v.length;u++){var q=v[u],q=DEXTTOP.DEXT5.util.trim(q).toLowerCase(),w="";a.getEditorMode()==q.replace("top_","")&&(w='class="on"');m+=" <li "+w+' id="ue_'+a.ID+"top_"+q+'"><a href="javascript:void(0);">DEXT_Top_Status</a></li>'}else{v=0;if(0<b){w=!1;for(u=0;u<b;u++)if(q=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(n,"status",u),"design"==q){w=!0;break}w||(v=-1)}for(u=v;u<b;u++)q="",
-1==u?q="design":(q=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(n,"status",u),q=DEXTTOP.DEXT5.util.trim(q).toLowerCase()),(v=DEXTTOP.DEXT5.util.xml.getNodeIdx(n,"status",u))&&v.getAttribute("title")&&""!=v.getAttribute("title")?(v=v.getAttribute("title"),a._config.statusBarTitle.push(v)):a._config.statusBarTitle.push(""),w="",a.getEditorMode()==q.replace("top_","")&&(w='class="on"'),m+=" <li "+w+' id="ue_'+a.ID+"top_"+q+'"><a href="javascript:void(0);">DEXT_Top_Status</a></li>'}m+="    </ul></div>";m+=
'<div onselectstart="return false;" id="ue_toolbar_'+a.ID+'" style="width:100%" class="ue_as">';q=a._makeEditorTopMenu(e);m+=q;u="0"==a._config.editorborder?"_xxx":"";q="";DEXTTOP.DEXT5.browser.ie&&(7>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)&&(q="margin-bottom:-2px;");m="3"==a._config.tool_bar||isViewMode(a)?m+('\t\t<table id="dext_toolbar_'+a.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table" style="display:none; '+q+'">'):m+('\t\t<table id="dext_toolbar_'+a.ID+
'" border="0" cellpadding="0" cellspacing="0" class="ue_table" style="'+q+'">');m+="\t\t\t<tr>";q="";"1"==a._config.top_menu&&"0"==a._config.top_status_bar&&(q="border-top-width:0px;");m="mono"==c?m+('\t\t\t\t<td class="ue_tg_'+c+u+'" style="'+q+'">'):m+('\t\t\t\t<td class="ue_tg_'+c+u+'" style="background-image:url('+d+"/ue_tbg.gif);"+q+'">');m+='\t\t\t\t\t<table id="table_gecko_'+a.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table01" ';m+=">";q=DEXTTOP.DEXT5.util.xml.count(f,"tool");
v=DEXTTOP.DEXT5.util.xml.count(g,"tool");0==q&&0==v?a._config.tool_bar="3":0==q?a._config.tool_bar="1":0==v&&(a._config.tool_bar="2");q=a._makeEditorIcon(f,"1");m+=q;q=a._makeEditorIcon(g,"2");m+=q;q=a._makeEditorFormBar(h);m+=q;if("1"==a._config.ruler.use){var m=m+"<tr>",y=18;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(y+=1);m+='<td class="ue_tdb_'+c+'01" id="dext_tab_tool3_'+a.ID+'" style="border:0px; padding:0px; height:'+y+'px; background-image:url(../images/bg/ruler.gif); background-repeat:no-repeat; display:none; position:relative;">';
y=this._setting.ruler_position.split(",");"2"!=a._config.ruler.mode&&(y=y.sort(function(a,b){return a-b}));this._setting.ruler_position=y.join(",");f=y.length;for(q=0;q<f;q++)m="2"==a._config.ruler.mode?1==q?m+('<img id="dext_ruler_point_'+q+"_"+a.ID+'" src="../images/bg/point2.gif" title="'+dext5_lang.setting["ruler"+q+"_desc"]+'" alt="" style="vertical-align:top; border:0px; width:14px; height:9px; margin:0 0 0 -7; display:none; position:absolute; top:0px; z-index:'+(G_MAIN_ZINDEX+101)+';" />'):
m+('<img id="dext_ruler_point_'+q+"_"+a.ID+'" src="../images/bg/point3.gif" title="'+dext5_lang.setting["ruler"+q+"_desc"]+'" alt="" style="vertical-align:bottom; border:0px; width:14px; height:9px; margin:0 0 0 -7; display:none; position:absolute; bottom:0px; z-index:'+(G_MAIN_ZINDEX+101)+';" />'):m+('<img id="dext_ruler_point_'+q+"_"+a.ID+'" src="../images/bg/point.gif" title="'+dext5_lang.setting["ruler"+q+"_desc"]+'" alt="" style="vertical-align:top; border:0px; width:14px; height:9px; margin:0 0 0 -7; display:none; position:absolute; top:-1px; z-index:'+
(G_MAIN_ZINDEX+101)+';" />');"2"==a._config.ruler.mode&&(m+='<div id="dext_ruler_area_0" style="background-color:#dddddd; background-color: rgba(0,0,0,0.18); filter:alpha(opacity=70); opacity:0.70; position:absolute; z-index:'+(G_MAIN_ZINDEX+100)+'; height:18px; position:absolute; width:10px; left:0px; top:0px;"></div>',f=DEXTTOP.DEXT5.util.parseIntOr0(y[2]),g=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXTWIN.document.getElementById("dext_frame_holder"+DEXTTOP.G_CURREDITOR.ID).style.width)-f,m+='<div id="dext_ruler_area_1" style="background-color:#dddddd; background-color: rgba(0,0,0,0.18); filter:alpha(opacity=70); opacity:0.70; position:absolute; z-index:'+
(G_MAIN_ZINDEX+100)+"; top:0px; height:18px; position:absolute; width:"+g+"px; left:"+f+'px;"></div>');m+="</td>";m+="</tr>"}m+="\t\t\t\t\t</table>";m+="\t\t\t\t</td>";m+="\t\t\t</tr>";m+="\t\t</table>";m+='\t<div id="ue_diabled_div_'+a.ID+'" style="background-color:#ffffff; filter:alpha(opacity=50); opacity:0.50; position:absolute; z-index:'+(G_MAIN_ZINDEX+1E3)+'; left:0px; top:0px; width:0px; height:100%;"></div>';"2"==a._config.ruler.mode&&(m+='\t<div id="ue_ruler_back_div" style="background-color:#ffffff; filter:alpha(opacity=0); opacity:0; position:absolute; z-index:'+
(G_MAIN_ZINDEX+100)+'; left:0px; top:0px; width:100%; height:100%; display:none;"></div>');"1"==a._config.tool_bar_grouping&&(m+='<div class="tool_bar_grouping_box" id="dext_div_tool_bar_grouping_box1" style="display:none; z-index:'+(G_MAIN_ZINDEX+900)+';">',m+='<div class="tool_bar_grouping_list tool_bar_grouping_list_'+a._config.style.skinName+'" id="dext_tool_bar_grouping_list1">',m+='<ul id="ul_tool_bar_grouping_list1">',m+="</ul>",m+="</div>",m+="</div>",m+='<div class="tool_bar_grouping_box" id="dext_div_tool_bar_grouping_box2" style="display:none; z-index:'+
(G_MAIN_ZINDEX+900)+';">',m+='<div class="tool_bar_grouping_list tool_bar_grouping_list_'+a._config.style.skinName+'" id="dext_tool_bar_grouping_list2">',m+='<ul id="ul_tool_bar_grouping_list2">',m+="</ul>",m+="</div>",m+="</div>");m+="</div>";if("1"==a._config.ruler.use){y=this._setting.ruler_position.split(",");f=y.length;m+='<div id="dext_ruler_pointline_div">';for(q=0;q<f;q++)g=a._config.ruler.guideLineColor,h=a._config.ruler.guideLineStyle,"2"==a._config.ruler.mode&&(g=a._config.ruler.moveGuideLineColor,
h=a._config.ruler.moveGuideLineStyle),m+='<div id="dext_ruler_pointline_'+q+"_"+a.ID+'" style="position:absolute; z-index: 9999; border-left:'+h+" 1px "+g+'; display:none;"></div>';m+="</div>"}"2"==a._config.ruler.mode&&(m+='<div id="dext_ruler_pointline_3_'+a.ID+'" style="position:absolute; left:'+y[2]+"px; z-index: 9999; border-left:"+a._config.ruler.guideLineStyle+" 1px "+a._config.ruler.guideLineColor+';"></div>');y=a._config.style.height.replace("px","");a._defaultHeight=y+"";m+='\t<div id="ue_editor_holder_'+
a.ID+'" class="ue_editor_'+c+"_lr"+u+'" ';if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)m="view"==a._config.mode&&"1"==a._config.view_mode_auto_height?m+' style="overflow:hidden;"':m+' style="overflow:scroll; -webkit-overflow-scrolling:touch;"';m+="\t></div>";u="0"==a._config.editorborder?"_xxx":"";m+='\t<div id="status_'+a.ID+'" class="ue_as" style="width:100%;">';m="1"==a._config.status_bar||p||0==b?m+('\t\t<table id="dext_statusbar_'+a.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table_'+
c+u+'" style="background-image:url('+d+"/ue_gbg.gif); display:none; "):m+('\t\t<table id="dext_statusbar_'+a.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table_'+c+u+'" style="background-image:url('+d+"/ue_gbg.gif); ");m+='">';m+='\t\t    <tr id="status_tr_'+a.ID+'" ';m+=">";m+="\t\t\t\t<td>";m+='\t\t\t\t\t<ul class="ue_btn_'+c+'" id="dext_tab_status_'+a.ID+'">';if(0==b)m+=' <li class="" id="ue_'+a.ID+'design" style="visibility:hidden;"><a href="javascript:void(0);">DEXT_Status</a></li>';
else if(""!=a._config.statusBarItem)for(v=a._config.statusBarItem.split(","),u=0;u<v.length;u++)q=v[u],q=DEXTTOP.DEXT5.util.trim(q).toLowerCase(),m+=' <li class="" id="ue_'+a.ID+q+'"><a href="javascript:void(0);">DEXT_Status</a></li>';else{v=0;if(0<b){w=!1;for(u=0;u<b;u++)if(q=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(n,"status",u),"design"==q){w=!0;break}w||(v=-1)}for(u=v;u<b;u++)q="",-1==u?q="design":(q=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(n,"status",u),q=DEXTTOP.DEXT5.util.trim(q).toLowerCase()),
0==a._config.statusBarTitle.length&&((v=DEXTTOP.DEXT5.util.xml.getNodeIdx(n,"status",u))&&v.getAttribute("title")&&""!=v.getAttribute("title")?(v=v.getAttribute("title"),a._config.statusBarTitle.push(v)):this._config.statusBarTitle.push("")),m+=' <li class="" id="ue_'+a.ID+q+'"><a href="javascript:void(0);">DEXT_Status</a></li>'}m+="\t\t\t\t\t</ul>";m+='<ul class="ue_btn_'+c+'" style="float: right;">';"1"==DEXTTOP.G_CURREDITOR._config.wordCount.use&&(m+='<li id="word_count_'+a.ID+'_holder" style="width: 300px; ',
null==DEXTTOP.G_CURREDITOR._config.zoomList&&(m+="text-align: right; "),m+='cursor:default;"><span id="count_line_span_'+a.ID+'" style="margin-right:10px;"></span><span id="count_characters_span_'+a.ID+'" style="margin-right:10px;"></span></li>');null!=DEXTTOP.G_CURREDITOR._config.zoomList&&(m+='<li id="zoom_'+a.ID+'_holder" class="zoom_editor_holder"><span class="bottom_width_r"><textarea id="ue_'+a.ID+'zoom_text" maxlength="5" rows="1" wrap="soft"></textarea>',m+='<a class="z_arrow" id="ue_'+a.ID+
'zoom" href="javascript:void(0);">',m+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">',m+='\t\t<span id="dext_pan_zoom_'+a.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc;"></span>',m+="\t</span>",m+='</a><a class="z_plus" id="ue_'+a.ID+'zoom_plus" href="javascript:void(0);">',m+='</a><a class="z_minus" id="ue_'+a.ID+'zoom_minus" href="javascript:void(0);"></a></span></li>');m+=
"</ul>";m+="\t\t\t\t</td>";m+="\t\t\t</tr>";m+="\t\t</table>";m+="\t</div>";m+="</div>";document.getElementById("editorContentArea").innerHTML=m;n=document.getElementById("ue_editor_holder_"+a.ID);createEditorIframe(a._config,n,"dext5_design_"+a.ID,dext5_lang.iframe_title.design,a._docType[a._setting.doctype],a._setting.encoding,a._setting.lang,a._setting.xmlnsname,a._setting.font_family,a._setting.font_size,a._setting.line_height);y=document.createElement("textarea");y.id="dext5_source_"+a.ID;y.title=
dext5_lang.iframe_title.source;y.style.color="#111111";y.style.width="0px";y.style.height="0px";DEXTTOP.DEXT5.browser.gecko||(y.style.display="none");y.style.borderWidth="0px";y.style.margin="0px 0px";y.style.padding="0px";y.className="DEXT_fiVe_EdiTor_source_editor_font";"1"==a._config.sourceViewtype&&("wrap"in y?y.wrap="off":"wordWrap"in y.style&&(y.style.wordWrap="normal"));n.appendChild(y);y=document.createElement("textarea");y.id="dext5_text_"+a.ID;y.title=dext5_lang.iframe_title.text;y.style.color=
"#111111";y.style.width="0px";y.style.height="0px";DEXTTOP.DEXT5.browser.gecko||(y.style.display="none");y.style.borderWidth="0px";y.style.margin="0px 0px";y.style.padding="0px";y.className="DEXT_fiVe_EdiTor_text_editor_font";n.appendChild(y);if(n=document.getElementById("ue_"+a.ID+"design"))n.className=a._config.style.skinName,n.getElementsByTagName("A")[0].className="color_on",n.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+"/ue_btn_bg.gif)";setEditorHeight(a,
!0);document.getElementById("ue_editor_holder_"+a.ID).style.height=0>a._defaultHeight?"0px":a._defaultHeight+"px";document.getElementById("dext_background")||(n=document.createElement("div"),n.setAttribute("id","dext_background"),n.style.zIndex=G_MAIN_ZINDEX+1E3,document.getElementsByTagName("body")[0].appendChild(n));document.getElementById("dext_click_background")||(n=document.createElement("div"),n.setAttribute("id","dext_click_background"),n.style.zIndex=G_MAIN_ZINDEX+1E3,document.body.appendChild(n),
DEXTTOP.DEXT5.util.addEvent(n,"click",function(){DEXT5_EDITOR.prototype.dialog._click_background()}),n.onmousedown=function(){return!1},n.unselectable="on");a._dextFormatting.init(a.ID);a._dextLineHeight.init(a.ID);a._dextzoom.init(a.ID);if(n=document.getElementById("ue_"+a.ID+"design"))n.style.backgroundImage="url("+d+"/ue_btn_bg.gif)";a._setTopMenuEvents(e);a._setIconEvents();a._iconEnable("default");a._config.useServerLicense?DEXTTOP.DEXT5.util.checkServerLicense(a):(d=setTimeout(_fn_0,2E3),DEXTTOP.DEXT5.DEXTMULTIPLETIMEOUT.push(d));
"1"==a._config.resize_bar&&0<b&&DEXTTOP.DEXTWIN==top&&!DEXTTOP.DEXT5.browser.mobile&&!DEXTTOP.DEXT5.browser.iOS&&a._setEditorResizeBar();if("1"==a._config.tool_bar_grouping){groupingIcon();d=document.getElementById("dext_span_"+a.ID+"tool_bar_grouping1");"mono"==c?(d.style.height="38px",d.style.marginTop="-6px",7==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&(d.style.height="39px")):d.style.height=DEXTTOP.DEXT5.browser.quirks?"29px":"27px";var x=document.getElementById("dext_div_tool_bar_grouping_box1"),
e=function(){return function(b){DEXTTOP.G_CURREDITOR=a;"block"==z.style.display&&hideGroupingBox();if("block"==x.style.display)hideGroupingBox();else{if(DEXTTOP.DEXT5.browser.mobile||"mobile"==DEXTTOP.DEXT5.UserAgent.device.type)x.style.top="0px",x.style.left="0px";x.style.display="block";showGroupingBackground();setPositionGroupingDiv(1);var c=x.getElementsByTagName("a"),d=c.length;if(0<d)var e=setInterval(function(){a.groupingBoxOpen&&(c[0].focus(),setFocusFirstAndLast2(c[0],c[d-1]),a.groupingBoxOpen=
!1,clearInterval(e))},100)}}}();DEXTTOP.DEXT5.util.addEvent(d,"click",e);d=document.getElementById("dext_span_"+a.ID+"tool_bar_grouping2");"mono"==c?(d.style.height="37px",d.style.marginTop="-6px",7==DEXTTOP.DEXT5.browser.ieVersion&&(d.style.marginTop="-7px",DEXTTOP.DEXT5.browser.quirks&&(d.style.height="38px"))):(d.style.height="28px",10>DEXTTOP.DEXT5.browser.ieVersion&&(7==DEXTTOP.DEXT5.browser.ieVersion?(d.style.height="27px",d.style.marginTop="-2px",DEXTTOP.DEXT5.browser.quirks&&(d.style.marginTop=
"0px")):d.style.marginTop="-1px"));var z=document.getElementById("dext_div_tool_bar_grouping_box2"),c=function(){return function(b){DEXTTOP.G_CURREDITOR=a;"block"==x.style.display&&hideGroupingBox();if("block"==z.style.display)hideGroupingBox();else{if(DEXTTOP.DEXT5.browser.mobile||"mobile"==DEXTTOP.DEXT5.UserAgent.device.type)z.style.top="0px",z.style.left="0px";z.style.display="block";showGroupingBackground();setPositionGroupingDiv(2);var c=z.getElementsByTagName("a"),d=c.length;if(0<d)var e=setInterval(function(){a.groupingBoxOpen&&
(c[0].focus(),setFocusFirstAndLast2(c[0],c[d-1]),a.groupingBoxOpen=!1,clearInterval(e))},100)}}}();DEXTTOP.DEXT5.util.addEvent(d,"click",c);if(("1"==a._config.pluginInstallType||"2"==a._config.pluginInstallType)&&G_dext5plugIn&&!G_dext5plugIn.productKey&&void 0==G_dext5plugIn.productKey)if("0"==a._config.usePluginInstallGuide)requestPluginInstall(window,document,a._config);else{if("0"==a._config.pluginInstallGuideType){var c=getDialogWindow(),A=getDialogDocument(),d={},d=getWindowClientSize(c),n=
"CSS1Compat"==A.compatMode?A.documentElement.scrollWidth:A.body.scrollWidth,y="CSS1Compat"==A.compatMode?A.documentElement.scrollHeight:A.body.scrollHeight,e={},e=getWindowScrollPos(c);null==A.getElementById("d5editor_install_div_back")&&(b=A.createElement("div"),b.innerHTML='<div id="d5editor_install_div_back" style="background-color:white; filter:alpha(opacity=80); opacity:0.8; -moz-opacity:0.8; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=80); -khtml-opacity: 0.8; left: 0px; top: 0px; width: '+
n+"px; height: "+y+"px; display: block; position: absolute; z-index: "+(a._config.pluginInstallGuideZIndex+1)+';"></div>',A.body.appendChild(b.firstChild));null==A.getElementById("d5editor_install_div")&&(n=A.createElement("div"),y='<div id="d5editor_install_div" style="border:2px #0e639c solid; z-index:'+(a._config.pluginInstallGuideZIndex+5)+'; position:fixed; _position:absolute; overflow:hidden; width:600px; height:212px; background-color:white;">',y+='<iframe frameborder="0" src="'+a._config.webPath.pluginInstallGuide+
'" style="position:absolute; width:600px; height:212px; border-width:0px;" title="Plugin Install Guide"></iframe>',n.innerHTML=y+"</div>",y=[0,0],DEXTTOP.DEXT5.browser.quirks&&(y=e),n.firstChild.style.left=y[0]+d[0]/2-300+"px",n.firstChild.style.top=y[1]+d[1]/2-106+"px",DEXTTOP.DEXT5.installGuideResizeEvt=function(){try{var a=A.getElementById("install_div_back");if(a){var b="CSS1Compat"==A.compatMode?A.documentElement.scrollHeight:A.body.scrollHeight;a.style.width=("CSS1Compat"==A.compatMode?A.documentElement.scrollWidth:
A.body.scrollWidth)+"px";a.style.height=b+"px"}}catch(c){}},DEXTTOP.DEXT5.util.addEvent(c,"resize",DEXTTOP.DEXT5.installGuideResizeEvt),A.body.appendChild(n))}else c=640,DEXTTOP.DEXT5.browser.ie&&(c-=4),0==!!DEXTTOP.DEXT5.loadedPluginPopup&&(DEXTTOP.DEXT5.loadedPluginPopup=!0,a.pluginInstallGuidePopup=Dext5_PopupCenter(a._config.webPath.pluginInstallGuide,"DEXT5_Plugin_Install_Guide",c,208,void 0,void 0,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no"));
var B=setInterval(function(){if(G_dext5plugIn&&(G_dext5plugIn.productKey||void 0!=G_dext5plugIn.productKey)){if(clearInterval(B),"1"==a._config.usePluginInstallGuide)if("1"==a._config.pluginInstallGuideType){if(null!=a.pluginInstallGuidePopup)try{a.pluginInstallGuidePopup.close()}catch(b){}}else try{closePluginInstall()}catch(c){}}else{var d=document.getElementById("dext5plugin");d&&(G_dext5plugIn=null,d.parentNode.removeChild(d),fn_createPluginObject(a._config));document.getElementById("dext5plugin")&&
(G_dext5plugIn=document.getElementById("dext5plugin"))}},200)}}if("2"==DEXTTOP.G_CURREDITOR._config.ruler.mode){var G=document.getElementById("dext_ruler_point_0_"+DEXTTOP.G_CURREDITOR.ID),D=document.getElementById("dext_ruler_point_1_"+DEXTTOP.G_CURREDITOR.ID),I=document.getElementById("dext_ruler_point_2_"+DEXTTOP.G_CURREDITOR.ID);DEXTTOP.DEXT5.util.addEvent(G,"mouseover",function(){G.style.cursor="pointer"});DEXTTOP.DEXT5.util.addEvent(D,"mouseover",function(){D.style.cursor="pointer"});DEXTTOP.DEXT5.util.addEvent(I,
"mouseover",function(){I.style.cursor="pointer"});DEXTTOP.DEXT5.util.addEvent(G,"mousedown",rulerStartDrag);DEXTTOP.DEXT5.util.addEvent(D,"mousedown",rulerStartDrag);DEXTTOP.DEXT5.util.addEvent(I,"mousedown",rulerStartDrag)}"1"==DEXTTOP.G_CURREDITOR._config.usePersonalSetting&&DEXTTOP.DEXT5.browser.LocalStorageSupported&&(c=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_"+DEXTTOP.G_CURREDITOR.ID+"_ruler"))&&"0"==c.use&&(DEXTTOP.G_CURREDITOR._config.ruler.view="0",hideRuler(DEXTTOP.G_CURREDITOR))},
_setLazyLoadFrame:function(a){"1"!=DEXTTOP.G_CURREDITOR._config.contextMenuDisable&&DEXT5_CONTEXT._create(a);"0"==DEXTTOP.G_CURREDITOR._config.top_menu&&DEXT5_TOPMENU._create(a)},_setEditorResizeBar:function(){DEXTTOP.G_CURREDITOR.dextResize=new DextResize(DEXTTOP.G_CURREDITOR);DEXTTOP.G_CURREDITOR.dextResize.createStatusResizeBar();DEXTTOP.G_CURREDITOR.dextResize.apply(DEXTTOP.DEXTDOC)},_dextSetting:function(a){this._setting.grid_color=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"grid_color");this._setting.grid_color_nm=
DEXTTOP.DEXT5.util.xml.getNodeValue(a,"grid_color_nm");this._setting.grid_spans=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"grid_spans");this._setting.grid_form=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"grid_form");this._setting.encoding=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"encoding");this._PageProp.encoding=this._setting.encoding;if(""!=DEXTTOP.DEXT5.config.Document.DocTitle)this._setting.page_title=DEXTTOP.DEXT5.config.Document.DocTitle;else{var b=DEXTTOP.DEXT5.util.xml.getNode(a,"document"),b=DEXTTOP.DEXT5.util.xml.getNodeValue(b,
"doc_title");""!=b&&(this._setting.page_title=b)}this._setting.page_title&&""!=this._setting.page_title||(this._setting.page_title=dext5_lang.document.no_title);b="";""!=DEXTTOP.DEXT5.config.EnforceDoctype?this._config.enforceDoctype=DEXTTOP.DEXT5.config.EnforceDoctype:(b=DEXTTOP.DEXT5.util.xml.getNode(a,"doctype"))&&b.getAttribute("enforce_doctype")&&""!=b.getAttribute("enforce_doctype")&&(this._config.enforceDoctype=b.getAttribute("enforce_doctype"));"1"==this._config.enforceDoctype?b="None":"2"==
this._config.enforceDoctype?DEXTTOP.DEXT5.browser.ie?b="Auto":(b="None",this._config.enforceDoctype="1"):b=""!=DEXTTOP.DEXT5.config.DocType?DEXTTOP.DEXT5.config.DocType:DEXTTOP.DEXT5.util.xml.getNodeValue(a,"doctype");this._setting.doctype=this._setting_DocType(b);this._PageProp.doctype=this._setting.doctype;this._setting.xmlnsname=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"xmlnsname");this._PageProp.xmlnsname=this._setting.xmlnsname;this._setting.lang=DEXTTOP.G_CURREDITOR._config.lang;if((this._PageProp.lang=
this._setting.lang)&&0<this._setting.lang.length){var b=document.getElementsByTagName("html")[0],c=this._setting.lang;-1<c.indexOf("-")&&(c=c.split("-")[0]);b.setAttribute("lang",c);b.setAttribute("xml:lang",c);0<this._setting.xmlnsname.length&&b.setAttribute("xmlns",this._setting.xmlnsname)}this._setting.font_family=this._config.defaultFontFamily;this._setting.font_size=this._config.defaultFontSize;this._setting.line_height=this._config.defaultLineHeight;this._setting.show_font_real=DEXTTOP.DEXT5.util.xml.getNodeValue(a,
"show_font_real");""==this._setting.show_font_real&&(this._setting.show_font_real="0");"CCODE_001"==this._config.custom_code&&(this._setting.show_font_real="1");"1"==this._setting.show_font_real&&(b=DEXTTOP.DEXT5.util.xml.getNode(a,"show_font_real"))&&b.getAttribute("mode")&&""!=b.getAttribute("mode")&&(this._config.showRealFontMode=b.getAttribute("mode"));this._setting.enter_tag=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"enter_tag");this._setting.shift_enter_tag=DEXTTOP.DEXT5.util.xml.getNodeValue(a,
"shift_enter_tag");a=getAutoSave(DEXTTOP.G_CURREDITOR);"0"!=a&&("1"==DEXTTOP.G_CURREDITOR._config.setAutoSave.mode?a="1,"+DEXTTOP.G_CURREDITOR._config.setAutoSave.interval:"0"==DEXTTOP.G_CURREDITOR._config.setAutoSave.mode&&(a="2"));this._setting.auto_save=a;this._setting.auto_save_fn=null;"2"!=DEXTTOP.G_CURREDITOR._config.ruler.mode&&"1"==DEXTTOP.G_CURREDITOR._config.usePersonalSetting&&DEXTTOP.DEXT5.browser.LocalStorageSupported?(a=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_"+this.ID+"_ruler"))?
(a=a.position,a=a.replace("10,10,",""),this._setting.ruler_position=a):this._setting.ruler_position=DEXTTOP.G_CURREDITOR._config.ruler.rulerInitPosition:this._setting.ruler_position=DEXTTOP.G_CURREDITOR._config.ruler.rulerInitPosition;this._docType.Auto=DEXTTOP.DEXT5.util.getDocType(DEXTTOP.document);this._docType.None="";this._docType["XHTML 1.1"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">';this._docType["XHTML 1.0 Transitional"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';
this._docType["XHTML 1.0 Strict"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">';this._docType["XHTML 1.0 Frameset"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">';this._docType["HTML 5"]="<!DOCTYPE html>";this._docType["HTML 4.01 Transitional"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">';this._docType["HTML 4.01 Strict"]=
'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">';this._docType["HTML 4.01 Frameset"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">';this._docType["HTML 3.2"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">';this._docType["HTML 2.0"]='<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">'},_setting_DocType:function(a){for(var b="HTML 5",c="Auto;None;XHTML 1.1;XHTML 1.0 Transitional;XHTML 1.0 Strict;XHTML 1.0 Frameset;HTML 5;HTML 4.01 Transitional;HTML 4.01 Strict;HTML 4.01 Frameset;HTML 3.2;HTML 2.0".split(";"),
d=c.length,e=0;e<d;e++)if(a==c[e]){b=a;break}return b},_makeEditorTopMenu:function(a){var b=this._config.style.skinName,c="",d=DEXTTOP.DEXT5.util.xml.count(a,"menu");0==d&&(this._config.top_menu="1");var e="";borderLeftRight="";if("0"==this._config.top_status_bar||"0"==this._config.editorborder)e="border-top-width:0px;";"0"==this._config.editorborder&&(borderLeftRight="border-left-width:0px;border-right-width:0px;");var f="";""!=e+borderLeftRight&&(f=" style='"+e+borderLeftRight+"'");c="1"==this._config.top_menu||
isViewMode(this)?c+('<table style="display:none; height:0px;" border="0" cellpadding="0" cellspacing="0" class="ue_tm tm_'+b+'" id="dext_menu_'+this.ID+'" '+f+">"):c+('<table border="0" cellpadding="0" cellspacing="0" class="ue_tm tm_'+b+'" id="dext_menu_'+this.ID+'" '+f+">");c+='<tr><td><ul id="dext_tab_menu_'+this.ID+'">';for(b=0;b<d;b++)e=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"menu",b),e=DEXTTOP.DEXT5.util.trim(e).toLowerCase(),c+='<li id="ue_'+this.ID+e+'"><a href="javascript:void(0);" id="'+
this.ID+":"+e+'">'+dext5_lang.top_menu[e]+"</a></li>";return c+="</ul></td></tr></table>"},_makeEditorIcon:function(a,b){var c=this._config.style.skinName,d=this._config.webPath.image,e=d+"skin/"+c,f='<span class="ue_SM"><img style="margin:1px; padding: 0px; width: 11px; height: 26px;" src="'+e+'/separator.gif" alt="" /></span>',g="",h=0,h="0"==b?DEXTTOP.DEXT5.util.xml.count(a,"menu"):DEXTTOP.DEXT5.util.xml.count(a,"tool"),n=isViewMode(this);"0"==b?g=g+"<tr>"+('\t<td class="ue_tdb_'+c+'" style="padding: 1px 5px 0px 5px;" >'):
"1"==b?(g+='<tr id="tool1_'+this.ID+'">',g="3"==this._config.tool_bar||"1"==this._config.tool_bar||n?"mono"==c?g+('\t<td class="ue_tdb_'+c+' txt_ip_blue" style="padding: 5px 5px 5px 5px; display:none;" id="dext_tab_tool1_'+this.ID+'">'):g+('\t<td class="ue_tdb_'+c+' txt_ip_blue" style="padding: 1px 5px 0px 5px; display:none;" id="dext_tab_tool1_'+this.ID+'">'):"mono"==c?g+('\t<td class="ue_tdb_'+c+' txt_ip_blue" style="padding: 5px 5px 5px 5px;" id="dext_tab_tool1_'+this.ID+'">'):g+('\t<td class="ue_tdb_'+
c+' txt_ip_blue" style="padding: 1px 5px 0px 5px;" id="dext_tab_tool1_'+this.ID+'">')):(g+='<tr id="tool2_'+this.ID+'">',g="3"==this._config.tool_bar||"2"==this._config.tool_bar||n?"mono"==c?g+('\t<td class="ue_tdb_'+c+'01 txt_ip_blue" style="padding: 5px 5px 4px 5px; display:none;" id="dext_tab_tool2_'+this.ID+'">'):g+('\t<td class="ue_tdb_'+c+'01 txt_ip_blue" style="padding: 2px 5px 0px 5px; background-image:url('+e+'/ue_tbg01.gif); display:none;" id="dext_tab_tool2_'+this.ID+'">'):"mono"==c?g+
('\t<td class="ue_tdb_'+c+'01 txt_ip_blue" style="padding: 5px 5px 4px 5px;" id="dext_tab_tool2_'+this.ID+'">'):g+('\t<td class="ue_tdb_'+c+'01 txt_ip_blue" style="padding: 2px 5px 0px 5px; background-image:url('+e+'/ue_tbg01.gif);" id="dext_tab_tool2_'+this.ID+'">'));for(e=0;e<h;e++){if("0"==b)n=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"menu",e);else{n=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"tool",e);if("apply_format"==n){if(""!=DEXTTOP.DEXT5.config.ApplyFormatExceptStyle)this._config.applyFormatExceptStyle=
DEXTTOP.DEXT5.config.ApplyFormatExceptStyle.split(",");else{var m=DEXTTOP.DEXT5.util.xml.getNodeIdx(a,"tool",e);m&&m.getAttribute("except_style")&&""!=m.getAttribute("except_style")&&(this._config.applyFormatExceptStyle=m.getAttribute("except_style").split(","))}this.isUseApplyFormat=!0}"full_screen"==n?(m=DEXTTOP.DEXT5.util.xml.getNodeIdx(a,"tool",e),""!=DEXTTOP.DEXT5.config.FullScreenTop?this._config.fullScreenTop=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.config.FullScreenTop):m&&m.getAttribute("top")&&
""!=m.getAttribute("top")&&(this._config.fullScreenTop=DEXTTOP.DEXT5.util.parseIntOr0(m.getAttribute("top"))),""!=DEXTTOP.DEXT5.config.FullScreenLeft?this._config.fullScreenLeft=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.config.FullScreenLeft):m&&m.getAttribute("left")&&""!=m.getAttribute("left")&&(this._config.fullScreenLeft=DEXTTOP.DEXT5.util.parseIntOr0(m.getAttribute("left"))),""!=DEXTTOP.DEXT5.config.FullScreenRight?this._config.fullScreenRight=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.config.FullScreenRight):
m&&m.getAttribute("right")&&""!=m.getAttribute("right")&&(this._config.fullScreenRight=DEXTTOP.DEXT5.util.parseIntOr0(m.getAttribute("right"))),""!=DEXTTOP.DEXT5.config.FullScreenBottom?this._config.fullScreenBottom=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.DEXT5.config.FullScreenBottom):m&&m.getAttribute("bottom")&&""!=m.getAttribute("bottom")&&(this._config.fullScreenBottom=DEXTTOP.DEXT5.util.parseIntOr0(m.getAttribute("bottom")))):"text_paste"==n&&(m=DEXTTOP.DEXT5.util.xml.getNodeIdx(a,"tool",e))&&
m.getAttribute("mode")&&""!=m.getAttribute("mode")&&(this.setTextPasteMode=m.getAttribute("mode"))}for(var n=DEXTTOP.DEXT5.util.trim(n).toLowerCase(),m=this.remove_item.length,p=0;p<m;p++)if(this.remove_item[p].toLowerCase()==n){n="remove";break}if("0"==b)g+='<span class="uebutton_combo_on" id="dext_span_'+this.ID+n+'" >',g+="</span>",g+=f;else if(0==n.indexOf("p_"))m=n.replace("p_",""),g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">',p="",DEXTTOP.DEXT5.browser.ie&&(p="vertical-align:bottom; "),
g+='\t<a href="javascript:;" id="'+this.ID+":"+n+'"><img style="'+p+'margin: 0px; padding: 0px; width: 20px; height: 20px;" id="ue_'+this.ID+n+'" class="ue_H ue_M" title="" alt="" src="'+this._config.webPath.plugin+m+'/images/icon.png" /></a>',g+="</span>",G_ICON_FULL_SET.push(n);else if(getCustomIconAttr(n).isCustom)m="custom",null!=DEXTTOP.DEXT5.ajax.load(d+"icon/"+getCustomIconAttr(n).command+".gif")&&(m=getCustomIconAttr(n).command),g+='<span style="" class="uebutton_span_on" id="dext_span_'+
this.ID+n+'">',g+='\t<a href="javascript:;" id="'+this.ID+":"+n+'"><img style="margin: 2px 0px 0px 1.5px; padding: 0px; width: 16px; height: 16px;" id="ue_'+this.ID+n+'" class="ue_H ue_M" title="" alt="" src="'+d+"icon/"+m+'.gif" /></a>',g+="</span>",G_ICON_FULL_SET.push(n);else switch(n){case "remove":break;case "separator":g+=f;break;case "font_family":case "font_size":case "line_height":case "formatting":case "letter_spacing":m=!1;switch(n){case "font_family":"1"==this._config.useFontFamilyKeyin&&
(m=!0);break;case "font_size":"1"==this._config.useFontSizeKeyin&&(m=!0);break;case "line_height":"1"==this._config.useLineHeightKeyin&&(m=!0)}if(m){if(m="",DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.quirks&&(m="22px"),g+='<span class="uebutton_combo_on',"font_size"==n&&"1"==this._config.useFontSizeIncDec?g+=" fontSize upDown":"line_height"==n&&"1"==this._config.useLineHeightIncDec&&(g+=" lineHeight upDown"),g+='" id="dext_span_'+this.ID+n+'" >',g+='\t<textarea placeholder="" rows="1" wrap="soft" id="txtara_'+
this.ID+n+'" style="height:'+m+';" title="'+dext5_lang.icon[n].replace("\uae30\ubcf8","")+'"></textarea>',g+='<a class="t_arrow" href="javascript:void(0);"  id="ue_'+this.ID+n+'"></a>',"font_size"==n&&"1"==this._config.useFontSizeIncDec||"line_height"==n&&"1"==this._config.useLineHeightIncDec)g+='<a class="t_arrow t_arrow_top" href="javascript:void(0);"  id="ue_'+this.ID+n+'_inc" style="cursor: pointer;">',g+="</a>",g+='<a class="t_arrow t_arrow_bottom" href="javascript:void(0);"  id="ue_'+this.ID+
n+'_dec" style="cursor: pointer;"></a>'}else if(m="",m="line_height"==n?"Fsize_Btn_"+c:"Font_Btn_"+c,g+='<span class="uebutton_combo_on',"font_size"==n&&"1"==this._config.useFontSizeIncDec?g+=" fontSize upDown":"line_height"==n&&"1"==this._config.useLineHeightIncDec?g+=" lineHeight upDown":"letter_spacing"==n&&"1"==this._config.useLetterSpacingIncDec&&(g+=" spacing upDown"),g+='" id="dext_span_'+this.ID+n+'" >',g+='\t<button unselectable="on" onmousedown="return false;" id="ue_'+this.ID+n+'" class="'+
m+'" type="button" title="'+dext5_lang.icon[n].replace("\uae30\ubcf8","")+'" style="margin:0;"><span></span></button>',"line_height"==n&&"1"==this._config.useLineHeightIncDec||"letter_spacing"==n&&"1"==this._config.useLetterSpacingIncDec||"font_size"==n&&"1"==this._config.useFontSizeIncDec)g+='<a class="t_arrow t_arrow_top" href="javascript:void(0);"  id="ue_'+this.ID+n+'_inc" style="cursor: pointer;"></a>',g+='<a class="t_arrow t_arrow_bottom" href="javascript:void(0);"  id="ue_'+this.ID+n+'_dec" style="cursor: pointer;"></a>';
g+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<span id="dext_pan_'+n+"_"+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';g+="\t</span>";g+="</span>";break;case "table_insert":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="'+this.ID+":"+n+'" class="'+n+'"><span id="ue_'+this.ID+n+'" style="display:block;width:16px; height:16px;"></span></a>';
g+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<span id="dext_pan_'+n+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc;">';g+='\t\t\t<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;">0 * 0</span>';g+="\t\t</span>";g+="\t</span>";g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_table_insert">';
g+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_table_insert" class="dialog"></a>';g+="</span>";break;case "detail_table_insert":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="'+this.ID+":"+n+'" class="'+n+'"><span id="ue_'+this.ID+n+'" style="display:block;width:16px; height:16px;"></span></a>';g+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<span id="dext_pan_'+n+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc;">';
g+='\t\t\t<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;">0 * 0</span>';g+="\t\t</span>";g+="\t</span>";g+="</span>";break;case "detail_table_insert_new":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="'+this.ID+":"+n+'" class="'+n+'"><span id="ue_'+this.ID+n+'" style="display:block;width:16px; height:16px;"></span></a>';g+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<span id="dext_pan_'+
n+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc; ">';g+='\t\t\t<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;">0 * 0</span>';g+="\t\t</span>";g+="\t</span>";g+="</span>";break;case "font_color":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+n+'" class="'+n+'">';g+='<em class="dext_font_color_basic dext_color_style1" id="dext_em_'+
this.ID+'color_show"></em>';g+="</a>";g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_font_color">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_font_color" class="dialog"></a>';g+="</span>";break;case "detail_font_color":break;case "font_bg_color":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+n+'" class="'+n+'">';g+='\t<em class="dext_font_color_basic dext_color_style2" id="dext_em_'+
this.ID+'bg_color_show"></em>';g+="</a>";g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_font_bg_color">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_font_bg_color" class="dialog"></a>';g+="</span>";break;case "detail_font_bg_color":break;case "cell_bg_color":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+n+'" class="'+n+'">';g+='\t    <em class="dext_font_color_basic dext_color_style2" id="dext_em_'+
this.ID+'cell_bg_color_show"></em>';g+="    </a>";g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_cell_bg_color">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_cell_bg_color" class="dialog"></a>';g+="</span>";break;case "detail_cell_bg_color":break;case "list_number":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+n+'" class="'+n+'"></a>';g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+
this.ID+'detail_list_number">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_list_number" class="dialog"></a>';g+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<span id="dext_pan_detail_list_number_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc;"></span>';g+="\t</span>";g+="</span>";break;case "detail_list_number":break;case "list_bullets":g+='<span style="" class="uebutton_span_on" id="dext_span_'+
this.ID+n+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+n+'" class="'+n+'"></a>';g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_list_bullets">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_list_bullets" class="dialog"></a>';g+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<span id="dext_pan_detail_list_bullets_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';
g+="\t</span>";g+="</span>";break;case "detail_list_bullets":break;case "align_group":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+n+'" class="'+n+'"></a>';g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'align_group_detail">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'align_group_detail" class="dialog"></a>';g+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+
2E3)+'">';g+='\t\t<span id="dext_span_align_group_detail_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';g+="\t</span>";g+="</span>";break;case "align_group_detail":break;case "order_of_objects":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+n+'" class="'+n+'"></a>';g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+
this.ID+'order_of_objects_detail">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'order_of_objects_detail" class="dialog"></a>';g+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<span id="dext_span_order_of_objects_detail_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';g+="\t</span>";g+="</span>";break;case "order_of_objects_detail":break;case "table_group":g+=
'<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+n+'" class="'+n+'"></a>';g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'table_group_detail">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'table_group_detail" class="dialog"></a>';g+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<span id="dext_span_table_group_detail_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';
g+="\t</span>";g+="</span>";break;case "table_group_detail":break;case "insert_datetime":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+n+'" class="'+n+'">';g+="</a>";g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_insert_datetime">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_insert_datetime" class="dialog"></a>';g+="</span>";break;case "detail_insert_datetime":break;default:g+=
'<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+n+'">',g+='\t<a href="javascript:;" id="ue_'+this.ID+n+'" class="'+n+'"></a>',g+="</span>"}}if("1"==b){c=!1;m=this.remove_item.length;for(p=0;p<m;p++)if("about"==this.remove_item[p]){c=!0;break}0==c&&(g+='<span style="" class="uebutton_span_on">',g+='\t<a href="javascript:;" id="'+this.ID+':about" class="about"><span id="ue_'+this.ID+'about" style="display:block;width:16px; height:16px;"></span></a>',g+="</span>")}"1"==this._config.tool_bar_grouping&&
("1"==b?(g+='<span style="z-index:'+(G_MAIN_ZINDEX+850)+';" class="tool_bar_grouping" id="dext_span_'+this.ID+'tool_bar_grouping1">',g+='\t<a href="javascript:;" id="ue_'+this.ID+'tool_bar_grouping1" class=""><span style="display:none;">'+dext5_lang.icon.toolbar_grouping+" 1</span></a>",g+="</span>"):"2"==b&&(g+='<span style="z-index:'+(G_MAIN_ZINDEX+850)+';" class="tool_bar_grouping" id="dext_span_'+this.ID+'tool_bar_grouping2">',g+='\t<a href="javascript:;" id="ue_'+this.ID+'tool_bar_grouping2" class=""><span style="display:none;">'+
dext5_lang.icon.toolbar_grouping+" 2</span></a>",g+="</span>"));g+="\t</td>";return g+="</tr>"},_makeEditorFormBar:function(a){var b="";if("1"==this._config.formMode){var c=this._config.style.skinName,d='<span class="ue_SM"><img style="margin:1px; padding: 0px; width: 11px; height: 26px;" src="'+(this._config.webPath.image+"skin/"+c)+'/separator.gif" alt="" /></span>',e=0,e=DEXTTOP.DEXT5.util.xml.count(a,"tool");if(0<e&&"1"==this._config.formMode)for(b=b+('<table id="" class="ue_table02 tm_'+c+'2" border="0" cellpadding="0" cellspacing="0">')+
"<tbody>",b+='<tr id="tool3_'+this.ID+'">',b+='<td class="ue_tdb_ty ue_tdb_'+c+'">',c=0;c<e;c++){var f;f=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"tool",c);f=DEXTTOP.DEXT5.util.trim(f).toLowerCase();for(var g=this.remove_item.length,h=0;h<g;h++)if(this.remove_item[h]==f){f="remove";break}switch(f){case "remove":break;case "separator":b+=d;break;default:b+='<span id="dext_span_'+this.ID+f+'" class="uebutton_type_on"><a id="ue_'+this.ID+f+'" title="" href="javascript:;" class="'+f.replace("input_",
"type_")+'"></a></span>'}}b+="</td>";b+="</tr>";b+="</tbody>";b+="</table>"}return b},_div_pan_reset:function(a){},_iconEnable:function(a,b){if(null==this.iconEnableCommandType||this.iconEnableCommandType!=a||"undo"==G_LAST_CMD||"redo"==G_LAST_CMD){this.iconEnableCommandType=a;if(0==DEXTTOP.G_CURREDITOR._config.editorBodyEditable&&(""==a||"default"==a))try{var c=getFirstRange().range.startContainer;3==c.nodeType&&(c=c.parentNode);0==c.isContentEditable&&(a="editableFalse")}catch(d){}for(var e=null,
f=null,g="",c=e="",h=0,n=G_ICON_FULL_SET.length;h<n;h++)if(g=DEXTTOP.DEXT5.util.trim(G_ICON_FULL_SET[h]).toLowerCase(),e=document.getElementById("ue_"+this.ID+g),f=document.getElementById("dext_span_"+this.ID+g),e&&(e.style.cursor="pointer"),f){switch(g){case "formatting":case "font_family":case "font_size":case "line_height":case "letter_spacing":e="font_size"==g&&"1"==this._config.useFontSizeIncDec?"fontSize upDown uebutton_combo_":"line_height"==g&&"1"==this._config.useLineHeightIncDec?"lineHeight upDown uebutton_combo_":
"letter_spacing"==g&&"1"==this._config.useLetterSpacingIncDec?"spacing upDown uebutton_combo_":"uebutton_combo_";break;case "detail_table_insert":case "detail_list_number":case "detail_list_bullets":case "order_of_objects_detail":case "align_group_detail":case "table_group_detail":case "detail_font_color":case "detail_font_bg_color":case "detail_cell_bg_color":case "detail_insert_datetime":e="uebutton_dialog_";break;case "input_textfield":case "input_textarea":case "input_select":case "input_checkbox":case "input_radio":case "input_button":case "input_imagebutton":case "input_hiddenfield":case "input_align_left":case "input_align_right":case "input_valign_top":case "input_valign_bottom":case "input_same_width":case "input_same_height":case "input_word_spacing":case "input_line_height":case "input_same_width_height":case "table_lock":case "cell_lock":case "table_lock_property":case "placeholder":e=
"uebutton_type_";break;default:e="uebutton_span_"}(c=DEXTTOP.DEXT5.util.getClass(f))&&-1<c.indexOf("_off")&&(DEXTTOP.DEXT5.util.setClass(f,e+"on"),f=f.getElementsByTagName("a")[0])&&(f.title=dext5_lang.icon[g])}c=[];switch(a){case "":case "default":c="copy cut table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property table_tool cell_border cell_bg_color table_group table_group_detail apply_format image_align_default image_align_left image_align_right table_lock cell_lock table_lock_property detail_cell_bg_color element_position order_of_objects order_of_objects_detail table_adjust insert_table_top_paragraph insert_table_bottom_paragraph".split(" ");
break;case "selectedSingleCell":c="new save print pagebreak copy cut paste text_paste find replace template emoticon horizontal_line image_create image_editor flash_create insert_link_media media_create iframe_create hyperlink_create insert_file file_open bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete insert_row_up insert_row_down insert_column_left insert_column_right merge_cell cell_size table_same_width table_same_height table_same_widthheight full_screen entity insert_row_column insert_row insert_column table_row_clone table_selection table_select row_property column_property indent outdent format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton show_blocks photo_editor insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder chart insert_table_top_paragraph insert_table_bottom_paragraph".split(" ");
break;case "selectedMultiCell":c="new save print pagebreak copy cut paste text_paste find replace emoticon horizontal_line template image_create image_editor flash_create insert_link_media media_create iframe_create hyperlink_create insert_file file_open bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete insert_row_up insert_row_down insert_column_left insert_column_right full_screen entity insert_row_column insert_row insert_column table_row_clone table_selection table_select row_property column_property indent outdent format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton show_blocks photo_editor insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder chart insert_table_top_paragraph insert_table_bottom_paragraph".split(" ");
break;case "focusInCell":c="copy cut pagebreak merge_cell table_same_width table_same_height table_same_widthheight doc_bg_image merge_cell cell_size apply_format image_align_default image_align_left image_align_right".split(" ");break;case "focusTable":c="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create hyperlink_create insert_file file_open insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell remove_css insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight font_color font_bg_color list_number list_bullets detail_list_number detail_list_bullets template entity table_delete insert_row_column insert_row insert_column formatting font_family font_size line_height letter_spacing bold italic underline strike_through superscript subscript remove_format table_row_clone table_selection table_select cell_size align_vertical row_property select_all table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail indent outdent image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder chart table_adjust".split(" ");
"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign&&(c.push("align_left"),c.push("align_center"),c.push("align_right"),c.push("align_full"),c.push("align_group"),c.push("align_group_detail"));break;case "cellSelectText":c="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight template entity table_delete insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_cell_bg_color insert_datetime detail_insert_datetime video calculator mini_photo_editor placeholder chart table_adjust".split(" ");
"1"!=this._config.allowInoutdentText&&(c.push("indent"),c.push("outdent"));canConversion()||c.push("conversion");break;case "selectArea":c="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight template entity table_delete insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_cell_bg_color insert_datetime detail_insert_datetime video calculator mini_photo_editor placeholder chart table_adjust".split(" ");
canConversion()||c.push("conversion");break;case "focusImage":c="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets detail_list_number detail_list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator placeholder chart table_adjust".split(" ");
break;case "focusChart":c="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets detail_list_number detail_list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator placeholder table_adjust".split(" ");
break;case "focusFigure":c="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets detail_list_number detail_list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator align_full placeholder chart table_adjust".split(" ");
break;case "focusEmbed":c="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets indent outdent insert_row_column insert_row insert_column table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator mini_photo_editor placeholder chart table_adjust".split(" ");
break;case "editableFalse":c="copy cut paste text_paste replace emoticon setting horizontal_line image_create image_editor image_property image_editor_property flash_create flash_property media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property remove_hyperlink bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color align_group align_group_detail align_left align_center align_right align_full line_height indent outdent list_number list_bullets detail_list_number detail_list_bullets formatting font_family font_size select_all entity insert_row insert_column table_select cell_size align_vertical table_tool list_number list_bullets insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom grid tool_replace convert_table_to_text insert_link_media paste_word cell_border cell_bg_color table_indent table_outdent ruler pagebreak dirltr dirrtl insert_file format_painter apply_format letter_spacing align image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_textarea_property input_select input_select_property input_imagebutton input_same_width input_same_height input_same_width_height accessibility_validation table_copy table_paste intable_paste table_content_paste horizontal_sum vertical_sum horizontal_avg vertical_avg table_selection show_blocks table_lock cell_lock table_lock_property list_lower_alpha word_transform photo_editor photo_editor_property insert_file_property detail_cell_bg_color insert_datetime detail_insert_datetime conversion personal_data forbidden_word video video_property spell_check calculator mini_photo_editor placeholder chart table_adjust".split(" ");
break;case "allDisable":c=G_ICON_FULL_SET;break;case "dextResize":c="new save print pagebreak find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create hyperlink_create insert_file file_open insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell remove_css insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight font_color font_bg_color list_number list_bullets detail_list_number detail_list_bullets template entity table_delete insert_row_column insert_row insert_column formatting font_family font_size line_height letter_spacing bold italic underline strike_through superscript subscript remove_format table_row_clone table_selection table_select cell_size align_vertical row_property select_all table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail indent outdent image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color table_lock cell_lock table_lock_property insert_datetime detail_insert_datetime video calculator mini_photo_editor placeholder chart table_adjust".split(" ");
break;case "focusPageBreak":c="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets detail_list_number detail_list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor detail_font_color detail_font_bg_color detail_cell_bg_color insert_datetime detail_insert_datetime conversion video calculator placeholder chart table_adjust".split(" ");
break;case "placeholder":c="copy cut paste text_paste replace emoticon setting horizontal_line image_create image_editor image_property image_editor_property flash_create flash_property media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property remove_hyperlink bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color align_group align_group_detail align_left align_center align_right align_full line_height indent outdent list_number list_bullets detail_list_number detail_list_bullets formatting font_family font_size select_all entity insert_row insert_column table_select cell_size align_vertical table_tool list_number list_bullets insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom grid tool_replace convert_table_to_text insert_link_media paste_word cell_border cell_bg_color table_indent table_outdent ruler pagebreak dirltr dirrtl insert_file format_painter apply_format letter_spacing align image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_textarea_property input_select input_select_property input_imagebutton input_same_width input_same_height input_same_width_height accessibility_validation table_copy table_paste intable_paste table_content_paste horizontal_sum vertical_sum horizontal_avg vertical_avg table_selection show_blocks table_lock cell_lock table_lock_property list_lower_alpha word_transform photo_editor photo_editor_property insert_file_property detail_cell_bg_color insert_datetime detail_insert_datetime conversion personal_data forbidden_word video video_property spell_check calculator mini_photo_editor chart table_adjust".split(" ")}for(var m in G_DEPlugin)G_DEPlugin[m].onDisableToolIcon&&
!G_DEPlugin[m].onDisableToolIcon(a)||c.push("p_"+m);c=c.concat(this.lockCommand);0==this.UndoManager.canUndo&&(c[c.length]="undo");0==this.UndoManager.canRedo&&(c[c.length]="redo");if("editableFalse"!=a){b&&1==b&&(c=addDisalbeItemForNoActionTable(c));if("2"==this._setting.auto_save.toString().split(",")[0]||void 0==getAutoSaveHtml_userID(this.ID,this._config.setAutoSave.unique_key)||""==getAutoSaveHtml_userID(this.ID,this._config.setAutoSave.unique_key))c[c.length]="load_auto_save";null==this._formatPainterList&&
(c[c.length]="apply_format");"focusImage"==a&&(h=DEXTTOP.G_SELECTED_IMAGE_ELEMENT)&&h.getAttribute("dext5customdata")&&""!=h.getAttribute("dext5customdata")&&(h=h.getAttribute("dext5customdata"),"iframe"!=getDextCustomData(h).type&&(c.push("image_align_default"),c.push("image_align_left"),c.push("image_align_right")));(h=getFormControlSelectedItem())&&2>h.count&&(c.push("input_same_width"),c.push("input_same_height"),c.push("input_same_width_height"))}h=0;for(n=c.length;h<n;h++)if(g=DEXTTOP.DEXT5.util.trim(c[h]).toLowerCase(),
e=document.getElementById("ue_"+this.ID+g),f=document.getElementById("dext_span_"+this.ID+g),"zoom"!=g&&"zoom_plus"!=g&&"zoom_minus"!=g||"allDisable"!=a)if(e&&(e.style.cursor="default"),f){switch(g){case "formatting":case "font_family":case "font_size":case "line_height":case "letter_spacing":e="font_size"==g&&"1"==this._config.useFontSizeIncDec?"fontSize upDown uebutton_combo_":"line_height"==g&&"1"==this._config.useLineHeightIncDec?"lineHeight upDown uebutton_combo_":"letter_spacing"==g&&"1"==this._config.useLetterSpacingIncDec?
"spacing upDown uebutton_combo_":"uebutton_combo_";break;case "detail_insert_datetime":case "detail_table_insert":case "detail_list_number":case "detail_list_bullets":case "table_group_detail":case "align_group_detail":case "order_of_objects_detail":case "detail_font_color":case "detail_font_bg_color":case "detail_cell_bg_color":e="uebutton_dialog_";break;case "input_textfield":case "input_textarea":case "input_select":case "input_checkbox":case "input_radio":case "input_button":case "input_imagebutton":case "input_hiddenfield":case "input_align_left":case "input_align_right":case "input_valign_top":case "input_valign_bottom":case "input_same_width":case "input_same_height":case "input_word_spacing":case "input_line_height":case "input_same_width_height":case "table_lock":case "cell_lock":case "table_lock_property":case "placeholder":e=
"uebutton_type_";break;default:e="uebutton_span_"}DEXTTOP.DEXT5.util.setClass(f,e+"off");0==g.indexOf("p_")?(m=f.getElementsByTagName("img")[0])&&0>m.title.indexOf(dext5_lang.icon.inactive_button)&&(m.title=m.title+" "+dext5_lang.icon.inactive_button):(f=f.getElementsByTagName("a")[0])&&0>f.title.indexOf(dext5_lang.icon.inactive_button)&&(f.title=dext5_lang.icon[g]+" "+dext5_lang.icon.inactive_button)}DEXT5_TOPMENU._disabeld_menu=c}},_iconSelected:function(a){for(var b="bold italic underline align_left align_center align_right align_full strike_through subscript superscript full_screen grid list_number list_bullets dirltr dirrtl show_blocks table_lock cell_lock table_lock_property font_color font_bg_color table_border".split(" "),
c="",d=0,e=b.length;d<e;d++)if(_icon_id=DEXTTOP.DEXT5.util.trim(b[d]).toLowerCase(),_icon_span=document.getElementById("dext_span_"+this.ID+_icon_id))c=DEXTTOP.DEXT5.util.getClass(_icon_span),c=DEXTTOP.DEXT5.util.replaceAll(c,"uebutton_span_enter",""),c=DEXTTOP.DEXT5.util.trim(c),DEXTTOP.DEXT5.util.setClass(_icon_span,c),_icon_span.style.backgroundImage="";if(a)for(d=0,e=a.length;d<e;d++)if(_icon_id=DEXTTOP.DEXT5.util.trim(a[d]).toLowerCase(),_icon_span=document.getElementById("dext_span_"+this.ID+
_icon_id))c=DEXTTOP.DEXT5.util.getClass(_icon_span),c+=" uebutton_span_enter",DEXTTOP.DEXT5.util.setClass(_icon_span,c),-1<_icon_span.className.indexOf("uebutton_type")?_icon_span.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/form_skinback_release.gif)":_icon_span.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/skinback_release.gif)"},_setTopMenuEvents:function(a){for(var b=this,c=null,d="",e=0,f=DEXTTOP.DEXT5.util.xml.count(a,
"menu");e<f;e++)if(d=DEXTTOP.DEXT5.util.trim(DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"menu",e)).toLowerCase(),c=document.getElementById("ue_"+b.ID+d)){switch(c){case "design":case "source":case "preview":case "text":"textContent"in c?c.textContent=dext5_lang.top_menu[d]:c.innerText=dext5_lang.top_menu[d]}var g=function(c){return function(d){var e=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+b._config.editor_id);null!=e&&(e.style.display="none");c==b._top_menu_click_id?(b._top_menu_click_flag?
(b._top_menu_click_flag=!1,b._top_menu_click_id="",hideTopMenuAndFocus()):(b._top_menu_click_id=c,b._top_menu_click_flag=!0,setTopMenu(d,b,c,b._config,a)),DEXTTOP.DEXT5.util.stopEvent(d)):c!=b._top_menu_click_id&&"design"==DEXTTOP.G_CURREDITOR._currentMode&&(b._top_menu_click_id=c,b._top_menu_click_flag=!0,setTopMenu(d,b,c,b._config,a),DEXTTOP.DEXT5.util.stopEvent(d));d=0;for(e=DEXTTOP.DEXT5.util.xml.count(a,"menu");d<e;d++)_m_id=DEXTTOP.DEXT5.util.trim(DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"menu",
d)).toLowerCase(),_m=document.getElementById("ue_"+b.ID+_m_id),_m.childNodes[0].className=_m_id==b._top_menu_click_id?"on":""}}(d),h=function(c){return function(d){var e=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+b._config.editor_id);null!=e&&(e.style.display="none");b._top_menu_click_flag?(b._top_menu_click_id=c,setTopMenu(d,b,c,b._config,a)):(b._top_menu_click_id="",hideTopMenu());DEXTTOP.DEXT5.util.stopEvent(d);d=0;for(e=DEXTTOP.DEXT5.util.xml.count(a,"menu");d<e;d++)_m_id=DEXTTOP.DEXT5.util.trim(DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,
"menu",d)).toLowerCase(),_m=document.getElementById("ue_"+b.ID+_m_id),_m.childNodes[0].className=_m_id==b._top_menu_click_id?"on":""}}(d),d=function(a){return function(a){b._top_menu_click_flag&&(a=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+b._config.editor_id),null!=a&&(a.style.display=""))}}(d);DEXTTOP.DEXT5.util.addEvent(c,"click",g);DEXTTOP.DEXT5.util.addEvent(c,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(c,"mouseout",d);c=c.getElementsByTagName("a")[0];g=function(a){return function(b){a.className=
"on"}}(c);h=function(a){return function(b){a.className=""}}(c);DEXTTOP.DEXT5.util.addEvent(c,"focus",g);DEXTTOP.DEXT5.util.addEvent(c,"blur",h)}},_setIconEvents:function(){for(var a=this,b=null,c="",d=0,e=G_ICON_FULL_SET.length,f;d<e;d++)if(c=DEXTTOP.DEXT5.util.trim(G_ICON_FULL_SET[d]).toLowerCase(),b=document.getElementById("ue_"+a.ID+c)){if(getCustomIconAttr(G_ICON_FULL_SET[d]).isCustom)b.setAttribute("title",getCustomIconAttr(G_ICON_FULL_SET[d])["desc_"+a._config.lang]),"A"==b.nodeName&&(f=document.createElement("span"),
f.style.display="none",f.innerText=getCustomIconAttr(G_ICON_FULL_SET[d])["desc_"+a._config.lang],b.appendChild(f));else if(null!=dext5_lang.icon[c]&&void 0!=dext5_lang.icon[c])if("design"==c||"source"==c||"preview"==c||"text"==c)0<a._config.statusBarTitle.length&&void 0!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?""!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?b.setAttribute("title",a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]):b.setAttribute("title",
dext5_lang.icon[c]):b.setAttribute("title",dext5_lang.icon[c]);else try{f=document.createElement("span"),f.style.display="none",f.innerText=dext5_lang.icon[c],"A"==b.nodeName?(b.setAttribute("title",dext5_lang.icon[c]),b.appendChild(f)):"SPAN"==b.nodeName&&b.parentNode&&"A"==b.parentNode.nodeName&&(b.parentNode.setAttribute("title",dext5_lang.icon[c]),b.parentNode.appendChild(f))}catch(g){}switch(c){case "top_design":case "top_source":case "top_preview":case "top_text":0<a._config.statusBarTitle.length&&
void 0!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx]?(""!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx]?b.getElementsByTagName("A")[0].title=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx]:b.getElementsByTagName("A")[0].title=dext5_lang.icon[c.replace("top_","")],DEXTTOP.G_CURREDITOR.topStatusBarTitleIdx++):b.getElementsByTagName("A")[0].title=dext5_lang.icon[c.replace("top_","")],b.getElementsByTagName("A")[0].innerHTML=dext5_lang.icon[c.replace("top_",
"")]}switch(c){case "design":case "source":case "preview":case "text":0<a._config.statusBarTitle.length&&void 0!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?(""!=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]?b.getElementsByTagName("A")[0].title=a._config.statusBarTitle[DEXTTOP.G_CURREDITOR.statusBarTitleIdx]:b.getElementsByTagName("A")[0].title=dext5_lang.icon[c],DEXTTOP.G_CURREDITOR.statusBarTitleIdx++):b.getElementsByTagName("A")[0].title=dext5_lang.icon[c],
b.getElementsByTagName("A")[0].innerHTML=dext5_lang.icon[c]}var h=function(b){return function(c){a._dextCommands(a.ID,b);"shortcut"==b&&(G_ShortCutClick=!0);DEXTTOP.DEXT5.util.stopEvent(c)}}(c),n="";switch(c){case "font_family":case "font_size":case "letter_spacing":n="click";break;default:n="click"}DEXTTOP.DEXT5.util.addEvent(b,n,h);b.onmousedown=function(){return!1};b.unselectable="on";h=function(b){return function(c){if(!(-1<",detail_table_insert,detail_list_number,detail_list_bullets,align_group_detail,order_of_objects_detail,table_group_detail,detail_font_color,detail_font_bg_color,detail_cell_bg_color,detail_insert_datetime,".indexOf(","+
b+","))){var d=document.getElementById("dext_span_"+a.ID+b);null!=d&&(""==d.style.backgroundImage&&-1<d.className.indexOf("_on")&&(d.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+"/icon_skinback.gif)"),DEXTTOP.DEXT5.util.stopEvent(c))}}}(c);c=function(b){return function(c){var d=document.getElementById("dext_span_"+a.ID+b);null!=d&&(0<d.style.backgroundImage.indexOf("skinback.gif")&&(d.style.backgroundImage=""),DEXTTOP.DEXT5.util.stopEvent(c))}}(c);DEXTTOP.DEXT5.util.addEvent(b,
"mouseover",h);DEXTTOP.DEXT5.util.addEvent(b,"mouseout",c)}b=function(){return function(b){document.getElementById("ue_toolbar_"+a.ID).onselectstart="";b=b.target||b.srcElement;b.selectionStart=0;b.selectionEnd=b.value.length}}();d=function(){return function(b){document.getElementById("ue_toolbar_"+a.ID).onselectstart=new Function("return false")}}();e=function(){return function(){DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0}}();f=document.getElementById("txtara_"+a.ID+"font_family");c=document.getElementById("txtara_"+
a.ID+"font_size");h=document.getElementById("txtara_"+a.ID+"line_height");n=document.getElementById("ue_"+a.ID+"zoom_text");f&&(DEXTTOP.DEXT5.util.addEvent(f,"focus",b),DEXTTOP.DEXT5.util.addEvent(f,"blur",d),DEXTTOP.DEXT5.util.addEvent(f,"mousedown",e));c&&(DEXTTOP.DEXT5.util.addEvent(c,"focus",b),DEXTTOP.DEXT5.util.addEvent(c,"blur",d),DEXTTOP.DEXT5.util.addEvent(c,"mousedown",e));h&&(DEXTTOP.DEXT5.util.addEvent(h,"focus",b),DEXTTOP.DEXT5.util.addEvent(h,"blur",d),DEXTTOP.DEXT5.util.addEvent(h,
"mousedown",e));n&&DEXTTOP.DEXT5.util.addEvent(n,"mousedown",e);this._load_editor_frame(!0)},_load_editor_frame:function(a){var b=this;void 0==b._EDITOR&&DEXTTOP.G_CURREDITOR&&""!=DEXTTOP.G_CURREDITOR._config.directEditHtmlUrl&&(b=DEXTTOP.G_CURREDITOR);b._EDITOR.design=document.getElementById("dext5_design_"+b.ID);b._EDITOR.source=document.getElementById("dext5_source_"+b.ID);b._EDITOR.preview=document.getElementById("dext5_preview_"+b.ID);b._EDITOR.text=document.getElementById("dext5_text_"+b.ID);
var c=b._EDITOR.design;b._DOC=c.contentDocument?c.contentDocument:c.contentWindow.document;G_USE_EDITOR_ID=b.ID;DEXTTOP.G_CURREDITOR=b;b._BODY=b._DOC.body;"1"!=b._config.browserSpellCheck&&"spellcheck"in b._BODY&&(b._BODY.spellcheck=!1);"contentEditable"in b._BODY&&(isViewMode(b)?b._BODY.contentEditable=!1:b._BODY.contentEditable=a&&""!=b._config.focusInitObjId?!1:!0,0==b._config.editorBodyEditable&&(b._BODY.contentEditable=!1));LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID);
LayerFrame.title=dext5_lang.iframe_title.layer;dext_src_init_once(c,b);dext_src_init(c);0<_iframeDoc.body.clientWidth&&(b._defTableWidth=_iframeDoc.body.clientWidth-30,b._defaultWidth=_iframeDoc.body.clientWidth-30);100>b._defTableWidth&&(b._defTableWidth=400,b._defaultWidth=400);"1"==b._config.useFontSizeKeyin?document.getElementById("txtara_"+b.ID+"font_size")&&("1"==b._setting.show_font_real?document.getElementById("txtara_"+b.ID+"font_size").value=b._setting.font_size:document.getElementById("txtara_"+
b.ID+"font_size").value=dext5_lang.icon.font_size):document.getElementById("ue_"+b.ID+"font_size")&&("1"==b._setting.show_font_real?document.getElementById("ue_"+b.ID+"font_size").innerHTML="<span>"+b._setting.font_size+"</span>":document.getElementById("ue_"+b.ID+"font_size").innerHTML="<span>"+dext5_lang.icon.font_size+"</span>");"1"==b._config.useFontFamilyKeyin?document.getElementById("txtara_"+b.ID+"font_family")&&("1"==b._setting.show_font_real?document.getElementById("txtara_"+b.ID+"font_family").value=
b._setting.font_family:document.getElementById("txtara_"+b.ID+"font_family").value=dext5_lang.icon.font_family):document.getElementById("ue_"+b.ID+"font_family")&&("1"==b._setting.show_font_real?document.getElementById("ue_"+b.ID+"font_family").innerHTML="<span>"+b._setting.font_family+"</span>":document.getElementById("ue_"+b.ID+"font_family").innerHTML="<span>"+dext5_lang.icon.font_family+"</span>");document.getElementById("ue_"+b.ID+"letter_spacing")&&(document.getElementById("ue_"+b.ID+"letter_spacing").innerHTML=
"<span>"+dext5_lang.icon.letter_spacing+"</span>");""!=b._config.defaultMessage&&(c=b._BODY.innerHTML,"<p></p>"==c||"<P></P>"==c?b._BODY.innerHTML="<p>"+b._config.defaultMessage+"</p>":b._config.defaultMessage="");if(a){a=function(){return function(a){a=_dext_editor;null==a&&(a=DEXTTOP.G_CURREDITOR);if(0==isDEXTContainerMode())try{resizeEditor(a,!1)}catch(b){}"1"==a._config.tool_bar_grouping&&(groupingIcon(a),setPositionGroupingDiv(1),setPositionGroupingDiv(2));"1"==a._config.ruler.useResizeEvent&&
setRulerPositionForNode()}}();DEXTTOP.DEXT5.util.addEvent(window,"resize",a);try{if(setTimeout(function(){var a=_dext_editor.Frame;if(DEXTTOP.DEXT5.browser.LocalStorageSupported){var b=DEXTTOP.DEXTWIN.localStorage["dext_"+a.editor.ID+"_auto_list"];b&&(a.editor._config.autoList.use=b)}try{setAutoSave(a.editor,!0)}catch(c){}try{isViewMode(a.editor)?a.editor._BODY.style.cursor="auto":showRuler(a.editor)}catch(d){}try{if(""!=a.editor._config.setValueObjId){var e=DEXTTOP.DEXTDOC.getElementById(a.editor._config.setValueObjId);
if(e){var p=e.value;""!=p&&DEXTTOP.DEXT5.setHtmlContents(p,a.editor.ID)}}}catch(t){}b=a.editor._config.statusBarInitMode;if("design"!=b){for(var e=!1,p=a.editor._config.statusBarItem.split(","),q=p.length,u=0;u<q;u++)if("design"==p[u]){e=!0;break}e||(a.editor._EDITOR.design.style.width="0px",a.editor._EDITOR.design.style.height="0px");DEXTTOP.DEXT5.ShowTextChangeAlert=!1;a.editor._dextCommands(a.editor.ID,b);DEXTTOP.DEXT5.ShowTextChangeAlert=!0}try{try{DEXT5_EDITOR.prototype._setLazyLoadFrame(a.editor.ID)}catch(v){}try{var w=
DEXTTOP.DEXTDOC.getElementById("dext_toolmenu_background"+a.editor.ID);w&&w.parentNode.removeChild(w)}catch(y){}try{var x=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+a.editor.ID);x&&x.parentNode.removeChild(x)}catch(z){}try{var A=DEXTTOP.DEXTDOC.getElementById("dext_context_background");A&&A.parentNode.removeChild(A)}catch(B){}try{var G=DEXTTOP.DEXTDOC.getElementById("dext_disabled");G&&G.parentNode.removeChild(G)}catch(D){}try{var I=DEXTTOP.DEXTDOC.getElementById("dext_dialog");I&&I.parentNode.removeChild(I)}catch(K){}DEXTTOP.DEXT5.setDirty(a.editor.ID);
a.editor._config.isLoadedEditor=!0;setScrollStyleForIOS(a.editor);0!=a.editor._config.initFocus||DEXTTOP.DEXT5.browser.ie||(a.editor.isInitFocusHandler=!1);null==DEXTTOP.DEXT5.IsEditorLoadedHashTable&&(DEXTTOP.DEXT5.IsEditorLoadedHashTable=new DEXTTOP.DEXT5.util.hashTable);"1"!=DEXTTOP.DEXT5.IsEditorLoadedHashTable.getItem(a.editor.ID)&&DEXTTOP.DEXT5.IsEditorLoadedHashTable.setItem(a.editor.ID,"1");showWordCount();for(var E in G_DEPlugin)if("function"===typeof G_DEPlugin[E].onLoaded)G_DEPlugin[E].onLoaded();
if(""==a.editor._config.LoadedEvent){""!=a.editor._config.directEditHtmlUrl&&loadDirectEditHtmlUrl(a.editor._config);try{"function"===typeof DEXTTOP.DEXTWIN.dext_editor_loaded_event&&DEXTTOP.DEXTWIN.dext_editor_loaded_event(a)}catch(N){}}else if("function"==typeof a.editor._config.LoadedEvent)try{DEXTTOP.DEXT5.config.LoadedEvent(a)}catch(H){}1==a.editor.isInitFocusHandler&&0==a.editor._config.initFocus&&DEXTTOP.DEXT5.browser.ie?a.editor.isInitFocusHandler=!1:setRulerPositionForNode(a.editor);setEditorIframeTitle(a.editor);
if(DEXTTOP.DEXT5.InitEditorDataHashTable){var J=DEXTTOP.DEXT5.InitEditorDataHashTable.getItem(a.editor.ID);"undefined"!=typeof J&&("object"==typeof J?"setHtmlValueExWithDocType"==J.mode?DEXTTOP.DEXT5.setHtmlValueExWithDocType(J.value,a.editor.ID):"setHtmlValueEx"==J.mode?DEXTTOP.DEXT5.setHtmlValueEx(J.value,a.editor.ID):"setHtmlValue"==J.mode?DEXTTOP.DEXT5.setHtmlValue(J.value,a.editor.ID):"setBodyValueEx"==J.mode?DEXTTOP.DEXT5.setBodyValueEx(J.value,a.editor.ID):"setBodyValueExLikeDiv"==J.mode?DEXTTOP.DEXT5.setBodyValueExLikeDiv(J.value,
a.editor.ID):"setBodyValue"==J.mode?DEXTTOP.DEXT5.setBodyValue(J.value,a.editor.ID):"loadHtmlValueExFromURL"==J.mode?DEXTTOP.DEXT5.loadHtmlValueExFromURL(J.value,a.editor.ID):"loadHtmlValueExFromServerURL"==J.mode?DEXTTOP.DEXT5.loadHtmlValueExFromServerURL(J.value,a.editor.ID):"setDirectEditHtmlUrl"==J.mode?DEXTTOP.DEXT5.setDirectEditHtmlUrl(J.value,a.editor.ID):"setOriginalHtmlValue"==J.mode&&DEXTTOP.DEXT5.setOriginalHtmlValue(J.value,a.editor.ID):DEXTTOP.DEXT5.setHtmlContentsEw(J,a.editor.ID),DEXTTOP.DEXT5.InitEditorDataHashTable.removeItem(a.editor.ID))}}catch(M){}try{if(""!=
a.editor._config.focusInitObjId){var L=DEXTTOP.DEXTDOC.getElementById(a.editor._config.focusInitObjId);a.editor._config.focusInitObjIdEx=a.editor._config.focusInitObjId;a.editor._config.focusInitObjId="";L?setTimeout(function(){var b=DEXTTOP.DEXTDOC.getElementById(a.editor._config.tabIndexObjId);b&&(b.tabIndex=""!=a.editor._config.tabIndexObjValue?a.editor._config.tabIndexObjValue:"0",a.editor._config.tabIndexObjId="");L.focus();!isViewMode(a.editor)&&a.editor._config.editorBodyEditable&&(a.editor._BODY.contentEditable=
!0)},100):0==isViewMode(a.editor)&&setTimeout(function(){!isViewMode(a.editor)&&a.editor._config.editorBodyEditable&&(a.editor._BODY.contentEditable=!0)},200)}}catch(F){}try{""!=a.editor._config.focusInitEditorObjId&&setTimeout(function(){DEXTTOP.DEXT5.setFocusToObject(a.editor._config.focusInitEditorObjId,!1,a.editor.ID);a.editor._config.focusInitEditorObjId=""},2E3)}catch(C){}try{"function"===typeof DEXTTOP.DEXTWIN.editor_loaded_event&&DEXTTOP.DEXTWIN.editor_loaded_event(a)}catch(W){}},100),0==
this._config.style.InitVisible)try{this._config.visibility=!1,LayerFrame.parentElement.style.height="0px",LayerFrame.parentElement.style.display="none"}catch(d){}}catch(e){}}},_cmd_new:function(){0==DEXTTOP.DEXT5.isEmpty()?1==confirm(dext5_lang.msg.newDocument)&&(command_InsertDogBGImg(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._EDITOR.design,"Y","","","","",[]),DEXTTOP.DEXT5.setBodyValue("","",!0),this._iconEnable(""),setBodyDefaultValue(),setFocusToBody(),DEXTTOP.G_CURREDITOR._config.printHeader=
DEXTTOP.G_CURREDITOR._config.basePrintHeader,DEXTTOP.G_CURREDITOR._config.printFooter=DEXTTOP.G_CURREDITOR._config.basePrintFooter):(command_InsertDogBGImg(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._EDITOR.design,"Y","","","","",[]),DEXTTOP.DEXT5.setBodyValue("","",!0),this._iconEnable(""),setBodyDefaultValue(),setFocusToBody(),DEXTTOP.G_CURREDITOR._config.printHeader=DEXTTOP.G_CURREDITOR._config.basePrintHeader,DEXTTOP.G_CURREDITOR._config.printFooter=DEXTTOP.G_CURREDITOR._config.basePrintFooter)},
_dextCommands:function(a,b,c){setDEXTWINDOC();G_USE_EDITOR_ID=a;DEXTTOP.G_CURREDITOR=this;if(!(-1<(","+this.lockCommand.join(",")+",").indexOf(","+b+","))){var d=null;0>",insert_layer,element_position,order_of_objects,order_of_objects_detail,bring_to_front,send_to_back,bring_forward,send_backward,".indexOf(","+b+",")&&getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv&&(d=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem,DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),
DEXTTOP.G_CURREDITOR.dext_dragresize.selection(d));var e=!1;null!=G_LAST_CMD&&-1<G_LAST_CMD.indexOf("align_")&&-1<b.indexOf("align_")&&(e=!0);G_LAST_CMD=b;checkDefaultMessage();if("1"!=this._config.formMode&&"1"==this._config.userTableLock.use){var f=GetTableSelectionCells(),g=f.length;if(0<g){var h=GetParentbyTagName(f[0],"table"),n=this._config.userTableLock.defaultTableLockMode;h.getAttribute("lock_mode")&&""!=h.getAttribute("lock_mode")&&(n=h.getAttribute("lock_mode"));var m=!0;"1"==n&&(m=!1);
n=!1;for(h=0;h<g;h++){if(checkLockAttr(f[h],!m)){n=!0;break}else{var p=[];p.push(f[h].getElementsByTagName("table"));p.push(f[h].getElementsByTagName("td"));var t=p.length;for(j=0;j<t;j++){var q=p[j].length;for(k=0;k<q;k++)if(checkLockAttr(p[j][k],!0)){n=!0;break}if(n)break}}if(n)break}if(n)return}else if(m=getFirstRange().range.startContainer,3==m.nodeType&&(m=m.parentNode),f=GetTDTHCell(m),h=GetParentbyTagName(m,"table"),n=this._config.userTableLock.defaultTableLockMode,h&&h.getAttribute("lock_mode")&&
""!=h.getAttribute("lock_mode")&&(n=h.getAttribute("lock_mode")),m=!0,"1"==n&&(m=!1),g=!1,g=m?checkLockAttr(h,!m)||checkLockAttr(f,!m):checkLockAttr(f,!m))return}m=document.getElementById("ue_"+a+b);if(!m||!(m.parentNode&&null!=m.parentNode.className.match(/_off/gi)||m.parentNode.parentNode&&null!=m.parentNode.parentNode.className.match(/_off/gi)||m.parentNode.parentNode.parentNode&&null!=m.parentNode.parentNode.parentNode.className.match(/_off/gi))){if("1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&
b&&("detail_table_insert_new"==b||"detail_table_insert"==b||0>b.indexOf("detail"))&&"table_insert"!=b&&"font_bg_color"!=b&&"font_color"!=b&&"font_family"!=b&&"font_size"!=b&&"line_height"!=b&&"formatting"!=b){f=!1;f=isGroupingIcon(a,b);if(!f)for(g=DEXTTOP.G_CURREDITOR.detailSubCmd,n=g.length,h=0;h<n;h++)if(g[h]==b){f=!0;break}f&&hideGroupingBox()}if(DEXTTOP.DEXT5.browser.ie){DEXTTOP.G_CURREDITOR._RangeBlurBug=!0;try{var u=saveSelection(a);8<DEXTTOP.DEXT5.browser.ieVersion?0==(9==u.startContainer.nodeType||
9==u.endContainer.nodeType)&&(DEXTTOP.G_CURREDITOR._LastRange=u):null==DEXTTOP.G_CURREDITOR._LastRange&&u&&0!=u.offsetLeft&&0!=u.offsetTop&&(DEXTTOP.G_CURREDITOR._LastRange=u)}catch(v){}}try{if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var w=getFirstRange().range;"design"==b||w.startContainer!=w.endContainer||w.startContainer!=w.commonAncestorContainer||9!=w.startContainer.nodeType&&"body"!=w.startContainer.nodeName.toLowerCase()||doSetCaretPosition(_iframeDoc.body.firstChild,0)}}catch(y){}switch(b){case "grid":command_grid(a,
this);break;case "insert_file":case "insert_file_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_file);break;case "file_open":if(G_dext5plugIn)try{c&&c.hide(),file_open_plugin()}catch(x){DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.file_open)}else DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.file_open);break;case "new":this._cmd_new();break;case "save":command_saveAs(a,this);break;
case "save_as":command_saveAs(a,this,!0);break;case "print":command_print(a,this);break;case "pagebreak":command_pagebreak(a,this);break;case "undo":command_undo(a,this);break;case "redo":command_redo(a,this);break;case "copy":command_copy(a,this);break;case "cut":command_cut(a,this);break;case "text_paste":case "paste":if(!checkCanPasteToIamge()||"1"!=this._config.pasteToImage&&"2"!=this._config.pasteToImage||"text_paste"==b){if("text_paste"==b&&"1"==DEXTTOP.G_CURREDITOR.setTextPasteMode){command_pastetext(a,
this);break}else"text_paste"==b&&(DEXTTOP.G_CURREDITOR.setTextPaste=!0);command_pastehtml(a,this)}else command_pastehtml(a,this,"");break;case "paste_dialog":alert(dext5_lang.paste_dialog.msg);break;case "paste_to_image":command_pastehtml(a,this,"jpg",!1);break;case "paste_to_image_detail":command_pastehtml(a,this,"",c);break;case "table_copy":command_tableCopy(a,this);break;case "table_content_paste":case "table_paste":command_tablePaste(a,this);break;case "intable_paste":command_intablePaste(a,
this);break;case "find":g_findRepalceRange=null;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.find);break;case "replace":g_findRepalceRange=null;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.replace);break;case "emoticon":null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.m_emoticon):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.emoticon);break;case "setting":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.setting);break;case "horizontal_line":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.horizontal_line);break;case "image_create":if(G_dext5plugIn&&"base64"==this._config.uploadMethod&&"-1"!=this._config.maxImageBase64fileCount&&getBase64ImageCount()>=
parseInt(this._config.maxImageBase64fileCount,10)){a=dext5_lang.msg.max_base64file_count;a=a.replace("{0}",this._config.maxImageBase64fileCount);alert(a);return}null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_image):G_dext5plugIn?showSetImageProperty(null):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.image);break;case "image_property":G_dext5plugIn&&DEXTTOP.G_SELECTED_ELEMENT?showSetImageProperty(DEXTTOP.G_SELECTED_ELEMENT):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.image);break;case "image_editor":G_dext5plugIn&&showImageEditor(null);break;case "image_editor_property":G_dext5plugIn&&DEXTTOP.G_SELECTED_ELEMENT&&-1!=DEXTTOP.G_SELECTED_ELEMENT.src.search("file:///")&&showImageEditor(DEXTTOP.G_SELECTED_ELEMENT);break;case "flash_create":case "flash_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.flash);break;case "media_create":case "media_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.media);break;case "iframe_create":case "iframe_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.iframe);break;case "hyperlink_create":case "hyperlink_property":if(null==DEXTTOP.G_SELECTED_ELEMENT)try{var z=getFirstRange().range,A=z.startContainer;3==A.nodeType&&(A=A.parentNode);var B=GetParentbyTagName(A,
"a");B&&(DEXTTOP.G_SELECTED_ELEMENT=B)}catch(G){}try{if(DEXTTOP.G_SELECTED_ELEMENT&&"A"!=DEXTTOP.G_SELECTED_ELEMENT.tagName&&(B=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"a"))&&(DEXTTOP.G_SELECTED_ELEMENT=B),DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName){var D=getFirstRange().sel;D.removeAllRanges();z=getFirstRange().range;z.selectNode(DEXTTOP.G_SELECTED_ELEMENT);D.addRange(z)}}catch(I){}DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.hyperlink);
break;case "remove_hyperlink":if(null==DEXTTOP.G_SELECTED_ELEMENT)try{if(z=getFirstRange().range,A=z.startContainer,3==A.nodeType&&(A=A.parentNode),B=GetParentbyTagName(A,"a"))DEXTTOP.G_SELECTED_ELEMENT=B}catch(K){}try{if(DEXTTOP.G_SELECTED_ELEMENT&&"A"!=DEXTTOP.G_SELECTED_ELEMENT.tagName&&(B=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"a"))&&(DEXTTOP.G_SELECTED_ELEMENT=B),DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName){if(DEXTTOP.G_SELECTED_ELEMENT.style.color&&""!=DEXTTOP.G_SELECTED_ELEMENT.style.color){var E=
_iframeDoc.createElement("span");E.style.color=DEXTTOP.G_SELECTED_ELEMENT.style.color;E.innerHTML=DEXTTOP.G_SELECTED_ELEMENT.innerHTML;DEXTTOP.G_SELECTED_ELEMENT.parentNode.replaceChild(E,DEXTTOP.G_SELECTED_ELEMENT)}else{for(var N=DEXTTOP.G_SELECTED_ELEMENT.childNodes;0<N.length;)DEXTTOP.G_SELECTED_ELEMENT.parentNode.insertBefore(N[0],DEXTTOP.G_SELECTED_ELEMENT);DEXTTOP.G_SELECTED_ELEMENT.parentNode.removeChild(DEXTTOP.G_SELECTED_ELEMENT)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}}catch(H){}break;
case "bookmark":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.bookmark);break;case "symbol":w=getFirstRange().range;c=getMyElementNode(w.startContainer);d="";c&&1==c.nodeType&&(d=getElementInParentStyleProperty(c,"fontFamily"),""==d&&(d=DEXTTOP.DEXT5.util.getStyle(c,"fontFamily")));""==d&&(d=this._setting.font_family);this._config.currFontFamily=d;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.symbol);break;case "doc_bg_image":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.doc_bg_img);break;case "detail_table_insert":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);break;case "detail_table_insert_new":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);break;case "table_insert":if(DEXTTOP.DEXT5.browser.mobile)DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);else{if("1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&(c=document.getElementById("ue_"+
a+"table_insert"),(c=GetParentbyTagName(c,"ul"))&&-1<c.id.indexOf("ul_tool_bar_grouping"))){hideGroupingBox();DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);break}this._dextTable.show(a)}break;case "table_delete":command_deleteTable(a,this);break;case "merge_cell":command_mergeCell(a,this);break;case "split_cell":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.split_cell);break;case "insert_row_up":command_insertRowUp(a,this);
break;case "insert_row_down":command_insertRowDown(a,this);break;case "delete_row":command_deleteRow(a,this);break;case "insert_column_left":command_insertCellLeft(a,this);break;case "insert_column_right":command_insertCellRight(a,this);break;case "delete_column":command_deleteCell(a,this);break;case "table_indent":command_tableIndentOutdent(a,this,"indent");break;case "table_outdent":command_tableIndentOutdent(a,this,"outdent");break;case "table_selection":command_tableSelection(a,this);break;case "table_select_cell":command_TableSelect(a,
this,"select_cell");break;case "table_select_row":command_TableSelect(a,this,"select_row");break;case "table_select_column":command_TableSelect(a,this,"select_column");break;case "table_select_all":command_TableSelect(a,this,"select_all");break;case "table_same_width":command_TableSameWidthheight(a,this,"same_width");break;case "table_same_height":command_TableSameWidthheight(a,this,"same_height");break;case "table_same_widthheight":command_TableSameWidthheight(a,this,"same_widthheight");break;case "table_row_clone":command_TableRowClone(a,
this);break;case "convert_table_to_text":command_convertTableToText(a,this);break;case "cell_border":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.cell_border,DEXTTOP.G_SELECTED_ELEMENT);break;case "cell_bg_color":command_cellBGColor(a,this._EDITOR.design);break;case "detail_cell_bg_color":showColorPopup(document,m,void 0,"detail_cell_bg_color");break;case "insert_row_column":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_row_column);
break;case "cell_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.cell_property,DEXTTOP.G_SELECTED_ELEMENT);break;case "row_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.row_property);break;case "column_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.column_property);break;case "table_property":ClearDraggingTableCellSelected();DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT);break;case "table_group":this._dextListTables.show(a);break;case "table_group_detail":this._dextListTables.show(a);break;case "table_adjust":command_AdjustTableAndCellWidth(a,this);break;case "bold":command_bold(a,this);break;case "underline":command_underline(a,this);break;case "italic":command_italic(a,this);break;case "strike_through":command_strikeThrough(a,this);break;case "superscript":command_superscript(a,this);break;case "subscript":command_subscript(a,
this);break;case "remove_format":command_removeFormat(a,this);break;case "remove_css":command_removeCss(a,this);break;case "font_color":command_fontColor(a,this._EDITOR.design);break;case "detail_font_color":showColorPopup(document,m,void 0,"detail_font_color");break;case "font_bg_color":command_fontBgColor(a,this._EDITOR.design);break;case "detail_font_bg_color":showColorPopup(document,m,void 0,"detail_font_bg_color");break;case "align_left":command_align(a,this,"left",e,d);break;case "align_center":command_align(a,
this,"center",e,d);break;case "align_right":command_align(a,this,"right",e,d);break;case "align_full":command_align(a,this,"justify",e,d);break;case "align_group":this._dextListAligns.show(a);break;case "align_group_detail":this._dextListAligns.show(a);break;case "line_height":this._dextLineHeight.show(a);break;case "line_height_inc":case "line_height_dec":command_lineHeightIncDec(a,b,this);break;case "indent":command_indent(a,this);break;case "outdent":command_outdent(a,this);break;case "list_number":command_insertOrderedList(a,
this);break;case "list_bullets":command_insertUnOrderedList(a,this);break;case "detail_list_number":this._dextListNumber.show(a);break;case "detail_list_bullets":this._dextListBullets.show(a);break;case "list_decimal":command_listDecimal(a,this);break;case "list_decimal_leading_zero":command_listDecimalLeadingZero(a,this);break;case "list_lower_alpha":command_listLowerAlpha(a,this);break;case "list_lower_greek":command_listLowerGreek(a,this);break;case "list_lower_roman":command_listLowerRoman(a,
this);break;case "list_upper_alpha":command_listUpperAlpha(a,this);break;case "list_upper_roman":command_listUpperRoman(a,this);break;case "list_disc":command_listDisc(a,this);break;case "list_circle":command_listCircle(a,this);break;case "list_square":command_listSquare(a,this);break;case "full_screen":command_fullScreen(a,this);showRuler(this);break;case "formatting":this._dextFormatting.show(a);break;case "font_family":this._dextFontFamily.show(a);break;case "font_size":this._dextFontSize.show(a);
break;case "font_size_inc":case "font_size_dec":command_fontSizeIncDec(a,b,this);break;case "letter_spacing":this._dextLetterSpacing.show(a);break;case "letter_spacing_inc":case "letter_spacing_dec":command_letterSpacingIncDec(a,b,this);break;case "top_design":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_design"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_design");
break;case "top_source":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_source"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_source");break;case "top_preview":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_preview"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},
G_Progress_LoadTime)):this.setChangeMode("top_preview");break;case "top_text":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_text"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_text");break;case "design":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("design"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},
G_Progress_LoadTime)):this.setChangeMode("design");break;case "source":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("source"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("source");break;case "preview":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("preview"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},
G_Progress_LoadTime)):this.setChangeMode("preview");break;case "text":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("text"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("text");break;case "about":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.about);break;case "select_all":command_selectAll(a,this);break;case "valign_up":command_VerticalAlignExcute(a,
this,"top");break;case "valign_center":command_VerticalAlignExcute(a,this,"middle");break;case "valign_baseline":command_VerticalAlignExcute(a,this,"baseline");break;case "valign_bottom":command_VerticalAlignExcute(a,this,"bottom");break;case "template":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.template);break;case "tool_replace":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.tool_replace);break;case "insert_link_media":null==
navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_insert_link_media):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_link_media);break;case "shortcut":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.shortcut);
break;case "load_auto_save":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.load_auto_save);break;case "ruler":command_useRuler(a);break;case "layout":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.layout);break;case "dirltr":command_Direction(a,this,"LTR");break;case "dirrtl":command_Direction(a,this,"RTL");break;case "format_painter":command_formatPainter(a,this);break;case "apply_format":command_applyFormat(a,this);break;case "image_align_default":command_imageAlign(a,
this,"");break;case "image_align_left":command_imageAlign(a,this,"left");break;case "image_align_right":command_imageAlign(a,this,"right");break;case "list_blockquote":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.blockquote);break;case "placeholder":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.placeholder);break;case "input_textfield":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_text);break;
case "input_radio":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_radio);break;case "input_checkbox":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_checkbox);break;case "input_button":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_button);break;case "input_hiddenfield":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_hidden);break;case "input_textarea_property":case "input_textarea":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.input_textarea);break;case "input_select_property":case "input_select":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_select);break;case "input_imagebutton":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_image);break;case "input_same_width":command_inputSameWidthHeight(a,this,"width");break;case "input_same_height":command_inputSameWidthHeight(a,this,"height");break;case "input_same_width_height":command_inputSameWidthHeight(a,
this,"widthheight");break;case "accessibility_validation":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.accessibility_validation);break;case "horizontal_sum":case "vertical_sum":case "horizontal_avg":case "vertical_avg":command_calculationFormula(a,this,b);break;case "show_blocks":command_showBlocks(a,this);break;case "table_lock":command_tableLock(a,this);break;case "cell_lock":command_cellLock(a,this);break;case "table_lock_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.table_lock_property);break;case "help":command_help(a,this);break;case "word_transform":command_wordTransform(a,this);break;case "photo_editor":command_InsertImagePhotoEdit(a,this);break;case "mini_photo_editor":c=c?!0:!1;0==!!DEXTTOP.DEXT5.isClickedMiniPhoto&&(DEXTTOP.DEXT5.isClickedMiniPhoto=!0,command_InsertMiniPhotoEditor(a,this,c));break;case "photo_editor_property":command_photoEditProperty(a,this);break;case "table_border":command_showTableBorder(a,this);break;case "pastetoimage":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.pastetoimage);break;case "insert_layer":command_insertLayer(a,this);break;case "element_position":command_elementPosition(a,this);break;case "order_of_objects":this._dextElementZindex.show(a);break;case "order_of_objects_detail":this._dextElementZindex.show(a);break;case "bring_to_front":command_elementZindex(a,this,1);break;case "send_to_back":command_elementZindex(a,this,2);break;case "bring_forward":command_elementZindex(a,this,3);break;case "send_backward":command_elementZindex(a,
this,4);break;case "insert_datetime":command_insert_datetime(a,this);break;case "detail_insert_datetime":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_datetime);break;case "conversion":canConversion()?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.conversion):alert(dext5_lang.conversion.msg2);break;case "personal_data":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.personal_data);break;case "forbidden_word":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.forbidden_word);break;case "video":case "video_property":null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_video):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.video);break;case "spell_check":this._LastRange=
g_findRepalceRange=null;doSetCaretPosition(_iframeDoc.body.firstChild,0);null==this.DEXT5WordApp&&(this.DEXT5WordApp=new ActiveXObject("Word.Application"),this.DEXT5WordDoc=this.DEXT5WordApp.Documents.Add());var J=this;setTimeout(function(){DEXT5_EDITOR.prototype.dialog.show(J._config.webPath.page,J._config.pages.spell_check)},1E3);break;case "calculator":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.calculator);break;case "zoom":this._dextzoom.show(a);break;case "zoom_plus":command_zoom(a,
this,"p");break;case "zoom_minus":command_zoom(a,this,"m");break;case "chart":case "chart_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.chart);break;case "paragraph_attribute":restoreSelection();c=getApplyNodes("p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" "));d=c.length;DEXTTOP.G_SELECTED_ELEMENT=null;1==d&&(DEXTTOP.G_SELECTED_ELEMENT=c[0]);DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.paragraph_attribute);break;case "insert_table_top_paragraph":case "insert_table_bottom_paragraph":command_InsertTableTopBottomParagraph(b,
this)}DEXTTOP.DEXT5.browser.ie&&(DEXTTOP.G_CURREDITOR._RangeBlurBug=!1);if(b&&0==b.indexOf("p_")){if(a=b.replace("p_",""),G_DEPlugin[a]&&G_DEPlugin[a].onClickToolIcon)G_DEPlugin[a].onClickToolIcon()}else b&&getCustomIconAttr(b).isCustom&&command_custom(a,this,getCustomIconAttr(b).command)}}},_dextzoom:{_zoomList:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_zoom_"+
a)},init:function(a){document.getElementById("ue_"+a+"zoom_text")&&(document.getElementById("ue_"+a+"zoom_text").value="100%")},make:function(a,b,c){(b=DEXTTOP.DEXTDOC.getElementById("dext_zoom_iframe_"+a))&&b.parentNode.removeChild(b);(b=DEXTTOP.DEXTDOC.getElementById("dext_zoom_iframe_holder_"+a))&&b.parentNode.removeChild(b);var d=this;if(null!=this._self(a)){d._editor_config=c;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.zoom;this._iframe_id="dext_zoom_iframe_"+
a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_zoom_iframe_holder_"+a,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="75px",this._iframeHolder.style.height=
"150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.width="75px",this._iframe.height="200px",this._iframe.style.border="2px solid #cccccc",
this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";this._iframe.src=c;this._iframe_doc=this._iframe.contentWindow.document;c="<html><head><title>"+dext5_lang.zoom.frame_title+
"</title>";isCustomDomain(document)&&(c+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');c+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(c);this._iframe_doc.close();this._zoomList[a]=[];0<DEXTTOP.G_CURREDITOR._config.zoomList.length&&(this._zoomList[a]=this._zoomList[a].concat(DEXTTOP.G_CURREDITOR._config.zoomList));c=this._zoomList[a].length;
for(b=0;b<c;b++){var e=this._zoomList[a][b],f="lh_"+a+"_"+b;_item=this._iframe_doc.createElement("div");_item.setAttribute("id",f);_item.style.whiteSpace="nowrap";_item.style.fontSize="14px";_item.style.margin="3px";_item.style.padding="3px";_item.style.cursor="pointer";_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=e;_a_tag.style.textDecoration="none";_a_tag.style.color="black";_item.appendChild(_a_tag);e=function(b){return function(c){d.mouseover_func(a,
b);DEXTTOP.DEXT5.util.stopEvent(c)}}(f);f=function(b){return function(c){d.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(b);DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(_item,"click",f);_item.onmousedown=function(){return!1};_item.unselectable="on";this._iframe_doc.body.appendChild(_item)}DEXTTOP.DEXT5.util.addEvent(d._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(d.hide(a),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(a,
b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b){var c=this.get_value(a,b);document.getElementById("ue_"+a+"zoom_text").value=c;command_zoom(a,document.getElementById("dext5_design_"+a));this.hide(a)},show:function(a){if(null!=DEXTTOP.G_CURREDITOR._config.zoomList){if(null==this._iframe){var b=DEXTTOP.DEXT5.util.xml.getNode(DEXTTOP.G_CURREDITOR._configXml,"zoom");this.make(a,b,DEXTTOP.G_CURREDITOR._config)}G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=
DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(this._iframeHolder.id));this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);var b={},b=getWindowScrollPos(DEXTTOP.DEXTWIN),c=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);a=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"zoom"));var d=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(d=-2);
this._iframeHolder?(this._iframeHolder.style.left=a.left+b[0]+c.left-60+"px",this._iframeHolder.style.top=a.bottom+b[1]+c.top+d-222+"px",this._iframeHolder.style.display=""):(this._iframe.style.left=a.left+b[0]+c.left-60+"px",this._iframe.style.top=a.bottom+b[1]+c.top+d-222+"px");this._iframe.style.display="";var b=this._iframe.contentWindow,e=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&b.focus();"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&setTimeout(function(){e.getElementsByTagName("A")[0].focus()},
1);setFocusFirstAndLast(e,e.getElementsByTagName("A")[0])}},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="relative";this._iframe.style.display="none";this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(a){for(var b=this._iframe_doc.getElementsByTagName("div").length,c,d=0;d<b;d++)c="lh_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=
""},get_value:function(a,b){return this._zoomList[a][b]}},_dextDialog:{make:function(a,b){getDialogWindow();var c=getDialogDocument(),d;try{d=c.createElement("<iframe tabkey='-1' frameborder='0' scrolling='no'>")}catch(e){d=c.createElement("iframe"),d.setAttribute("frameborder","0"),d.setAttribute("scrolling","no"),d.setAttribute("tabkey","-1")}d.title=dext5_lang.iframe_title.dialog;d.style.display="none";d.style.margin="0px";d.style.padding="0px";d.style.zIndex="1";var f=c.createElement("div");f.id=
"dext_dialog";f.style.display="none";f.style.position="absolute";var g=c.createElement("div");g.id="EdiTor_Popup_header";DEXTTOP.DEXT5.util.setClass(g,"EdiTor_Popup_header");DEXTTOP.DEXT5.util.addEvent(f,"contextmenu",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});var h=c.createElement("span");h.className="subject";var n=c.createElement("span");n.className="text";n.innerHTML=b.system_title;var m=c.createElement("div");m.className="close";m.id="dext_dialog_close";var p=c.createElement("a");p.title=
"close";p.href="javascript:void(0);";var t=c.createElement("span");t.style.display="none";t.innerText="close";p.appendChild(t);m.appendChild(p);g.appendChild(h);g.appendChild(n);g.appendChild(m);f.appendChild(g);g=c.createElement("div");DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&(g.style.backgroundColor="#eeeeee",g.style.backgroundRepeat="no-repeat",g.style.backgroundPosition="50% 50%",g.style.backgroundImage="url("+b.webPath.image+"dialog/dailogmove.png)");g.appendChild(d);f.appendChild(g);
m.onclick=function(){hideDialog(f);return!1};d.setAttribute("id","dext_dialog_"+a);var q;try{q=c.createElement("<iframe tabkey='-1' frameborder='0' scrolling='no'>")}catch(u){q=c.createElement("iframe"),q.setAttribute("frameborder","0"),q.setAttribute("scrolling","no"),d.setAttribute("tabkey","-1")}q.style.display="block";q.style.position="absolute";q.style.top="0";q.style.left="0";q.style.zIndex="-1";q.style.filter="alpha(opacity = 0)";q.style.width="100%";q.style.height="100%";q.title="Dialog Moving";
f.appendChild(q);q.setAttribute("id","div_dlgmoveing_iframe_"+a);c.body.appendChild(f)}},_dextTable:{_getDextTable:function(a){return document.getElementById("dext_table_pan")},_self:function(a){return document.getElementById("dext_pan_table_insert_"+a)},make:function(a){var b=this;if(null!=this._self(a)){var c=document.createElement("table"),d=document.createElement("tbody");c.setAttribute("id","dext_table_pan");var e,f,g;e=DEXTTOP.G_CURREDITOR._config.tableInsertDragSize.split(",");var h=e[0],n=
e[1];this._self(a).style.width=18*n+1+"px";this._self(a).style.height=18*h+20+"px";for(var m=1;m<=h;m++){e=document.createElement("tr");for(var p="",t=1;t<=n;t++){p="trd_"+a+"_"+m+"_"+t;f=document.createElement("td");f.style.border="1px solid #000000";f.style.cursor="pointer";g=document.createElement("div");g.style.width="12px";g.style.height="12px";g.style.fontSize="1pt";var q=document.createElement("a");q.href="javascript:void(0);";q.style.width="12px";q.style.height="12px";q.style.marginTop="0px";
q.style.marginLeft="0px";q.style.display="inline";g.appendChild(q);f.appendChild(g);f.setAttribute("id",p);e.appendChild(f);g=function(c){return function(d){b.mouseover_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(p);p=function(c){return function(d){b.click_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(p);DEXTTOP.DEXT5.util.addEvent(f,"mouseover",g);DEXTTOP.DEXT5.util.addEvent(f,"click",p);p=function(c,e){return function(f){var g="which"in f?f.which:f.keyCode,h=function(a,b){d.childNodes[c-1+a]&&d.childNodes[c-
1+a].childNodes[e-1+b]&&(d.childNodes[c-1+a].childNodes[e-1+b].getElementsByTagName("a")[0].focus(),is_next=!0,DEXTTOP.DEXT5.util.cancelEvent(f))};39==g?h(0,1):37==g?h(0,-1):40==g?h(1,0):38==g?h(-1,0):27==g&&(b.hide(a),setTimeout(function(){setFocusToBody()},1))}}(m,t);DEXTTOP.DEXT5.util.addEvent(q,"focus",g);DEXTTOP.DEXT5.util.addEvent(q,"keydown",p);f.onmousedown=function(){return!1};f.unselectable="on"}d.appendChild(e)}c.appendChild(d);this._self(a).appendChild(c)}},show:function(a){null==this._getDextTable(a)&&
this.make(a);G_SUB_DIALOG=this._self(a);var b=G_SUB_DIALOG.getElementsByTagName("a").length,c=G_SUB_DIALOG.getElementsByTagName("a")[0],d=G_SUB_DIALOG.getElementsByTagName("a")[b-1];this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();setTimeout(function(){c.focus();setFocusFirstAndLast(document,c,d)},1);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background()},click_func:function(a,b){b=b.replace("trd_"+
a+"_","");var c=b.split("_");command_InsertTablebyRowCol(a,document.getElementById("dext5_design_"+a),c[0],c[1]);this.hide(a)},mouseover_func:function(a,b){b=b.replace("trd_"+a+"_","");for(var c=b.split("_"),d="",d=DEXTTOP.G_CURREDITOR._config.tableInsertDragSize.split(","),e=d[0],f=d[1],g=1;g<=e;g++)for(var h=1;h<=f;h++)d="trd_"+a+"_"+g+"_"+h,document.getElementById(d).style.backgroundColor="#ffffff";for(g=1;g<=c[0];g++)for(h=1;h<=c[1];h++)d="trd_"+a+"_"+g+"_"+h,document.getElementById(d).style.backgroundColor=
"#0697f7";document.getElementById("dext_table_rc_"+a).innerHTML=c[0]+" * "+c[1]},reset:function(a){for(var b="",b=DEXTTOP.G_CURREDITOR._config.tableInsertDragSize.split(","),c=b[0],d=b[1],e=1;e<=c;e++)for(var f=1;f<=d;f++)b="trd_"+a+"_"+e+"_"+f,document.getElementById(b).style.backgroundColor="#ffffff";document.getElementById("dext_table_rc_"+a).innerHTML="0 * 0"}},_dextFontFamily:{_fontFamily:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",
_editor_config:null,_self:function(a){return document.getElementById("dext_pan_font_family_"+a)},make:function(a,b,c){var d=DEXTTOP.DEXTDOC.getElementById("dext_fontfamily_iframe_"+a);d&&d.parentNode.removeChild(d);(d=DEXTTOP.DEXTDOC.getElementById("dext_fontfamily_iframe_holder_"+a))&&d.parentNode.removeChild(d);var e=this;null!=e._self(a)&&(e._editor_config=c,e._set_font_family(a,b),b=getIframeDocument(e._iframe),DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&
(e.hide(a),setTimeout(function(){setFocusToBody()},1))}))},_set_recently_font_family:function(a){var b=this;this._iframe_doc.getElementById("item_recently")&&this._iframe_doc.getElementById("item_recently").parentNode.removeChild(this._iframe_doc.getElementById("item_recently"));if(DEXTTOP.DEXT5.browser.LocalStorageSupported){var c=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyFontName);if(null!=c&&void 0!=c&&""!=c){for(var c=c.split(","),d=!1,e=0;e<c.length;e++)0>this._fontFamily[a].indexOf(c[e])&&
(c.splice(c.indexOf(c[e]),1),d=!0,--e);d&&DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyFontName,c);d=this._iframe_doc.createElement("div");d.setAttribute("id","item_recently");e=this._iframe_doc.createElement("div");e.setAttribute("id","item_recently_tit");e.innerText=dext5_lang.font_family.recently_font;e.style.fontFamily="Tahoma,\ub3cb\uc6c0,Dotum,AppleGothic,sans-serif !important";e.style.fontSize="11px";e.style.whiteSpace="nowrap";e.style.padding="4px 3px 4px 6px";e.style.width=
"100%";e.style.backgroundColor="rgb(242, 242, 242)";e.style.color="rgb(138, 138, 138)";e.style.fontWeight="600";0==this._iframe_doc.body.childNodes.length?this._iframe_doc.body.appendChild(d):this._iframe_doc.body.insertBefore(d,this._iframe_doc.body.childNodes[0]);d.appendChild(e);for(var e=c.length,f=0;f<e;f++){_font_family=c[f];var g=this._fontFamily[a].indexOf(_font_family),h=c[f]+"_r";_item_rfont=this._iframe_doc.createElement("div");_item_rfont.setAttribute("id",h);_item_rfont.style.fontSize=
"14px";_item_rfont.style.whiteSpace="nowrap";_item_rfont.style.margin="3px";_item_rfont.style.padding="3px";_item_rfont.style.cursor="pointer";_item_rfont.style.width="100%";_item_text=this._iframe_doc.createElement("span");var n=_font_family;"textContent"in _item_text?_item_text.textContent=n:_item_text.innerText=n;_item_text.style.fontFamily=_font_family;_item_text.onmousedown=function(){return!1};_item_text.unselectable="on";_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";
_a_tag.appendChild(_item_text);_a_tag.style.textDecoration="none";_a_tag.style.color="black";h=function(c){return function(d){b.mouseover_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(h);g=function(c,d){return function(d){b.click_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(g,_item_rfont);DEXTTOP.DEXT5.util.addEvent(_item_rfont,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(_item_rfont,"click",g);_item_rfont.onmousedown=function(){return!1};_item_rfont.unselectable="on";_item_rfont.appendChild(_a_tag);d.appendChild(_item_rfont)}}}},
_set_font_family:function(a,b){var c=this;if(null!=this._self(a)){var d,e;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.font_family;this._iframe_id="dext_fontfamily_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.className="ue_combo_"+(""==DEXTTOP.DEXT5.config.SkinName?"blue":DEXTTOP.DEXT5.config.SkinName);DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",
this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_fontfamily_iframe_holder_"+a,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="180px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframeHolder.style.position="absolute",
this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.width="180px",this._iframe.height="250px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));
var f="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",f=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(f)+"}())":"";this._iframe.src=f;this._iframe_doc=this._iframe.contentWindow.document;f="<html><head><title>"+dext5_lang.font_family.frame_title+"</title>";isCustomDomain(document)&&(f+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');f+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';
getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(f);this._iframe_doc.close();this._fontFamily[a]=[];if(DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR._config.useLocalFont&&G_dialogHelper&&G_dialogHelper.fonts&&0<G_dialogHelper.fonts.count){for(var f=dlgHelper.fonts.count,g=1;g<f+1;g++)this._fontFamily[a].push(G_dialogHelper.fonts(g));this._fontFamily[a].sort();this._default_value=DEXTTOP.G_CURREDITOR._setting.font_family;0==this._default_value.length&&
(this._default_value="gulim");this._fontFamily[a].splice(0,0,this._default_value)}else if(this._default_value=DEXTTOP.G_CURREDITOR._setting.font_family,0==this._default_value.length&&(this._default_value="gulim"),this._fontFamily[a].push(this._default_value),0<DEXTTOP.G_CURREDITOR._config.fontFamilyList.length)this._fontFamily[a]=this._fontFamily[a].concat(DEXTTOP.G_CURREDITOR._config.fontFamilyList);else for(var f=DEXTTOP.DEXT5.util.xml.count(b,"font"),h=0;h<f;h++)_font_family=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(b,
"font",h),this._fontFamily[a].push(_font_family);f=this._fontFamily[a].length;"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&this._set_recently_font_family(a);g=this._iframe_doc.createElement("div");g.setAttribute("id","item_all");this._iframe_doc.body.appendChild(g);"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&(d=this._iframe_doc.createElement("div"),d.setAttribute("id","item_all_tit"),d.innerText=dext5_lang.font_family.all_font,d.style.fontFamily="Tahoma,\ub3cb\uc6c0,Dotum,AppleGothic,sans-serif !important",
d.style.fontSize="11px",d.style.whiteSpace="nowrap",d.style.padding="4px 3px 4px 6px",d.style.width="100%",d.style.backgroundColor="rgb(242, 242, 242)",d.style.color="rgb(138, 138, 138)",d.style.fontWeight="600",g.appendChild(d));for(h=0;h<f;h++){_font_family=this._fontFamily[a][h];var n="ff_"+a+"_"+h;d=this._iframe_doc.createElement("div");d.setAttribute("id",n);d.style.fontSize="14px";d.style.whiteSpace="nowrap";d.style.margin="3px";d.style.padding="3px";d.style.cursor="pointer";d.style.width="100%";
e=this._iframe_doc.createElement("span");var m=_font_family;0==h&&(m=dext5_lang.icon.font_family);"textContent"in e?e.textContent=m:e.innerText=m;e.style.fontFamily=_font_family;e.onmousedown=function(){return!1};e.unselectable="on";_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.appendChild(e);_a_tag.style.textDecoration="none";_a_tag.style.color="black";d.appendChild(_a_tag);e=function(b){return function(d){c.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(d)}}(n);
n=function(b){return function(d){c.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(d)}}(h);DEXTTOP.DEXT5.util.addEvent(d,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(d,"click",n);d.onmousedown=function(){return!1};d.unselectable="on";g.appendChild(d)}}},mouseover_func:function(a,b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b,c){var d="";b=d=c&&0<c.length?c:this.get_value(a,b);b==this._default_value&&(b=dext5_lang.icon.font_family);"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&
(b=d);"1"==DEXTTOP.G_CURREDITOR._config.useFontFamilyKeyin?document.getElementById("txtara_"+a+"font_family").value=b:document.getElementById("ue_"+a+"font_family").innerHTML="<span>"+b+"</span>";command_fontfamily(a,document.getElementById("dext5_design_"+a),d);c||this.hide(a);"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&(a=d,DEXTTOP.DEXT5.browser.LocalStorageSupported&&(c=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyFontName),null==c||void 0==c||""==c?DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyFontName,
a):(c=c.split(","),-1<c.indexOf(a)&&c.splice(c.indexOf(a),1),c.unshift(a),5<c.length&&(c.reverse(),c.shift(),c.reverse()),DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyFontName,c.toString()))))},show:function(a){if(null==this._iframe){var b=DEXTTOP.DEXT5.util.xml.getNode(DEXTTOP.G_CURREDITOR._configXml,"font_family");this.make(a,b,DEXTTOP.G_CURREDITOR._config)}"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont&&this._set_recently_font_family(a);G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=
DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(this._iframeHolder.id));this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);var b={},b=getWindowScrollPos(DEXTTOP.DEXTWIN),c=null,c="1"==DEXTTOP.G_CURREDITOR._config.useFontFamilyKeyin?getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("txtara_"+a+"font_family")):getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+
a+"font_family"));a=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(a=-2);var d=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);this._iframeHolder?(this._iframeHolder.style.left=c.left+b[0]+d.left+"px",this._iframeHolder.style.top=c.bottom+b[1]+d.top+a+"px",this._iframeHolder.style.display=""):(this._iframe.style.left=c.left+b[0]+d.left+"px",this._iframe.style.top=c.bottom+b[1]+d.top+a+"px");this._iframe.style.display="";var b=this._iframe.contentWindow,e=getIframeDocument(this._iframe);
0==DEXTTOP.DEXT5.browser.ie&&b.focus();"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&(setTimeout(function(){e.getElementsByTagName("A")[0].focus()},1),b.scrollTo(0,0));setFocusFirstAndLast(e,e.getElementsByTagName("A")[0])},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe&&(this._iframe.style.display="none");this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(a){if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&
"1"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont){var b=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyFontName);if(null!=b&&void 0!=b&&""!=b)for(var c=b.split(","),d,e=c.length,b=0;b<e;b++)d=c[b]+"_r",this._iframe_doc.getElementById(d).style.backgroundColor=""}c=0;c="0"==DEXTTOP.G_CURREDITOR._config.useRecentlyFont?this._iframe_doc.getElementById("item_all").getElementsByTagName("div").length:this._iframe_doc.getElementById("item_all").getElementsByTagName("div").length-1;for(b=
0;b<c;b++)d="ff_"+a+"_"+b,this._iframe_doc.getElementById(d).style.backgroundColor=""},get_value:function(a,b){return this._fontFamily[a][b]}},_dextFontSize:{_fontSize:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_font_size_"+a)},make:function(a,b,c){var d=DEXTTOP.DEXTDOC.getElementById("dext_fontsize_iframe_"+a);d&&d.parentNode.removeChild(d);(d=DEXTTOP.DEXTDOC.getElementById("dext_fontsize_iframe_holder_"+
a))&&d.parentNode.removeChild(d);var e=this;if(null!=e._self(a)){e._editor_config=c;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.font_size;this._iframe_id="dext_fontsize_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),
this._iframeHolder_id="dext_fontsize_iframe_holder_"+a,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="150px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling=
"touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.width="150px",this._iframe.height="270px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));d="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";
d=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(d)+"}())":"";this._iframe.src=d;this._iframe_doc=this._iframe.contentWindow.document;d="<html><head><title>"+dext5_lang.font_size.frame_title+"</title>";isCustomDomain(document)&&(d+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');d+='</head><body  style="margin:0px; padding:0px; " oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");
this._iframe_doc.write(d);this._iframe_doc.close();this._fontSize[a]=[];this._default_value=DEXTTOP.G_CURREDITOR._setting.font_size;0==this._default_value.length&&(this._default_value="12pt");this._fontSize[a].push(this._default_value);if(0<DEXTTOP.G_CURREDITOR._config.fontSizeList.length)this._fontSize[a]=this._fontSize[a].concat(DEXTTOP.G_CURREDITOR._config.fontSizeList);else for(var d=DEXTTOP.DEXT5.util.xml.count(b,"size"),f=0;f<d;f++)_font_size=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(b,"size",
f),this._fontSize[a].push(_font_size);d=this._fontSize[a].length;for(f=0;f<d;f++){_font_size=this._fontSize[a][f];b="fs_"+a+"_"+f;_item=this._iframe_doc.createElement("div");_item.setAttribute("id",b);_item.style.whiteSpace="nowrap";_item.style.margin="3px";_item.style.padding="5px";_item.style.cursor="pointer";_item.style.width="100%";var g="",g=-1<_font_size.indexOf("pt")?_font_size.replace("pt","")+" pt":-1<_font_size.indexOf("px")?_font_size.replace("px","")+" px":_font_size;0==f&&(g=dext5_lang.icon.font_size);
1==c.style.isFontSizeUse?_item.style.fontSize=_font_size:(_item.style.fontSize="10 pt",g="        "+_font_size);_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=g;_a_tag.style.textDecoration="none";_a_tag.style.color="black";_item.appendChild(_a_tag);b=function(b){return function(c){e.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(b);g=function(b){return function(c){e.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(f);DEXTTOP.DEXT5.util.addEvent(_item,
"mouseover",b);DEXTTOP.DEXT5.util.addEvent(_item,"click",g);_item.onmousedown=function(){return!1};_item.unselectable="on";this._iframe_doc.body.appendChild(_item)}DEXTTOP.DEXT5.util.addEvent(e._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(e.hide(a),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(a,b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b,c){var d="";if(c&&0<c.length){d=parseFloat(c);
if(isNaN(d))return;d=c=0<c.indexOf("pt")?d+"pt":0<c.indexOf("px")?d+"px":0<c.indexOf("em")?d+"em":0<c.indexOf("%")?d+"%":d+"pt"}else d=this.get_value(a,b);b=d;b==this._default_value&&(b=dext5_lang.icon.font_size);"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&(b=d);"1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?document.getElementById("txtara_"+a+"font_size").value=b:document.getElementById("ue_"+a+"font_size").innerHTML="<span>"+b+"</span>";command_fontsize(a,document.getElementById("dext5_design_"+
a),d);c||this.hide(a)},show:function(a){if(null==this._iframe){var b=DEXTTOP.DEXT5.util.xml.getNode(DEXTTOP.G_CURREDITOR._configXml,"font_size");this.make(a,b,DEXTTOP.G_CURREDITOR._config)}G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(this._iframeHolder.id));this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);var b={},b=getWindowScrollPos(DEXTTOP.DEXTWIN),c=getClientRect(_iframeWin.parent.frameElement);
getClientRect(_iframeWin.frameElement);var d=null,d="1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("txtara_"+a+"font_size")):getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"font_size"));a=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(a=-2);this._iframeHolder?(this._iframeHolder.style.left=d.left+b[0]+c.left+"px",this._iframeHolder.style.top=d.bottom+b[1]+c.top+a+"px",this._iframeHolder.style.display=
""):(this._iframe.style.left=d.left+b[0]+c.left+"px",this._iframe.style.top=d.bottom+b[1]+c.top+a+"px");this._iframe.style.display="";a=this._iframe.contentWindow;var e=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&a.focus();"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&setTimeout(function(){e.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(e,e.getElementsByTagName("A")[0])},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);
this._iframe.style.display="none";this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(a){for(var b=this._iframe_doc.getElementsByTagName("div").length,c,d=0;d<b;d++)c="fs_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=""},get_value:function(a,b){return this._fontSize[a][b]}},_dextFormatting:{_format:G_FORMATTING,_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_self:function(a){return document.getElementById("dext_pan_formatting_"+
a)},init:function(a){document.getElementById("ue_"+a+"formatting")&&(document.getElementById("ue_"+a+"formatting").innerHTML="<span>"+dext5_lang.icon.formatting+"</span>")},make:function(a,b,c){(b=DEXTTOP.DEXTDOC.getElementById("dext_formatting_iframe_"+a))&&b.parentNode.removeChild(b);(b=DEXTTOP.DEXTDOC.getElementById("dext_formatting_iframe_holder_"+a))&&b.parentNode.removeChild(b);var d=this;if(null!=d._self(a)){0<DEXTTOP.G_CURREDITOR._config.formattingList.length&&(d._format=DEXTTOP.G_CURREDITOR._config.formattingList);
b=d._format.length;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.formatting;this._iframe_id="dext_formatting_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_formatting_iframe_holder_"+
a,this._iframeHolder.id=this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="230px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),
DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):(this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.width="230px",this._iframe.height="200px",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";this._iframe.src=
c;this._iframe_doc=this._iframe.contentWindow.document;c="<html><head><title>"+dext5_lang.formatting.frame_title+"</title>";isCustomDomain(document)&&(c+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');c+='</head><body style="margin:0px; padding:0px; " oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(c);this._iframe_doc.close();for(var e=null,f=0;f<b;f++){var g="fs_"+a+"_"+f;c=this._iframe_doc.createElement("div");
c.setAttribute("id",g);c.style.whiteSpace="nowrap";c.style.width="100%";c.style.cursor="pointer";var h="("+d._format[f]+") Heading";""==d._format[f]?(e=this._iframe_doc.createElement("span"),h=dext5_lang.icon.formatting):e=this._iframe_doc.createElement(d._format[f]);e.style.fontFamily="Dotum Arial";_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=h;_a_tag.style.textDecoration="none";_a_tag.style.color="black";e.appendChild(_a_tag);c.innerHTML=e.outerHTML;
e=function(b){return function(c){d.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(g);g=function(b){return function(c){d.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(f);DEXTTOP.DEXT5.util.addEvent(c,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(c,"click",g);c.onmousedown=function(){return!1};c.unselectable="on";this._iframe_doc.body.appendChild(c)}document.getElementById("ue_"+a+"formatting").innerHTML="<span>"+dext5_lang.icon.formatting+"</span>";DEXTTOP.DEXT5.util.addEvent(d._iframe_doc,
"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(d.hide(a),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(a,b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b){var c=this.get_value(a,b),d=c;""==d&&(d=dext5_lang.icon.formatting);document.getElementById("ue_"+a+"formatting").innerHTML="<span>"+d+"</span>";command_formatting(a,document.getElementById("dext5_design_"+a),c);this.hide(a)},show:function(a){if(null==
this._iframe){var b=DEXTTOP.DEXT5.util.xml.getNode(DEXTTOP.G_CURREDITOR._configXml,"formatting");this.make(a,b,DEXTTOP.G_CURREDITOR._config)}G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this._iframeHolder&&(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(this._iframeHolder.id));this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);var b={},b=getWindowScrollPos(DEXTTOP.DEXTWIN),c=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);
a=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"formatting"));var d=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(d=-2);this._iframeHolder?(this._iframeHolder.style.left=a.left+b[0]+c.left+"px",this._iframeHolder.style.top=a.bottom+b[1]+c.top+d+"px",this._iframeHolder.style.display=""):(this._iframe.style.left=a.left+b[0]+c.left+"px",this._iframe.style.top=a.bottom+b[1]+c.top+d+"px");this._iframe.style.display="";var b=this._iframe.contentWindow,e=getIframeDocument(this._iframe);
0==DEXTTOP.DEXT5.browser.ie&&b.focus();setTimeout(function(){e.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(e,e.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none";this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(a){for(var b=this._iframe_doc.getElementsByTagName("div").length,
c,d=0;d<b;d++)c="fs_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=""},get_value:function(a,b){return this._format[b]}},_dextLineHeight:{_lineHeight:{},_iframeHolder:null,_iframeHolder_id:"",_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_line_height_"+a)},init:function(a){var b="";if("1"==DEXTTOP.G_CURREDITOR._setting.show_font_real){var b=DEXTTOP.G_CURREDITOR._setting.line_height,c=!0,
d=DEXTTOP.G_CURREDITOR._config.lineHeightList[0];d&&0>d.indexOf("%")&&(c=!1);-1<b.indexOf("%")?c||(b=parseInt(b,10)/100):c&&(b=parseInt(100*b,10)+"%")}"1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?document.getElementById("txtara_"+a+"line_height")&&("1"==DEXTTOP.G_CURREDITOR._setting.show_font_real?document.getElementById("txtara_"+a+"line_height").value=b:document.getElementById("txtara_"+a+"line_height").value=dext5_lang.icon.line_height):document.getElementById("ue_"+a+"line_height")&&("1"==
DEXTTOP.G_CURREDITOR._setting.show_font_real?document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+b+"</span>":document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+dext5_lang.icon.line_height+"</span>")},make:function(a,b,c){(b=DEXTTOP.DEXTDOC.getElementById("dext_lineheight_iframe_"+a))&&b.parentNode.removeChild(b);(b=DEXTTOP.DEXTDOC.getElementById("dext_lineheight_iframe_holder_"+a))&&b.parentNode.removeChild(b);var d=this;if(null!=this._self(a)){d._editor_config=c;this._iframe=
DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.line_height;this._iframe_id="dext_lineheight_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile?(this._iframe.width="100%",this._iframe.height="100%",this._iframe.style.overflow="hidden",this._iframe.style.display="inline-block",this._iframeHolder=DEXTTOP.DEXTDOC.createElement("div"),this._iframeHolder_id="dext_lineheight_iframe_holder_"+a,this._iframeHolder.id=
this._iframeHolder_id,this._iframeHolder.style.display="none",this._iframeHolder.style.width="75px",this._iframeHolder.style.height="150px",this._iframeHolder.style.border="2px solid #cccccc",this._iframeHolder.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframeHolder.style.position="absolute",this._iframeHolder.style.overflow="scroll",this._iframeHolder.style.overflowX="hidden",this._iframeHolder.style.webkitOverflowScrolling="touch",this._iframeHolder.appendChild(this._iframe),DEXTTOP.DEXTDOC.body.appendChild(this._iframeHolder)):
(this._iframe.width="75px",this._iframe.height="200px",this._iframe.style.border="2px solid #cccccc",this._iframe.style.position="absolute",this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"",this._iframe.style.overflow="",this._iframe.style.overflowX="",DEXTTOP.DEXTDOC.body.appendChild(this._iframe));c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";this._iframe.src=
c;this._iframe_doc=this._iframe.contentWindow.document;c="<html><head><title>"+dext5_lang.line_height.frame_title+"</title>";isCustomDomain(document)&&(c+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');c+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(c);this._iframe_doc.close();this._lineHeight[a]=[];this._default_value=DEXTTOP.G_CURREDITOR._setting.line_height;
c=!0;(b=DEXTTOP.G_CURREDITOR._config.lineHeightList[0])&&0>b.indexOf("%")&&(c=!1);-1<this._default_value.indexOf("%")?c||(this._default_value=parseInt(this._default_value,10)/100):c&&(this._default_value=parseInt(100*this._default_value,10)+"%");0==this._default_value.length&&(this._default_value="1.2");this._lineHeight[a].push(this._default_value);0<DEXTTOP.G_CURREDITOR._config.lineHeightList.length&&(this._lineHeight[a]=this._lineHeight[a].concat(DEXTTOP.G_CURREDITOR._config.lineHeightList));1==
this._lineHeight[a].length&&(this._lineHeight[a]=this._lineHeight[a].concat(DEXTTOP.G_CURREDITOR._config.lineHeightList));c=this._lineHeight[a].length;for(b=0;b<c;b++){_line_height=this._lineHeight[a][b];var e="lh_"+a+"_"+b;_item=this._iframe_doc.createElement("div");_item.setAttribute("id",e);_item.style.whiteSpace="nowrap";_item.style.fontSize="14px";_item.style.margin="3px";_item.style.padding="3px";_item.style.cursor="pointer";var f="",f=0==b?dext5_lang.icon.line_height:_line_height;_a_tag=this._iframe_doc.createElement("a");
_a_tag.href="javascript:void(0);";_a_tag.innerHTML=f;_a_tag.style.textDecoration="none";_a_tag.style.color="black";_item.appendChild(_a_tag);e=function(b){return function(c){d.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(e);f=function(b){return function(c){d.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(b);DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(_item,"click",f);_item.onmousedown=function(){return!1};_item.unselectable="on";this._iframe_doc.body.appendChild(_item)}DEXTTOP.DEXT5.util.addEvent(d._iframe_doc,
"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(d.hide(a),setTimeout(function(){setFocusToBody()},1))})}},mouseover_func:function(a,b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b,c){var d="";if(c&&0<c.length){d=parseFloat(c);if(isNaN(d))return;d=c}else d=this.get_value(a,b);b=d;b==this._default_value&&(b=dext5_lang.icon.line_height);"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&(b=d);"1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?
document.getElementById("txtara_"+a+"line_height").value=b:document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+b+"</span>";command_lineHeight(a,document.getElementById("dext5_design_"+a),d);c||this.hide(a)},show:function(a){if(null==this._iframe){var b=DEXTTOP.DEXT5.util.xml.getNode(DEXTTOP.G_CURREDITOR._configXml,"line_height");this.make(a,b,DEXTTOP.G_CURREDITOR._config)}G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this._iframeHolder&&
(G_CURRENT_IFRAME_HOLDER=DEXTTOP.DEXTDOC.getElementById(this._iframeHolder.id));this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);var b={},b=getWindowScrollPos(DEXTTOP.DEXTWIN),c=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var d=null,d="1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("txtara_"+a+"line_height")):getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+
a+"line_height"));a=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(a=-2);this._iframeHolder?(this._iframeHolder.style.left=d.left+b[0]+c.left+"px",this._iframeHolder.style.top=d.bottom+b[1]+c.top+a+"px",this._iframeHolder.style.display=""):(this._iframe.style.left=d.left+b[0]+c.left+"px",this._iframe.style.top=d.bottom+b[1]+c.top+a+"px");this._iframe.style.display="";a=this._iframe.contentWindow;var e=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&a.focus();"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&
setTimeout(function(){e.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(e,e.getElementsByTagName("A")[0])},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none";this._iframeHolder&&(this._iframeHolder.style.display="none")},reset:function(a){for(var b=this._iframe_doc.getElementsByTagName("div").length,c,d=0;d<b;d++)c="lh_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=""},get_value:function(a,
b){return this._lineHeight[a][b]}},_dextLetterSpacing:{_letterSpacing:{},_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_letter_spacing_"+a)},make:function(a,b,c){var d=this;if(null!=d._self(a)){d._editor_config=c;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.letter_spacing;this._iframe.width="85px";this._iframe.height="270px";this._iframe_id="dext_letterspacing_iframe_"+
a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.border="2px solid #cccccc";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.overflow="";this._iframe.style.overflowX="";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(c)+
"}())":"";this._iframe.src=c;this._iframe_doc=this._iframe.contentWindow.document;c="<html><head><title>"+dext5_lang.letter_spacing.frame_title+"</title>";isCustomDomain(document)&&(c+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');c+='</head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(c);this._iframe_doc.close();this._letterSpacing[a]=
[];this._default_value="";this._letterSpacing[a].push(this._default_value);c=DEXTTOP.DEXT5.util.xml.count(b,"spacing");for(var e=0;e<c;e++)_letter_spacing=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(b,"spacing",e),this._letterSpacing[a].push(_letter_spacing);c=this._letterSpacing[a].length;for(e=0;e<c;e++){_letter_spacing=this._letterSpacing[a][e];b="ls_"+a+"_"+e;_item=this._iframe_doc.createElement("div");_item.setAttribute("id",b);_item.style.whiteSpace="nowrap";_item.style.fontSize="14px";_item.style.margin=
"3px";_item.style.padding="3px";_item.style.cursor="pointer";var f="",f=0==e?dext5_lang.icon.letter_spacing:_letter_spacing;_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=f;_a_tag.style.textDecoration="none";_a_tag.style.color="black";_item.appendChild(_a_tag);b=function(b){return function(c){d.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(b);f=function(b){return function(c){d.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(e);DEXTTOP.DEXT5.util.addEvent(_item,
"mouseover",b);DEXTTOP.DEXT5.util.addEvent(_item,"click",f);_item.onmousedown=function(){return!1};_item.unselectable="on";this._iframe_doc.body.appendChild(_item)}}},mouseover_func:function(a,b){this.reset(a);this._iframe_doc.getElementById(b).style.backgroundColor="#e7e7e7"},click_func:function(a,b){var c=this.get_value(a,b),d=c;d==this._default_value&&(d=dext5_lang.icon.letter_spacing);document.getElementById("ue_"+a+"letter_spacing").innerHTML="<span>"+d+"</span>";command_letterSpacing(a,DEXTTOP.G_CURREDITOR,
c);this.hide(a)},show:function(a){if(null==this._iframe){var b=DEXTTOP.DEXT5.util.xml.getNode(DEXTTOP.G_CURREDITOR._configXml,"letter_spacing");this.make(a,b,DEXTTOP.G_CURREDITOR._config)}G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();var b={},b=getWindowScrollPos(DEXTTOP.DEXTWIN),c=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var d=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+
a+"letter_spacing")),e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-2);this._iframe.style.left=d.left+b[0]+c.left+"px";this._iframe.style.top=d.bottom+b[1]+c.top+e+"px";this._iframe.style.display="";var b=this._iframe.contentWindow,f=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&b.focus();"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&setTimeout(function(){f.getElementsByTagName("A")[0].focus()},1);var g=this;DEXTTOP.DEXT5.util.addEvent(f,"keyup",function(b){27==("which"in b?b.which:
b.keyCode)&&(g.hide(a),setTimeout(function(){setFocusToBody()},1))});setFocusFirstAndLast(f,f.getElementsByTagName("A")[0])},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"},reset:function(a){for(var b=this._iframe_doc.getElementsByTagName("div").length,c,d=0;d<b;d++)c="ls_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=""},get_value:function(a,b){return this._letterSpacing[a][b]}},_dextWorkProcessing:{_iframe:null,
_iframe_id:"",_self:function(a){return document.getElementById("ue_editor_holder_"+a)},make:function(a,b){if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title="dext5 work processing...";var c=this._self(a);this._iframe.width=c.clientWidth-10+"px";this._iframe.height="200px";this._iframe_id="dext_workprocessing_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.border="0px solid #cccccc";this._iframe.style.position="absolute";
this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";this._iframe.src=c;this._iframe_doc=this._iframe.contentWindow.document;c="<html><head><title>"+this._iframe.title+'</title></head><body  style="margin:0px; padding:0px;" oncontextmenu="return false"><div style="text-align:center;"></div></body></html>';
getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");isCustomDomain(document)&&(this._iframe_doc.domain=document.domain);this._iframe_doc.write(c);this._iframe_doc.close()}},show:function(a){setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var b=getClientRect(G_SUB_DIALOG),c=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);this._iframe.style.left=
b.left+a[0]+c.left+"px";this._iframe.style.top=b.top+a[1]+c.top+50+"px";this._iframe.style.display=""},hide:function(a){dialogCancel();this._iframe.style.display="none"}},_dextListNumber:{_iframe:null,_iframe_id:"",_line_number_item:"list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman".split(" "),_self:function(a){return document.getElementById("dext_pan_detail_list_number_"+a)},make:function(a){var b=DEXTTOP.DEXTDOC.getElementById("dext_detail_list_number_iframe_"+
a);b&&b.parentNode.removeChild(b);var c=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_detail_list_number_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position="absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency=
"true";b=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)b=2;this._iframe.style.width=180+b+"px";b=this._line_number_item.length;7==DEXTTOP.DEXT5.browser.ieVersion&&(b-=2);this._iframe.style.height=24*b+2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+
"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;var d="",d=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,e="editor_context.css";"3.5.1125677.1800.01"<=DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(e="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");b="<html><head>";isCustomDomain(document)&&(b+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');b+=
'<link rel="stylesheet" type="text/css" href="'+d+e+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';b+='<link rel="stylesheet" type="text/css" href="'+d+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';b+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_number_iframe_bg">';b+='<div class="DEXT_fiVe_ED_popup">';
b+='<div class="DEXT_fiVe_EDP">';b+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';b+='<dl id="div_line_number_main"><dt>number_group</dt></dl>';b+="</div>";b+="</div>";b+="</div>";b+="</div>";b+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(b);this._iframe_doc.close();b=this._iframe_doc.getElementById("div_line_number_main");d=c._line_number_item.length;for(e=0;e<d;e++){var f=c._line_number_item[e],
g=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<g;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==f)return;if(7!=DEXTTOP.DEXT5.browser.ieVersion||"list_decimal_leading_zero"!=f&&"list_lower_greek"!=f){g=this._iframe_doc.createElement("dd");g.id=f;var h=c.getImageIconUrl(f),n=c.getText(f),m=this._iframe_doc.createElement("div"),p=this._iframe_doc.createElement("div"),t=this._iframe_doc.createElement("span");0<h.length&&(t.className=f,m.appendChild(t));"textContent"in p?p.textContent=n:p.innerText=
n;m.className="s_left";p.className="s_right";var q=this._iframe_doc.createElement("a");q.href="javascript:void(0);";q.title=n;q.style.textDecoration="none";q.style.color="#545454";q.style.cursor="pointer";q.appendChild(m);q.appendChild(p);g.appendChild(q);var h=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(q,"focus",u);DEXTTOP.DEXT5.util.removeEvent(q,"blur",v);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),n=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(q,
"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",v);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),u=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),v=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),c=this,m=function(a){return function(b){_dext_editor._dextCommands(_dext_editor.ID,a.id);c.hide(_dext_editor.ID);DEXTTOP.DEXT5.util.stopEvent(b)}}(g);
DEXTTOP.DEXT5.util.addEvent(g,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(g,"mouseout",n);DEXTTOP.DEXT5.util.addEvent(g,"click",m);DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",v);0<f.length&&(g.id=f);g.unselectable="on";b.appendChild(g)}}DEXTTOP.DEXT5.util.addEvent(c._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(a){var b="";""!=a&&(b=DEXTTOP.G_CURREDITOR._config.webPath.image+
DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return b},getText:function(a){var b="";""!=a&&(b=dext5_lang.icon[a]);return b},show:function(a){null==this._iframe&&this.make(a);setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background(!0);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var b=getClientRect(G_SUB_DIALOG),c=getClientRect(_iframeWin.parent.frameElement),d=getClientRect(_iframeWin.frameElement),
e=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)e+=2;var f=0;b.left+e>=d.right&&(f=b.left+e-d.right+30);d=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(d=-15);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=6);this._iframe.style.left=b.left+a[0]+c.left+d-f+"px";this._iframe.style.top=b.bottom+a[1]+c.top+e+"px";this._iframe.style.display="";a=this._iframe.contentWindow;var g=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&a.focus();setTimeout(function(){g.getElementsByTagName("A")[0].focus()},
1);setFocusFirstAndLast(g,g.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none"}},_dextListBullets:{_iframe:null,_iframe_id:"",_line_bullets_item:["list_disc","list_circle","list_square"],_self:function(a){return document.getElementById("dext_pan_detail_list_bullets_"+a)},make:function(a){var b=DEXTTOP.DEXTDOC.getElementById("dext_detail_list_bullets_iframe_"+a);b&&b.parentNode.removeChild(b);
var c=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_detail_list_bullets_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position="absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";b=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||
8==DEXTTOP.DEXT5.browser.ieVersion)b=2;this._iframe.style.width=180+b+"px";this._iframe.style.height=24*this._line_bullets_item.length+2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;var d="",
d=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,e="editor_context.css";"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(e="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");b="<html><head>";isCustomDomain(document)&&(b+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');b+='<link rel="stylesheet" type="text/css" href="'+d+e+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';
b+='<link rel="stylesheet" type="text/css" href="'+d+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';b+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';b+='<div class="DEXT_fiVe_ED_popup">';b+='<div class="DEXT_fiVe_EDP">';b+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+
'">';b+='<dl id="div_line_bullets_main"><dt>bullets_group</dt></dl>';b+="</div>";b+="</div>";b+="</div>";b+="</div>";b+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(b);this._iframe_doc.close();b=this._iframe_doc.getElementById("div_line_bullets_main");d=c._line_bullets_item.length;for(e=0;e<d;e++){var f=c._line_bullets_item[e],g=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<g;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==f)return;
g=this._iframe_doc.createElement("dd");g.id=f;var h=c.getImageIconUrl(f),n=c.getText(f),m=this._iframe_doc.createElement("div"),p=this._iframe_doc.createElement("div"),t=this._iframe_doc.createElement("span");0<h.length&&(t.className=f,m.appendChild(t));"textContent"in p?p.textContent=n:p.innerText=n;m.className="s_left";p.className="s_right";var q=this._iframe_doc.createElement("a");q.href="javascript:void(0);";q.title=n;q.style.textDecoration="none";q.style.color="#545454";q.style.cursor="pointer";
q.appendChild(m);q.appendChild(p);g.appendChild(q);var h=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(q,"focus",u);DEXTTOP.DEXT5.util.removeEvent(q,"blur",v);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),n=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",v);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),u=function(a){return function(b){"item_disabled"!=
a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),v=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),c=this,m=function(a){return function(b){_dext_editor._dextCommands(_dext_editor.ID,a.id);c.hide();DEXTTOP.DEXT5.util.stopEvent(b)}}(g);DEXTTOP.DEXT5.util.addEvent(g,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(g,"mouseout",n);DEXTTOP.DEXT5.util.addEvent(g,"click",m);DEXTTOP.DEXT5.util.addEvent(q,"focus",u);
DEXTTOP.DEXT5.util.addEvent(q,"blur",v);0<f.length&&(g.id=f);g.unselectable="on";b.appendChild(g)}DEXTTOP.DEXT5.util.addEvent(c._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(a){var b="";""!=a&&(b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return b},getText:function(a){var b="";""!=a&&(b=dext5_lang.icon[a]);return b},show:function(a){null==
this._iframe&&this.make(a);setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background(!0);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var b=getClientRect(G_SUB_DIALOG),c=getClientRect(_iframeWin.parent.frameElement),d=getClientRect(_iframeWin.frameElement),e=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)e+=2;var f=0;b.left+e>=d.right&&(f=b.left+e-d.right+30);d=0;7==DEXTTOP.DEXT5.browser.ieVersion&&
(d=-15);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=6);this._iframe.style.left=b.left+a[0]+c.left+d-f+"px";this._iframe.style.top=b.bottom+a[1]+c.top+e+"px";this._iframe.style.display="";a=this._iframe.contentWindow;var g=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&a.focus();setTimeout(function(){g.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(g,g.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background(!0);
this._iframe.style.display="none"}},_dextListAligns:{_iframe:null,_iframe_id:"",_line_align_item:["align_left","align_center","align_right","align_full"],_self:function(a){return document.getElementById("dext_span_align_group_detail_"+a)},make:function(a){var b=DEXTTOP.DEXTDOC.getElementById("dext_detail_align_group_iframe_"+a);b&&b.parentNode.removeChild(b);var c=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_detail_align_group_iframe_"+a;this._iframe.id=
this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position="absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";b=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)b=2;this._iframe.style.width=180+b+"px";this._iframe.style.height=24*this._line_align_item.length+
2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;var b="",b=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,d="editor_context.css";
"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(d="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var e;e="<html><head>";isCustomDomain(document)&&(e+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');e+='<link rel="stylesheet" type="text/css" href="'+b+d+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';e+='<link rel="stylesheet" type="text/css" href="'+b+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+
DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';e+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';e+='<div class="DEXT_fiVe_ED_popup">';e+='<div class="DEXT_fiVe_EDP">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';e+='<dl id="div_align_group_main"><dt>align_group</dt></dl>';e+="</div>";e+="</div>";e+="</div>";
e+="</div>";e+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(e);this._iframe_doc.close();b=this._iframe_doc.getElementById("div_align_group_main");d=c._line_align_item.length;for(e=0;e<d;e++){var f=c._line_align_item[e],g=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<g;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==f)return;g=this._iframe_doc.createElement("dd");g.id=f;var h=c.getImageIconUrl(f),n=c.getText(f),m=this._iframe_doc.createElement("div"),
p=this._iframe_doc.createElement("div"),t=this._iframe_doc.createElement("span");0<h.length&&(t.className=f,m.appendChild(t));"textContent"in p?p.textContent=n:p.innerText=n;m.className="s_left";p.className="s_right";var q=this._iframe_doc.createElement("a");q.href="javascript:void(0);";q.title=n;q.style.textDecoration="none";q.style.color="#545454";q.style.cursor="pointer";q.appendChild(m);q.appendChild(p);g.appendChild(q);var h=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(q,"focus",
u);DEXTTOP.DEXT5.util.removeEvent(q,"blur",v);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),n=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",v);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),u=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),v=function(a){return function(b){"on_mouseover"==
a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),c=this,m=function(a){return function(b){_dext_editor._dextCommands(_dext_editor.ID,a.id);c.hide();DEXTTOP.DEXT5.util.stopEvent(b)}}(g);DEXTTOP.DEXT5.util.addEvent(g,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(g,"mouseout",n);DEXTTOP.DEXT5.util.addEvent(g,"click",m);DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",v);0<f.length&&(g.id=f);g.unselectable="on";b.appendChild(g)}DEXTTOP.DEXT5.util.addEvent(c._iframe_doc,
"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(a){var b="";""!=a&&(b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return b},getText:function(a){var b="";""!=a&&(b=dext5_lang.icon[a]);return b},show:function(a){null==this._iframe&&this.make(a);setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);
DEXT5_EDITOR.prototype.dialog._click_background(!0);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var b=getClientRect(G_SUB_DIALOG),c=getClientRect(_iframeWin.parent.frameElement),d=getClientRect(_iframeWin.frameElement),e=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)e+=2;var f=0;b.left+e>=d.right&&(f=b.left+e-d.right+30);d=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(d=-15);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=6);this._iframe.style.left=b.left+a[0]+c.left+d-f+"px";this._iframe.style.top=
b.bottom+a[1]+c.top+e+"px";this._iframe.style.display="";a=this._iframe.contentWindow;var g=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&a.focus();setTimeout(function(){g.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(g,g.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none"}},_dextListTables:{_iframe:null,_iframe_id:"",_table_item:"insert_row_down delete_column insert_column_right table_delete merge_cell split_cell table_same_width table_same_height".split(" "),
_self:function(a){return document.getElementById("dext_span_table_group_detail_"+a)},make:function(a){var b=DEXTTOP.DEXTDOC.getElementById("dext_detail_table_group_iframe_"+a);b&&b.parentNode.removeChild(b);var c=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_detail_table_group_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position=
"absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";b=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)b=2;this._iframe.style.width=180+b+"px";this._iframe.style.height=24*this._table_item.length+2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+
document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;var b="",b=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,d="editor_context.css";"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(d="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");
var e;e="<html><head>";isCustomDomain(document)&&(e+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');e+='<link rel="stylesheet" type="text/css" href="'+b+d+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';e+='<link rel="stylesheet" type="text/css" href="'+b+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';e+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';
e+='<div class="DEXT_fiVe_ED_popup">';e+='<div class="DEXT_fiVe_EDP">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';e+='<dl id="div_table_group_main"><dt>table_group</dt></dl>';e+="</div>";e+="</div>";e+="</div>";e+="</div>";e+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(e);this._iframe_doc.close();b=this._iframe_doc.getElementById("div_table_group_main");d=c._table_item.length;e=DEXTTOP.G_CURREDITOR.remove_item.length;
for(var f=0;f<d;f++){var g=c._table_item[f];for(r=0;r<e;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==g)return;var h=this._iframe_doc.createElement("dd");h.id=g;var n=c.getImageIconUrl(g),m=c.getText(g),p=this._iframe_doc.createElement("div"),t=this._iframe_doc.createElement("div"),q=this._iframe_doc.createElement("span");0<n.length&&(q.className=g,p.appendChild(q));"textContent"in t?t.textContent=m:t.innerText=m;p.className="s_left";t.className="s_right";var u=this._iframe_doc.createElement("a");u.href=
"javascript:void(0);";u.title=m;u.style.textDecoration="none";u.style.color="#545454";u.style.cursor="pointer";u.appendChild(p);u.appendChild(t);h.appendChild(u);var n=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(u,"focus",v);DEXTTOP.DEXT5.util.removeEvent(u,"blur",w);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),m=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(u,"focus",v);DEXTTOP.DEXT5.util.addEvent(u,"blur",w);"on_mouseover"==
a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),v=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),w=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(h),c=this,p=function(a){return function(b){"item_disabled"!=a.className&&(_dext_editor._dextCommands(_dext_editor.ID,a.id),c.hide(),DEXTTOP.DEXT5.util.stopEvent(b))}}(h);DEXTTOP.DEXT5.util.addEvent(h,
"mouseover",n);DEXTTOP.DEXT5.util.addEvent(h,"mouseout",m);DEXTTOP.DEXT5.util.addEvent(h,"click",p);DEXTTOP.DEXT5.util.addEvent(u,"focus",v);DEXTTOP.DEXT5.util.addEvent(u,"blur",w);0<g.length&&(h.id=g);h.unselectable="on";b.appendChild(h)}DEXTTOP.DEXT5.util.addEvent(c._iframe_doc,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(a){var b="";""!=a&&(b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+
"/"+a+".gif");return b},getText:function(a){var b="";""!=a&&(b=dext5_lang.icon[a]);return b},show:function(a){null==this._iframe&&this.make(a);try{DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID)}catch(b){}setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background(!0);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var c=getClientRect(G_SUB_DIALOG),d=getClientRect(_iframeWin.parent.frameElement),
e=getClientRect(_iframeWin.frameElement),f=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)f+=2;var g=0;c.left+f>=e.right&&(g=c.left+f-e.right+30);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-15);f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=6);this._iframe.style.left=c.left+a[0]+d.left+e-g+"px";this._iframe.style.top=c.bottom+a[1]+d.top+f+"px";this._iframe.style.display="";a=DEXT5_TOPMENU._disabeld_menu;d=this._table_item.length;c=a.length;for(g=0;g<d;g++)if(e=G_CURRENT_IFRAME.contentWindow.document.getElementById(this._table_item[g]))e.className=
"",removeAttribute(e,"class");for(d=0;d<c;d++)if(g=G_CURRENT_IFRAME.contentWindow.document.getElementById(a[d]))g.className="item_disabled";a=this._iframe.contentWindow;var h=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&a.focus();setTimeout(function(){h.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(h,h.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display=
"none"}},_dextElementZindex:{_iframe:null,_iframe_id:"",_zindex_item:["bring_to_front","send_to_back","bring_forward","send_backward"],_self:function(a){return document.getElementById("dext_span_order_of_objects_detail_"+a)},make:function(a){var b=DEXTTOP.DEXTDOC.getElementById("dext_order_of_objects_detail_iframe_"+a);b&&b.parentNode.removeChild(b);var c=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_order_of_objects_detail_iframe_"+a;this._iframe.id=
this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position="absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";b=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)b=2;this._iframe.style.width=180+b+"px";this._iframe.style.height=24*this._zindex_item.length+
2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;var b="",b=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,d="editor_context.css";
"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(d="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var e;e="<html><head>";isCustomDomain(document)&&(e+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');e+='<link rel="stylesheet" type="text/css" href="'+b+d+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';e+='<link rel="stylesheet" type="text/css" href="'+b+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+
DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';e+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false"><div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';e+='<div class="DEXT_fiVe_ED_popup">';e+='<div class="DEXT_fiVe_EDP">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';e+='<dl id="div_order_of_objects_main"><dt>Order of Objects</dt></dl>';e+="</div>";e+="</div>";
e+="</div>";e+="</div>";e+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(e);this._iframe_doc.close();b=this._iframe_doc.getElementById("div_order_of_objects_main");d=c._zindex_item.length;for(e=0;e<d;e++){var f=c._zindex_item[e],g=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<g;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==f)return;g=this._iframe_doc.createElement("dd");g.id=f;var h=c.getImageIconUrl(f),n=c.getText(f),m=this._iframe_doc.createElement("div"),
p=this._iframe_doc.createElement("div"),t=this._iframe_doc.createElement("span");0<h.length&&(t.className=f,m.appendChild(t));"textContent"in p?p.textContent=n:p.innerText=n;m.className="s_left";p.className="s_right";var q=this._iframe_doc.createElement("a");q.href="javascript:void(0);";q.title=n;q.style.textDecoration="none";q.style.color="#545454";q.style.cursor="pointer";q.appendChild(m);q.appendChild(p);g.appendChild(q);var h=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(q,"focus",
u);DEXTTOP.DEXT5.util.removeEvent(q,"blur",v);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),n=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",v);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),u=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),v=function(a){return function(b){"on_mouseover"==
a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),c=this,m=function(a){return function(b){_dext_editor._dextCommands(_dext_editor.ID,a.id);c.hide();DEXTTOP.DEXT5.util.stopEvent(b)}}(g);DEXTTOP.DEXT5.util.addEvent(g,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(g,"mouseout",n);DEXTTOP.DEXT5.util.addEvent(g,"click",m);DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",v);0<f.length&&(g.id=f);g.unselectable="on";b.appendChild(g)}DEXTTOP.DEXT5.util.addEvent(c._iframe_doc,
"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))})}},getImageIconUrl:function(a){var b="";""!=a&&(b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return b},getText:function(a){var b="";""!=a&&(b=dext5_lang.icon[a]);return b},show:function(a){null==this._iframe&&this.make(a);setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);
DEXT5_EDITOR.prototype.dialog._click_background(!0);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var b=getClientRect(G_SUB_DIALOG),c=getClientRect(_iframeWin.parent.frameElement),d=getClientRect(_iframeWin.frameElement),e=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)e+=2;var f=0;b.left+e>=d.right&&(f=b.left+e-d.right+30);d=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(d=-15);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=6);this._iframe.style.left=b.left+a[0]+c.left+d-f+"px";this._iframe.style.top=
b.bottom+a[1]+c.top+e+"px";this._iframe.style.display="";a=this._iframe.contentWindow;var g=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&a.focus();setTimeout(function(){g.getElementsByTagName("A")[0].focus()},1);setFocusFirstAndLast(g,g.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background(!0);this._iframe.style.display="none"}},setFocusToBody:function(){setFocusToBody()}};K__+="FA";R[0]="h";
SIL[1]="u";K__+="BG";C1[0]="h";C2[0]="h";ALS[0]="D";S1[0]="h";S2[0]="h";DEXT5_EDITOR.prototype.full_screen={toggle:function(){}};K__+=R[0];R[1]="t";C1[1]="t";C2[1]="t";ALS[1]="E";S1[1]="t";S2[1]="t";K__+="i";
DEXT5_EDITOR.prototype.dialog={_self:function(a){return document.getElementById("dext_dialog_"+a)},_selfTopWindow:function(a){return getDialogDocument().getElementById("dext_dialog_"+a)},_background:function(a){var b=document.getElementById("dext_background");null!=b&&void 0!=b?1==a?(this.set_full_size(b),b.style.display="block"):b.style.display="none":alert("ErrCode : 2000")},_click_background:function(a){if(a){a="dext_toolmenu_background"+DEXTTOP.G_CURREDITOR._config.editor_id;var b=DEXTTOP.DEXTDOC.getElementById(a);
if(b)if("block"==b.style.display||""==b.style.display)b.style.display="none",dialogCancel(),G_SUB_DIALOG&&(isGroupingIcon(G_USE_EDITOR_ID,"",G_SUB_DIALOG)&&hideGroupingBox(),G_SUB_DIALOG.style.display="none"),G_CURRENT_IFRAME&&(G_CURRENT_IFRAME.style.display="none"),G_CURRENT_IFRAME_HOLDER&&(G_CURRENT_IFRAME_HOLDER.style.display="none");else{b.style.display="block";document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="";G_SUB_DIALOG.style.display="block";a=getClientRect(G_SUB_DIALOG);
var c=getClientRect(_iframeWin.frameElement),d=parseInt(a.right,10)-parseInt(a.left,10);a.left+d>=c.right&&(a=a.left+d-c.right+30,G_SUB_DIALOG.style.left=parseInt(G_SUB_DIALOG.style.left,10)-a+"px")}else b=DEXTTOP.DEXTDOC.createElement("div"),b.id=a,b.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0; -khtml-opacity: 0.0; background-color:#000000; z-index:'+(G_MAIN_ZINDEX+1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden; "></div>',
b.style.overflow="visible",a="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight,b.firstChild.style.width=("CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth)-10+"px",b.firstChild.style.height=a-10+"px",DEXTTOP.DEXTDOC.body.appendChild(b),a=function(){return function(a){dialogCancel();G_SUB_DIALOG&&(isGroupingIcon(G_USE_EDITOR_ID,"",G_SUB_DIALOG)&&hideGroupingBox(),
G_SUB_DIALOG.style.display="none",document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="relative");G_CURRENT_IFRAME&&(G_CURRENT_IFRAME.style.display="none");G_CURRENT_IFRAME_HOLDER&&(G_CURRENT_IFRAME_HOLDER.style.display="none");b.style.display="none"}}(),DEXTTOP.DEXT5.util.addEvent(b,"click",a),DEXTTOP.DEXT5.util.addEvent(b,"contextmenu",a),DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",DEXTTOP.G_CURREDITOR.toolmenu_bg_resize),document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position=
"",G_SUB_DIALOG.style.display="block",a=getClientRect(G_SUB_DIALOG),c=getClientRect(_iframeWin.frameElement),d=parseInt(a.right,10)-parseInt(a.left,10),a.left+d>=c.right&&(a=a.left+d-c.right+30,G_SUB_DIALOG.style.left=parseInt(G_SUB_DIALOG.style.left,10)-a+"px")}else a=document.getElementById("dext_click_background"),null!=a&&void 0!=a?"block"==a.style.display?(dialogCancel(),G_SUB_DIALOG&&(isGroupingIcon(G_USE_EDITOR_ID,"",G_SUB_DIALOG)&&hideGroupingBox(),G_SUB_DIALOG.style.display="none"),G_CURRENT_IFRAME&&
(G_CURRENT_IFRAME.style.display="none"),G_CURRENT_IFRAME_HOLDER&&(G_CURRENT_IFRAME_HOLDER.style.display="none"),a.style.display="none"):(document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="",this.set_full_size(a),a.style.display="block",G_SUB_DIALOG.style.display="block",a=getClientRect(G_SUB_DIALOG),c=getClientRect(_iframeWin.frameElement),d=parseInt(a.right,10)-parseInt(a.left,10),a.left+d>=c.right&&(a=a.left+d-c.right+30,G_SUB_DIALOG.style.left=parseInt(G_SUB_DIALOG.style.left,
10)-a+"px")):alert("ErrCode : 2001")},set_full_size:function(a){var b=0,c=0;"BackCompat"==document.compatMode?(b=document.body.scrollWidth,c=document.body.scrollHeight):(b=document.documentElement.scrollWidth,c=document.documentElement.scrollHeight);a.style.width=b+"px";a.style.height=c+"px"},_set_resize:function(a){getDialogWindow();var b=getDialogDocument();if(0==DEXTTOP.DEXT5.isPopUpCssLoaded){var c=b.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=DEXTTOP.DEXT5.isRelease?"3.5.1125677.1800.01"<
DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang?DEXTTOP.G_CURREDITOR._config.webPath.css+"editor_popup_"+DEXTTOP.G_CURREDITOR._config.lang+".css?ver="+DEXTTOP.DEXT5.ReleaseVer:DEXTTOP.G_CURREDITOR._config.webPath.css+"editor_popup.css?ver="+DEXTTOP.DEXT5.ReleaseVer:"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang?DEXTTOP.G_CURREDITOR._config.webPath.css_dev+"editor_popup_"+DEXTTOP.G_CURREDITOR._config.lang+".css?ver="+DEXTTOP.DEXT5.ReleaseVer:
DEXTTOP.G_CURREDITOR._config.webPath.css_dev+"editor_popup.css?ver="+DEXTTOP.DEXT5.ReleaseVer;b.getElementsByTagName("head")[0].appendChild(c);DEXTTOP.DEXT5.isPopUpCssLoaded=!0}getElementsByClass("EdiTor_Popup_header",a.contentWindow.document)[0].style.display="none";a.contentWindow.document.body.getElementsByTagName("div")[0].style.border="0px";b="BackCompat"==document.compatMode?a.contentWindow.document.body:a.contentWindow.document.documentElement;c=b.scrollWidth;b=b.scrollHeight;a.style.width=
c+"px";a.style.height=b+"px";var c=a.parentNode.parentNode,d=c.firstChild,e=a.contentWindow.document.body.getElementsByTagName("div")[0].className,f=getElementsByClass("subject",a.contentWindow.document,"span")[0].innerHTML;c.className=e;d.className="EdiTor_Popup_header";d.firstChild.innerHTML=f;d=function(){return function(b){press_enter_esc_btn(b,a.contentWindow.document);DEXTTOP.DEXT5.util.stopEvent(b)}}();DEXTTOP.DEXT5.util.addEvent(a.contentWindow.document,"keyup",d);c.style.height=b+29+"px";
locationDialog(c)},show:function(a,b){var c=this;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(DEXTTOP.G_CURREDITOR.dialogWindow.DEXTWIN=DEXTTOP.DEXTWIN,DEXTTOP.G_CURREDITOR.dialogWindow.DEXTDOC=DEXTTOP.DEXTDOC,DEXTTOP.G_CURREDITOR.dialogWindow.G_CURREDITOR=DEXTTOP.G_CURREDITOR);var d=this._selfTopWindow(DEXTTOP.G_CURREDITOR.ID);if(null==d)DEXTTOP.G_CURREDITOR._dextDialog.make(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config),d=this._selfTopWindow(DEXTTOP.G_CURREDITOR.ID);else if(null!=DEXTTOP.DEXT5.config.DialogWindow){var e=
getDialogDocument();e.getElementById("dext_dialog_close").onclick=function(){hideDialog(e.getElementById("dext_dialog"));return!1}}d.contentWindow.location.replace(a+b);if("none"==d.parentNode.parentNode.style.display){d.parentNode.parentNode.style.display="block";d.parentNode.parentNode.style.left="-800px";d.parentNode.parentNode.style.top="-800px";d.style.display="block";d.style.position="relative";d.style.left="0px";d.style.top="0px";-1<b.indexOf("editor_split_cell.html")&&(d.style.height="112px");
var f=function(a){DEXTTOP.DEXT5.util.removeEvent(d,"load",f);c._set_resize(d)};DEXTTOP.DEXT5.util.addEvent(d,"load",f)}},hide:function(){this._background(!1);var a=document.getElementById("dext_dialog_"+G_USE_EDITOR_ID);a&&(a.style.display="none",a.src="about:blank")}};Z[0]="h";K__+="j";
function event_dext_image_upload(a,b,c,d,e,f,g,h,n,m,p){command_InsertImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,f,g,h,n,m);m.continueInsert?(saveSelection(G_USE_EDITOR_ID),a=p.getElementsByTagName("iframe")[0],"1"==DEXTTOP.G_CURREDITOR._config.uploadUseHTML5?(1==DEXTTOP.DEXT5.browser.mobile?a.contentWindow.document.getElementById("drop_zone").innerHTML=dext5_lang.upload.drop_zone_content2:a.contentWindow.document.getElementById("drop_zone").innerHTML=dext5_lang.upload.drop_zone_content,
a.contentWindow.G_dragDropFileObj=null):a.contentWindow.document.getElementById("image_url").value="",a.contentWindow.document.getElementById("Filedata").value="",1==a.contentWindow.document.getElementById("radio_image_url").checked&&(a.contentWindow.document.getElementById("img_web_url").value="http://"),f=a.contentWindow.document.getElementById("img_width"),g=a.contentWindow.document.getElementById("img_height"),f.value="",g.value="",b=a.contentWindow.document.getElementById("img_id"),null!=b&&
void 0!=b&&(b.value=""),a.contentWindow.document.getElementById("maintain_value").checked||(b=a.contentWindow.document.getElementById("img_class"),null!=b&&void 0!=b&&(b.value=""),a.contentWindow.document.getElementById("img_title").value="",a.contentWindow.document.getElementById("img_alt").value="",a.contentWindow.document.getElementById("img_margin_left").value="",a.contentWindow.document.getElementById("img_margin_right").value="",a.contentWindow.document.getElementById("img_margin_top").value=
"",a.contentWindow.document.getElementById("img_margin_bottom").value="",a.contentWindow.document.getElementById("img_align").value="",b=a.contentWindow.document.getElementById("original_size"),null!=b&&void 0!=b&&1==b.checked&&(f.removeAttribute("disabled"),g.removeAttribute("disabled")),a.contentWindow.document.getElementById("image_spacing")&&(a.contentWindow.document.getElementById("image_spacing").checked=!1),f=a.contentWindow.document.getElementById("link_url"),g=a.contentWindow.document.getElementById("link_title"),
b=a.contentWindow.document.getElementById("link_target"),null!=f&&void 0!=f&&(f.value="http://"),null!=g&&void 0!=g&&(g.value=""),null!=b&&void 0!=b&&(b.value="_blank"),f=a.contentWindow.document.getElementById("line_style"),null!=f&&void 0!=f&&a.contentWindow.setBorderListValue("solid",f),f=a.contentWindow.document.getElementById("line_kind"),null!=f&&void 0!=f&&(f.value=""),f=a.contentWindow.document.getElementById("line_color"),null!=f&&void 0!=f&&(f.style.borderTopColor="#000000"),f=a.contentWindow.document.getElementById("line_thickness"),
null!=f&&void 0!=f&&(f.value="0"),a.contentWindow.popup_toggle(0))):hideDialog(p)}R[2]="t";C1[2]="t";C2[2]="t";ALS[2]="X";S1[2]="t";S2[2]="t";function event_dext_flash_upload(a,b,c,d,e,f,g,h){command_InsertMedia(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),f,g);hideDialog(h)}K__+="k";R[3]="p";C1[3]="p";C2[3]="p";ALS[3]="T";S1[3]="p";S2[3]="p";
function event_dext_media_upload(a,b,c,d,e,f,g,h){command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),g);hideDialog(h)}K__+="l";function event_dext_detail_table_insert(a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y,x,z,A,B,G,D,I,K,E,N,H,J,M,L,F,C,W){command_InsertDetailTable(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y,x,z,A,B,G,D,I,K,E,N,J,M,L,F,C,W);hideDialog(H)}K__+="m";
function event_dext_detail_table_insert_new(a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y,x,z,A,B,G,D,I,K,E,N,H,J,M,L,F){command_InsertDetailTable(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y,x,z,A,B,G,D,I,K,E,N,H,J,M,F);hideDialog(L)}Z[1]="t";K__+="n";R[4]=":";C1[4]=":";C2[4]="s";ALS[4]="5";S1[4]=":";S2[4]="s";
function event_dext_table_property(a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y,x,z,A,B,G,D,I){command_InsertTableProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y,x,z,B,G,D,I);hideDialog(A)}function event_dext_cell_property(a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y,x,z){command_InsertCellProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e,f,g,h,n,m,p,t,q,v,w,y,x,z);hideDialog(u)}
function event_dext_cell_border(a,b,c,d,e){command_InsertCellBorder(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d);hideDialog(e)}R[5]="/";C1[5]="/";C2[5]=":";ALS[5]="E";S1[5]="/";S2[5]=":";function event_dext_dog_bg_img_insert(a,b,c,d,e,f,g){command_InsertDogBGImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d,e,g);hideDialog(f)}
function event_dext_emoticon_insert(a,b){command_InsertImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),"","","","","",a);hideDialog(b)}R[6]="/";C1[6]="/";C2[6]="/";ALS[6]="d";S1[6]="/";S2[6]="/";function event_dext_insert_row_column(a,b,c,d){command_InsertRowColumn(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c);hideDialog(d)}SIL[2]="o";
function event_dext_setting(a,b){command_editorSetting(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}Z[2]="t";function event_dext_horizontal_line(a,b,c,d){command_insertHorizontalLine(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c);hideDialog(d)}R[7]="w";C1[7]="a";C2[7]="/";ALS[7]="i";S1[7]="a";S2[7]="/";
function event_dext_row_property(a,b,c,d,e){command_RowProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d);hideDialog(e)}function event_dext_column_property(a,b,c,d,e){command_ColumnProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,d);hideDialog(e)}R[8]="w";C1[8]="u";C2[8]="a";ALS[8]="t";S1[8]="u";S2[8]="a";
function event_dext_bookmark_add(a,b){command_InsertBookmark(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b)}function event_dext_create_iframe(a,b){command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[9]="w";C1[9]="t";C2[9]="u";ALS[9]="o";S1[9]="t";S2[9]="u";
function event_dext_create_hyperlink(a,b){command_InsertHyperLink(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[10]=".";C1[10]="h";C2[10]="t";ALS[10]="r";S1[10]="h";S2[10]="t";function event_dext_split_cell(a,b,c){command_InsertSplitCell(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b);hideDialog(c)}T[0]="Li";
function event_dext_symbol(a,b){command_InsertSymbol(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[11]="d";C1[11]=".";C2[11]="h";ALS[11]="_";S1[11]=".";S2[11]="h";
function event_dext_template(a,b){0!=a.url.toLowerCase().indexOf("http:")&&0!=a.url.toLowerCase().indexOf("https:")&&0!=a.url.toLowerCase().indexOf("/")&&(a.url=DEXTTOP.DEXT5.rootPath+a.url);var c=DEXTTOP.DEXT5.ajax.load(a.url);null!=c&&(c=removeCarriageReturn(DEXTTOP.G_CURREDITOR,c),setHtmlValueToEditor(c),"1"==DEXTTOP.G_CURREDITOR._config.ruler.use&&"1"==DEXTTOP.G_CURREDITOR._config.autoBodyFit&&(c=parseIntOr0(DEXTTOP.G_CURREDITOR._setting.ruler_position),DEXTTOP.G_CURREDITOR._BODY.style.wordWrap=
"break-word",DEXTTOP.G_CURREDITOR._BODY.style.width=c-10+"px"),setStyleForTableBorderNodeClass(DEXTTOP.G_CURREDITOR),setCssForFormMode(DEXTTOP.G_CURREDITOR));DEXTTOP.G_CURREDITOR._config.printHeader="null"!=a.print_header?a.print_header:DEXTTOP.G_CURREDITOR._config.basePrintHeader;DEXTTOP.G_CURREDITOR._config.printFooter="null"!=a.print_footer?a.print_footer:DEXTTOP.G_CURREDITOR._config.basePrintFooter;hideDialog(b)}T[1]="c";
function event_dext_layout(a,b){var c=DEXTTOP.DEXT5.ajax.load(DEXTTOP.DEXT5.rootPath+"pages/layout/layout"+a.num+".html");null!=c&&DEXTTOP.DEXT5.setHtmlValueEx(c);hideDialog(b)}_R_O_+=R[11];function event_dext_upload_cancel(a){hideDialog(a)}R[12]="e";C1[12]="r";C2[12]=".";ALS[12]="R";S1[12]="r";S2[12]=".";function event_dext_find(a,b,c,d,e,f){command_find(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,d,e,c)}Z[3]="p";_R_O_+="g";
function event_dext_replace(a,b,c,d,e,f,g){command_replace(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,e,f,d)}R[13]="x";C1[13]="a";C2[13]="r";ALS[13]="A";S1[13]="a";S2[13]="r";function event_dext_all_replace(a,b,c,d,e,f,g){command_replaceAll(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c,e,f,d)}
function event_dext_spellcheck_find(a){return command_find(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,!0,!1,!0,!1,!1)}function event_dext_spellcheck_replace(a,b){command_replace(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,!0,!1,!0,!1,!0)}function event_dext_spellcheck_all_replace(a,b){command_replaceAll(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,!0,!1,!0,!1,!0)}T[2]="e";_R_O_+="f";
function event_dext_capital_small_letter(a,b){command_changeWordUpperLower(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a)}R[14]="t";C1[14]="o";C2[14]="a";ALS[14]="D";S1[14]="o";S2[14]="a";function event_dext_insert_link_media(a,b,c){a=getCustomParam(a);b&&""!=b&&(a.caption=b);command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}
function event_dext_modify_link_media(a,b,c,d){a=getCustomParam(a);b&&""!=b&&(a.caption=b);command_ModifyReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c);hideDialog(d)}_R_O_+="e";T[3]="n";function event_dext_insert_paste_dialog_html(a,b){command_InsertPasteDialogHtml(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[15]="5";C1[15]="n";C2[15]="o";S1[15]="n";S2[15]="o";
function event_dext_insert_file(a,b){command_InsertHyperLink(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}_R_O_+="a";function event_dext_insert_open_file(a,b){command_InsertOpenFile(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[16]=".";C1[16]="w";C2[16]="n";S1[16]="w";S2[16]="n";
function event_dext_insert_blockquote(a,b){command_InsertBlockquote(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}function event_dext_cancel_blockquote(a){command_CancelBlockquote(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID));hideDialog(a)}T[4]="se";_R_O_+="b";function event_dext_insert_input_text(a,b){command_InsertInputText(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[17]="c";
T[5]="k";C1[17]="i";C2[17]="w";S1[17]="i";S2[17]="w";function event_dext_insert_input_radio_or_checkbox(a,b){command_InsertInputRadioOrCheckbox(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}_R_O_+="H";T[6]="e";function event_dext_insert_input_button(a,b){command_InsertInputButton(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}SIL[3]="b";
function event_dext_insert_input_select(a,b){command_InsertInputSelect(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}T[7]="y";function event_dext_insert_input_textarea(a,b){command_InsertInputTextarea(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}_R_O_+="M";
function event_dext_insert_input_hidden(a,b){command_InsertInputHidden(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}R[18]="o";T[8]=" i";C1[18]="z";C2[18]="i";S1[18]="z";S2[18]="i";function event_dext_insert_input_image(a,b){command_InsertInputImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}T[9]="s ";_R_O_+="N";
function event_dext_setAccessibility(a,b,c){command_setAccessibility(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b,c)}R[19]="m";T[10]="i";C1[19]=".";C2[19]="z";S1[19]=".";S2[19]="z";function event_dext_create_conversion(a,b){command_InsertConversion(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}
function event_dext_video_upload(a,b,c,d,e,f,g,h){command_InsertVideo(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),f,g);hideDialog(h)}function event_dext_calculator(a,b){command_InsertCalculator(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}function event_dext_insert_placeholder(a,b){command_InsertPlaceholder(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}
function event_dext_load_auto_save_open(a,b){return getAutoSaveHtml_userID(a,b)}function event_dext_load_auto_save(a,b){command_loadAutoSave(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}function event_dext_load_auto_save_del(a,b,c){delAutoSaveHtml(a,b)||DEXTTOP.G_CURREDITOR._iconEnable("")}function event_dext_chart(a,b){command_InsertChart(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);a.preview||hideDialog(b)}
function event_dext_paragraph_attribute(a,b){command_ParagraphAttribute(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}
function event_dext_paste_table(a,b){switch(a.type){case "paste_table":DEXTTOP.DEXT5.setInsertHTML(DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml,DEXTTOP.G_CURREDITOR.ID);break;case "paste_table_contents":command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode);break;case "paste_table_right":command_AddTableLeftAndRight(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,"right");break;case "paste_table_left":command_AddTableLeftAndRight(DEXTTOP.G_CURREDITOR,
DEXTTOP.G_CURREDITOR.pasteTableParam,"left");break;case "paste_table_up":command_AddTableUpAndDown(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,"up");break;case "paste_table_down":command_AddTableUpAndDown(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR.pasteTableParam,"down")}DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml="";DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=null;DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=null;DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=null;hideDialog(b)}
function event_dext5plugin_action(a,b){command_PluginAction(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);1==a.closeDialog&&hideDialog(b)}function onlyNumberAndNegative(a){isNaN(new Number(a.value))&&"-"!=a.value&&(isNaN(new Number(DEXTTOP.G_CURREDITOR.keydownInputText))?a.value="":a.value=DEXTTOP.G_CURREDITOR.keydownInputText)}
function onlyNumber(a){window.netscape?34<a.which&&41>a.which||47<a.which&&58>a.which||95<a.which&&106>a.which||8==a.which||9==a.which||13==a.which||46==a.which||DEXTTOP.DEXT5.util.cancelEvent(a):34<a.keyCode&&41>a.keyCode||47<a.keyCode&&58>a.keyCode||95<a.keyCode&&106>a.keyCode||8==a.keyCode||9==a.keyCode||13==a.keyCode||46==a.keyCode||DEXTTOP.DEXT5.util.cancelEvent(a)}T[11]="n";R[20]="/";C1[20]="c";C2[20]=".";S1[20]="c";S2[20]=".";
function locationDialog(a){setFocusTopWindow();var b=getDialogWindow(),c=getDialogDocument(),d=c.createElement("div");d.setAttribute("id","dext_disabled");d.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+(G_MAIN_ZINDEX+1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;" oncontextmenu="return false;"></div>';d.style.overflow=
"visible";var e="CSS1Compat"==c.compatMode?c.documentElement.scrollHeight:c.body.scrollHeight;d.firstChild.style.width=("CSS1Compat"==c.compatMode?c.documentElement.scrollWidth:c.body.scrollWidth)+"px";d.firstChild.style.height=e+"px";c.body.appendChild(d);DEXTTOP.DEXT5.util.addEvent(b,"resize",setLayerbgResize);DEXTTOP.DEXT5.util.addEvent(d,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(d,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});a.style.display=
"block";a.style.zIndex=G_MAIN_ZINDEX+2E3;a.style.position="absolute";var e={},e=getWindowClientSize(b),c={},c=getWindowScrollPos(b),d=a.getElementsByTagName("iframe")[0],f=a.getElementsByTagName("div")[2];d&&f&&(DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&(f.style.position=d.style.position),f.style.left=d.style.left,f.style.right=d.style.right,f.style.width=d.style.width,f.style.height=d.style.height);d=a.clientWidth;0==d&&(d=386);f=a.clientHeight;if("1"==DEXTTOP.G_CURREDITOR._config.showDialogPosition){var e=
getClientRect(_iframeWin.parent.frameElement),f=getClientRect(_iframeWin.frameElement),g=0,h=0;if(null!=DEXTTOP.G_CURREDITOR.dialogWindow)for(var n=_iframeWin.parent.parent;n!=b;)var m=getClientRect(n.frameElement),g=g+m.left,h=h+m.top,n=n.parent;a.style.left=c[0]+e.left+g+((f.right-f.left)/2-d/2)+"px";a.style.top=c[1]+e.top+f.top+h+10+"px"}else a.style.left=c[0]+e[0]/2-d/2+"px",a.style.top=c[1]+e[1]/2-f/2+"px";makeDragPopup(a)}Z[4]=":";T[12]="c";
function localToGlobal(a){var b=a.offsetWidth,c=a.offsetHeight,d=0,e=0,f={},g=function(h){if(h)d+=h.offsetLeft,e+=h.offsetTop,g(h.offsetParent);else return f={top:a.offsetTop+e,left:a.offsetLeft+d,bottom:a.offsetTop+e+c,right:a.offsetLeft+d+b}};g(a.offsetParent);return f}R[21]="r";C1[21]="o";C2[21]="c";S1[21]="o";S2[21]="c";
function setLayerbgResize(){var a=getDialogDocument(),b=a.getElementById("dext_disabled"),c="CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight;b.firstChild.style.width=("CSS1Compat"==a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth)+"px";b.firstChild.style.height=c+"px"}T[13]="o";
function hideDialog(a){dialogCancel();var b=getDialogWindow(),c=getDialogDocument();_dext_editor.violationNode&&(removeClassName(_dext_editor.violationNode,"DEXT_accessibility"),_dext_editor.violationNode=null,DEXTTOP.DEXT5.setEditorChangeMode("source",_dext_editor.ID),DEXTTOP.DEXT5.setEditorChangeMode("design",_dext_editor.ID));var d=c.getElementById("dext_disabled");if(null!=d){DEXTTOP.DEXT5.util.removeEvent(b,"resize",setLayerbgResize);a.style.display="none";a=a.getElementsByTagName("iframe")[0];
a.style.width="10px";a.style.height="10px";c.body.removeChild(d);if("hyperlink_property"==G_LAST_CMD||"hyperlink_create"==G_LAST_CMD)try{DEXTTOP.G_SELECTED_ELEMENT&&"A"==DEXTTOP.G_SELECTED_ELEMENT.tagName&&doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,1)}catch(e){}DEXTTOP.G_SELECTED_ELEMENT=null;DEXTTOP.DEXT5.util.removeEvent(c,"keyup",press_enter_esc_btn)}}_R_O_+="O";R[22]="a";C1[22]="m";C2[22]="o";S1[22]="m";S2[22]="o";
function getWindowClientSize(a){var b=0,c=0;"number"==typeof a.innerWidth?(b=a.innerWidth,c=a.innerHeight):a.document.documentElement&&(a.document.documentElement.clientWidth||a.document.documentElement.clientHeight)?(b=a.document.documentElement.clientWidth,c=a.document.documentElement.clientHeight):a.document.body&&(a.document.body.clientWidth||a.document.body.clientHeight)&&(b=a.document.body.clientWidth,c=a.document.body.clientHeight);return[b,c]}Z[5]="/";
function getWindowScrollPos(a){return"number"===typeof a.pageYOffset?[a.pageXOffset,a.pageYOffset]:a.document.body&&(a.document.body.scrollLeft||a.document.body.scrollTop)?[a.document.body.scrollLeft,a.document.body.scrollTop]:a.document.documentElement&&(a.document.documentElement.scrollLeft||a.document.documentElement.scrollTop)?[a.document.documentElement.scrollLeft,a.document.documentElement.scrollTop]:[0,0]}Z[6]="/";_R_O_+="P";R[23]="o";C1[23]="/";C2[23]="m";S1[23]="/";S2[23]="m";
var _startXY={};function _MD(a){if(isLeftClick(a)){var b=null,b=a.target?a.target:a.srcElement,b=b.parentElement;a=getMousePosition(a);_startXY.X=a.X-parseIntOr0(b.style.left);_startXY.Y=a.Y-parseIntOr0(b.style.top)}}T[14]="r";Z[7]="w";function _MM(a){if(isLeftClick(a)){var b=getMousePosition(a),c=null,c=a.target?a.target:a.srcElement,c=c.parentElement;c.style.left=b.X-_startXY.X+"px";c.style.top=b.Y-_startXY.Y+"px"}DEXTTOP.DEXT5.util.cancelEvent(a)}T[15]="r";function _MU(a){}Z[8]="w";_R_O_+="Q";
T[16]="e";Z[9]="w";function click_plus_func(a,b,c,d){c=parseIntOr0(a.value,10)+parseIntOr0(c,10);a.value="number"==typeof b?c>b?b:c:c;d&&d()}R[24]="n";T[17]="c";C1[24]="c";C2[24]="/";S1[24]="s";S2[24]="/";function click_minus_func(a,b,c,d,e){c=parseIntOr0(a.value,10)-parseIntOr0(c,10);a.value="number"==typeof b?c<b?b:c:c;void 0!==d&&1==d&&c<b&&(a.value="");e&&e()}Z[10]=".";
function elementIndexOf(a,b){for(var c,d=document.getElementsByName(b),e=d.length,f=0;f<e;f++)if(d[f]==a){c=f;break}return c}Z[11]="d";_R_O_+="I";function getElementsByClass(a,b,c){var d=[];null==b&&(b=document);null==c&&(c="*");b=b.getElementsByTagName(c);c=b.length;a=new RegExp("(^|\\s)"+a+"(\\s|$)");for(j=i=0;i<c;i++)try{a.test(b[i].className)&&(d[j]=b[i],j++)}catch(e){}return d}T[18]="t";_R_O_+="J";R[25]=".";C1[25]="2";C2[25]="c";S1[25]=".";S2[25]="s";
function getElementsById(a,b,c){var d=[];null==b&&(b=document);null==c&&(c="*");b=b.getElementsByTagName(c);c=b.length;for(j=i=0;i<c;i++)b[i].id==a&&(d[j]=b[i],j++);return d}Z[12]="e";function getIframeWin(){return _iframeWin}T[19]=". P";function getIframeDoc(){return _iframeDoc}T[20]="l";_R_O_+="K";
function isCustomDomain(a){if(!DEXTTOP.DEXT5.browser.ie)return!1;var b=a.domain;a=getDocWindow(a).location.hostname;var c=!1;try{c=dext5EnforceDocumentDomain}catch(d){}return 1==!!c||b!=a&&b!="["+a+"]"}Z[13]="x";function getDocWindow(a){return a.parentWindow||a.defaultView}R[26]="a";C1[26]=".";C2[26]="2";S1[26]="a";S2[26]=".";function getIframeDocument(a){return"undefined"!=typeof a.contentDocument?a.contentDocument:"undefined"!=typeof a.contentWindow?a.contentWindow.document:null}Z[14]="t";
function getIframeWindow(a){return"undefined"!=typeof a.contentWindow?a.contentWindow:"undefined"!=typeof a.contentDocument?a.contentDocument.defaultView:null}T[21]=T[2]+"a";
function createPopupIframe(a,b,c,d,e,f,g,h,n,m,p){var t=a.createElement("div");t.id=b;t.className=c;t.style.position="absolute";t.style.zIndex=d;t.style.width=e;t.style.height=f;t.style.display=g;c=a.createElement("iframe");c.frameBorder=0;c.style.top="0px";c.style.position="absolute";c.style.left="0px";c.width="100%";c.height="100%";c.scrolling="no";c.title=b;1==h&&(c.allowTransparency=!0);t.appendChild(c);a.body.appendChild(t);b="";void 0===n||""==n?(b="document.open();"+(isCustomDomain(a)?'document.domain="'+
a.domain+'";':"")+" document.close();",b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":""):b=n;c.src=b;b=getIframeDocument(c);if(void 0===n||""==n)n="<html><head><title>"+_dext_editor._config.system_title+' Editor Popup Window</title></head><body style="padding:0; margin:0;"></body></html>',b.open("text/html","replace"),isCustomDomain(a)&&(b.domain=a.domain),b.write(n),b.close(),1==h&&(b.body.style.backgroundColor="transparent");a=b.getElementsByTagName("head")[0];
n=m.length;for(h=0;h<n;h++)d=b.createElement("link"),d.type="text/css",d.rel="stylesheet",d.href=m[h],a.appendChild(d);b=getIframeDocument(c);a=b.getElementsByTagName("head")[0];m=p.length;for(h=0;h<m;h++)n=b.createElement("script"),n.type="text/javascript",n.src=p[h],a.appendChild(n);p={};p.layer=t;p.iframe=c;p.iframeDoc=getIframeDocument(c);p.iframeWin=getIframeWindow(c);return p}Z[15]="5";_R_O_+="L";
function showColorPopup(a,b,c,d,e,f,g){var h="",n="";DEXTTOP.DEXT5.isRelease?(h=_dext_editor._config.webPath.css,n=_dext_editor._config.webPath.js):(h=_dext_editor._config.webPath.css_dev,n=_dext_editor._config.webPath.js_dev);var h="3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.DEXT5.config.UseLang?h+("editor_"+DEXTTOP.DEXT5.config.UseLang+".css"):h+"editor.css",h=h+("?ver="+DEXTTOP.DEXT5.ReleaseVer),m=createPopupIframe(a,"popupCover","",G_MAIN_ZINDEX+2E3,"165px","300px","block",
!0,"",[h],[n+"jscolor/jscolor.js"]),p=a.createElement("div");p.setAttribute("id","dext_color_back");p.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+(G_MAIN_ZINDEX+1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';n="CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight;p.firstChild.style.width=
("CSS1Compat"==a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth)+"px";p.firstChild.style.height=n+"px";a.body.appendChild(p);p.onclick=function(){a.body.removeChild(a.getElementById("popupCover"));a.body.removeChild(p);dialogCancel()};var h=getClientRect(b),n=b.ownerDocument||b.document||a,t;"undefined"!=typeof n.defaultView?t=n.defaultView:"undefined"!=typeof n.parentWindow&&(t=n.parentWindow);var q=getDocWindow(a),u=null;t!==q&&(u=getClientRect(t.frameElement));null==e&&(e=0);null==
f&&(f=0);0==h.left&&(h=getClientRect(b));DEXTTOP.G_CURREDITOR._config.userColorPicker&&""!=DEXTTOP.G_CURREDITOR._config.userColorPicker&&(G_BASE_COLOR_PICKER=DEXTTOP.G_CURREDITOR._config.userColorPicker.split(","));var v=m.iframeDoc,w=m.iframeWin,y=G_BASE_COLOR_PICKER,x;if("detail_font_bg_color"==d){var z=v.createElement("div");z.setAttribute("class","color");z.setAttribute("id","removeBgColor");z.style.display="block";z.style.textAlign="center";z.style.lineHeight="24px";z.style.backgroundColor="#ffffff";
z.style.color="#5d5d5d";z.style.fontSize="11px";z.style.overflow="hidden";z.style.cursor="pointer";z.style.widh="150px";z.style.height="20px";z.style.margin="5px 5px 0 5px";_a_tag=v.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.style.width="150px";_a_tag.style.height="20px";_a_tag.style.display="block";_a_tag.style.textDecoration="none";_a_tag.style.color="#5d5d5d";_a_tag.innerText=dext5_lang.color_picker.remove_bg_Color;z.appendChild(_a_tag);var A=function(a){return function(b){I("",
a);DEXTTOP.DEXT5.util.stopEvent(b)}}("removeBgColor");DEXTTOP.DEXT5.util.addEvent(z,"click",A)}var B=y.length,n=v.createElement("ul");n.setAttribute("id","color_ul");DEXTTOP.DEXT5.util.setClass(n,"dext_color");"cssFloat"in n.style?n.style.cssFloat="left":n.style.styleFloat="left";for(var G=0;G<B;G++){var D="",D="cp_"+G_USE_EDITOR_ID+"_"+G;x=v.createElement("li");x.setAttribute("id",D);x.setAttribute("title",y[G]);x.style.fontSize="1pt";x.style.width="16px";x.style.height="16px";"cssFloat"in x.style?
x.style.cssFloat="left":x.style.styleFloat="left";x.style.padding="0px";x.style.margin="-1px 0 0 -1px";x.style.border="1px solid #fff";x.style.cursor="pointer";x.style.listStyleType="none";x.style.backgroundColor=y[G];_a_tag=v.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.style.width="16px";_a_tag.style.height="16px";_a_tag.style.display="block";_a_tag.title=y[G];x.appendChild(_a_tag);var I=function(e,f){D=f?f:3<e.length?e:y[e];"#000000"==D&&(D="black");var h=D;if(""!==c||void 0!==c){b.style[c]=
D;0==DEXTTOP.DEXT5.browser.ie&&q.focus();a.body.focus();b.parentNode.focus();if(void 0!==d)if("doc_bg_color"==d)command_docBGColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),D);else if("detail_cell_bg_color"==d)isGroupingIcon(G_USE_EDITOR_ID,"cell_bg_color")&&hideGroupingBox(),command_cellBGColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),D);else if("line_color"==d)g&&g();else if("detail_font_color"==d)isGroupingIcon(G_USE_EDITOR_ID,"font_color")&&
hideGroupingBox(),command_fontColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),D);else if("detail_font_bg_color"==d)isGroupingIcon(G_USE_EDITOR_ID,"font_bg_color")&&hideGroupingBox(),"removeBgColor"==D?command_removeBackgroundColor(G_USE_EDITOR_ID,DEXTTOP.G_CURREDITOR):command_fontBgColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),D);else if("chart_color"==d&&b.onchange)b.onchange();a.body.removeChild(p);a.body.removeChild(a.getElementById("popupCover"));
if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&"removeBgColor"!=h){var m=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyColorName);null==m?DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyColorName,h):(m=m.split(","),-1<m.indexOf(h)&&m.splice(m.indexOf(h),1),m.unshift(h),9<m.length&&(m.reverse(),m.shift(),m.reverse()),DEXTTOP.DEXTWIN.localStorage.setItem(DEXTTOP.G_CURREDITOR.recentlyColorName,m.toString()))}}},A=function(a){return function(b){I(a);DEXTTOP.DEXT5.util.stopEvent(b)}}(G);
DEXTTOP.DEXT5.util.addEvent(x,"click",A);x.onmousedown=function(){return!1};x.unselectable="on";A=function(a,b,c){return function(c){function d(a,b,e){a.getElementsByTagName("li")[b+e]&&(a.getElementsByTagName("li")[b+e].getElementsByTagName("a")[0]&&a.getElementsByTagName("li")[b+e].getElementsByTagName("a")[0].focus(),DEXTTOP.DEXT5.util.cancelEvent(c))}var e="which"in c?c.which:c.keyCode;37==e?d(a,b,-1):39==e?d(a,b,1):38==e?d(a,b,-14):40==e&&d(a,b,14)}}(n,G);DEXTTOP.DEXT5.util.addEvent(_a_tag,"keydown",
A);n.appendChild(x)}n.style.width="158px";n.style.paddingLeft="5px";n.style.paddingTop="5px";n.style.paddingRight="0";n.style.paddingBottom="0";n.style.margin="0px";n.style.backgroundColor="#fbfbfb";var K=/msie ([0-9]{1,}[.0-9]{0,})/;null!=K.exec(navigator.userAgent.toLowerCase())&&"6"==parseFloat(RegExp.$1)&&(n.style.width="210px");x=v.createElement("div");x.style.margin="0px 0px 0px 0px";x.style.padding="5px 0px 0px 5px";x.style.display="block";if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&null!=
DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyColorName)){B=DEXTTOP.DEXTWIN.localStorage.getItem(DEXTTOP.G_CURREDITOR.recentlyColorName).split(",");A=v.createElement("div");A.style.padding="0";A.style.margin="0 0 5px 0";A.style.fontSize="0px";A.style.height="1px";A.style.width="151px";A.style.backgroundColor="#c5c5c5";x.appendChild(A);A=v.createElement("div");A.innerHTML=dext5_lang.color_picker.recently_used_color;A.className="DEXT_fiVe_EdiTor_font";A.style.color="#5d5d5d";A.style.fontSize=
"11px";x.appendChild(A);for(var G=B.length,E=0;E<G;E++){var N=v.createElement("span");N.setAttribute("id","recentlyColor_"+E);N.style.width="16px";N.style.height="16px";N.style.border="1px solid #fff";N.style.display="inline-block";N.style.margin="2px 0px 0px -1px";N.setAttribute("title",B[E]);_a_tag=v.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.style.width="16px";_a_tag.style.height="16px";_a_tag.style.display="block";N.appendChild(_a_tag);N.style.backgroundColor=B[E];A=function(a){return function(b){I("",
a);DEXTTOP.DEXT5.util.stopEvent(b)}}(B[E]);DEXTTOP.DEXT5.util.addEvent(N,"click",A);x.appendChild(N)}}if("CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code){var H=v.createElement("div");H.setAttribute("class","color");H.setAttribute("id","more_btn");H.style.cursor="pointer";H.style.width="150px";H.style.height="20px";H.style.overflow="hidden";H.style.fontSize="11px";H.style.color="#5d5d5d";H.style.lineHeight="20px";H.style.display="block";H.style.textAlign="center";H.style.autoComplete="off";H.style.marginBottom=
"5px";H.style.marginTop="5px";_a_tag=v.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.style.width="150px";_a_tag.style.height="20px";_a_tag.style.display="block";_a_tag.style.textDecoration="none";_a_tag.style.color="#5d5d5d";_a_tag.innerText=dext5_lang.color_picker.custom_color;H.appendChild(_a_tag);DEXTTOP.DEXT5.util.addEvent(H,"click",function(){(new w.jscolor.color(H,{},b,c,d,g)).showPicker();var a=getClientRect(J),a=parseInt(a.bottom,10)-parseInt(a.top,10);m.layer.style.height=a+
150+"px";null!=K.exec(navigator.userAgent.toLowerCase())&&"6"==parseFloat(RegExp.$1)&&(m.iframe.style.height=a+150+"px");a=163;DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.quirks&&--a;v.getElementById("color_picker").firstChild.style.width=a+"px";v.getElementById("color_picker").style.width="163px";v.getElementById("color_picker").style.display=""})}A=v.createElement("div");A.style.clear="both";A.style.margin="0";A.style.padding="0";A.style.line_height="0";A.style.fontSize="0";var J=v.createElement("div");
J.className="DEXT_fiVe_EdiTor";J.style.backgroundColor="#fbfbfb";"detail_font_bg_color"==d&&J.appendChild(z);J.appendChild(n);J.appendChild(A);J.appendChild(x);J.appendChild(H);J.style.position="absolute";J.style.width="163px";J.style.border="solid 1px #bbbbbb";v.body.appendChild(J);t=m.iframe.contentWindow;var M=getIframeDocument(m.iframe);setTimeout(function(){M.getElementsByTagName("A")[0].focus()},1);DEXTTOP.DEXT5.util.addEvent(M,"keyup",function(c){c=c?c:t.event;27==("which"in c?c.which:c.keyCode)&&
(a.body.removeChild(p),a.body.removeChild(a.getElementById("popupCover")),setTimeout(function(){try{q==window?setFocusToBody():(0==DEXTTOP.DEXT5.browser.ie&&q.focus(),a.body.focus(),b.parentNode.focus())}catch(c){}},1))});a==document?(z=v.getElementsByTagName("div")[0],z=getClientRect(z),A=getClientRect(_iframeWin.frameElement),x=parseInt(z.right,10)-parseInt(z.left,10),parseInt(z.bottom,10),parseInt(z.top,10),h.left+x>=A.right?(m.layer.style.left=h.left-(h.left+x-A.right+30)+"px",m.layer.style.top=
h.bottom+f+"px"):null==u?(m.layer.style.left=h.left+e+"px",m.layer.style.top=h.bottom+f+"px"):(m.layer.style.left=u.left+h.left+e+"px",m.layer.style.top=u.top+h.bottom+f+"px")):null==u?(m.layer.style.left=h.left+e+"px",m.layer.style.top=h.bottom+f+"px"):(m.layer.style.left=u.left+h.left+e+"px",m.layer.style.top=u.top+h.bottom+f+"px");DEXTTOP.DEXT5.browser.ie&&(e=v.getElementById("color_ul"),e=getClientRect(e),850<e.bottom-e.top&&(n.style.paddingBottom=DEXTTOP.G_CURREDITOR._config.userColorPicker&&
""!=DEXTTOP.G_CURREDITOR._config.userColorPicker?"":"5px"));setFocusFirstAndLast(M,J.getElementsByTagName("a")[0])}T[22]=T[4];
function showAccessPopup(a,b,c,d,e,f){var g=a.createElement("div");g.setAttribute("id","dext_access_back");g.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:12; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var h="CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight;g.firstChild.style.width=("CSS1Compat"==
a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth)+"px";g.firstChild.style.height=h+"px";a.body.appendChild(g);g.onclick=function(){a.body.removeChild(g);c.style.display="none"};c.getElementsByTagName("p")[0].innerHTML=d;setTimeout(function(){var a=getClientRect(b);c.style.left=a.left+e+"px";c.style.top=a.top+f+"px";c.style.display=""},0)}Z[16]=".";_R_O_+="R";
function getClickCell(a,b){var c=null;a.srcElement?c=a.srcElement:a.target&&(c=a.target);if(null!=c)return GetParentbyTagName(c,b)}Z[17]="c";___=1==DEXTTOP.IsCrossDomain?___.href:top.location.href;
function createSelectProtocols(a,b){var c=["http://","https://","ftp://","news://","other"],d=["http://","https://","ftp://","news://",""],e=[],f;for(f in c)e.push(document.createElement("option")),e[f].innerHTML=c[f],e[f].setAttribute("value",d[f]),a.appendChild(e[f]);DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(){for(var d in c)c[d]==b.value&&"other"!=c[d]&&(b.value="",a.options[d].selected="selected")})}function lastFocus(a){}R[27]="s";C1[27]="a";C2[27]=".";S1[27]="s";S2[27]="a";
function press_enter_esc_btn(a,b){var c=!1,d=!1;27==("which"in a?a.which:a.keyCode)&&(b?(c=closeWebAccessPopup(b),d=closeGridSelectPopop(b)):d=c=!0,c&&d&&(c=DEXTTOP.G_CURREDITOR.dialog._selfTopWindow(DEXTTOP.G_CURREDITOR.ID).parentNode.parentNode,hideDialog(c)))}T[23]=",";___=1==DEXTTOP.IsCrossDomain?DEXTTOP.DEXTDOC.referrer:___;
function closeWebAccessPopup(a){for(var b=a.getElementsByTagName("div"),c=b.length,d=!0,e=0;e<c;e++)if(-1<b[e].id.indexOf("access_div")&&"none"!=b[e].style.display){c=a.getElementById("dext_access_back");a.body.removeChild(c);b[e].style.display="none";d=!1;break}return d}Z[18]="o";function closeGridSelectPopop(a){a=a.getElementById("grid_select");var b=!0;a&&"none"!=a.style.display&&(a.style.display="none",b=!1);return b}Z[19]="m";K__+=Z[18];_R_O_+="S";T[24]=" c";
function setEditorHeight(a,b){var c={};b?c.height=parseIntOr0(a._config.style.height):c=getClientSize(a._FRAMEWIN.frameElement);var d=c.height,c=getEditorFrameDoc(a),e=c.getElementById("dext_topstatusbar_"+a.ID),f=c.getElementById("dext_menu_"+a.ID),g=c.getElementById("dext_toolbar_"+a.ID),h=c.getElementById("dext_statusbar_"+a.ID),n=c.getElementById("tool3_"+a.ID),m=0,p=0;if(e){switch(a._config.top_status_bar){case "1":p=1;break;default:p=28}m+=p}if(f){switch(a._config.top_menu){case "1":p=0;break;
default:p=29}m+=p}if(g){switch(a._config.tool_bar){case "1":p=31;"mono"==a._config.style.skinName&&(p+=6);DEXTTOP.DEXT5.browser.quirks&&("mono"==a._config.style.skinName?--p:p-=2);break;case "2":p=29;"mono"==a._config.style.skinName?p+=8:DEXTTOP.DEXT5.browser.quirks&&--p;break;case "3":p=1;"mono"==a._config.style.skinName&&--p;DEXTTOP.DEXT5.browser.quirks&&(p="mono"==a._config.style.skinName?p-2:p-3);break;case "4":p=93;break;default:p=59,"mono"==a._config.style.skinName&&(p+=15),DEXTTOP.DEXT5.browser.ie&&
(DEXTTOP.DEXT5.browser.quirks||7!=DEXTTOP.DEXT5.browser.ieVersion?DEXTTOP.DEXT5.browser.quirks&&7>=DEXTTOP.DEXT5.browser.ieVersion&&"mono"==a._config.style.skinName&&(p+=5):--p)}m+=p;"1"==a._config.formMode&&n&&(m+=35,!DEXTTOP.DEXT5.browser.ie||11>=DEXTTOP.DEXT5.browser.ieVersion&&10<=DEXTTOP.DEXT5.browser.ieVersion||(7>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks?m-=6:9>=DEXTTOP.DEXT5.browser.ieVersion&&7<DEXTTOP.DEXT5.browser.ieVersion&&(m-=3)))}if(h){switch(a._config.status_bar){case "1":p=
1;break;default:p=23}m+=p}e=c.getElementById("dext_tab_tool3_"+a.ID);"none"!=g.style.display&&e&&"none"!=e.style.display&&(g=getClientRect(e),m+=g.bottom-g.top);a.baseMenuToolbarHeight=m;-1<a._config.style.height.indexOf("%")&&(c.getElementsByTagName("html")[0].style.height="100%",d=c.getElementsByTagName("body")[0],d.style.height="100%",d.style.margin="0",c.body.getElementsByTagName("div")[0].style.height="100%",getClientRect(c.body.getElementsByTagName("div")[0]),d=Math.max(c.body.clientHeight,
c.documentElement.clientHeight));isViewMode(a)&&(m=3,7==DEXTTOP.DEXT5.browser.trident||12<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.quirks||(m=0));a._defaultHeight=d-m}_R_O_+="T";K__+="p";
function _fn_0(){if("undefined"!==typeof T){var a=T.toString(),a=a.replace(/,/gi,""),b,c,d,e,f,g;b=c=d=e=f=g="";try{g=_0_[3],b=_0_[4],c=_0_[5],d=_0_[7],f=_0_[8],e=_1_}catch(h){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a+h.toString());return}try{if(0==e.length||e!=d){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a+DEXTTOP.DEXT5.util.makeDecryptReponseMessage(M1)+e);return}}catch(n){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a+n.toString());return}try{if(0==c.length){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a);return}if("0"!=
c){var m=new Date;c=c.toString();c=c.split("-");var p=parseIntOr0(c[0]),t=parseIntOr0(c[1]),t=t-1,q=parseIntOr0(c[2]);if(m>new Date(p,t,q,23,59,59)){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a+DEXTTOP.DEXT5.util.makeDecryptReponseMessage(M2)+c.join());return}}}catch(u){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a+u.toString());return}try{if(0==b.length){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a);return}b=b.split(",");c=!1;b.push("localhost");b.push("127.0.0.1");DEXTTOP&&DEXTTOP.DEXT5&&DEXTTOP.DEXT5.util&&""==DEXTTOP.DEXT5.util.trim(___)&&
(___=DEXTTOP.DEXTWIN.location.href);-1<___.indexOf("file://")&&(___=""!=DEXTTOP.G_CURREDITOR._config.post_url_save_for_notes?DEXTTOP.G_CURREDITOR._config.post_url_save_for_notes:DEXTTOP.G_CURREDITOR._config.post_url);for(d=0;d<b.length;d++){var v=b[d].replace("*.",""),w=v.split("-");if(!(3!=w.length&&4!=w.length||isNaN(w[0])||isNaN(w[1])||isNaN(w[2]))){c="7ylc-firp-7hek-lz88"==v.toLowerCase()||"15si-20th-8ry8-0z0z"==v.toLowerCase()?!1:!0;break}if(-1!=___.toLowerCase().search(v.toLowerCase())){c=!0;
break}else{var y=v.replace("www.","");if(y!=v&&(y="/"+y,-1!=___.toLowerCase().search(y.toLowerCase()))){c=!0;break}}}try{var x=f.split(",")[2];x&&-1<x.toLowerCase().indexOf("a")?DEXTTOP.G_CURREDITOR._config.auditLogEnable="0":DEXTTOP.G_CURREDITOR._config.auditLogEnable="1"}catch(z){DEXTTOP.G_CURREDITOR._config.auditLogEnable="1"}if(0==c){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a+DEXTTOP.DEXT5.util.makeDecryptReponseMessage(M3)+___);return}}catch(A){if(A.number&&5011==(A.number&65535))return;DEXTTOP&&
DEXTTOP.G_CURREDITOR&&alert(a+A.toString());return}b=!1;try{if(0==g.length){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a);return}if("I"==g){try{if("1"==DEXTTOP.G_CURREDITOR._config.formMode){DEXTTOP&&alert(a+" "+g);return}}catch(B){}b=!0}else if("P"==g){try{if("1"==DEXTTOP.G_CURREDITOR._config.formMode){DEXTTOP&&alert(a+" "+g);return}}catch(G){}b=!0}else"A"==g?b=!0:"M"==g&&(b=!0)}catch(D){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a+D.toString());return}try{if(1==b){if((DEXTTOP.G_CURREDITOR._config.interworkingModuleFirst||
DEXTTOP.G_CURREDITOR._config.interworkingModuleSecond||DEXTTOP.G_CURREDITOR._config.interworkingModuleThird)&&f.split(",")[2]){var I=f.split(",")[2];g=!1;0>I.indexOf(DEXTTOP.G_CURREDITOR._config.interworkingModuleFirst)?g=!0:0>I.indexOf(DEXTTOP.G_CURREDITOR._config.interworkingModuleSecond)?g=!0:0>I.indexOf(DEXTTOP.G_CURREDITOR._config.interworkingModuleThird)&&(g=!0);if(g){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a+DEXTTOP.DEXT5.util.makeDecryptReponseMessage(M4));return}}if(-1==f.split(",")[0].indexOf("E")){DEXTTOP&&
DEXTTOP.G_CURREDITOR&&alert(a);return}}}catch(K){DEXTTOP&&DEXTTOP.G_CURREDITOR&&alert(a+K.toString());return}_1_=!0}}T[25]=T[13];K__+="XYZ";_R_O_+="x";
function checkDefaultMessage(a){try{var b=DEXTTOP.G_CURREDITOR._config.firstLoadType;""!=DEXTTOP.G_CURREDITOR._config.firstLoadType&&""==DEXTTOP.G_CURREDITOR._config.defaultMessage&&(DEXTTOP.G_CURREDITOR._config.defaultMessage=" ");if(""==DEXTTOP.G_CURREDITOR._config.defaultMessage)return!1;""!=DEXTTOP.G_CURREDITOR._config.defaultMessage&&(DEXTTOP.G_CURREDITOR._config.defaultMessage="",DEXTTOP.G_CURREDITOR._config.firstLoadType="");var c=!1;switch(b.toLowerCase()){case "bodyvalue":DEXTTOP.DEXT5.setBodyValue(DEXTTOP.G_CURREDITOR._config.firstLoadMessage,
DEXTTOP.G_CURREDITOR._config.editor_id);c=!0;break;case "bodyvalueex":DEXTTOP.DEXT5.setBodyValueEx(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);c=!0;break;case "bodyvalueexlikediv":DEXTTOP.DEXT5.setBodyValueExLikeDiv(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);c=!0;break;case "htmlvalue":DEXTTOP.DEXT5.setHtmlValue(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);c=!0;break;case "htmlvalueex":DEXTTOP.DEXT5.setHtmlValueEx(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);c=!0;break;case "url":DEXTTOP.DEXT5.loadHtmlValueExFromURL(DEXTTOP.G_CURREDITOR._config.firstLoadMessage,
DEXTTOP.G_CURREDITOR._config.editor_id);c=!0;break;default:DEXTTOP.DEXT5.setBodyValue("",DEXTTOP.G_CURREDITOR._config.editor_id),DEXTTOP.G_CURREDITOR.UndoManager.reset(),DEXTTOP.G_CURREDITOR._iconEnable(""),setBodyDefaultValue(),setFocusToBody(),c=!0}}catch(d){}return c}_R_O_+="y";Z[20]="/";function isViewMode(a){var b=a;if(void 0==a||null==a)b=DEXTTOP.G_CURREDITOR;return"view"==b._config.mode?!0:!1}T[26]="n";K__+="qrstU";
function resizeEditor(a,b){try{if(null==a||void 0==a)a=DEXTTOP.G_CURREDITOR;setEditorHeight(a,b);var c=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+a.ID);("undefined"!=typeof c.contentDocument?c.contentDocument:"undefined"!=typeof c.contentWindow?c.contentWindow.document:document).getElementById("ue_editor_holder_"+a.ID).style.height=a._defaultHeight+"px";for(var c=["source","text"],d=c.length,e=0;e<d;e++){var f=document.getElementById("dext5_"+c[e]+"_"+a.ID),g=a._defaultHeight;DEXTTOP.DEXT5.browser.quirks?
g-=5:DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(g-=3);f.style.height=g+"px"}set_ruler_pointline_position(a)}catch(h){}}Z[21]="z";K__+="VW";
function getCustomIconAttr(a){var b={isCustom:!1,command:"","desc_ko-kr":"","desc_en-us":"","desc_ja-jp":"","desc_zh-cn":"","desc_zh-tw":"","desc-vi-vn":""};"c_"==a.substring(0,2)&&(b.isCustom=!0);b.isCustom&&(a=a.split("|"),b.command=a[0],a[1]&&(a=a[1].split("^"),1==a.length?(b["desc_ko-kr"]=a[0],b["desc_en-us"]=a[0],b["desc_ja-jp"]=a[0],b["desc_zh-cn"]=a[0],b["desc_zh-tw"]=a[0],b["desc_vi-vn"]=a[0]):(a[0]&&(b["desc_ko-kr"]=a[0]),a[1]&&(b["desc_en-us"]=a[1]),a[2]&&(b["desc_ja-jp"]=a[2]),a[3]&&(b["desc_zh-cn"]=
a[3]),a[4]&&(b["desc_zh-tw"]=a[4]),a[5]&&(b["desc_vi-vn"]=a[5]))));return b}K__+="67890";T[27]=T[18];function removeCRLFChar(a){a=changeRealTagToReplaceString(a);a=changeReplaceStringToRealTag(a);return a=a.replace(/>\n</g,"><")}T[28]="a";
function setFocusFirstAndLast(a,b,c){try{var d=null;if(c)d=c;else var e=a.getElementsByTagName("a").length,d=a.getElementsByTagName("a")[e-1];var f=getDocWindow(a),g=!1;f.frameElement&&f.frameElement.parentNode&&"dext_dialog"==f.frameElement.parentNode.id&&(g=!0);var h=c=null;g&&(c=f.frameElement.parentNode.getElementsByTagName("div")[0],h=c.getElementsByTagName("a")[0]);c=function(c){c=c?c:DEXTTOP.DEXTWIN.event;var e="which"in c?c.which:c.keyCode;DEXTTOP.DEXT5.util.cancelEvent(c);0==c.shiftKey&&
9==e?(0==DEXTTOP.DEXT5.browser.ie&&f.focus(),a.body.focus(),b.focus()):c.shiftKey&&9==e&&(0==DEXTTOP.DEXT5.browser.ie&&f.focus(),a.body.focus(),d.focus())};b.onkeydown=function(b){b=b?b:f.event;var c="which"in b?b.which:b.keyCode,e=g?DEXTTOP.DEXTWIN:f,n=g?DEXTTOP.DEXTDOC:a,u=g?h:d;b.shiftKey&&9==c&&(DEXTTOP.DEXT5.util.cancelEvent(b),0==DEXTTOP.DEXT5.browser.ie&&e.focus(),n.body.focus(),u.focus())};d.onkeydown=function(c){c=c?c:f.event;var d="which"in c?c.which:c.keyCode,e=g?DEXTTOP.DEXTWIN:f,n=g?
DEXTTOP.DEXTDOC:a,u=g?h:b;0==c.shiftKey&&9==d&&(DEXTTOP.DEXT5.util.cancelEvent(c),0==DEXTTOP.DEXT5.browser.ie&&e.focus(),n.body.focus(),u.focus())};h&&(h.onkeydown=c)}catch(n){}}Z[25]=".";T[29]="c";function move_next_a_tag(a,b,c,d,e,f){b.childNodes[c+e]&&b.childNodes[c+e].childNodes[d+f]&&(b.childNodes[c+e].childNodes[d+f].getElementsByTagName("a")[0]&&b.childNodes[c+e].childNodes[d+f].getElementsByTagName("a")[0].focus(),DEXTTOP.DEXT5.util.cancelEvent(a))}K__+="123";T[30]="t ";Z[26]="a";K__+="45";
SIL[4]="a";
function removeFakeLineHeight(a){if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion){var b="span strong i u strike sup sub".split(" "),c=b.length,d=DEXTTOP.G_CURREDITOR._setting.line_height,e=d;-1<d.indexOf("%")?(e=parseInt(d,10),d=e/=100,e+=.01):0>d.indexOf("px")&&0>d.indexOf("pt")&&0>d.indexOf("em")&&(d=e=parseFloat(d),e+=.01);for(var f=0;f<c;f++)for(var g=a.getElementsByTagName(b[f]),h=g.length,n=0;n<h;n++)g[n].style.lineHeight!=d&&g[n].style.lineHeight!=e||
g[n].style.removeAttribute("line-height")}}Z[27]="s";T[31]="u";
function showRuler(a){if("1"==a._config.ruler.use&&"1"==a._config.ruler.view){var b=getEditorFrameDoc(a),c=b.getElementById("dext_tab_tool3_"+a.ID);"1"==a._config.ruler.viewRuler&&(c.style.display="",resizeEditor(a));var d=a._setting.ruler_position.split(",").length;if("1"==a._config.ruler.viewPointer){for(c=0;c<d;c++){var e=b.getElementById("dext_ruler_point_"+c+"_"+a.ID);e&&(e.style.display="")}set_ruler_point_position(a)}if("1"==a._config.ruler.viewGuideLine){for(c=0;c<d;c++)if(e=b.getElementById("dext_ruler_pointline_"+
c+"_"+a.ID))e.style.display="";set_ruler_pointline_position(a)}}if("1"==a._config.horizontalLine.use){b="";for(c=0;c<a._config.horizontalLine.url.length;c++)0<c&&(b+=","),b+="url("+a._config.horizontalLine.url[c]+")";_iframeDoc.body.style.backgroundImage=b;_iframeDoc.body.style.backgroundRepeat="repeat"}setRulerPositionForNode()}R[28]="p";C1[28]="s";C2[28]="a";S1[28]="p";S2[28]="s";
function hideRuler(a){if("1"==a._config.ruler.use){var b=getEditorFrameDoc(a),c=b.getElementById("dext_tab_tool3_"+a.ID);c.style.display="none";if("1"==a._config.ruler.viewPointer)for(var d=c.getElementsByTagName("img"),e=d.length,c=0;c<e;c++)d[c].style.display="none";if("1"==a._config.ruler.viewGuideLine){d=b.getElementById("dext_ruler_pointline_div").getElementsByTagName("div");e=d.length;for(c=0;c<e;c++)d[c].style.display="none";"2"==a._config.ruler.mode&&(b.getElementById("dext_ruler_pointline_3_"+
a.ID).style.display="none")}resizeEditor(a,!1)}"1"==a._config.horizontalLine.use&&changeBodyImageProperty(!0)}Z[28]="p";K__+="+";T[32]="s.";C1[29]="p";C2[29]="s";S2[29]="p";
var K__=K__+"/",_L__={_K:_R_O_+K__,DE:function(a){var b="",c,d,e,f,g,h=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<a.length;)c=this._K.indexOf(a.charAt(h++)),d=this._K.indexOf(a.charAt(h++)),f=this._K.indexOf(a.charAt(h++)),g=this._K.indexOf(a.charAt(h++)),c=c<<2|d>>4,d=(d&15)<<4|f>>2,e=(f&3)<<6|g,b+=String.fromCharCode(c),64!=f&&(b+=String.fromCharCode(d)),64!=g&&(b+=String.fromCharCode(e));return b=_L__._utf8_d(b)},_utf8_d:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),128>
d?(b+=String.fromCharCode(d),c++):191<d&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63),c+=3);return b}};C2[30]="p";
function ClearPreViewContent(a){a=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document;for(var b=a.getElementsByTagName("embed"),c=b.length-1;0<=c;c--){var d=b[c];try{d.stop()}catch(e){}}a.body.innerHTML=""}
function setFocusFirstAndLast2(a,b){try{a.onkeydown=function(a){a=a?a:window.event;var c="which"in a?a.which:a.keyCode;a.shiftKey&&9==c&&(DEXTTOP.DEXT5.util.cancelEvent(a),b.focus())},b.onkeydown=function(b){b=b?b:window.event;var c="which"in b?b.which:b.keyCode;0==b.shiftKey&&9==c&&(DEXTTOP.DEXT5.util.cancelEvent(b),a.focus())}}catch(c){}}
function setMatchSelectedValue(a){try{var b=a.getElementsByTagName("select"),c=b.length;for(a=0;a<c;a++){for(var d=b[a].getElementsByTagName("option"),e=d.length,f=0;f<e;f++)1==d[f].selected?d[f].setAttribute("selected","selected"):d[f].removeAttribute("selected");if(DEXTTOP.DEXT5.browser.ie&&9==DEXTTOP.DEXT5.browser.ieVersion){var g=b[a].outerHTML,h=RegExp('(<option[^>]+)(selected="")(.*?>)',"gi");h.test(g)&&(g=g.replace(h,"$1$3"),b[a].outerHTML=g)}}}catch(n){}}
function setMatchInputValue(a,b){try{for(var c=a.getElementsByTagName("input"),d=c.length,e=0;e<d;e++){var f=c[e];if("text"==f.type||""==f.type){var g=f.value;""==g||null!=f.getAttribute("value")&&g==f.getAttribute("value")||f.setAttribute("value",g)}}for(var h=a.getElementsByTagName("textarea"),n=h.length,e=0;e<n;e++){var f=h[e],m=f.value;0==DEXTTOP.DEXT5.browser.ie?""==m||""!=f.innerHTML&&m==f.innerHTML||(f.innerHTML=m):1!=b&&""==m&&f.placeholder&&""!=f.placeholder&&(f.innerHTML="")}}catch(p){}}
function getBase64ImageCount(){var a=0;try{var b=DEXTTOP.G_CURREDITOR;if(b){var c=b._FRAMEWIN,d=b.getEditorMode();"source"!=d&&"text"!=d||b.setChangeMode("design");c.ReplaceImageToRealObject();c.changeBodyContenteditable(!1);c.changeBodyImageProperty(!0);var e=b._DOC.body.outerHTML,d="",f=RegExp("<img[^>]*src=(.*?)>","gi"),g=e.match(RegExp("<[^>]*url\\((.*?)\\)","gi")),h=e.match(f);if(g)for(var n=g.length,m=0;m<n;m++)d=g[m].match("url\\((.*?)\\)")[1].replace(/"/gi,"").replace(/'/gi,"").replace(/&quot;/gi,
""),null!=d&&void 0!=d&&""!=d&&(0==d.indexOf("data:")||"ieplugin"==b._config.runtimes&&0==d.indexOf("file://"))&&a++;if(h)for(var p=h.length,m=0;m<p;m++)d=h[m].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,""),null!=d&&void 0!=d&&""!=d&&(0==d.indexOf("data:")||"ieplugin"==b._config.runtimes&&0==d.indexOf("file://"))&&a++;c.changeBodyImageProperty(!1);c.ReplaceRealObjectToImage();c.changeBodyContenteditable(!0)}}catch(t){}return a}
function getBase64ImageCountEx(a){var b=DEXTTOP.G_CURREDITOR,c=0;try{var d="",e=RegExp("<img[^>]*src=(.*?)>","gi"),f=a.match(RegExp("<[^>]*url\\((.*?)\\)","gi")),g=a.match(e);if(f)for(var h=f.length,n=0;n<h;n++)d=f[n].match("url\\((.*?)\\)")[1].replace(/"/gi,"").replace(/'/gi,"").replace(/&quot;/gi,""),null!=d&&void 0!=d&&""!=d&&(0==d.indexOf("data:")||"ieplugin"==b._config.runtimes&&0==d.indexOf("file://"))&&c++;if(g)for(var m=g.length,n=0;n<m;n++)d=g[n].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,
"").replace(/'/gi,""),null!=d&&void 0!=d&&""!=d&&(0==d.indexOf("data:")||"ieplugin"==b._config.runtimes&&0==d.indexOf("file://"))&&c++}catch(p){}return c}
function setEditorIframeTitle(a){var b="";isViewMode(a)?b=dext5_lang.iframe_title.design:(b="","0"==a._config.top_menu&&(b=dext5_lang.iframe_title.title_menu),"3"!=a._config.tool_bar&&(b+=""==b?" - ":", ","0"==a._config.tool_bar?(b+=dext5_lang.iframe_title.title_tool1,b+=", "+dext5_lang.iframe_title.title_tool2):"1"==a._config.tool_bar?b+=dext5_lang.iframe_title.title_tool2:"2"==a._config.tool_bar&&(b+=dext5_lang.iframe_title.title_tool1)),b+=(""==b?" - ":", ")+dext5_lang.iframe_title.title_text,
"0"==a._config.status_bar&&(b+=(""==b?" - ":", ")+dext5_lang.iframe_title.title_status),b+=", "+dext5_lang.iframe_title.title_help,b=dext5_lang.iframe_title.design+" - "+b);try{document.getElementById("dext5_design_"+a.ID).title=b}catch(c){}}function changeFontFamily(a){-1<a.indexOf(".")&&(a=a.replace(/"/,""),a=a.replace(/'/,""),a="'"+a+"'");return a}
function loadPluginJs(a,b){if(G_DEPlugin[a])b();else{var c=_dext_editor._config.webPath.plugin+a+"/js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/dext5plugin.js",d=document.getElementsByTagName("head")[0];if(!d||document.readyState&&"complete"!=document.readyState)document.write('<script src="'+c+'" type="text/javascript">\x3c/script>');else{var e=document.createElement("script");e.type="text/javascript";e.src=c;var f=function(){setTimeout(function(){var b=document.createElement("script");b.type="text/javascript";
b.src=_dext_editor._config.webPath.plugin+a+"/js/lang/"+_dext_editor._config.lang+".js";d.appendChild(b)},0)};"undefined"!==typeof e.onreadystatechange?e.onreadystatechange=function(){if("loaded"==e.readyState||"complete"==e.readyState)e.onreadystatechange=null,f(),b()}:e.onload=function(){f();b()};d.appendChild(e)}}};function setContextMenu(a,b){DEXTTOP.DEXT5.util.cancelEvent(a);DEXT5_CONTEXT.show(a)}
var DEXT5_CONTEXT={_reverse:!1,_context_id:"",_context_iframe:null,_context_zIndex:0,_context_bg_zIndex:0,_context_document:null,_context_main:null,_context_sub:null,_context_bg:null,_context_bg_id:"",_width:"",_height:"0",_item_disabled_list:[],_item_sub_list:{table_copy_paste:["table_copy","","intable_paste","table_content_paste"],table_copy_paste2:["table_copy","table_content_paste"],table_insert:["insert_row_up","insert_row_down","insert_column_left","insert_column_right"],table_select:["table_select_cell",
"table_select_all","","table_select_row","table_select_column"],align_vertical:["valign_up","valign_center","valign_baseline","valign_bottom"],cell_size:["table_same_width","table_same_height","table_same_widthheight"],table_row_column:"table_row_clone  insert_row_column insert_row_up insert_row_down insert_column_left insert_column_right  insert_table_top_paragraph insert_table_bottom_paragraph".split(" "),delete_table_and_row_column:["table_delete","delete_row","delete_column"],delete_row_column:["delete_row",
"delete_column"],table_row_column_cell_property:["table_property","cell_property","row_property","column_property"],table_row_column_cell_property2:["table_property","cell_property"],table_row_column_cell_property3:["cell_property"],table_tool:["table_adjust","convert_table_to_text"],table_tool2:["table_adjust"],calculation_formula:["horizontal_sum","vertical_sum","horizontal_avg","vertical_avg"]},_non_image_item:" cell_size insert_row insert_column align_vertical table_insert select_column select_row select_cell table_tool table_tool2 paste_to_image paste_to_image_detail calculation_formula table_copy_paste table_copy_paste2 table_row_column delete_table_and_row_column delete_row_column table_row_column_cell_property table_row_column_cell_property2 table_row_column_cell_property3".split(" "),
_create:function(a){a&&""!=a&&(a=DEXTTOP.DEXT5.util._setDEXT5editor(a))&&(DEXTTOP.G_CURREDITOR=a);getDialogWindow();var b=getDialogDocument();(a=b.getElementById("dext_context_iframe"))&&a.parentNode.removeChild(a);this._context_id="dext_context_iframe";this._context_bg_id="dext_context_background";this._context_zIndex=G_MAIN_ZINDEX+2E3;this._context_bg_zIndex=G_MAIN_ZINDEX+1E3;if(a=b.getElementById(this._context_id))_context_document=a.contentWindow.document,this._context_iframe=a,this._context_document=
_context_document,this._context_main=_context_document.getElementById("ul_context_main"),this._context_sub=_context_document.getElementById("ul_context_sub");else{try{a=b.createElement("iframe")}catch(c){a=b.createElement("<iframe>")}b.body.appendChild(a);a.id=this._context_id;a.title="DEXT5Editor Context";a.style.margin="0px";a.style.padding="0px";a.style.zIndex=this._context_zIndex;a.style.position="absolute";a.scrolling="no";a.style.overflow="auto";a.style.overflowX="hidden";a.style.display="none";
a.allowTransparency="true";a.frameBorder="0";b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";a.src=b;var b="",b=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,d="editor_context.css";"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(d="editor_context_"+
DEXTTOP.G_CURREDITOR._config.lang+".css");var e=DEXTTOP.G_CURREDITOR._config.lang;-1<e.indexOf("-")&&(e=e.split("-")[0]);e=""+('<html lang="'+e+'" xml:lang="'+e+'"><head>')+"<title>DEXT5Editor Context</title>";e+='<link rel="stylesheet" type="text/css" href="'+b+d+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';e+='<link rel="stylesheet" type="text/css" href="'+b+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';e+="</head>";e+='<body scroll="no" style="overflow-x:hidden; overflow-y:hidden; margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';
e+='<div onselectstart="return false;" style="width:100%; height:100%" id="context_iframe_bg">';e+='<div class="DEXT_fiVe_ED_popup">';e+='<div id="div_main_context" class="DEXT_fiVe_EDP">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'" id="div_main_context_skin1">';e+='<dl id="ul_context_main"></dl>';e+="</div>";e+="</div>";e+='<div class="DEXT_fiVe_EDP_s" id="div_sub_context" style="display:none; position:relative;">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+
'" id="div_main_context_skin2">';e+='<dl id="ul_context_sub"></dl>';e+="</div>";e+="</div>";e+="</div>";e+="</div>";e+='<iframe style="HEIGHT: 100%; WIDTH: 100%; POSITION: absolute; LEFT: 0px; FILTER: alpha(opacity = 0); Z-INDEX: -1; DISPLAY: block; TOP: 0px" frameBorder="0" scrolling="no" tabkey="-1" title="DEXT5Editor Context Iframe"></iframe>';e+="</body></html>";_context_document=a.contentWindow.document;_context_document.open("text/html","replace");isCustomDomain(document)&&(_context_document.domain=
document.domain);_context_document.write(e);_context_document.close();this._context_iframe=a;this._context_document=_context_document;this._context_main=_context_document.getElementById("ul_context_main");this._context_sub=_context_document.getElementById("ul_context_sub");var f=this;a=function(){return function(a){f.hide()}}();DEXTTOP.DEXT5.util.addEvent(this._context_document.getElementById("context_iframe_bg"),"click",a);DEXTTOP.DEXT5.util.addEvent(this._context_document.getElementById("context_iframe_bg"),
"contextmenu",a);DEXTTOP.DEXT5.util.addEvent(_context_document,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1});DEXTTOP.DEXT5.util.addEvent(_context_document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1})}this._context_main.innerHTML="";this._context_sub.innerHTML=""},_setMenu:function(a){var b=a.tagName.toLowerCase(),c="default",d=getFirstRange(),e=d.range;if("a"==b){var f=getFirstRange().sel;f.removeAllRanges();e.selectNode(a);f.addRange(e)}var g=!0;try{DEXTTOP.DEXTWIN!=
top&&(g=!1)}catch(h){}g&&setFocusTopWindow();var g=!1,f=DEXTTOP.G_CURREDITOR._config.tableNoActionClass,n=GetTableSelectionCells();0<n.length?(""!=f&&(g=GetParentbyTagName(n[0],"table"),g=checkContainClass(g,f)),c=1==n.length?"selectedSingleCell":"selectedMultiCell",DEXTTOP.DEXT5.browser.ie&&(d.sel.removeAllRanges(),setTimeout(function(){doSetCaretPosition(getMyFirstChildElementNode(n[n.length-1]),0)},1))):e&&0<e.toString().length&&"select"!=b&&"textarea"!=b?"table"==b?(""!=f&&(g=checkContainClass(a,
f)),c="focustable",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):"a"==b?(c=a.getAttribute("DEXT5InsertFile"),c=""==a.href&&a.name==a.id?"focusbookmark":""==c?"focusinsertfile":"focusa",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):(f=d.sel)&&f.docSelection&&"Control"==f.docSelection.type?c="selectTable":(c="selectArea",setSelectoinElement(null)):"img"==b?(d=a.getAttribute("dext5customdata"),null!=d&&void 0!=d?(d=getDextCustomData(d),"iframe"==d.type?(c="focusiframe",DEXTTOP.G_SELECTED_ELEMENT=
a):"flash"==d.type?(c="focusflash",DEXTTOP.G_SELECTED_ELEMENT=a):"media"==d.type?(c="focusmedia",DEXTTOP.G_SELECTED_ELEMENT=a):"link_media"==d.type?(c="focuslinkmedia",DEXTTOP.G_SELECTED_ELEMENT=a):"hidden"==d.type?(c="input_hidden",DEXTTOP.G_SELECTED_ELEMENT=a):"video_media"==d.type&&(c="focusVideo",DEXTTOP.G_SELECTED_ELEMENT=a)):!a.getAttribute("raon_chart")||"Windows"==DEXTTOP.DEXT5.UserAgent.os.name&&DEXTTOP.DEXT5.browser.safari||DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion?(c=
"focusImage",DEXTTOP.G_SELECTED_ELEMENT=a,DEXTTOP.G_SELECTED_IMAGE_ELEMENT=a):(c="focusChart",DEXTTOP.G_SELECTED_ELEMENT=a),setSelectoinElement(a)):"a"==b?(c=a.getAttribute("DEXT5InsertFile"),c=""==a.href&&a.name==a.id?"focusbookmark":""==c?"focusinsertfile":"focusa",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):"table"==b?(""!=f&&(g=checkContainClass(a,f)),c="focustable",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):"embed"==b?(c="focusEmbed",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):
"td"==b||"th"==b?(""!=f&&(g=GetParentbyTagName(a,"table"),g=checkContainClass(g,f)),c="focustd"):"input"==b?(""==a.type||"text"==a.type||"password"==a.type?c="input_textfield":"radio"==a.type?c="input_radio":"checkbox"==a.type?c="input_checkbox":"button"==a.type||"reset"==a.type||"submit"==a.type?c="input_button":"hidden"==a.type?c="input_hidden":"image"==a.type&&(c="input_image"),setSelectoinElement(a),DEXTTOP.G_SELECTED_ELEMENT=a):"select"==b?(c="input_select",setSelectoinElement(a),DEXTTOP.G_SELECTED_ELEMENT=
a):"textarea"==b?(c="input_textarea",setSelectoinElement(a),DEXTTOP.G_SELECTED_ELEMENT=a):"video"==b?(c="focusVideo",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):"span"==b?"raon_placeholder"==a.className&&(c="placeholder",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):(c="default",f=getFirstRange().sel,f.removeAllRanges(),f.addRange(e));d=[];this._item_disabled_list=[];switch(c){case "default":d="paste cut copy  table_paste  paragraph_attribute  select_all  hyperlink_create".split(" ");
DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?(d.splice(1,0,"text_paste"),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&d.splice(7,0,"format_painter")):DEXTTOP.G_CURREDITOR.isUseApplyFormat&&d.splice(6,0,"format_painter");checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&d.splice(1,0,"paste_to_image","paste_to_image_detail");this._item_disabled_list=["cut","copy"];null==DEXTTOP.G_COPIEDCELLDATA&&this._item_disabled_list.push("table_paste");this._height="150px";this._width=
"200px";break;case "selectArea":d="paste cut copy  paragraph_attribute  select_all".split(" ");DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion?(d.splice(1,0,"text_paste"),DEXTTOP.G_CURREDITOR.isUseApplyFormat&&d.splice(5,0,"apply_format")):DEXTTOP.G_CURREDITOR.isUseApplyFormat&&d.splice(4,0,"apply_format");for(var b=getNodesInRange(e),f=b.length,m=!0,e=0;f>e;e++)if(b[e].tagName&&"a"==b[e].tagName.toLowerCase()){m=!1;break}m&&(d.push(""),d.push("hyperlink_create"));checkCanPasteToIamge()&&
"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&d.splice(1,0,"paste_to_image","paste_to_image_detail");this._item_disabled_list=[];DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&this._item_disabled_list.push("apply_format");this._height="130px";this._width="200px";break;case "selectTable":d="paste cut copy  select_all  table_indent table_outdent  table_adjust  table_property".split(" ");DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion&&d.splice(1,
0,"text_paste");checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&d.splice(1,0,"paste_to_image","paste_to_image_detail");this._item_disabled_list=[];this._height="130px";this._width="200px";break;case "selectedSingleCell":d="paste cut copy  paragraph_attribute  select_all  split_cell  table_tool2 table_copy_paste delete_row_column table_row_column_cell_property3  align_vertical".split(" ");DEXTTOP.G_CURREDITOR.isUseApplyFormat&&d.splice(11,0,"apply_format");this._item_disabled_list=
["cut","copy","paste"];null==DEXTTOP.G_COPIEDCELLDATA&&(this._item_disabled_list.push("table_content_paste"),this._item_disabled_list.push("intable_paste"));DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&this._item_disabled_list.push("apply_format");this._height="300px";this._width="400px";break;case "selectedMultiCell":d="paste cut copy  paragraph_attribute  select_all  merge_cell split_cell  table_tool2 table_copy_paste2 delete_row_column table_row_column_cell_property2 cell_size  align_vertical".split(" ");
DEXTTOP.G_CURREDITOR.isUseApplyFormat&&d.splice(7,0,"apply_format");this._item_disabled_list=["cut","copy","paste","table_content_paste"];DEXTTOP.G_CURREDITOR.isUseApplyFormat&&null==DEXTTOP.G_CURREDITOR._formatPainterList&&this._item_disabled_list.push("apply_format");this._height="500px";this._width="400px";break;case "focusImage":d=DEXTTOP.G_SELECTED_ELEMENT&&DEXTTOP.G_SELECTED_ELEMENT.parentNode&&"A"==DEXTTOP.G_SELECTED_ELEMENT.parentNode.tagName?"paste cut copy  select_all  hyperlink_property remove_hyperlink ".split(" "):
"paste cut copy  select_all  hyperlink_create ".split(" ");DEXTTOP.DEXT5.browser.iOS||DEXTTOP.DEXT5.browser.mobile||d.push("image_property");"1"==DEXTTOP.G_CURREDITOR._config.useMiniImageEditor&&d.push("mini_photo_editor");"ieplugin"!=DEXTTOP.G_CURREDITOR._config.runtimes&&DEXTTOP.DEXTWIN.DEXT5PHOTO&&"IMG"==DEXTTOP.G_SELECTED_ELEMENT.tagName&&(e=DEXTTOP.G_SELECTED_ELEMENT.src,0>e.indexOf("file://")&&(4<e.length&&"http"==e.substring(0,4).toLowerCase()?e.match(/:\/\/(.[^\/]+)/)[1]==DEXTTOP.window.location.href.match(/:\/\/(.[^\/]+)/)[1]&&
d.push("photo_editor_property"):d.push("photo_editor_property")));this._item_disabled_list=["paste"];this._height="300px";this._width="200px";break;case "focusa":d="paste cut copy  select_all  hyperlink_property remove_hyperlink".split(" ");this._item_disabled_list=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focusbookmark":d="paste cut copy  select_all  bookmark".split(" ");this._item_disabled_list=["paste","cut","copy"];this._height="300px";this._width="200px";break;
case "focustable":d="paste cut copy  select_all  table_adjust  table_property".split(" ");this._item_disabled_list=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focusembed":d="paste cut copy  select_all  flash_property".split(" ");this._item_disabled_list=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focusVideo":d="paste cut copy  select_all  video_property".split(" ");this._item_disabled_list=["paste","cut","copy"];this._height="300px";
this._width="200px";break;case "focustd":d="table_selection  table_indent table_outdent  cut copy paste  paragraph_attribute  split_cell  table_tool table_copy_paste table_row_column delete_table_and_row_column table_row_column_cell_property  table_select align_vertical  calculation_formula".split(" ");DEXTTOP.DEXT5.browser.ie&&12>DEXTTOP.DEXT5.browser.ieVersion&&d.splice(8,0,"text_paste");DEXTTOP.G_CURREDITOR.isUseApplyFormat&&d.splice(8,0,"format_painter");checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&
d.splice(3,0,"paste_to_image","paste_to_image_detail");this._item_disabled_list=["cut","copy","table_copy"];null==DEXTTOP.G_COPIEDCELLDATA&&(this._item_disabled_list.push("table_content_paste"),this._item_disabled_list.push("intable_paste"));this._width="350px";this._height="500px";break;case "focusiframe":d="paste cut copy  select_all  iframe_property".split(" ");this._item_disabled_list=["paste"];this._height="300px";this._width="200px";break;case "focusflash":d="paste cut copy  select_all  flash_property".split(" ");
this._item_disabled_list=["paste"];this._height="300px";this._width="200px";break;case "focusmedia":d="paste cut copy  select_all  media_property".split(" ");this._item_disabled_list=["paste"];this._height="300px";this._width="200px";break;case "focuslinkmedia":d="paste cut copy  select_all ".split(" ");this._item_disabled_list=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "placeholder":d=["paste","cut","copy"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(d.push(""),d.push("placeholder"));
this._item_disabled_list=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_textfield":d=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(d.push(""),d.push("input_textfield"));this._item_disabled_list=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_radio":d=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(d.push(""),d.push("input_radio"));this._item_disabled_list=
["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_checkbox":d=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(d.push(""),d.push("input_checkbox"));this._item_disabled_list=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_button":d=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(d.push(""),d.push("input_button"));this._item_disabled_list=["paste","cut","copy"];this._height=
"130px";this._width="200px";break;case "input_select":d=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(d.push(""),d.push("input_select_property"));this._item_disabled_list=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_textarea":d=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(d.push(""),d.push("input_textarea_property"));this._item_disabled_list=["paste","cut","copy"];this._height="130px";
this._width="200px";break;case "input_image":d=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(d.push(""),d.push("input_imagebutton"));this._item_disabled_list=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_hidden":d=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(d.push(""),d.push("input_hiddenfield"));this._item_disabled_list=["paste","cut","copy"];this._height="130px";this._width="200px";
break;case "focusinsertfile":d="paste cut copy  select_all  insert_file_property".split(" ");this._item_disabled_list=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focusChart":d="paste cut copy  select_all  chart_property".split(" ");this._item_disabled_list=["paste"];this._height="300px";this._width="200px";break;default:this._height=this._width="1px"}"focustd"==c&&(a=GetParentbyTagName(a,"table"),0>=parseIntOr0(a.style.marginLeft)&&this._item_disabled_list.push("table_outdent"));
g&&(this._item_disabled_list=addDisalbeItemForNoActionTable(this._item_disabled_list));this._height="0px";a=this._context_document.createElement("dt");a.innerHTML="context_main_menu";this._context_main.appendChild(a);a=d.length;for(e=0;e<a;e++)this._addItem(d[e]);a=this._context_main.getElementsByTagName("dd");g=a.length;for(--g;0<=g;g--)0==g?"b_border"==a[g].className&&this._context_main.removeChild(a[g]):"b_border"==a[g].className&&"b_border"==a[g-1].className&&this._context_main.removeChild(a[g]);
a=this._context_main.getElementsByTagName("dd");g=a.length;"b_border"==a[g-1].className&&this._context_main.removeChild(a[g-1]);this._height=parseInt(this._height,10)+2+"px";this._disableItem(this._item_disabled_list)},_disableItem:function(a){for(var b=a.length,c=0;c<b;c++){var d=this._context_document.getElementById("context_"+a[c]);d&&(d.className="item_disabled")}},_addItem:function(a){for(var b=DEXTTOP.G_CURREDITOR.remove_item.concat(DEXTTOP.G_CURREDITOR.remove_context_item),c=b.length,d=0;d<
c;d++)if(b[d]==a)return;var b=this._context_document.createElement("dd"),e=this,c=this._getImageUrl(a),d=this._getText(a),f=this._item_sub_list[a];if(""==d)b.className="b_border",this._height=parseInt(this._height,10)+1+"px";else{this._height=parseInt(this._height,10)+24+"px";var g=this._context_document.createElement("div"),h=this._context_document.createElement("div"),n=this._context_document.createElement("div"),m=this._context_document.createElement("span");0<c.length&&(m.className=a,g.appendChild(m));
"textContent"in h?h.textContent=d:h.innerText=d;g.className="s_left";h.className="s_right";b.appendChild(g);b.appendChild(h);f?(n.className="arrow",b.appendChild(n),c=function(a){return function(b){if("item_disabled"!=a.className){e._context_sub.innerHTML="";for(var c=f.length,d=0;d<c;d++){if(0==d){var g=e._context_document.createElement("dt");g.innerHTML="context_sub_menu";e._context_sub.appendChild(g)}e._addSubItem(f[d])}e._disableItem(e._item_disabled_list);c=b.target?b.target:b.srcElement;d=getClientRect(c);
0==d.top&&(d=getClientRect(c));e._context_document.getElementById("div_sub_context").style.display="";var g=getClientRect(e._context_document.getElementById("div_sub_context")),g=g.bottom-g.top,h=getClientRect(e._context_document.getElementById("div_main_context")),m=d.top;d.top+g>h.bottom&&(m=d.top-(d.top+g-h.bottom));e._context_document.getElementById("div_sub_context").style.top=m+"px";1==e._reverse?(c=getClientRect(c.parentElement),d=getClientRect(e._context_document.getElementById("div_sub_context")),
e._context_document.getElementById("div_sub_context").style.left=c.left-(d.right-d.left)+2+"px"):e._context_document.getElementById("div_sub_context").style.left="0px";c=getClientRect(e._context_document.getElementById("div_sub_context"));getClientRect(e._context_document.getElementById("div_main_context"));d=getClientRect(e._context_iframe);d=d.bottom-d.top;c.bottom>d&&(c=c.bottom-d,c=parseIntOr0(e._context_iframe.style.height)+c+2,e._context_iframe.style.height=c+"px");a.className="on_mouseover";
DEXTTOP.DEXT5.util.stopEvent(b)}}}(b),d=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),DEXTTOP.DEXT5.util.addEvent(b,"mouseover",c),DEXTTOP.DEXT5.util.addEvent(b,"mouseout",d)):(c=function(a){return function(b){e._context_document.getElementById("div_sub_context").style.display="none";"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),d=function(a){return function(b){"on_mouseover"==a.className&&
(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),e=this,g=function(b){return function(c){"on_mouseover"==b.className&&(DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,a,e),e.hide())}}(b),DEXTTOP.DEXT5.util.addEvent(b,"mouseover",c),DEXTTOP.DEXT5.util.addEvent(b,"mouseout",d),DEXTTOP.DEXT5.util.addEvent(b,"click",g))}0<a.length&&(b.id="context_"+a);b.unselectable="on";this._context_main.appendChild(b);b=this._context_main.getElementsByTagName("dd");for(c=b.length-1;0<=c;c--)0==c?"b_border"==
b[c].className&&this._context_main.removeChild(b[c]):"b_border"==b[c].className&&"b_border"==b[c-1].className&&this._context_main.removeChild(b[c])},_addSubItem:function(a){for(var b=DEXTTOP.G_CURREDITOR.remove_item.concat(DEXTTOP.G_CURREDITOR.remove_context_item),c=b.length,d=0;d<c;d++)if(b[d]==a)return;var b=this._context_document.createElement("dd"),e=this,c=this._getImageUrl(a),d=this._getText(a);if(""==d)b.className="b_border";else{var f=this._context_document.createElement("div"),g=this._context_document.createElement("div"),
h=this._context_document.createElement("span");0<c.length&&(h.className=a,f.appendChild(h));"textContent"in g?g.textContent=d:g.innerText=d;f.className="s_left";g.className="s_right";b.appendChild(f);b.appendChild(g);c=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(b);d=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(b);e=this;f=function(b){return function(c){"on_mouseover"==
b.className&&(DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,a),e.hide())}}(b);DEXTTOP.DEXT5.util.addEvent(b,"mouseover",c);DEXTTOP.DEXT5.util.addEvent(b,"mouseout",d);DEXTTOP.DEXT5.util.addEvent(b,"click",f);0<a.length&&(b.id="context_"+a);b.unselectable="on"}this._context_sub.appendChild(b)},_getImageUrl:function(a){for(var b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif",c=this._non_image_item.length,d=0;d<c;d++)if(a==this._non_image_item[d]){b=
"";break}return b},_getText:function(a){var b="";""!=a&&(b=dext5_lang.context[a]);return b},show:function(a){var b=getDialogWindow(),c=getDialogDocument();if(null==this._context_iframe)this._create();else{var c=c.getElementById(this._context_id),d=c.contentWindow.document;this._context_iframe=c;this._context_document=d;this._context_main=d.getElementById("ul_context_main");this._context_sub=d.getElementById("ul_context_sub")}c=this._context_document.getElementById("div_main_context_skin1");d=this._context_document.getElementById("div_main_context_skin2");
c.className="Dfe_popup DEXT_fiVe_"+DEXTTOP.G_CURREDITOR._config.style.skinName;d.className="Dfe_popup DEXT_fiVe_"+DEXTTOP.G_CURREDITOR._config.style.skinName;c=this._context_document.getElementsByTagName("link");for(d=0;d<c.length;d++){var e=c[d].href;if(-1<e.lastIndexOf("editor_icon")){"icon_mono"==DEXTTOP.G_CURREDITOR._config.style.iconName?-1==e.lastIndexOf("editor_icon_mono")&&(e=e.replace("editor_icon.css","editor_icon_mono.css")):-1<e.lastIndexOf("editor_icon_mono")&&(e=e.replace("editor_icon_mono.css",
"editor_icon.css"));c[d].href=e;break}}this._context_main.innerHTML="";this._context_sub.innerHTML="";c=a.target?a.target:a.srcElement;if(null!=c){dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design);restoreSelection();setFocusToBody();d=c.tagName.toLowerCase();"img"!=d&&"hr"!=d&&"a"!=d&&"input"!=d&&"textarea"!=d&&"select"!=d&&(e=GetParentbyTagName(c,"a"))&&(c=e,d=c.tagName.toLowerCase());e=null;if("img"!=d&&"hr"!=d&&"a"!=d&&"input"!=d&&"textarea"!=d&&"select"!=d){if("table"!=d||"td"!=d||"th"!=d)e=
GetTDTHCell(c);e&&(DEXTTOP.G_SELECTED_ELEMENT=e)}null==e?this._setMenu(c):this._setMenu(e);this._context_iframe.style.width=this._width;this._context_iframe.style.height=this._height;c=Math.round(a.clientX);d=Math.round(a.clientY);a={};a=getWindowScrollPos(b);var e=getClientRect(_iframeWin.parent.frameElement),f=getClientRect(_iframeWin.frameElement),g=0,h=0;if(null!=DEXTTOP.G_CURREDITOR.dialogWindow)for(var n=_iframeWin.parent.parent;n!=b;)var m=getClientRect(n.frameElement),g=g+m.left,h=h+m.top,
n=n.parent;this._context_iframe.style.left=c+a[0]+e.left+f.left+g+"px";this._context_iframe.style.top=d+a[1]+e.top+f.top+h+"px";this._reverse=!1;c=parseInt(this._context_iframe.style.left,10)+parseInt(this._width,10);d=parseInt(this._context_iframe.style.top,10)+parseInt(this._height,10);e=getWindowClientSize(b);b=a[0]+e[0]-20;a=a[1]+e[1]-10;c>=b?(e=c-b,e=parseInt(this._context_iframe.style.left,10)-e,c-b<parseInt(this._width,10)/2&&(e-=parseInt(this._width,10)/2),this._context_iframe.style.left=
e+"px","cssFloat"in this._context_document.getElementById("div_main_context").style?this._context_document.getElementById("div_main_context").style.cssFloat="right":this._context_document.getElementById("div_main_context").style.styleFloat="right",this._reverse=!0):"cssFloat"in this._context_document.getElementById("div_main_context").style?this._context_document.getElementById("div_main_context").style.cssFloat="left":this._context_document.getElementById("div_main_context").style.styleFloat="left";
d>=a&&(b=d-a,b=parseInt(this._context_iframe.style.top,10)-b,this._context_iframe.style.top=b+"px");this._makeBackground();this._context_iframe.style.display=""}},hide:function(){this._context_document&&this._context_document.getElementById("div_sub_context")&&(this._context_document.getElementById("div_sub_context").style.display="none");this._context_iframe&&(this._context_iframe.style.display="none");this._context_bg&&(this._context_bg.style.display="none");var a=DEXTTOP.G_CURREDITOR._LastRange?
DEXTTOP.G_CURREDITOR._LastRange:getFirstRange().range;restoreSelection(a,!0)},_makeBackground:function(){var a=this,b=getDialogWindow(),c=getDialogDocument();this._context_bg=c.getElementById(a._context_bg_id);DEXTTOP.G_CURREDITOR.dialogWindow&&this._context_bg&&(this._context_bg.parentNode.removeChild(this._context_bg),this._context_bg=null);this._context_bg&&(this._context_bg.style.display="",this._context_bg.style.overflow="visible");if(!this._context_bg){this._context_bg=c.createElement("div");
this._context_bg.id=this._context_bg_id;this._context_bg.style.overflow="visible";this._context_bg.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0;  -khtml-opacity: 0.0; background-color:#ffffff; z-index:'+this._context_bg_zIndex+'; position:absolute; left:0px; top:0px;overflow:hidden; width:1px; height:1px; "></div>';c.body.appendChild(this._context_bg);var d=function(){return function(b){a.hide()}}();DEXTTOP.DEXT5.util.addEvent(this._context_bg,
"click",d);DEXTTOP.DEXT5.util.addEvent(this._context_bg,"contextmenu",d);DEXTTOP.DEXT5.util.addEvent(b,"resize",DEXTTOP.G_CURREDITOR.context_bg_resize);b="CSS1Compat"==c.compatMode?c.documentElement.scrollHeight:c.body.scrollHeight;this._context_bg.firstChild.style.width=("CSS1Compat"==c.compatMode?c.documentElement.scrollWidth:c.body.scrollWidth)-10+"px";this._context_bg.firstChild.style.height=b-10+"px"}}};function setDoctypeProperty(a,b,c,d){var e=_iframeDoc.getElementsByTagName("head")[0],f=getHeadScriptSrc(e,!0),e=e.outerHTML,g=_iframeDoc.body.outerHTML;setGlobalTableDefaultValue();FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(a+"<html>"+e+g+"</html>");_iframeDoc.close();setHeadScriptSrc(_iframeDoc,f);0<c.length&&(a=_iframeDoc.getElementsByTagName("html")[0],-1<c.indexOf("-")&&(c=c.split("-")[0]),a.setAttribute("lang",
c),a.setAttribute("xml:lang",c),0<d.length&&a.setAttribute("xmlns",d));""==b&&(b="utf-8");try{var h=_iframeDoc.getElementsByTagName("meta")[0];h.setAttribute("http-equiv","Content-Type");h.setAttribute("content","text/html");h.setAttribute("charset",b)}catch(n){}DEXTTOP.G_CURREDITOR._load_editor_frame(!1)}
function createEditorIframe(a,b,c,d,e,f,g,h,n,m,p){var t=document.createElement("iframe");b.appendChild(t);t.id=c;t.title=d;t.frameBorder=0;t.style.width="100%";t.style.height="100%";t.style.borderWidth="0px";if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)t.style.overflow="hidden",t.style.display="inline-block";b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+
"}())":"";t.src=b;b=getIframeDocument(t);""==p?p="1.2":-1<p.indexOf("%")&&(p=1*parseIntOr0(p,10)/100);c="";""==a.document.docTitle.toString()&&(a.document.docTitle=dext5_lang.document.no_title);c=(""==e?"":e+"\n")+("<html><head><title>"+a.document.docTitle+"</title>");""!=a.imageBaseUrl&&(c+='<base href="'+a.imageBaseUrl+'" />');""!=a.ieCompatible&&(c+='<meta http-equiv="X-UA-Compatible" content="IE='+a.ieCompatible+'" />\n');c+="<style type=text/css>";c+=createEditorDefaultStyleInnerHTML(a,n,m,p);
c+="</style>";e="";e=DEXTTOP.DEXT5.isRelease?a.webPath.css:a.webPath.css_dev;c+='<link href="'+e+"editor_contents.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" rel="stylesheet" type="text/css" />';if("1"==DEXTTOP.G_CURREDITOR._config.formMode||"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use)c+='<link href="'+e+"editor_form.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" rel="stylesheet" type="text/css" />';c+="</head>";e="";switch(a.scrollOverflow){case "1":e='style="overflow-x:scroll;"';break;case "2":e='style="overflow-y:scroll;"';
break;case "3":e='style="overflow-x:scroll;overflow-y:scroll;"';break;case "4":e='style="overflow-x:hidden;"';break;case "5":e='style="overflow-y:hidden;"';break;case "6":e='style="overflow-x:hidden;overflow-y:hidden;"'}c="1"==a.setDefaultStyle.value||"2"==a.setDefaultStyle.value?c+('<body id="'+a.setDefaultStyle.body_id+'" '+e+">"):c+("<body "+e+">");c+="<p></p></body></html>";getDocWindow(b);b.open("text/html","replace");isCustomDomain(document)&&(b.domain=document.domain);b.write(c);b.close();
g&&0<g.length&&(e=b.getElementsByTagName("html")[0],-1<g.indexOf("-")&&(g=g.split("-")[0]),e.setAttribute("lang",g),e.setAttribute("xml:lang",g),0<h.length&&e.setAttribute("xmlns",h));""==f&&(f="utf-8");h=b.getElementsByTagName("head")[0];g=b.createElement("meta");g.setAttribute("http-equiv","Content-Type");g.setAttribute("content","text/html");g.setAttribute("charset",f);h.appendChild(g);5<a.userCssUrl.length&&createDynamicCssLinkToHeadTag(b,h,a.userCssUrl);5<a.userJsUrl.length&&createDynamicJsLinkToHeadTag(b,
h,a.userJsUrl);return t}
function setHtmlValueWithDocTypeToEditor(a,b){var c=DEXTTOP.G_CURREDITOR;"1"==c._config.enforceDoctype&&(a=a.replace(/<!doctype *([^>?+])*>/gi,""));var d=getRemoveHeadScript(a);a=d.html;a=addDefaultStyleToEditor(a,c);FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(a);_iframeDoc.close();setHeadScriptSrc(_iframeDoc,d.scriptsAry);setScrollStyleForIOS(DEXTTOP.G_CURREDITOR);showWordCount();DEXTTOP.G_CURREDITOR._load_editor_frame(!1);
"base64"!=c._config.uploadMethod&&base64imageToLocalFile(_iframeDoc);"1"==c._config.horizontalLine.use?c._BODY.style.marginTop="0px":c._BODY.style.margin=""}
function setHtmlValueToEditor(a,b){var c=DEXTTOP.G_CURREDITOR;"1"==c._config.enforceDoctype&&(a=a.replace(/<!doctype *([^>?+])*>/gi,""));var d=c._docType[c._PageProp.doctype],e=_iframeDoc.getElementsByTagName("head")[0];setHeadLinkUrlTimeStamp(e);e=getRemoveHeadScript(a);a=e.html;a=addDefaultStyleToEditor(a,c);FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(d+a);_iframeDoc.close();setHeadScriptSrc(_iframeDoc,
e.scriptsAry);setScrollStyleForIOS(DEXTTOP.G_CURREDITOR);showWordCount();DEXTTOP.DEXT5.util.setBodyBackground(c);if("1"==c._config.horizontalLine.use){var f=c._FRAMEWIN;setTimeout(function(){f.showRuler(c)},0)}DEXTTOP.G_CURREDITOR._load_editor_frame(!1);"1"==c._config.horizontalLine.use?c._BODY.style.marginTop="0px":c._BODY.style.margin="";"base64"!=c._config.uploadMethod&&base64imageToLocalFile(_iframeDoc);"show_blocks"==c.ShowBlocks&&(c.ShowBlocks="",command_showBlocks(a,b))}
function setHeadValueToEditor(a){var b=DEXTTOP.G_CURREDITOR;"1"==b._config.enforceDoctype&&(a=a.replace(/<!doctype *([^>?+])*>/gi,""));var c=b._docType[b._PageProp.doctype],d=b._PageProp.lang,e=b._PageProp.xmlnsname,f=_iframeDoc.getElementsByTagName("body")[0],g;g=f.style.padding;var f=f.style.margin,h=getRemoveHeadScript(a);a=h.html;a=addDefaultStyleToEditor(a,b);FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(c+
"<html>"+a+"</html>");_iframeDoc.close();setHeadScriptSrc(_iframeDoc,h.scriptsAry);setScrollStyleForIOS(DEXTTOP.G_CURREDITOR);showWordCount();0<d.length&&(a=_iframeDoc.getElementsByTagName("html")[0],-1<d.indexOf("-")&&(d=d.split("-")[0]),a.setAttribute("lang",d),a.setAttribute("xml:lang",d),0<e.length&&a.setAttribute("xmlns",e));0<g.length&&(_iframeDoc.body.style.padding=g);0<f.length&&(_iframeDoc.body.style.margin=f);b._load_editor_frame(!1);"1"==b._config.horizontalLine.use?b._BODY.style.marginTop=
"0px":b._BODY.style.margin="";"base64"!=b._config.uploadMethod&&base64imageToLocalFile(_iframeDoc)}
function setBodyValueToEditorEx(a){var b=DEXTTOP.G_CURREDITOR;"1"==b._config.enforceDoctype&&(a=a.replace(/<!doctype *([^>?+])*>/gi,""));var c=b._PageProp.lang,d=b._PageProp.xmlnsname,e=_iframeDoc.getElementsByTagName("head")[0];setHeadLinkUrlTimeStamp(e);var f=getHeadScriptSrc(e,!0),e=e.outerHTML,g=_iframeDoc.getElementsByTagName("body")[0],h;h=g.style.padding;g=g.style.margin;FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");isCustomDomain(document)&&(_iframeDoc.domain=document.domain);
_iframeDoc.write("<html>"+e+a+"</html>");_iframeDoc.close();setHeadScriptSrc(_iframeDoc,f);setScrollStyleForIOS(DEXTTOP.G_CURREDITOR);showWordCount();0<c.length&&(a=_iframeDoc.getElementsByTagName("html")[0],-1<c.indexOf("-")&&(c=c.split("-")[0]),a.setAttribute("lang",c),a.setAttribute("xml:lang",c),0<d.length&&a.setAttribute("xmlns",d));0<h.length&&(_iframeDoc.body.style.padding=h);0<g.length&&(_iframeDoc.body.style.margin=g);-1<e.indexOf("#"+b._config.setDefaultStyle.body_id)&&(_iframeDoc.body.id=
b._config.setDefaultStyle.body_id);b._load_editor_frame(!1);"base64"!=b._config.uploadMethod&&base64imageToLocalFile(_iframeDoc)}
function setBodyValueToEditor(a){var b=DEXTTOP.G_CURREDITOR;"1"==b._config.enforceDoctype&&(a=a.replace(/<!doctype *([^>?+])*>/gi,""));var c=b._docType[b._PageProp.doctype],d=b._PageProp.lang,e=b._PageProp.xmlnsname,f=_iframeDoc.getElementsByTagName("head")[0];setHeadLinkUrlTimeStamp(f);var g=getHeadScriptSrc(f,!0),h=f.outerHTML,n=_iframeDoc.getElementsByTagName("body")[0],m,p,t,q,u,f=n.style.padding;m=n.style.margin;p=n.style.backgroundImage;t=n.style.backgroundColor;q=n.style.backgroundAttachment;
u=n.style.backgroundRepeat;FixFlashError2(_iframeDoc);var n=n.outerHTML,v=n.toLowerCase().indexOf("<body"),w=n.indexOf(">"),y="",y=-1<v&&-1<w?n.substring(v,w+1):"<body>";_iframeDoc.open("text/html","replace");isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(c+"<html>"+h+y+a+"</body></html>");_iframeDoc.close();setHeadScriptSrc(_iframeDoc,g);setScrollStyleForIOS(DEXTTOP.G_CURREDITOR);showWordCount();0<d.length&&(a=_iframeDoc.getElementsByTagName("html")[0],-1<d.indexOf("-")&&
(d=d.split("-")[0]),a.setAttribute("lang",d),a.setAttribute("xml:lang",d),0<e.length&&a.setAttribute("xmlns",e));0<f.length&&(_iframeDoc.body.style.padding=f);0<m.length&&(_iframeDoc.body.style.margin=m);0<p.length&&(_iframeDoc.body.style.backgroundImage=p);0<t.length&&(_iframeDoc.body.style.backgroundColor=t);0<q.length&&(_iframeDoc.body.style.backgroundAttachment=q);0<u.length&&(_iframeDoc.body.style.backgroundRepeat=u);try{b._load_editor_frame(!1)}catch(x){}"base64"!=b._config.uploadMethod&&base64imageToLocalFile(_iframeDoc)}
function setHtmlToPreview(){var a=DEXTTOP.G_CURREDITOR,b;b=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document;var c=a._docType[a._PageProp.doctype],d=a._PageProp.lang,e=a._PageProp.xmlnsname,f=_iframeDoc.getElementsByTagName("head")[0],g=getHeadScriptSrc(f,!1),f=f.outerHTML,f=f.replace(/<script[^>]*src=([\s\S]*?)[\s\S]*?>[\s\S]*?<\/script>/gi,"");setMatchSelectedValue(_iframeDoc.body);setMatchInputValue(_iframeDoc.body);var h="",n="",m="";
_iframeDoc.body.style.transformOrigin&&""!=_iframeDoc.body.style.transformOrigin&&(h=_iframeDoc.body.style.transformOrigin,_iframeDoc.body.style.transformOrigin="");_iframeDoc.body.style.transform&&""!=_iframeDoc.body.style.transform&&(n=_iframeDoc.body.style.transform,_iframeDoc.body.style.transform="");_iframeDoc.body.style.zoom&&""!=_iframeDoc.body.style.zoom&&(m=_iframeDoc.body.style.zoom,_iframeDoc.body.style.zoom="");var p=_iframeDoc.body.outerHTML;""!=h&&(_iframeDoc.body.style.transformOrigin=
h);""!=n&&(_iframeDoc.body.style.transform=n);""!=m&&(_iframeDoc.body.style.zoom=m);changeBodyImageProperty(!0);DEXTTOP.DEXT5.browser.ie&&"1"==a._config.plugInUse&&"1"==a._config.printPreview&&(h='<object id="dext5printpreview" classid="CLSID:2A28D4A1-467B-48C7-AF21-51F6D88456BD" width="0" height="0"><param name="saveFileType" value="">'+('<param name="serverDomain" value="'+a._config.serverDomain+'">'),h+='<param name="toSavePathUrl" value="'+a._config.toSavePathURL+'">',h+='<param name="saveFolderNameRule" value="'+
a._config.saveFolderNameRule+'">',h+='<param name="saveFileNameRule" value="'+a._config.saveFileNameRule+'">',h+='<param name="productKey" value="'+a._config.productKey+'">',h+='<param name="licenseKeyUrl" value="'+a._config.plugin_root+'">',h+='<param name="postPageURL" value="'+a._config.post_url+'">',h+='<param name="accessibility" value="'+a._config.accessibility+'">',h+='<param name="licenseKey" value="'+a._config.LicenseKey+'">',h+='<param name="strPrintMargin" value="'+a._config.printMarginltrb+
'">',h+='<param name="hasContainer" value="'+a._config.hasContainer+'">',h+='<param name="nUsePrintLandscape" value="'+a._config.printLandscape+'">',h+="</object>",p+=h);DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&(p=DEXTTOP.DEXT5.util.htmlRevision(p));a._PageProp.bshowgrid&&1==a._PageProp.bshowgrid&&changeBodyImageProperty(!1);FixFlashError();getDocWindow(b);b.open("text/html","replace");isCustomDomain(document)&&(b.domain=document.domain);b.write(c+"<html>"+f+p+"</html>");b.close();
setHeadScriptSrc(b,g);0<d.length&&(c=b.getElementsByTagName("html")[0],-1<d.indexOf("-")&&(d=d.split("-")[0]),(g=_iframeDoc.getElementsByTagName("html")[0])&&g.getAttribute("lang")&&""!=g.getAttribute("lang")?c.setAttribute("lang",d):c.removeAttribute("lang"),c.setAttribute("xml:lang",d),0<e.length&&c.setAttribute("xmlns",e));replaceClassForBorder(a,b.body,"hidden");replaceClassForBookmark(a,b.body,"hidden");hiddenBlocks(b);if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)try{for(var t=
b.getElementsByTagName("iframe"),q=t.length,e=0;e<q;e++){var u=t[e],v=b.createElement("div");v.style.height=u.height?u.height+"px":u.style.height+"px";v.style.width=u.width?u.width+"px":u.style.width+"px";v.style.overflow="scroll";v.style.overflowX="hidden";v.style.WebkitOverflowScrolling="touch";setWrapperToElement(u,v)}}catch(w){}"spellcheck"in b.body&&(b.body.spellcheck=!1);"contentEditable"in b.body&&(b.body.contentEditable=!1);if(DEXTTOP.DEXT5.browser.ie)try{DEXTTOP.DEXT5.util.addEvent(a._EDITOR.preview.contentWindow,
"unload",function(){FixFlashError()}),DEXTTOP.DEXT5.util.addEvent(_iframeWin,"unload",function(){FixFlashError2(_iframeDoc)})}catch(y){}setAdjustTableBorder(b);DEXTTOP.DEXT5.util.addEvent(b.body,"click",function(a){try{evt=a?a:event,evt.srcElement?elem=evt.srcElement:evt.target&&(elem=evt.target)}catch(b){}if(elem&&("a"!=elem.tagName.toLowerCase()&&(elem=GetParentbyTagName(elem,"a")),elem&&elem.getAttribute("href")&&!(-1<elem.getAttribute("href").indexOf("#")))){var c=elem.getAttribute("target");
elem.setAttribute("target","_blank");setTimeout(function(){c&&""!=c?elem.setAttribute("target",c):elem.removeAttribute("target")},1)}})}function setWrapperToElement(a,b){a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b);b.appendChild(a)}
function changeBodyImageProperty(a){var b=DEXTTOP.G_CURREDITOR;if(a)b._PageProp.bodyimage&&0<b._PageProp.bodyimage.length?_iframeDoc.body.style.backgroundImage=b._PageProp.bodyimage:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-image"):_iframeDoc.body.style.removeAttribute("backgroundImage"),b._PageProp.bodycolor&&0<b._PageProp.bodycolor.length?_iframeDoc.body.style.backgroundColor=b._PageProp.bodycolor:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-color"):
_iframeDoc.body.style.removeAttribute("backgroundColor"),b._PageProp.bodyattachment&&0<b._PageProp.bodyattachment.length?_iframeDoc.body.style.backgroundAttachment=b._PageProp.bodyattachment:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-attachment"):_iframeDoc.body.style.removeAttribute("backgroundAttachment"),b._PageProp.bodyrepeat&&0<b._PageProp.bodyrepeat.length?_iframeDoc.body.style.backgroundRepeat=b._PageProp.bodyrepeat:_iframeDoc.body.style.removeProperty?
_iframeDoc.body.style.removeProperty("background-repeat"):_iframeDoc.body.style.removeAttribute("backgroundRepeat");else if(b._PageProp.gridimage&&0<b._PageProp.gridimage.length&&(_iframeDoc.body.style.backgroundImage=b._PageProp.gridimage),b._PageProp.gridattachment&&0<b._PageProp.gridattachment.length&&(_iframeDoc.body.style.backgroundAttachment=b._PageProp.gridattachment),b._PageProp.gridrepeat&&0<b._PageProp.gridrepeat.length&&(_iframeDoc.body.style.backgroundRepeat=b._PageProp.gridrepeat),"1"==
b._config.horizontalLine.use&&0<b._config.horizontalLine.url.length){a="";for(var c=0;c<b._config.horizontalLine.url.length;c++)0<c&&(a+=","),a+='url("'+b._config.horizontalLine.url[c]+'")';_iframeDoc.body.style.backgroundImage=a;_iframeDoc.body.style.backgroundRepeat="repeat";_iframeDoc.body.style.margin="0px 10px 10px 10px"}}
function changeBodyContenteditable(a){a?DEXTTOP.G_CURREDITOR._config.editorBodyEditable&&(_iframeDoc.body.contentEditable=a):(_iframeDoc.body.removeAttribute("contentEditable"),_iframeDoc.body.style.removeProperty?(_iframeDoc.body.style.removeProperty("margin-left"),_iframeDoc.body.style.removeProperty("margin-top"),_iframeDoc.body.style.removeProperty("margin-right"),_iframeDoc.body.style.removeProperty("margin-bottom"),_iframeDoc.body.style.removeProperty("margin")):(_iframeDoc.body.style.removeAttribute("marginLeft"),
_iframeDoc.body.style.removeAttribute("marginTop"),_iframeDoc.body.style.removeAttribute("marginRight"),_iframeDoc.body.style.removeAttribute("marginBottom"),_iframeDoc.body.style.removeAttribute("margin")))}
function fakeBodyDivForBackground(a,b){a=a.replace(/(\r\n|\n|\r)/gm,"");if(b){var c=a.substr(0,4),d=a.substr(a.length-6,6);"<div"==c.toLowerCase()&&"</div>"==d.toLowerCase()&&(c=c.replace(c,"<body"),d=d.replace(d,"</body>"),a=a.substring(4,a.length-6),a=c+a+d)}else c=a.substr(0,5),d=a.substr(a.length-7,7),"<body"==c.toLowerCase()&&"</body>"==d.toLowerCase()&&(c=c.replace(c,"<div"),d=d.replace(d,"</div>"),a=a.substring(5,a.length-7),a=c+a+d);return a}
function createDynamicCssLinkToHeadTag(a,b,c){try{if(""!=c){var d=a.createElement("link");d.type="text/css";d.rel="stylesheet";d.href=c;b.appendChild(d)}}catch(e){}}function clearDynamicCssLinkToHeadTag(a,b){try{for(var c=a.getElementsByTagName("link"),d=c.length-1;0<d;d--)a.removeChild(c[d]);b&&0<c.length&&a.removeChild(c[0])}catch(e){}}
function addDynamicCssToHeadTag(a,b,c){try{for(var d=b.getElementsByTagName("style"),e=d.length-1;0<e;e--)b.removeChild(d[e]);if(""!=c){var f=a.createElement("style");f.type="text/css";f.styleSheet?(f.styleSheet.cssText=c,""==f.innerHTML&&(f.innerHTML=c)):f.appendChild(a.createTextNode(c));b.appendChild(f)}}catch(g){}}function createDynamicJsLinkToHeadTag(a,b,c){try{if(""!=c){var d=a.createElement("script");d.type="text/javascript";d.src=c;b.appendChild(d)}}catch(e){}}
function clearDynamicJsLinkToHeadTag(a){try{for(var b=a.getElementsByTagName("script"),c=b.length-1;0<=c;c--)a.removeChild(b[c])}catch(d){}}function addDynamicJsToHeadTag(a,b,c){try{for(var d=b.getElementsByTagName("script"),e=d.length-1;0<=e;e--){var f=d[e];f.src&&""!=f.src||b.removeChild(f)}if(""!=c){var g=a.createElement("script");g.type="text/javascript";g.appendChild(a.createTextNode(c));b.appendChild(g)}}catch(h){}}
function getValueWithSetStyleInP(a){if("CCODE_001"==a._config.custom_code)try{var b="",c="";""!=a._setting.font_family&&(c=a._setting.font_family);""!=a._setting.font_size&&(b=a._setting.font_size);if(""!=c||""!=b){var d=a._DOC.body.getElementsByTagName("p"),e=d.length;for(a=0;a<e;a++)""!=c&&""==d[a].style.fontFamily&&(d[a].style.fontFamily=c),""!=b&&""==d[a].style.fontSize&&(d[a].style.fontSize=b)}}catch(f){}}
function addDefaultStyleToEditor(a,b){if("1"==b._config.setDefaultStyle.dext_set_style){var c=["body","p","li"];"0"!=b._config.setDefaultStyle.value&&(c="#"+b._config.setDefaultStyle.body_id,c=[c,c+" p",c+" li"]);var d=[!1,!1,!1],e=c.length,f=a.toLowerCase(),g=f.toLowerCase().indexOf("<style"),h=f.toLowerCase().indexOf("</style>"),n=b._setting.line_height;""==n?n="1.2":-1<n.indexOf("%")&&(n=1*parseIntOr0(n,10)/100);var m="";if(-1<f.toLowerCase().indexOf("<head")&&-1<g&&-1<h){for(var p="",p=f.substring(g,
h),t=p.indexOf(">"),f=p.substring(0,t+1),t=p.substring(t+1),q=t.indexOf("/*"),p=t.indexOf("*/");-1<q&&-1<p;)q=t.substring(0,q),t=t.substring(p+2),t=q+t,q=t.indexOf("/*"),p=t.indexOf("*/");for(var q=t.split("}"),u=q.length,p=0;p<u;p++)if(t=q[p].indexOf("{"),-1<t){for(var v=q[p].substring(0,t),w=0;w<e;w++)if(-1<c[w].indexOf(DEXTTOP.DEXT5.util.trim(v))){d[w]=!0;var y=q[p].substring(t);c[w]==c[0]?(0>y.indexOf("font-family")&&(q[p]=q[p]+"font-family:"+b._setting.font_family+"; "),0>y.indexOf("font-size")&&
(q[p]=q[p]+"font-size:"+b._setting.font_size+"; "),0>y.indexOf("margin")&&(q[p]+="margin:10px; ")):(0>y.indexOf("line-height")&&(q[p]=q[p]+"line-height:"+n+"; "),0>y.indexOf("margin")?(q[p]=q[p]+"margin-top:"+b._config.defaultFontMarginTop+"; ",q[p]=q[p]+"margin-bottom:"+b._config.defaultFontMarginBottom+"; "):-1<y.indexOf("margin-")&&(0>y.indexOf("margin-top")&&(q[p]=q[p]+"margin-top:"+b._config.defaultFontMarginTop+"; "),0>y.indexOf("margin-bottom")&&(q[p]=q[p]+"margin-bottom:"+b._config.defaultFontMarginBottom+
"; ")))}m+=q[p]+"}"}else m+=q[p];e=d.length;for(p=0;p<e;p++)0==d[p]&&(m=c[p]==c[0]?m+(c[p]+" { font-size:"+b._setting.font_size+"; font-family:"+b._setting.font_family+"; margin:10px; cursor:text; }"):m+(c[p]+" { line-height:"+n+"; margin-top:"+b._config.defaultFontMarginTop+"; margin-bottom:"+b._config.defaultFontMarginBottom+"; }"));m=f+m;a=a.substring(0,g)+m.toLowerCase()+a.substring(h,a.length)}else-1<f.toLowerCase().indexOf("<head")&&0>g&&(t=f.toLowerCase().indexOf("</head"),0<t&&(m=m+"<style type=text/css>"+
("body { cursor:text; margin:10px; font-family:"+b._setting.font_family+"; font-size:"+b._setting.font_size+"; }"),m+="p { line-height:"+n+"; margin-top:"+b._config.defaultFontMarginTop+"; margin-bottom:"+b._config.defaultFontMarginBottom+"; }",m+="li { line-height:"+n+"; margin-top:"+b._config.defaultFontMarginTop+"; margin-bottom:"+b._config.defaultFontMarginBottom+"; }",m+="</style>",a=a.substring(0,t)+m+a.substring(t,a.length)))}return a}
function base64imageToLocalFile(a){if(G_dext5plugIn){a=a.body.getElementsByTagName("img");for(var b=a.length,c=0;c<b;c++){var d=a[c];if(!d.getAttribute("raon_chart"))try{var e=d.src;if("data:"==e.substring(0,5)){var f=e.split(",");if(2==f.length){var g=getExtFromImageDataSrc(f[0]);try{var h=G_dext5plugIn.getLocalImageFromBase64Image(f[1],g);0<h.length&&(d.src=h)}catch(n){}}}}catch(m){}}}}
function setStyleForTableBorderNodeClass(a){try{if(0==checkIfIncluded("editor_contents.css")){var b="",b=DEXTTOP.DEXT5.isRelease?a._config.webPath.css:a._config.webPath.css_dev;DEXTTOP.DEXT5.addUserCssUrl(b+"editor_contents.css?ver="+DEXTTOP.DEXT5.ReleaseVer,a.ID)}}catch(c){}}
function setCssForFormMode(a){try{if(("1"==a._config.formMode||"1"==a._config.userTableLock.use)&&0==checkIfIncluded("editor_form.css")){var b="",b=DEXTTOP.DEXT5.isRelease?a._config.webPath.css:a._config.webPath.css_dev;DEXTTOP.DEXT5.addUserCssUrl(b+"editor_form.css?ver="+DEXTTOP.DEXT5.ReleaseVer,a.ID)}}catch(c){}}
function setHeadLinkUrlTimeStamp(a){a=a.childNodes;for(var b=a.length,c=0;c<b;c++){var d=a[c];if(d&&d.tagName&&"link"==d.tagName.toLowerCase()&&!(-1<d.href.indexOf("editor_contents.css")||-1<d.href.indexOf("editor_form.css"))){var e="";try{d.outerHTML.match(RegExp("(hrefs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),e=RegExp.$2}catch(f){e=d.href}d=e.split("?");if(1<d.length){for(var e=d[1].split("&"),g=e.length,h=0;h<g;h++)-1<e[h].indexOf("t=")&&(e[h]="t="+(new Date).getTime());a[c].href=d[0]+"?"+e.join("&")}else a[c].href=
d[0]+"?t="+(new Date).getTime()}}}
function getHeadScriptSrc(a,b){for(var c=a.getElementsByTagName("script"),d=[],e=c.length;0<e;e--){var f=c[e-1];if(f.src&&""!=f.src){var g="";try{f.outerHTML.match(RegExp("(srcs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),g=RegExp.$2}catch(h){g=f.src}g=g.split("?");if(1<g.length){for(var n=g[1].split("&"),m=n.length,p=0;p<m;p++)-1<n[p].indexOf("t=")&&(n[p]="t="+(new Date).getTime());g=g[0]+"?"+n.join("&")}else g=g[0]+"?t="+(new Date).getTime();d.push(g);b&&a.removeChild(f)}}return d}
function setHeadScriptSrc(a,b){var c=a.getElementsByTagName("head")[0];if(c)for(var d=0,e=b.length;d<e;d++)createDynamicJsLinkToHeadTag(a,c,b[d])}
function getRemoveHeadScript(a){var b={html:a,scriptsAry:[]},c=a.toLowerCase().indexOf("<head"),d=a.toLowerCase().indexOf("</head>"),e=a.substring(0,c),c=a.substring(c,d+7);a=a.substring(d+7,a.length);var d=RegExp("<script[^>]*src=([\\s\\S]*?)>[\\s\\S]*?\x3c/script>","gi"),f=c.match(d);if(f){for(var g=f.length,h=0;g>h;h++)d=RegExp('<script[^>]*src="([\\s\\SS]*?)"([\\s\\S]*?)>[sS]*?\x3c/script>',"gi"),d.test(f[h]),b.scriptsAry.push(RegExp.$1);d=RegExp("<script[^>]*src=([\\s\\S]*?)>[\\s\\S]*?\x3c/script>",
"gi");c=c.replace(d,"");b.html=e+c+a}return b}
function addStyleTag(a,b){try{for(var c=!1,d=b._DOC.getElementsByTagName("head")[0],e=d.getElementsByTagName("style"),f=e.length,g=0;g<f;g++)if("mobile_style"==e[g].getAttribute("dext")){c=!0;break}if(!c){var h=a.cssText,n=b._DOC.createElement("style");n.type="text/css";for(var m in a.attrObj)a.attrObj[m]&&n.setAttribute(m,a.attrObj[m]);n.styleSheet?(n.styleSheet.cssText=h,""==n.innerHTML&&(n.innerHTML=h)):n.appendChild(b._DOC.createTextNode(h));d.appendChild(n)}}catch(p){}}
function setScrollStyleForIOS(a){DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&addStyleTag({cssText:"html,body{ -webkit-overflow-scrolling : touch !important; overflow: auto !important; height: 100% !important; }",attrObj:{dext:"mobile_style"}},a)}
function removeScrollStyleForIOS(a){if(DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS){a=a._DOC.getElementsByTagName("head")[0];for(var b=a.getElementsByTagName("style"),c=b.length-1;0<=c;c--)"mobile_style"==b[c].getAttribute("dext")&&a.removeChild(b[c])}}
function setEmptyTagWhiteSpace(a){if("0"==a._config.removeEmptyTag){a=a._DOC.body.getElementsByTagName("p");for(var b=a.length,c=0;c<b;c++){var d=0,e=a[c].getElementsByTagName("br"),d=d+e.length;0==d&&(e=a[c].getElementsByTagName("input"),d+=e.length);0==d&&(e=a[c].getElementsByTagName("textarea"),d+=e.length);0==d&&(e=a[c].getElementsByTagName("img"),d+=e.length);0<d||""!=(void 0!=a[c].innerText?a[c].innerText:a[c].textContent).replace(unescape("%u200B"),"")||(d=document.createTextNode("\u00a0"),
a[c].appendChild(d))}}}
function createEditorDefaultStyleInnerHTML(a,b,c,d){var e="";void 0==b&&(b=DEXTTOP.G_CURREDITOR._setting.font_family);void 0==c&&(c=DEXTTOP.G_CURREDITOR._setting.font_size);void 0==d&&(d=DEXTTOP.G_CURREDITOR._setting.line_height);var f="";"1"==a.defaultImemode&&(f="-ms-image-mode: active; ime-mode: active;");var g="";"1"==a.autoBodyFit&&(g="word-wrap:break-word;");var h="10px;";"1"==a.horizontalLine.use&&(h="0px 10px 10px 10px;");"1"==a.setDefaultStyle.value||"2"==a.setDefaultStyle.value?(e+="#"+
a.setDefaultStyle.body_id+" { cursor:text; margin:"+h+" font-family:"+changeFontFamily(b)+"; font-size:"+c+";"+f+g+" }",e+="#"+a.setDefaultStyle.body_id+" p { line-height:"+d+"; margin-top:"+a.defaultFontMarginTop+"; margin-bottom:"+a.defaultFontMarginBottom+"; }",e+="#"+a.setDefaultStyle.body_id+" li { line-height:"+d+"; margin-top:"+a.defaultFontMarginTop+"; margin-bottom:"+a.defaultFontMarginBottom+"; }",e+="#"+a.setDefaultStyle.body_id+" .raon_placeholder { display: inline-block; }",e+="#"+a.setDefaultStyle.body_id+
" .raon_placeholder:empty:before { content: attr(placeholder); color: #EE0000; }",e+="#"+a.setDefaultStyle.body_id+" .raon_placeholder:focus:before { content: none; }"):(e+="body { cursor:text; margin:"+h+" font-family:"+changeFontFamily(b)+"; font-size:"+c+";"+f+g+" }",e+="p { line-height:"+d+"; margin-top:"+a.defaultFontMarginTop+"; margin-bottom:"+a.defaultFontMarginBottom+"; }",e+="li { line-height:"+d+"; margin-top:"+a.defaultFontMarginTop+"; margin-bottom:"+a.defaultFontMarginBottom+"; }",e+=
".raon_placeholder { display: inline-block; }.raon_placeholder:empty:before { content: attr(placeholder); color: #EE0000; }",e+=".raon_placeholder:focus:before { content: none; }");return e}
function defaultStyleSameCheck(a,b){var c=!1;"1"==b._config.setDefaultStyle.value||"2"==b._config.setDefaultStyle.value?-1<a.indexOf("#"+b._config.setDefaultStyle.body_id)&&(c=!0):0>a.indexOf("#"+b._config.setDefaultStyle.body_id)&&-1<a.indexOf("body {")&&-1<a.indexOf("p {")&&-1<a.indexOf("li {")&&(c=!0);return c}function getDefaultStyleTag(a,b){for(var c=null,d=a.getElementsByTagName("style"),e=d.length,f=0;f<e;f++)if(defaultStyleSameCheck(d[f].innerHTML,b)){c=d[f];break}return c};var g_findRepalceRange=null;
function command_find(a,b,c,d,e,f,g,h){dext_src_init(b);restoreSelection();setFocusToBody();if(0==c.length)return!1;try{a=null;if(null==g_findRepalceRange){var n=getFirstRange().range;a=rangy.createRange(_iframeDoc);a.selectNodeContents(_iframeDoc.body);f?a.setStart(n.startContainer,n.startOffset):a.setEnd(n.startContainer,n.startOffset)}else a=g_findRepalceRange;d={caseSensitive:d,wholeWordsOnly:e,direction:f?"forward":"backward"};var m=a.findText(c,d);if(m)a.select(),f?a.collapse(!1):a.collapse(!0),
setAutoScrollToRange(a),g_findRepalceRange=a;else if(g)if(a=f?moveCursorToTag(_iframeDoc.body,!0):moveCursorToTag(_iframeDoc.body,!1),m=a.findText(c,d))a.select(),f?a.collapse(!1):a.collapse(!0),setAutoScrollToRange(a),g_findRepalceRange=a;else return 0!=h&&alert(dext5_lang.find.msg.no_find),!1;else return 0!=h&&alert(dext5_lang.find.msg.no_find),!1}catch(p){}}
function command_replace(a,b,c,d,e,f,g,h,n){dext_src_init(b);restoreSelection();setFocusToBody();if(0!=c.length)try{var m=null;if(null==g_findRepalceRange){var p=getFirstRange().range,m=rangy.createRange(_iframeDoc);m.selectNodeContents(_iframeDoc.body);m.setStart(p.startContainer,p.startOffset)}else m=g_findRepalceRange;var t={caseSensitive:e,wholeWordsOnly:f,direction:g?"forward":"backward"},q=!1,u=(p=getFirstRange().range)&&p.toString();!e&&p&&(c=c.toLowerCase(),u=u.toLowerCase());if(u==c)if(p.collapse(g),
m.setStart(p.startContainer,p.startOffset),q=m.findText(c,t)){m.select();m.deleteContents();var v=m.getDocument().createTextNode(d);m.insertNode(v);m.selectNode(v);m.select();g?m.collapse(!1):m.collapse(!0);n||command_find(a,b,c,e,f,g,h)}else g_findRepalceRange&&h&&(m=g?moveCursorToTag(_iframeDoc.body,!0):moveCursorToTag(_iframeDoc.body,!1),q=m.findText(c,t))&&(m.select(),m.deleteContents(),v=m.getDocument().createTextNode(d),m.insertNode(v),m.selectNode(v),m.select(),g?m.collapse(!1):m.collapse(!0),
command_find(a,b,c,e,f,g,h));else command_find(a,b,c,e,f,g,h)}catch(w){}}
function command_replaceAll(a,b,c,d,e,f,g,h,n){dext_src_init(b);restoreSelection();setFocusToBody();if(0!=c.length)try{g_findRepalceRange=null;range=rangy.createRange(_iframeDoc);range.selectNodeContents(_iframeDoc.body);a={caseSensitive:e,wholeWordsOnly:f,direction:g?"forward":"backward"};for(b=0;range.findText(c,a);){range.select();range.deleteContents();var m=range.getDocument().createTextNode(d);range.insertNode(m);range.selectNode(m);range.select();b+=1;g?range.collapse(!1):range.collapse(!0)}0<
b&&!n&&alert(b+dext5_lang.replace.replaceall_result)}catch(p){}}
function command_changeWordUpperLower(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();a=getFirstRange().range;try{if(a||(a=rangy.createRange(_iframeDoc),a.selectNodeContents(_iframeDoc.body)),a){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=getSelectionTextNodes(a),e=a.startContainer;e.firstNode&&(e=e.firstNode);var f=a.startOffset,g=a.endContainer;g.lasttNode&&(g=g.lasttNode);var h=a.endOffset,n=d.length;for(a=0;a<n;a++){var m=d[a];if(3==
m.nodeType){var p=m.nodeValue,t,q,u;t=q=u="";m==e&&m==g?(q=p.substring(0,f),t=p.substring(f,h),u=p.substring(h,p.length)):m==e&&0<f?(q=p.substring(0,f),t=p.substring(f,p.length)):m==g&&h<p.length?(t=p.substring(0,h),q=p.substring(h,p.length)):t=p;if("UPPER"==c)t=t.toUpperCase();else if("LOWER"==c)t=t.toLowerCase();else if("FIRSTUPPER"==c)t=t.replace(/\b([a-z])/g,function(a){return a.toUpperCase()});else return;p=m==e&&m==g?q+t+u:m==e&&0<f?q+t:t+q;m.nodeValue=p}}rangy.getSelection(_iframeWin).removeAllRanges();
moveCursorToTag(_iframeDoc.body,!0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}catch(v){}}function moveCursorToTag(a,b){if(null!=a&&void 0!=a){var c=rangy.createRange(_iframeDoc);c.selectNodeContents(a);try{b?c.collapse(!0):c.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(c)}catch(d){}return c}}function getNextNode(a){if(a.firstChild)return a.firstChild;for(;a;){if(a.nextSibling)return a.nextSibling;a=a.parentNode}}
function getNodesInRange(a){var b=a.startContainer,c=a.endContainer;a=a.commonAncestorContainer;var d=[],e;for(e=b.parentNode;e&&(d.push(e),e!=a);e=e.parentNode);d.reverse();for(e=b;e&&(d.push(e),e!=c);e=getNextNode(e));return d}
function getAllNodesInBody(a,b){var c=[];if(b){var d=a.getElementsByTagName("*");if(d)for(var e=d.length,f=0;f<e;f++){var g=d[f];g.tagName.toLowerCase();1==g.nodeType&&c.push(g)}}else for(g=a.childNodes[0];null!=g;)if(1==g.nodeType&&c.push(g),g.hasChildNodes())g=g.firstChild;else{for(;null==g.nextSibling&&g!=a;)g=g.parentNode;g=g.nextSibling}return c}function setAutoScrollToRange(a){try{var b=a.startContainer.parentNode;if(b){var c=getElementOffset(b);_iframeWin.scroll(c.left,c.top)}}catch(d){}}
function getNextSiblings(a,b){for(;a=a.nextSibling;)1!=a.nodeType&&3!=a.nodeType||b.push(a)}function firstElementChild(a){var b=a.firstElementChild;if(!b)for(b=a.firstChild;b&&1!==b.nodeType;)b=b.nextSibling;return b}
function getTextNodesBetween(a){function b(a){var t=a.nodeValue;a==d&&a==e&&a!==c?(t&&m.push(t.substring(f,g)),h=n=!0):a==d?(t&&m.push(t.substring(f)),h=!0):a==e?(t&&m.push(t.substring(0,g)),n=!0):3==a.nodeType&&t&&h&&!n&&!/^\s*$/.test(t)&&m.push(t);for(var t=0,q=a.childNodes.length;!n&&t<q;++t)b(a.childNodes[t])}var c=a.commonAncestorContainer,d=a.startContainer,e=a.endContainer,f=a.startOffset,g=a.endOffset,h=!1,n=!1,m=[];b(c);return m}
function getSelectionTextNodes(a){function b(a){var m=a.nodeValue;a==d&&a==e&&a!==c?(m&&h.push(a),f=g=!0):a==d?(m&&h.push(a),f=!0):a==e?(m&&h.push(a),g=!0):3==a.nodeType&&m&&f&&!g&&!/^\s*$/.test(m)&&h.push(a);for(var m=0,p=a.childNodes.length;!g&&m<p;++m)b(a.childNodes[m])}var c=a.commonAncestorContainer,d=a.startContainer,e=a.endContainer,f=!1,g=!1,h=[];b(c);return h};var _iframeDoc,_iframeWin,G_CURSOR_BEFORE_INTABLE=!1,G_BEFORE_INTABLE=null,G_FIRST_CLICK_EVENT=!0,G_ImagesBase64Data=[],G_IMG_TOTAL_SIZE=-1,G_IMG_TOTAL_LIST={},G_IMG_CURRENT_LIST={},G_IMG_CURRENT_ARRAYLIST=[],G_IMG_TOTAL_COUNT=0,G_KEY_IMG_COUNT=-1,G_KeyDownUpSync=!1;
function saveSelection(a,b){if(0!=DEXTTOP.DEXT5.browser.ie||0!=!!b){var c=document.getElementById("dext5_design_"+a);dext_src_init(c);var c=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,d;try{c&&(c.createRange?d=c.createRange():c.getRangeAt?d=c.getRangeAt(0):c.anchorNode&&c.focusNode&&doc.createRange&&(d=_iframeDoc.createRange(),d.setStart(c.anchorNode,c.anchorOffset),d.setEnd(c.focusNode,c.focusOffset),d.collapsed!==c.isCollapsed&&(d.setStart(c.focusNode,c.focusOffset),d.setEnd(c.anchorNode,
c.anchorOffset))))}catch(e){}return d}}function restoreSelection(a,b){if(0!=DEXTTOP.DEXT5.browser.ie||0!=!!b)try{_iframeDoc.body.focus();var c=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,d=getEditrFromEvent(null);if(null==a||void 0==a)a=d._LastRange;c&&a&&(a.select?a.select():c.removeAllRanges&&c.addRange&&(c.removeAllRanges(),c.addRange(a)),d._LastRange=null)}catch(e){}}
function createBookmark(){var a=document.getElementById("dext5_design_"+G_USE_EDITOR_ID);dext_src_init(a);var a=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,b;try{a&&(a.createRange?b=a.createRange():a.getRangeAt?b=a.getRangeAt(0):a.anchorNode&&a.focusNode&&doc.createRange&&(b=_iframeDoc.createRange(),b.setStart(a.anchorNode,a.anchorOffset),b.setEnd(a.focusNode,a.focusOffset),b.collapsed!==a.isCollapsed&&(b.setStart(a.focusNode,a.focusOffset),b.setEnd(a.anchorNode,a.anchorOffset))))}catch(c){}return b}
function goToBookmark(a){if(0!=DEXTTOP.DEXT5.browser.ie)try{_iframeDoc.body.focus();var b=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection;b&&a&&(a.select?a.select():b.removeAllRanges&&b.addRange&&(b.removeAllRanges(),b.addRange(a)))}catch(c){}}function RemoveUnnecessaryChar(a){a=ReplaceAll(a,unescape("%uFEFF"),"");return a=ReplaceAll(a,unescape("%u200b"),"")}
function CleanZeroChar(a){if("0"==DEXTTOP.G_CURREDITOR._config.removeEmptyTag)return a;var b="span b strong i em strike u sup sub font".split(" "),c=new RegExp("(<span[^>]*?raon_placeholder.*?>)(?:\\s|<br>|<br />|  | |)</span>","gim");a=a.replace(c,"$1"+unescape("%u200B")+"</span>");for(var c=b.length,d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"font","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"b","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],
"");a=setCleanTagOrValue(a,"strong","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"i","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"em","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"strike","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"u","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,"sup","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");a=setCleanTagOrValue(a,
"sub","");for(d=0;d<c;d++)a=setCleanTagOrValue(a,b[d],"");b="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>";c=new RegExp(b,"gim");return a=a.replace(c,"$1</span>")}function replaceEmptySpanTag(a){return a=a.replace(RegExp("(<span[^>]*?>)(?:| |)</span>","gim"),"$1"+unescape("%u200B")+"</span>")}
function setCleanTagOrValue(a,b,c){for(;;){var d,e;"span"==b?(d="<"+b+"></"+b+">",e="<"+b+" [^>]*></"+b+">"):(d="<"+b+">(?:\\s|<br>|<br />|  | |)</"+b+">",e="<"+b+" [^>]*>(?:\\s|<br>|<br />|  | |)</"+b+">");d=new RegExp(d,"gim");a=a.replace(d,c);e=new RegExp(e,"gim");a=a.replace(e,c);if(0==d.test(a)&&0==e.test(a))break}return a}
function getApplyDragResize(a){var b=!1;if("1"==a._config.dragResize&&!DEXTTOP.DEXT5.browser.mobile)if(0<a._config.dragResizeApplyBrowser.length)for(var c=a._config.dragResizeApplyBrowser.length,d=0,e;d<c;d++)switch(e=a._config.dragResizeApplyBrowser[d].toLowerCase(),e){case "ie":DEXTTOP.DEXT5.browser.ie&&7<=DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion&&(b=!0);break;case "edge":DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion&&(b=!0);break;case "firefox":DEXTTOP.DEXT5.browser.gecko&&
(b=!0);break;case "chrome":DEXTTOP.DEXT5.browser.chrome&&(b=!0);break;case "opera":DEXTTOP.DEXT5.browser.opera&&(b=!0);break;case "safari":DEXTTOP.DEXT5.browser.safari&&(b=!0)}else b=!0;a._config.useMouseTableInoutdent&&!DEXTTOP.DEXT5.browser.mobile&&(b=!0);return b}
function dext_src_init_once(a,b){rangy.init();_iframeWin=rangy.dom.getIframeWindow(a);_iframeDoc=rangy.dom.getIframeDocument(a);createTableResizeBar(_iframeDoc);if(getApplyDragResize(b))try{b.dext_dragresize&&b.dext_dragresize.remove(_iframeDoc),b.dext_dragresize=new DextDragResize,b.dext_dragresize.apply(_iframeDoc)}catch(c){}DEXTTOP.DEXT5.util.addEvent(document,"keyup",_dextiframe_Keyup,!1);DEXTTOP.DEXT5.util.addEvent(document,"keydown",_dextiframe_Keydown,!1);DEXTTOP.DEXT5.util.addEvent(window,
"unload",_dextiframe_Unload);DEXTTOP.DEXT5.util.addEvent(window,"beforeunload",_dextiframe_BeforeUnload);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mousedown",_iframeDoc_MouseDown,!0);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseup",_iframeDoc_MouseUp,!0);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseup",_iframeDoc_MouseUpMenu);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mousemove",_iframeDoc_MouseMove,!0);"1"!=b._config.contextMenuDisable&&DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"contextmenu",_iframeDoc_ContextMenu);
DEXTTOP.DEXT5.util.addEvent(document,"contextmenu",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"dblclick",_iframeDoc_DBClick);DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"click",_iframeBody_Click);DEXTTOP.DEXT5.util.addEvent(_iframeDoc.documentElement,"click",_iframeBody_Click);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keyup",_iframeDoc_Keyup);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keydown",_iframeDoc_Keydown);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keypress",
_iframeDoc_Keypress);if(DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"paste",_iframeDoc_Paste),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"beforepaste",_iframeDoc_BeforePaste);DEXTTOP.DEXT5.util.addEvent(document,"dragover",_iframeDoc_OnDropOver);"1"==b._config.dragAndDropAllow&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)||DEXTTOP.DEXT5.util.addEvent(_iframeWin,
"dragover",_iframeDoc_OnDropOver);DEXTTOP.DEXT5.util.addEvent(_iframeWin,"scroll",_iframeDoc_Scroll);DEXTTOP.DEXT5.browser.ie?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"beforedeactivate",_iframeDoc_BlurHandler),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"focus",_iframeDoc_FocusHandler)):(DEXTTOP.DEXT5.util.addEvent(_iframeWin,"blur",_iframeDoc_BlurHandler),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"blur",_iframeDoc_BlurHandler),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"focus",_iframeDoc_FocusHandler));
"0"==b._config.dragAndDropAllow||"view"==b._config.mode?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1}),DEXTTOP.DEXT5.util.addEvent(document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1})):(DEXTTOP.DEXT5.browser.gecko?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",insertDropImage),DEXTTOP.DEXT5.util.addEvent(document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1})):(DEXTTOP.DEXT5.browser.ie&&9<DEXTTOP.DEXT5.browser.ieVersion||
0==DEXTTOP.DEXT5.browser.ie)&&"ieplugin"!=b._config.runtimes&&(DEXTTOP.DEXT5.util.addEvent(document,"drop",insertDropImage),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",insertDropImage)),"ieplugin"==b._config.runtimes&&(DEXTTOP.DEXT5.util.addEvent(document,"drop",dropMousePosition),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",dropMousePosition)));if(("1"==b._config.view_mode_auto_height||"1"==b._config.view_mode_auto_width)&&"view"==b._config.mode){var d=function(a){return function(b){DEXTTOP.G_CURREDITOR=
a;set_view_mode_auto_height(a)}}(b),e=document.getElementById("dext5_design_"+b.ID);DEXTTOP.DEXT5.util.addEvent(e,"load",d)}DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&(DEXTTOP.DEXT5.util.addEvent(DEXTTOP.document.body,"touchend",parentTouchEndEvent),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"touchmove",touchMoveEvent),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"touchend",touchEndEvent));try{_iframeDoc.execCommand("MultipleSelection",null,!0)}catch(f){}if("0"==DEXTTOP.G_CURREDITOR._config.autoUrlDetect)try{_iframeDoc.execCommand("AutoUrlDetect",
!1,!1)}catch(g){}if(DEXTTOP.DEXT5.browser.gecko)try{_iframeDoc.execCommand("enableInlineTableEditing",!1,!1)}catch(h){}if(!isViewMode(b)){if("1"==b._config.defaultImemode&&(8>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks))try{var n=_iframeDoc.createElement("input");n.style.width="100px";n.style.height="30px";n.type="text";n.style.display="none";n.style.imeMode="active";_iframeDoc.body.appendChild(n);n.focus();_iframeWin.focus();_iframeDoc.body.removeChild(n)}catch(m){}""!=b._config.tabIndexObjId?
0==DEXTTOP.DEXT5.browser.ie&&setTimeout(setBodyDefaultValue,0):((!DEXTTOP.DEXT5.browser.ie||b._config.initFocus&&DEXTTOP.DEXT5.browser.ie)&&setTimeout(setBodyDefaultValue,0),setTimeout(setFocusToBody,0));setTimeout(function(){try{DEXTTOP.DEXT5.browser.ie?DEXTTOP.DEXT5.util.addEvent(document.body,"focus",_dextiframe_Focus):DEXTTOP.DEXT5.util.addEvent(window,"focus",_dextiframe_Focus)}catch(a){}},1E3)}}
function _dextiframe_Focus(a){if(DEXTTOP.DEXT5.browser.ie)try{var b=getEditrFromEvent(a),c=b._dextframeHasFocus;"1"==b._config.tabSequenceMode&&(c=!0);if(0==c&&(setFocusToBody(),DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)){var d=document.getElementsByTagName("A");0<d.length&&(d[0].className="")}b._dextframeHasFocus=!0}catch(e){}else setTimeout(function(){try{var b=getEditrFromEvent(a),c=b._dextframeHasFocus;"1"==b._config.tabSequenceMode&&
(c=!0);if(0==c&&(setFocusToBody(),DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)){var d=document.getElementsByTagName("A");0<d.length&&(d[0].className="")}b._dextframeHasFocus=!0}catch(e){}},0)}
function _iframeDoc_BeforePaste(a){setDEXTWINDOC();var b=getEditrFromEvent(a);if(isViewMode(b))DEXTTOP.DEXT5.util.cancelEvent(a);else if(a=a.target?a.target:a.srcElement,a=a.tagName?a.tagName.toLowerCase():null,!DEXTTOP.DEXT5.browser.ie||"textarea"!=a.toLowerCase()&&"input"!=a.toLowerCase())G_dext5plugIn||DEXTTOP.DEXT5.browser.ie&&"paste"!=G_LAST_CMD&&1==DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion&&setPasteBin()}
function setPasteBin(){try{if(DEXTTOP.DEXT5.browser.ie){DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID);var a=document.createElement("div");a.id="pasteDiv";var b=DEXTTOP.DEXT5.UserAgent;if("10"!=b.os.version||"IE"!=b.browser.name)a.innerHTML=unescape("%uFEFF");a.style.position="absolute";a.style.filter="alpha(opacity=0)";a.style.overflow="hidden";DEXTTOP.DEXT5.browser.gecko?(a.style.left="0px",a.style.top="0px"):(a.style.left="-1000px",a.style.top="-1000px");DEXTTOP.DEXT5.browser.ie&&
9>=DEXTTOP.DEXT5.browser.ieVersion?(a.style.width="999px",a.style.height="999px"):(a.style.width="0px",a.style.height="0px");a.contentEditable=!0;a.onpaste=fn_PasteIE;document.body.appendChild(a);0==DEXTTOP.G_CURREDITOR.initPaste?document.body.focus():DEXTTOP.G_CURREDITOR.initPaste=!1;a.focus();return!0}}catch(c){return!0}}
function setPasteBinForGecko(){if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion){DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID);var a=document.createElement("iframe");a.id="pasteIframe";a.frameBorder=0;a.style.width="0px";a.style.height="0px";a.style.position="absolute";a.style.left="0px";a.style.top="0px";if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)a.style.overflow="hidden",a.style.display="inline-block";var b="document.open();"+
(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";a.src=b;document.body.appendChild(a);a=getIframeDocument(a);a.open("text/html","replace");isCustomDomain(document)&&(a.domain=document.domain);a.write('<body contenteditable="true">'+unescape("%uFEFF")+"</body>");a.close();a.body.contentEditable=!0;a.body.onpaste=fn_PasteIE;a.body.focus()}}
function _iframeDoc_Paste(a){setDEXTWINDOC();var b=getEditrFromEvent(a);if(isViewMode(b))DEXTTOP.DEXT5.util.cancelEvent(a);else{if(DEXTTOP.DEXT5.browser.ie)return!0;b=a.target?a.target:a.srcElement;b=b.tagName?b.tagName.toLowerCase():null;if("textarea"!=b.toLowerCase()&&"input"!=b.toLowerCase()){if(null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)){var c=setInterval(function(){clearInterval(c);
for(var a=!1,b=DEXTTOP.G_CURREDITOR._DOC.getElementsByTagName("img"),d=b.length,e=0;e<d;e++)-1<b[e].src.indexOf("webkit-fake-url")&&(a=!0,b[e].parentNode.removeChild(b[e]));a&&alert(dext5_lang.msg.pasteFakeUrl)},10);return!0}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var b=!1,d="",e=!1;if(a&&a.clipboardData&&a.clipboardData.getData){/Files|files/.test(a.clipboardData.types)&&(e=!0);if(/Files|files/.test(a.clipboardData.types)&&a.clipboardData.getData("text/html")&&
-1<a.clipboardData.getData("text/html").indexOf(">\x3c!--p."))b=!1;else if(/text\/html/.test(a.clipboardData.types))d=a.clipboardData.getData("text/html"),b=!0;else if(/text\/plain/.test(a.clipboardData.types)){var d=a.clipboardData.getData("text/plain"),b=!0,f="",g=changeTextForAutoUrl(d,DEXTTOP.G_CURREDITOR);""!=g.changedData&&(f=d,d=g.changedData);var h=function(a){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/ /g,"&nbsp;");return a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,
a)},d=h(d);if(""!=g.changedData){g.changedData=d;try{d=rollBackTextForAutoUrl(g)}catch(n){d=h(f)}}}(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)&&b&&""==d&&/Files|files/.test(a.clipboardData.types)&&(b=!1)}DEXTTOP.G_CURREDITOR.pasteEvt=a;DEXTTOP.G_CURREDITOR.clipData=d;DEXTTOP.G_CURREDITOR.bTextorHtmlData=b;DEXTTOP.G_CURREDITOR.clipImageBlob=null;if("1"==DEXTTOP.G_CURREDITOR._config.pasteToImage||"2"==DEXTTOP.G_CURREDITOR._config.pasteToImage){try{testCanvas=document.createElement("canvas");
if("undefined"!=typeof testCanvas.toBlob&&1==e){for(var m=a.clipboardData.items.length,b=0;b<m;b++)if(/image\//.test(a.clipboardData.items[b].type)){DEXTTOP.G_CURREDITOR.clipImageBlob=a.clipboardData.items[b].getAsFile();break}if(DEXTTOP.G_CURREDITOR.clipImageBlob){DEXTTOP.DEXT5.util.cancelEvent(a);DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"pastetoimage");return}}command_pasteHtml5(DEXTTOP.G_CURREDITOR)}catch(p){command_pasteHtml5(DEXTTOP.G_CURREDITOR)}testCanvas=void 0}else command_pasteHtml5(DEXTTOP.G_CURREDITOR)}}}
function _iframeDoc_Keypress(a){setDEXTWINDOC();var b="which"in a?a.which:a.keyCode;try{var c=getEditrFromEvent(a),d=c._config,e=a.target?a.target:a.srcElement,f=e.tagName?e.tagName.toLowerCase():null;if(!DEXTTOP.DEXT5.browser.ie||"textarea"!=f.toLowerCase()&&"input"!=f.toLowerCase()){if("1"!=d.formMode&&"1"==d.userTableLock.use){var g=getFirstRange().range.startContainer;3==g.nodeType&&(g=g.parentNode);var h=GetTDTHCell(g),n;h&&(n=GetParentbyTagName(g,"table"));var f=!0,m=d.userTableLock.defaultTableLockMode;
n&&n.getAttribute("lock_mode")&&""!=n.getAttribute("lock_mode")&&(m=n.getAttribute("lock_mode"));"1"==m&&(f=!1);if(h){if(f&&checkLockAttr(n)){if(c.lastElemForLock)setFocusForLock(c.lastElemForLock);else{var p=findNoLockElem(n);p?setFocusForLock(p):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(event);DEXTTOP.DEXT5.util.cancelEvent(event);return}if(checkLockAttr(h,!f)){c.lastElemForLock?setFocusForLock(c.lastElemForLock):setFocusForLock(findNoLockCell(n));DEXTTOP.DEXT5.util.stopEvent(event);
DEXTTOP.DEXT5.util.cancelEvent(event);return}}}try{if(13==b&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion){var t=getFirstRange().range,q=getMyElementNode(t.startContainer);if(1==q.nodeType&&-1<",SPAN,U,I,STRONG,B,S,STRIKE,EM,SUP,SUB,".indexOf(","+q.tagName+",")){var u=q.innerHTML.toLowerCase();""==u&&11>=DEXTTOP.DEXT5.browser.ieVersion?q.innerHTML=unescape("%u200B"):"<br>"!=u&&"<br/>"!=u&&"<br />"!=u||11!=DEXTTOP.DEXT5.browser.ieVersion||
(q.innerHTML=unescape("%u200B"))}}}catch(v){}if("1"==d.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{e=getFirstRange().range.startContainer,3==e.nodeType&&(e=e.parentNode),DEXTTOP.DEXTWIN.dext_key_event("keypress",a,e)}catch(w){}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(""!=d.enterTag){var c=!1,y,x,z;z=d.enterTag;if(13==b){if(!a.shiftKey)if("undefined"!=typeof _iframeWin.getSelection){if(x=_iframeWin.getSelection(),x.getRangeAt&&x.rangeCount){y=
x.getRangeAt(0);y.deleteContents();var A=_iframeDoc.createElement(z);y.insertNode(A);y.setEndAfter(A);y.setStartAfter(A);y.collapse(!1);x.removeAllRanges();x.addRange(y);if(11<=DEXTTOP.DEXT5.browser.ieVersion||0==DEXTTOP.DEXT5.browser.ie){var B=A.nextSibling;if(null==B||3==B.nodeType&&""==B.nodeValue)A=_iframeDoc.createElement(z),y.insertNode(A),y.setEndBefore(A),y.setStartBefore(A),y.collapse(!1),x.removeAllRanges(),x.addRange(y)}c=!0}}else"undefined"!=typeof _iframeDoc.selection&&(x=_iframeDoc.selection,
x.createRange&&(y=x.createRange(),"div"==z?(z=getDefaultParagraphValue(!0),pasteHtmlAtCaretHuge(A.outerHTML)):z="<"+z+" />",y.pasteHTML(z),y.collapse(!1),y.select(),c=!0));c&&DEXTTOP.DEXT5.util.cancelEvent(a)}}}}catch(G){}}var bCtrlKey=!1,startBookmark,endBookmark;
function _iframeDoc_Keydown(a){setDEXTWINDOC();var b="which"in a?a.which:a.keyCode;if(!checkDefaultMessage(a)){var c=getEditrFromEvent(a);if(isViewMode(c)){if(0==(9==b||38==b||40==b||37==b||39==b)){var d=!0;a.ctrlKey&&("1"==DEXTTOP.G_CURREDITOR._config.viewModeAllowCopy&&67==b&&(d=!1),70==b&&(d=!1),80==b&&(d=!1));d&&DEXTTOP.DEXT5.util.cancelEvent(a)}}else{getApplyDragResize(c)&&c.dext_dragresize.G_dextResizeDiv&&c.dext_dragresize.keyDown(a);try{G_KEY_IMG_COUNT=_iframeDoc.getElementsByTagName("img").length}catch(e){}var f=
a.target?a.target:a.srcElement,g=f.tagName?f.tagName.toLowerCase():null,h=!1;if("textarea"==g||"input"==g)h=!0;if(0==h&&"1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var n=getFirstRange().range.startContainer;3==n.nodeType&&(n=n.parentNode);var m=GetTDTHCell(n),p;m&&(p=GetParentbyTagName(n,"table"));var t=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;p&&p.getAttribute("lock_mode")&&""!=p.getAttribute("lock_mode")&&(t=p.getAttribute("lock_mode"));
var q=!0;"1"==t&&(q=!1);if(m){if(q&&checkLockAttr(p)){if(DEXTTOP.G_CURREDITOR.lastElemForLock)setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock);else{var u=findNoLockElem(p);u?setFocusForLock(u):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(m,!q)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):setFocusForLock(findNoLockCell(p));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);
return}}if(8==b||46==b){for(var v=GetTableSelectionCells(),w=v.length,y=!1,x=0;x<w;x++)if(checkLockAttr(v[x],!q)){y=!0;break}if(y){DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}}var z=a.target?a.target:a.srcElement,A=z.tagName?z.tagName.toLowerCase():null;if(DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&13==b)try{var B=getFirstRange(),G=B.range,D=B.sel;if(0==G.toString().length){var I=G.startContainer;3==I.nodeType&&(I=I.parentNode);""!=I.style.fontSize&&(DEXTTOP.G_CURREDITOR.keydownFontSizeForIOS=
I.style.fontSize);for(var K=!1;;)if("FONT"==I.tagName){K=!0;break}else if("P"==I.tagName||"BODY"==I.tagName)break;else I=I.parentNode;if(K){var E=_iframeDoc.createElement("span");for(I.parentNode.insertBefore(E,I);I.hasChildNodes();)E.appendChild(I.firstChild);I.getAttribute("color")&&""!=I.getAttribute("color")&&(E.style.color=I.getAttribute("color"));I.getAttribute("face")&&""!=I.getAttribute("face")&&(E.style.fontFamily=I.getAttribute("face"));D.removeAllRanges();I.parentNode.removeChild(I);D.addRange(G);
var N=getFirstRange().range.startContainer,z=3==N.nodeType?N.parentNode:N,A=z.tagName.toLowerCase()}}}catch(H){}"2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode&&(0!=h||37!=b&&38!=b&&39!=b&&40!=b&&13!=b&&8!=b&&46!=b||adjustLiNodeForArrowKey("keydown",z,b,a));if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{z=getFirstRange().range.startContainer,3==z.nodeType&&(z=z.parentNode),DEXTTOP.DEXTWIN.dext_key_event("keydown",a,z)}catch(J){}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);
return}}if(DEXTTOP.DEXT5.browser.gecko){var M=getFirstRange().range;M.startContainer&&M.startContainer.tagName&&"BODY"==M.startContainer.tagName&&M.endContainer&&M.endContainer.tagName&&"BODY"==M.endContainer.tagName&&M.endOffset==_iframeDoc.body.childNodes.length&&(a.ctrlKey&&86==b||!(0!=a.ctrlKey||0!=a.altKey||38==b||40==b||37==b||39==b||91<=b&&93>=b||33<=b&&36>=b||112<=b&&123>=b)&&(32<=b&&127>=b||0==b||13==b||9==b||190<=b&&192>=b||173==b||219<=b&&222>=b))&&(_iframeDoc.body.innerHTML="<p><br></p>",
doSetCaretPosition(_iframeDoc.body.firstChild))}if(!A||"textarea"!=A&&"input"!=A&&"select"!=A)if("1"==DEXTTOP.G_CURREDITOR._config.disableKeydown&&8!=b&&46!=b)DEXTTOP.DEXT5.util.cancelEvent(a);else{if(0==a.ctrlKey&&112<=b&&123>=b)return DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!1;a.ctrlKey&&!a.altKey&&(d=nextTabKeyAccess(a,b))&&DEXTTOP.DEXT5.util.cancelEvent(a);if(d=setTableShortcut(a))return DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!1;if(8==b){var L=
a.srcElement;if(L){if(Mouse_Status==Mouse_IsControlSelecting&&1==L.nodeType&&"IMG"==L.tagName){DEXTTOP.DEXT5.util.cancelEvent(a);return}var F=getFirstRange(),C=F.range,W=F.sel;if(W&&W.docSelection&&"Control"==W.docSelection.type){DEXTTOP.DEXT5.util.cancelEvent(a);return}C&&"BODY"==C.startContainer.nodeName&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}}startBookmark=endBookmark=void 0;bCtrlKey=a.ctrlKey;var V=229;DEXTTOP.DEXT5.browser.gecko&&(V=0);0==a.ctrlKey&&
0==a.altKey&&0==DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length&&(32<=b&&127>=b||b==V)?(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("")):46==b||a.shiftKey||1==a.ctrlKey||1==a.ctrlKey&&67==b?1==a.ctrlKey&&0==a.altKey&&0==a.shiftKey&&67==b&&0<GetTableSelectionCells().length&&(command_tableCopy(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR),DEXTTOP.DEXT5.util.cancelEvent(a)):(ClearDraggingTableCellSelected(),ActiveCurrTable=
null);0==a.shiftKey&&0==bCtrlKey&&9==b&&"1"!=DEXTTOP.G_CURREDITOR._config.EditorTabDisable&&(setTabkeyAction(),DEXTTOP.DEXT5.util.cancelEvent(a));a.shiftKey&&0==bCtrlKey&&9==b&&(setShiftTabkeyAction(),DEXTTOP.DEXT5.util.cancelEvent(a));!DEXTTOP.DEXT5.browser.chrome||37!=b&&38!=b&&39!=b&&40!=b||setArrowKeyAction(37)&&DEXTTOP.DEXT5.util.cancelEvent(a);!DEXTTOP.DEXT5.browser.chrome&&!DEXTTOP.DEXT5.browser.opera||39!=b&&37!=b&&38!=b||0!=a.ctrlKey||0!=a.altKey||0!=a.shiftKey||(C=getFirstRange().range,
L=null,C&&C.startContainer&&(L=getMyElementNode(C.startContainer)),L?(DEXTTOP.G_CURREDITOR.keydownNodeForTableCaret.tdNode=GetTDTHCell(L),DEXTTOP.G_CURREDITOR.keydownNodeForTableCaret.backupRange=C.cloneRange()):(DEXTTOP.G_CURREDITOR.keydownNodeForTableCaret.tdNode=null,DEXTTOP.G_CURREDITOR.keydownNodeForTableCaret.backupRange=null));a.ctrlKey&&!a.altKey&&86==b&&0==DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0,DEXTTOP.G_CURREDITOR._iconEnable(""));if(1==bCtrlKey&&0==a.altKey&&13==b&&(C=getFirstRange().range,L=null,C&&C.startContainer&&(L=getMyElementNode(C.startContainer)),L)){var P=GetTDTHCell(L);if(null==P&&"tr"==L.tagName.toLowerCase()){var S=L.cells.length;0<S&&(P=L.cells[S-1])}if(P){var fa=GetParentbyTagName(P,"tr");if(p=GetParentbyTagName(P,"table")){var ba=P.cellIndex,U=fa.cells.length,ea=fa.rowIndex,ga=p.rows.length;1==ga?0==ba?insertPtagTableNear(!0,p):ba==U-1&&insertPtagTableNear(!1,p):0==ea&&
0==ba?insertPtagTableNear(!0,p):(1<P.rowSpan&&(ea+=P.rowSpan-1),ea==ga-1&&ba==U-1&&insertPtagTableNear(!1,p));DEXTTOP.DEXT5.util.cancelEvent(a)}}}if(1==bCtrlKey)if(a.altKey&&191==b)DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"about");else if(a.altKey&&220==b)DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"symbol"),DEXTTOP.DEXT5.util.cancelEvent(a);else if(a.altKey&&48==b){DEXTTOP.DEXT5.util.cancelEvent(a);var aa="- DEXT5 Editor Information -\n  Client Ver. "+DEXTTOP.DEXT5.ReleaseVer,
aa=aa+("\n  Server Ver. "+DEXTTOP.DEXT5.ServerReleaseVer);if("ieplugin"==DEXTTOP.G_CURREDITOR._config.runtimes)try{aa+="\n  Client Cab Ver. "+G_dext5plugIn.getDext5PluginVersion()}catch(X){}alert(aa)}else if(a.altKey&&57==b)DEXTTOP.G_CURREDITOR._config.useServerLicense||(DEXTTOP.DEXT5.util.cancelEvent(a),aa="DEXT5 Editor License Information",aa+="\n - Company : "+_0_[1],aa+="\n - System : "+_0_[2],aa+="\n - Domain : "+_0_[4],"0"!=_0_[5]&&(aa+="\n - ExpireDate : "+_0_[5]),aa+="\n - User Count : "+
_0_[6],alert(aa));else if(a.altKey&&80==b)try{G_dext5plugIn.SetLogLevel(1)}catch(ka){}else if(!a.altKey&&a.shiftKey&&67==b)DEXTTOP.DEXT5.util.cancelEvent(a),command_tableCopy(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR);else if(!a.altKey&&a.shiftKey&&86==b)DEXTTOP.DEXT5.util.cancelEvent(a),command_intablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR);else if(!a.altKey&&a.shiftKey&&(70==b||84==b))DEXTTOP.DEXT5.util.cancelEvent(a),command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR);
else if(!a.altKey&&86==b){"paste"==G_LAST_CMD&&(G_LAST_CMD=null);if(G_dext5plugIn){DEXTTOP.DEXT5.util.cancelEvent(a);var O=G_dext5plugIn.getPasteHtml(),O=O.replace(/layout-flow:.*?;/gi,""),O=O.replace(RegExp('(text-underline.*?)(;|(?="))',"gi"),"");"1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64_remove&&(O=O.replace(/<img[^>]*src=["\']([^>]*:\\)([^>"\']+)["\']?[^>]*>/gi,""));if(100==G_dext5plugIn.getHTMLFormatFromType){var Q="",da=changeTextForAutoUrl(O,DEXTTOP.G_CURREDITOR);""!=da.changedData&&
(Q=O,O=da.changedData);O=O.replace(/&not/g,"&amp;not");O=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,O);if(""!=da.changedData){da.changedData=O;try{O=rollBackTextForAutoUrl(da)}catch($a){O=Q,O=O.replace(/&not/g,"&amp;not")}}}else{var Ka="";try{Ka=G_dext5plugIn.getDext5PluginVersion()}catch(xa){}""!=Ka&&"5,0,0,9"<=Ka&&6!=G_dext5plugIn.getHTMLFormatFromType&&(O=O.replace(/\r\n/g,"\n"));"1"==DEXTTOP.G_CURREDITOR._config.removeHwpDummyTag&&(O=O.replace(/\&lt;!--\[if !supportEmptyParas\]--\&gt;/gi,
""),O=O.replace(/\&lt;!--\[if !supportLists\]--\&gt;/gi,""),O=O.replace(/\&lt;!--\[endif\]--\&gt;/gi,""),O=O.replace(/\&lt;!\[if !supportEmptyParas\]\&gt;/gi,""),O=O.replace(/\&lt;!\[endif\]\&gt;/gi,""))}var sa=!1;if(G_dext5plugIn.getHTMLFormatFromType&&G_dext5plugIn.getPasteHtmlEx&&6==G_dext5plugIn.getHTMLFormatFromType&&(sa=!0,DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion)){var pa=O.match(RegExp("<img[^>]*src=[\"']?([^>\"']+)[\"']?[^>]*>","gi"));if(pa)for(var Ra=pa.length,x=0;x<
Ra;x++)if(-1<pa[x].indexOf("file://")){sa=!1;break}}if(6==G_dext5plugIn.getHTMLFormatFromType&&DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion){var ya=G_dext5plugIn.getPasteHtmlEx(),ya=checkCopyInCellFormInertnNet(ya);""!=ya&&(O=ya,sa=!1)}if(checkCanPasteToIamge())if("1"==DEXTTOP.G_CURREDITOR._config.pasteToImage||"2"==DEXTTOP.G_CURREDITOR._config.pasteToImage){var za=G_dext5plugIn.ShowImageSaveDlgFromClipboard("");try{if("HTML"==za&&"1"==DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.value){var Aa=
DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.length,Ba=G_dext5plugIn.getOriginalHtml("body");if(Ba.length>Aa){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1);setFocusToBody();return}}}catch(db){}if(""==za)return;""!=za&&"HTML"!=za&&(O=za,sa=!1)}else{if("0"==DEXTTOP.G_CURREDITOR._config.pasteToImage&&"1"==DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.value&&(Aa=DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.length,Ba=G_dext5plugIn.getOriginalHtml("body"),Ba.length>Aa)){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1);
setFocusToBody();return}}else try{if("1"==DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.value&&(Aa=DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.length,Ba=G_dext5plugIn.getOriginalHtml("body"),Ba.length>Aa)){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();return}}catch(eb){}"1"==DEXTTOP.G_CURREDITOR._config.ie_BugFixed_Hyfont&&(O=DEXTTOP.DEXT5.util.replaceHyFont(O,DEXTTOP.G_CURREDITOR));var La=!0;sa&&(setPasteBin(),(La=document.execCommand("paste",!1,null))?(La=!1,fn_PasteIE()):
La=!0);if(La){var Na=!1;6==G_dext5plugIn.getHTMLFormatFromType&&(Na=!0);var ta=document.createElement("div");ta.innerHTML=O;replaceSpanToDivContainAbsolute(ta)&&(O=ta.innerHTML);try{ta.innerHTML="",ta=null,delete ta}catch(fb){}"1"==DEXTTOP.G_CURREDITOR._config.useHtmlCorrection?"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},
editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"htmlTagRevision",callFnParam:[O,!0,Na],callBackFn:fn_PastePlugin_htmlTagRevision_After})):(O=htmlTagRevision(O,!0,Na),fn_PastePlugin_htmlTagRevision_After(O)):fn_PastePlugin_htmlTagRevision_After(O)}}DEXTTOP.DEXT5.browser.gecko&&setPasteBinForGecko();DEXTTOP.DEXT5.browser.ie&&"12"<=DEXTTOP.DEXT5.browser.ieVersion&&setPasteBin()}else{if(!a.altKey&&83==b){for(var Sa=!1,Ta=DEXTTOP.G_CURREDITOR.remove_item,ab=Ta.length,x=0;x<ab;x++)if("save"==Ta[x]){Sa=
!0;break}Sa||command_saveAs("",DEXTTOP.G_CURREDITOR);DEXTTOP.DEXT5.util.cancelEvent(a)}}else if(13==b){var Ua=!1;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)Ua=!0;if(Ua&&!a.shiftKey)try{var Ca=getFirstRange().range.startContainer;3==Ca.nodeType&&(Ca=Ca.parentNode);for(var bb=DEXTTOP.G_CURREDITOR.checkEnterKeyTargetTagArr.length,x=0;x<bb;x++)if(GetParentbyTagName(Ca,DEXTTOP.G_CURREDITOR.checkEnterKeyTargetTagArr[x],!0)){DEXTTOP.G_CURREDITOR.isEnterKeyInTargetTag=
!0;break}if(1==DEXTTOP.G_CURREDITOR.isEnterKeyInTargetTag){var ua=Ca;if("DIV"==ua.tagName)DEXTTOP.G_CURREDITOR.changeDivTagArr.push(ua);else{for(var Da=ua;;){var Ea=Da.tagName;if("BODY"==Ea){Da=null;break}if(Ea&&("LI"==Ea||2==Ea.length&&0==Ea.indexOf("H")))break;else Da=Da.parentNode}null==Da&&(ua=GetParentbyTagName(ua,"div",!0))&&DEXTTOP.G_CURREDITOR.changeDivTagArr.push(ua)}}}catch(gb){DEXTTOP.G_CURREDITOR.isEnterKeyInTargetTag=!1,DEXTTOP.G_CURREDITOR.changeDivTagArr=[]}DEXTTOP.DEXT5.browser.ie&&
setLineHeightForBgColor()}DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&moveRulerPosition(a);if(1==bCtrlKey&&0==a.altKey&&89==b)DEXTTOP.G_CURREDITOR.UndoManager.execRedo(),DEXTTOP.DEXT5.util.cancelEvent(a);else if(1==bCtrlKey&&0==a.altKey&&90==b)getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0),DEXTTOP.G_CURREDITOR.UndoManager.execUndo(),DEXTTOP.DEXT5.util.cancelEvent(a);else if(0==bCtrlKey&&13==b){var Fa=!0;"1"==DEXTTOP.G_CURREDITOR._config.useUndoLightMode&&(isSelected()||(Fa=!1));Fa&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}else if(0==bCtrlKey&&46==b&&setDeleteKeyAction())return"1"==DEXTTOP.G_CURREDITOR._config.allowDeleteCount?(DEXTTOP.G_CURREDITOR.UndoManager.charCount+=1,DEXTTOP.G_CURREDITOR.UndoManager.charCount>=
G_PutUndoCharCount&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)):(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0),DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!0;if(0==bCtrlKey&&(46==b||8==b)){var ma=getFirstRange().range.startContainer;3==ma.nodeType&&(ma=ma.parentNode);!DEXTTOP.DEXT5.browser.ie||1!=ma.childNodes.length||ma.innerHTML!=unescape("%u200B")&&ma.innerHTML!=unescape("%uFEFF")||(ma.innerHTML=
"");try{var va=getFirstRange(),Ma=va.range;if(Ma.startContainer==Ma.endContainer){var ia=GetParentbyTagName(ma,"p");if(ia)if(DEXTTOP.DEXT5.browser.ie){var Va=va.sel;if(1==DEXTTOP.DEXT5.util.isEmptyContents(ia)){var Ga=!1;if(8==b&&ia.previousSibling){var na=ia.previousSibling,qa=null;1==na.nodeType&&na.childNodes&&0==na.childNodes.length||(qa=getMyChildElementNode(na));null==qa&&(qa=na);"BR"==qa.nodeName&&(qa=na);Ga=!0;"HR"==na.nodeName&&(Ga=!1,fn_PrevOrNextNodeForkeyDownEvt(b,va,ia,!0),qa=na.previousSibling);
window.setTimeout(function(){doSetCaretPosition(qa,1)},0)}else 46==b&&ia.nextSibling&&(Ga=!0,"HR"==ia.nextSibling.nodeName&&(Ga=!1,fn_PrevOrNextNodeForkeyDownEvt(b,va,ia,!0,11==DEXTTOP.DEXT5.browser.ieVersion)));Ga&&(Va.removeAllRanges(),Ma.selectNode(ia),Va.addRange(Ma))}else fn_PrevOrNextNodeForkeyDownEvt(b,va,ia,!0)}else 0==DEXTTOP.DEXT5.util.isEmptyContents(ia)&&fn_PrevOrNextNodeForkeyDownEvt(b,va,ia,!1)}}catch(hb){}if(DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR._config.allowUnableToDeleteMsg){var C=
getFirstRange().range,cb=C.endContainer,Wa=GetParentbyTagName(C.startContainer,"table"),Xa=GetParentbyTagName(cb,"table");(Wa||Xa)&&Wa!=Xa&&alert(dext5_lang.msg.unable_to_delete)}"1"==DEXTTOP.G_CURREDITOR._config.allowDeleteCount?(DEXTTOP.G_CURREDITOR.UndoManager.charCount+=1,DEXTTOP.G_CURREDITOR.UndoManager.charCount>=G_PutUndoCharCount&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)):(Fa=!0,"1"==DEXTTOP.G_CURREDITOR._config.useUndoLightMode&&(isSelected()||
(Fa=!1)),Fa&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0));if(removePTagNearTable(b))return DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!0}0==bCtrlKey&&(32<=b&&127>=b||b==V)&&(0==DEXTTOP.G_CURREDITOR.UndoManager.index&&0<DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length?(DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length=1,DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):DEXTTOP.G_CURREDITOR.UndoManager.index<DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length&&
(DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length=DEXTTOP.G_CURREDITOR.UndoManager.index+1),DEXTTOP.G_CURREDITOR.UndoManager.charCount+=1,1==DEXTTOP.G_CURREDITOR.UndoManager.canRedo&&(DEXTTOP.G_CURREDITOR.UndoManager.canRedo=!1,DEXTTOP.G_CURREDITOR.UndoManager.canUndo=!0,DEXTTOP.G_CURREDITOR._iconEnable("")),DEXTTOP.G_CURREDITOR.UndoManager.charCount>=G_PutUndoCharCount&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0));!DEXTTOP.DEXT5.browser.ie||37!=b&&
38!=b&&39!=b&&40!=b||setTableArrowKeyDownAction(a);if(1==DEXTTOP.G_CURREDITOR._config.adjustCursorInTable&&0==a.shiftKey&&0==a.ctrlKey&&0==a.altKey&&(38==b||40==b)){var M=getFirstRange().range,Oa=M.startContainer;if((P=GetTDTHCell(Oa))&&0==isSelected()){var oa=!1,Ha=!1,Pa=function(){try{var a=_iframeDoc.getElementsByTagName("dext_dummy");if(a)for(var b=a.length-1;0<=b;b--)a[b].parentNode.removeChild(a[b])}catch(c){}};if(40==b){n=Oa;if(1==n.nodeType&&0<n.childNodes.length){var la=n.childNodes[M.startOffset];
if(0==!!la)for(x=M.startOffset-1;0<=x;x--){if(la=n.childNodes[x]){n=la;break}}else n=la}if(n.nodeType&&"BR"==n.tagName&&n.nextSibling){var Ia=n.nextSibling;if(1==Ia.nodeType&&"BR"==Ia.tagName)null==Ia.nextSibling?oa=!0:Ha=!0;else if(3!=Ia.nodeType||""!=Ia.textContent.replace(/\s/g,""))Ha=!0}if(0==Ha&&0==oa){var ja=_iframeDoc.createElement("dext_dummy");try{1==n.nodeType?n.nextSibling?n.parentNode.insertBefore(ja,n.nextSibling):n.parentNode.appendChild(ja):3==n.nodeType&&M.insertNode(ja)}catch(ib){Pa()}try{var ca=
P.innerHTML,Ja=ca.indexOf("</dext_dummy>");-1<Ja&&(ca=ca.substring(Ja+13),ja.parentNode.removeChild(ja),0==ca.indexOf("<br")&&(ca=ca.replace(/<br *([^>?+])*>/i,"")),ca=ca.replace(/<br *([^>?+])*><\//gi,"</"),0>ca.indexOf("<p")&&0>ca.indexOf("<br")&&0>ca.indexOf("<div")&&0>ca.indexOf("<table")&&(oa=!0))}catch(jb){oa=!1}}}else if(38==b){n=Oa;if(1==n.nodeType&&0<n.childNodes.length)if(la=n.childNodes[M.startOffset],0==!!la)for(x=M.startOffset-1;0<=x;x--){if(la=n.childNodes[x]){n=la;break}}else n=la;
if(n.nodeType&&"BR"==n.tagName&&n.previousSibling){var Ya=n.previousSibling;1==Ya.nodeType&&"BR"==Ya.tagName&&(Ha=!0)}if(0==Ha&&0==oa){ja=_iframeDoc.createElement("dext_dummy");try{1==n.nodeType?n.previousSibling?n.parentNode.insertBefore(ja,n):n.parentNode.firstChild?n.parentNode.insertBefore(ja,n.parentNode.firstChild):n.parentNode.appendChild(ja):3==n.nodeType&&M.insertNode(ja)}catch(kb){Pa()}try{ca=P.innerHTML,Ja=ca.indexOf("<dext_dummy>"),-1<Ja&&(ca=ca.substring(0,Ja),ja.parentNode.removeChild(ja),
ca=ca.replace(/<br *([^>?+])*>$/i,""),ca=ca.replace(/<br *([^>?+])*><\//gi,"</"),0>ca.indexOf("</p")&&0>ca.indexOf("</div")&&0>ca.indexOf("</table")&&0>ca.indexOf("<br")&&(oa=!0))}catch(lb){oa=!0}}}if(oa){DEXTTOP.DEXT5.util.cancelEvent(a);DEXTTOP.DEXT5.util.stopEvent(a);var Qa=getTopOrBottomBoundNextCell(P,b);if(Qa.nextCell)if(40==b){for(var Y=Qa.nextCell;Y.firstChild;)if(Y.firstChild)Y=Y.firstChild;else break;3==Y.nodeType?Y=Y.parentNode:1!=Y.nodeType||"BR"!=Y.tagName&&"IMG"!=Y.tagName||(Y=Y.parentNode);
doSetCaretPosition(Y,0)}else{if(38==b){for(Y=Qa.nextCell;Y.lastChild;)if(Y.lastChild)Y=Y.lastChild;else break;3==Y.nodeType?Y=Y.parentNode:1!=Y.nodeType||"BR"!=Y.tagName&&"IMG"!=Y.tagName||(Y=Y.parentNode);doSetCaretPosition(Y,1)}}else p=GetParentbyTagName(P,"table"),40==b?p.nextSibling&&doSetCaretPosition(p.nextSibling,0):38==b&&p.previousSibling&&doSetCaretPosition(p.previousSibling,1)}Pa()}}if(32==b&&"1"==DEXTTOP.G_CURREDITOR._config.autoList.use)try{if(C=getFirstRange().range,0==C.toString().length&&
(z=getMyElementNode(C.startContainer),z=GetParentbyTagName(z,"p"))){var ra=function(b,c){DEXTTOP.DEXT5.util.cancelEvent(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=b.innerHTML.substring(0,b.innerHTML.indexOf("1.")),d=ReplaceAll(d,"&nbsp;",""),d=DEXTTOP.DEXT5.util.rtrim(DEXTTOP.DEXT5.util.ltrim(d)),d=d.replace(/>\s+</gi,"><"),d=d+b.innerHTML.substring(b.innerHTML.indexOf("1."),b.innerHTML.length);b.innerHTML=d;d=b;b.firstChild&&1==b.firstChild.nodeType&&(d=b.firstChild);doSetCaretPosition(d,
0);try{for(var e=b.childNodes,f=e.length,g=0;g<f;g++)if(3==e[g].nodeType)if(0==ReplaceAll(e[g].textContent.replace(/\s/g,""),unescape("%u200B"),"").length)e[g].textContent="";else{var h=c.replace(".","\\.").replace("*","\\*"),m=new RegExp(h,""),n=e[g].textContent.match(m);if(n&&0<n.length){e[g].textContent=e[g].textContent.replace(m,"");break}}doSetCaretPosition(d,0)}catch(p){}},ha=z.innerText,wa=C.startContainer.nodeValue,wa=wa.substring(0,getFirstRange().range.startOffset),wa=DEXTTOP.DEXT5.util.ltrim(wa),
ha=DEXTTOP.DEXT5.util.ltrim(ha),ha=ha.substring(0,wa.length);if(wa==ha)switch(ReplaceAll(ha,unescape("%u200B"),"")){case "1.":ra(z,ha);command_insertOrderedList(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR);break;case "01.":ra(z,ha);command_listNumberBullets(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,"N","decimal-leading-zero");break;case "i.":ra(z,ha);command_listNumberBullets(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,"N","lower-roman");break;case "I.":ra(z,ha);command_listNumberBullets(DEXTTOP.G_CURREDITOR.ID,
DEXTTOP.G_CURREDITOR,"N","upper-roman");break;case "a.":ra(z,ha);command_listNumberBullets(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,"N","lower-alpha");break;case "A.":ra(z,ha);command_listNumberBullets(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,"N","upper-alpha");break;case "*":ra(z,ha),command_insertUnOrderedList(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR)}}}catch(mb){}putUndoWordCount(a);setTimeout(function(){bCtrlKey=!1},300);if(27==b){var Za=DEXTTOP.document.getElementById("dext_context_background");
Za&&"none"!=Za.style.display&&DEXT5_CONTEXT.hide()}}}}}
function fn_PrevOrNextNodeForkeyDownEvt(a,b,c,d,e){var f=b.range;b=b.sel;var g=!1;if(46==a){var h=f.getBoundingDocumentRect(),n=saveSelection(DEXTTOP.G_CURREDITOR.ID,!0);b.removeAllRanges();DEXTTOP.DEXT5.browser.ie?f.selectNode(c):f.selectNodeContents(c);1==e&&f.selectNodeContents(c);b.addRange(f);e=f.getBoundingDocumentRect();restoreSelection(n,!0);0==Math.round(h.width)&&Math.round(h.left)==Math.round(h.right)&&Math.round(h.right)==Math.round(e.right)&&(g=!0)}else 8==a&&0==f.startOffset&&0==f.endOffset&&
(g=!0);if(g){G_KeyDownUpSync=d;var m;8==a&&c.previousSibling?m=c.previousSibling:46==a&&c.nextSibling&&(m=c.nextSibling);if(m)if(DEXTTOP.DEXT5.browser.ie&&1==DEXTTOP.DEXT5.util.isEmptyContents(m))m.innerHTML="";else if("FIGURE"==m.nodeName||"HR"==m.nodeName)DEXTTOP.DEXT5.browser.ie?(b.removeAllRanges(),f.selectNode(m),b.addRange(f)):m.parentNode.removeChild(m)}}
function fn_PastePlugin_htmlTagRevision_After(a){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();a=removeTagStyle(a);a=repairPasteTextInCell(a);0<a.length?(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR._iconEnable("")),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(a=DEXTTOP.DEXT5.util.officeCleanByDom(a,!0),showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,
ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"DEXTTOP.DEXT5.util.officeClean",callFnParam:[a,!0],callBackFn:fn_PastePlugin_officeClean_After})):(a=DEXTTOP.DEXT5.util.officeClean(a,!0),fn_PastePlugin_officeClean_After(a))):"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}
function fn_PastePlugin_officeClean_After(a){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();a=OfficePasteClean(a);a=DEXTTOP.DEXT5.util.emptyTagRemove(a);a=IEPasteRemoveEmptyNodes(a);a=DEXTTOP.DEXT5.util.htmlRevision(a);a=xssReplaceScript(null,a);a=getImageAutoFitForPasteHtml(a);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&a&&""!=a&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount){var b=getBase64ImageCountEx(a);if(0<b&&getBase64ImageCount()+b>
parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10)){var c=dext5_lang.msg.max_base64file_count,c=c.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount);alert(c);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}"1"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjustInPaste&&/<table/i.test(a)&&(a=command_AdjustTableAndCellWidth(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,{type:"paste",htmlData:a}));if("function"==typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event){b=
a;try{b=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(a)}catch(d){b=a}if(b)a=b;else if(0==b||""==b){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}if(pasteWordCount(a)){-1<a.indexOf("dext5customdata")&&(a=checkExistCustomData(a));var e=GetTableSelectionCells(),b=document.createElement("div");b.innerHTML=a;b=b.childNodes;if(1==b.length&&b[0].tagName&&"table"==b[0].tagName.toLowerCase()&&0<e.length)0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),
command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,b[0]),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;else{e=!1;if("1"==DEXTTOP.G_CURREDITOR._config.useTablePasteDialog){var f=getFirstRange().range,c=null;f.startContainer==f.endContainer&&(c=f.startContainer,3==c.nodeType&&(c=c.parentNode),c=GetTDTHCell(c));c&&1==b.length&&b[0].tagName&&"table"==b[0].tagName.toLowerCase()&&(e=!0)}e?(DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=b[0],DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=
a,DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=c,DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=GetParentbyTagName(c,"table"),DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.paste_table)):setTimeout(function(){pasteHtmlAtCaretHuge(a)},0)}checkPasteImage(a);0>a.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),ClearDraggingTableAllTable());
"base64"!=DEXTTOP.G_CURREDITOR._config.uploadMethod&&base64imageToLocalFile(_iframeDoc);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){}},500)}else"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}
function removePTagNearTable(a){var b=!1;try{var c=getFirstRange().range;if(0<c.toString().length)return b;var d=null;c&&c.startContainer&&(d=getMyElementNode(c.startContainer));if(d&&1==d.nodeType){var e=d.innerHTML;if(""==e||"<br>"==e||"<br/>"==e||"<br />"==e)if(46==a?nearElem=d.nextSibling:8==a&&(nearElem=d.previousSibling),nearElem&&1==nearElem.nodeType&&("table"==nearElem.tagName.toLowerCase()||"blockquote"==nearElem.tagName.toLowerCase())){if(46==a)"table"==nearElem.tagName.toLowerCase()?doSetCaretPosition(nearElem.rows[0].cells[0],
0):doSetCaretPosition(nearElem,0);else if(8==a)if("table"==nearElem.tagName.toLowerCase()){var f=nearElem.rows.length;doSetCaretPosition(nearElem.rows[f-1].cells[nearElem.rows[f-1].cells.length-1],0)}else{var g=nearElem.childNodes[nearElem.childNodes.length-1];g||(g=nearElem);doSetCaretPosition(g,1)}d.innerHTML="";d.parentNode.removeChild(d);b=!0}}}catch(h){}return b}
function setPasteCellData(){var a=getFirstRange().range,b=null;if(a&&a.startContainer){if(b=DrageStartCell){var c=GetTDTHCell(b);if(c){if(null==DEXTTOP.G_COPIEDCELLDATA)return!1;for(var d=GetParentbyTagName(c,"tr"),a=GetParentbyTagName(c,"table"),c=c.cellIndex,d=d.rowIndex,e,f=DEXTTOP.G_COPIEDCELLDATA.length,g=0,h=0;h<f&&void 0!=a.rows[d+h];h++){for(var g=DEXTTOP.G_COPIEDCELLDATA[h].length,n=0;n<g&&!(g>a.rows[d+h].cells.length);n++)void 0!=a.rows[d+h].cells[c+n]&&(a.rows[d+h].cells[c+n].innerHTML=
DEXTTOP.G_COPIEDCELLDATA[h][n],e=a.rows[d+h].cells[c+n]);try{if(a.rows[d+(h+1)])for(var m=a.rows[d+(h+1)].cells,g=0;g<=m.length;g++){var p=getClientRect(m[g]),t=getClientRect(b);if(p.left<=t.left&&p.right>t.left){c=m[g].cellIndex;break}}}catch(q){}}null!=e&&(doSetCaretPosition(e.childNodes[0],1),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&"&nbsp;"==e.innerHTML&&(e.innerHTML=""))}else{if(null==DEXTTOP.G_COPIEDTABLE)return!1;b=DEXTTOP.G_COPIEDTABLE.outerHTML;0==DEXTTOP.DEXT5.browser.gecko&&
(b=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?b+"<p></p>":b+getDefaultParagraphValue(!0));pasteHtmlAtCaretHuge(b)}}else{if(null==DEXTTOP.G_COPIEDTABLE)return!1;restoreSelection();setFocusToBody();a=getFirstRange().range;getMyElementNode(a.startContainer);b=DEXTTOP.G_COPIEDTABLE.outerHTML;0==DEXTTOP.DEXT5.browser.gecko&&(b=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?b+"<p></p>":b+getDefaultParagraphValue(!0));pasteHtmlAtCaretHuge(b)}return!0}return!1}
function getEnterTagString(a){var b="",b=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":"<br />",c="";"br"==a?c="<br />":"p"==a?c="<p>"+b+"</p>":"div"==a&&(c="<div>"+b+"</div>");return c}
function _iframeDoc_Keyup(a){setDEXTWINDOC();var b=getEditrFromEvent(a);if(isViewMode(b)||b.dextiframeKeydown)b.dextiframeKeydown=!1,DEXTTOP.DEXT5.util.cancelEvent(a);else{var b="which"in a?a.which:a.keyCode,c=a.target?a.target:a.srcElement,d=c.tagName?c.tagName.toLowerCase():null,c=!1;if("textarea"==d||"input"==d)c=!0;if(0==c){d=getFirstRange();d=d.range.startContainer;3==d.nodeType&&(d=d.parentNode);if(37==b||38==b||39==b||40==b)G_CURSOR_ELEMENT=d;try{if(d&&1==d.nodeType&&"hr"==d.tagName.toLowerCase()&&
!a.shiftKey&&!a.ctrlKey)if(37==b){for(;d&&(1!=d.nodeType||"hr"==d.tagName.toLowerCase());){if(3==d.nodeType){d=d.parentNode;break}if(!d.previousSibling){var e=_iframeDoc.createElement("p");if(DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion)e.innerHTML="&nbsp;";else{var f=_iframeDoc.createElement("br");e.appendChild(f)}d.parentNode.insertBefore(e,d)}d=d.previousSibling}if(d){if(d&&"table"==d.tagName.toLowerCase())var g=d.rows,h=g[g.length-1].cells,n=h[h.length-1],d=n.lastChild;else if("ul"==
d.tagName.toLowerCase()||"ol"==d.tagName.toLowerCase())d=d.lastChild;if(d.lastChild&&1==d.lastChild.nodeType&&"br"==d.lastChild.tagName.toLowerCase()){for(var m=d.lastChild.previousSibling;m;)if(1==m.nodeType&&"br"==m.tagName.toLowerCase())m=m.previousSibling;else break;m?m&&1==m.nodeType?d=m:m&&3==m.nodeType&&(d=m):(doSetCaretPosition(d,0),d=null)}d&&doSetCaretPosition(d,1)}}else if(39==b){for(;d&&(1!=d.nodeType||"hr"==d.tagName.toLowerCase());){if(3==d.nodeType){d=d.parentNode;break}d.nextSibling||
(e=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?e.innerHTML="&nbsp;":(f=_iframeDoc.createElement("br"),e.appendChild(f)),d.parentNode.appendChild(e));d=d.nextSibling}if(d){if("table"==d.tagName.toLowerCase())g=d.rows,h=g[0].cells,n=h[0],d=n.firstChild;else if("ul"==d.tagName.toLowerCase()||"ol"==d.tagName.toLowerCase())d=d.firstChild;doSetCaretPosition(d,0)}}}catch(p){}}if(0==c&&"1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){d=
getFirstRange();d=d.range.startContainer;3==d.nodeType&&(d=d.parentNode);var e=GetTDTHCell(d),t;e&&(t=GetParentbyTagName(d,"table"));f=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;t&&t.getAttribute("lock_mode")&&""!=t.getAttribute("lock_mode")&&(f=t.getAttribute("lock_mode"));g=!0;"1"==f&&(g=!1);if(e){if(g&&checkLockAttr(t)){if(DEXTTOP.G_CURREDITOR.lastElemForLock)setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock);else{var q=findNoLockElem(t);q?setFocusForLock(q):(window.focus(),
document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(e,!g)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):setFocusForLock(findNoLockCell(t));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}DEXTTOP.G_CURREDITOR.lastElemForLock=e}else checkLockElemInSelectionRange()}t=a.target?a.target:a.srcElement;e=t.tagName?t.tagName.toLowerCase():null;if(DEXTTOP.DEXT5.browser.mobile&&
DEXTTOP.DEXT5.browser.iOS&&13==b)try{var u=getFirstRange(),v=u.range,w=u.sel,y=v.startContainer;3==y.nodeType&&(y=y.parentNode);if("SPAN"==y.tagName&&y.firstChild&&1==y.firstChild.nodeType&&"BR"==y.firstChild.tagName){y.removeChild(y.firstChild);var x=rangy.createRange(_iframeDoc).getDocument().createTextNode(unescape("%uFEFF"));y.appendChild(x);doSetCaretPosition(y,1)}for(u=!1;;)if("FONT"==y.tagName){u=!0;break}else if("P"==y.tagName||"BODY"==y.tagName)break;else y=y.parentNode;if(u){var z=_iframeDoc.createElement("span");
for(y.parentNode.insertBefore(z,y);y.hasChildNodes();)z.appendChild(y.firstChild);y.getAttribute("color")&&""!=y.getAttribute("color")&&(z.style.color=y.getAttribute("color"));y.getAttribute("face")&&""!=y.getAttribute("face")&&(z.style.fontFamily=y.getAttribute("face"));y.getAttribute("size")&&""!=y.getAttribute("size")&&(z.style.fontSize=DEXTTOP.G_CURREDITOR.keydownFontSizeForIOS);w.removeAllRanges();y.parentNode.removeChild(y);w.addRange(v);var A=getFirstRange().range.startContainer;t=3==A.nodeType?
A.parentNode:A;e=t.tagName.toLowerCase()}}catch(B){}v=!1;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)v=!0;if(v&&13==b&&!a.shiftKey&&DEXTTOP.G_CURREDITOR.isEnterKeyInTargetTag){DEXTTOP.G_CURREDITOR.isEnterKeyInTargetTag=!1;try{var G=getFirstRange().range.startContainer;3==G.nodeType&&(G=G.parentNode);v=G;w=!1;if("DIV"==v.tagName)w=!0;else{for(y=v;;){var D=y.tagName;if("BODY"==D){y=null;break}if(D&&("LI"==D||2==D.length&&0==D.indexOf("H")))break;else y=
y.parentNode}if(null==y){var I=GetParentbyTagName(v,"div",!0);I&&(w=!0,v=I)}}if(w){var K=DEXTTOP.G_CURREDITOR.changeDivTagArr.length;if(0<K){for(D=K-1;0<=D;D--){var E=_iframeDoc.createElement("p"),N=DEXTTOP.G_CURREDITOR.changeDivTagArr[D];setCopyAllObjectAtributes(N,E,!0);N.parentNode.replaceChild(E,N)}DEXTTOP.G_CURREDITOR.changeDivTagArr=[]}makeRangeSelectionMarkInDesign();var H=_iframeDoc.createElement("p"),E=v;setCopyAllObjectAtributes(E,H,!0);E.parentNode.replaceChild(H,E);setRangeSelectionMarkInDesign(!0)}}catch(J){setRangeSelectionMarkInDesign(!0),
DEXTTOP.G_CURREDITOR.isEnterKeyInTargetTag=!1,DEXTTOP.G_CURREDITOR.changeDivTagArr=[]}}if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{t=getFirstRange().range.startContainer,3==t.nodeType&&(t=t.parentNode),DEXTTOP.DEXTWIN.dext_key_event("keyup",a,t)}catch(M){}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(e&&("textarea"==e||"input"==e||"select"==e))return!1;if(8==b||46==b||DEXTTOP.DEXT5.browser.gecko&&
a.ctrlKey&&88==b)if(3>_iframeDoc.body.childNodes.length&&(H=_iframeDoc.body.innerHTML,""==H||"<br>"==H||DEXTTOP.DEXT5.browser.ie&&11<DEXTTOP.DEXT5.browser.ieVersion&&"<div><br></div>"==H)&&(_iframeDoc.body.innerHTML="",setBodyDefaultValue()),G_KeyDownUpSync&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion)try{G_KeyDownUpSync=!1;var L=getFirstRange().range,G=getMyElementNode(L.startContainer);if("SPAN"==G.nodeName){var F=G.style.cssText,C;if(G.nextSibling){var W=G.nextSibling;if(("SPAN"==
W.nodeName||"FONT"==W.nodeName)&&""==W.className&&""==W.id&&null==W.nextSibling&&(S=W.style.cssText,-1<F.indexOf(S))){for(C=saveSelection(DEXTTOP.G_CURREDITOR.ID);0<W.childNodes.length;)G.appendChild(W.childNodes[0]);DEXTTOP.DEXT5.util.removeElement(W);restoreSelection(C)}}else if(G.childNodes){W=!1;C=saveSelection(DEXTTOP.G_CURREDITOR.ID);for(var V=G.childNodes.length-1,P,S;0<=V;V--)P=G.childNodes[V],"SPAN"!=P.nodeName&&"FONT"!=P.nodeName||""!=P.className||""!=P.id||(S=P.style.cssText,-1<F.indexOf(S)&&
(DEXTTOP.DEXT5.util.removeElement(P),W=!0));W&&restoreSelection(C)}}}catch(fa){G_KeyDownUpSync=!1}if(!a.ctrlKey&&!bCtrlKey||a.altKey){if(46==b||8==b)_iframeDoc_MouseUpMenu(a),DEXTTOP.G_SELECTED_ELEMENT=null;if(!a.shiftKey&&13==b&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion){setLineHeightForBgColor();try{if(L=getFirstRange().range,G=getMyElementNode(L.startContainer),1==G.nodeType&&-1<",SPAN,U,I,STRONG,B,S,STRIKE,EM,SUP,SUB,".indexOf(","+
G.tagName+",")){var ba=G.innerHTML.toLowerCase();if(""==ba&&11>=DEXTTOP.DEXT5.browser.ieVersion)G.innerHTML=unescape("%u200B");else if(("<br>"==ba||"<br/>"==ba||"<br />"==ba)&&11==DEXTTOP.DEXT5.browser.ieVersion)G.innerHTML=unescape("%u200B");else if(""!=ba&&"SPAN"==G.nodeName&&(F=G.style.cssText,G.childNodes&&3>=G.childNodes.length&&(1!=G.childNodes.length||"#text"!=G.childNodes[0].nodeName))){var U=G.childNodes,L=null;"SPAN"!=U[0].nodeName&&"FONT"!=U[0].nodeName||""!=U[0].className||""!=U[0].id?
"#text"==U[0].nodeName&&("SPAN"!=U[1].nodeName&&"FONT"!=U[1].nodeName||""!=U[1].className||""!=U[1].id?2==U.length&&"BR"==U[1].nodeName&&U[1].parentNode.removeChild(U[1]):(_currFCStyle=U[1].style.cssText,-1<F.indexOf(_currFCStyle)&&(L=U[1]))):(_currFCStyle=G.firstChild.style.cssText,-1<F.indexOf(_currFCStyle)&&(L=U[0]));L&&(DEXTTOP.DEXT5.util.removeElement(L),doSetCaretPosition(G,0))}}}catch(ea){}}}else if(86==b&&G_dext5plugIn){DEXTTOP.DEXT5.util.cancelEvent(a);return}DEXTTOP.DEXT5.browser.ie&&9>=
DEXTTOP.DEXT5.browser.ieVersion&&moveRulerPosition(a);if(32==b||13==b||46==b||8==b||37==b||38==b||39==b||40==b||36==b||35==b||33==b||34==b){"2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode&&(0!=c||37!=b&&38!=b&&39!=b&&40!=b&&13!=b||adjustLiNodeForArrowKey("keyup",t,b));try{var ga=getFirstRange(),q=ga.range,G=null;if(q&&q.startContainer&&(F=!0,32==b&&(F=!1),F)){if((G=ga.sel.focusNode)&&3==G.nodeType)for(;1!=G.nodeType;)if(G.parentNode)G=G.parentNode;else break;else G=getMyElementNode(q.startContainer);
setMenuIconRealable(G)}}catch(aa){}DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion&&0==(32==b||13==b)?setTableArrowKeyUpAction(a):(!DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion)&&1==(32==b||13==b)&&setAutoUrlHyperLink(a,ga)}ga=229;DEXTTOP.DEXT5.browser.gecko&&(ga=0);0==a.ctrlKey&&0==a.altKey&&1==DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length&&DEXTTOP.G_CURREDITOR.isInitKeydownForSetApi&&(32<=b&&127>=b||b==ga)&&(DEXTTOP.G_CURREDITOR.isInitKeydown=
!1,DEXTTOP.G_CURREDITOR.UndoManager.canUndo=!0);if(a.shiftKey&&35==b){q=getFirstRange().range;try{if(1==q.endContainer.nodeType&&"BODY"==q.endContainer.tagName){for(var X=q.endContainer.childNodes[q.endOffset-1];3!=X.nodeType;)X=X.lastChild,1==X.nodeType&&"BR"==X.tagName&&(X=X.previousSibling);q.setEndAfter(X);getFirstRange().sel.addRange(q);q.collapse(!0)}}catch(ka){}}try{X=!1;if(DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.quirks){if(37==b||38==b||39==b||40==b||36==b||35==b||33==b||34==b||a.ctrlKey)X=
!0}else X=!0;if(X){X=null;(q=getFirstRange().range)&&0==q.toString().length&&q.startContainer&&(X=getMyElementNode(q.startContainer));if((DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)&&(39==b||37==b||38==b)&&0==a.ctrlKey&&0==a.altKey&&0==a.shiftKey&&"BODY"==X.tagName)if(DEXTTOP.G_CURREDITOR.keydownNodeForTableCaret.tdNode){var O=GetParentbyTagName(DEXTTOP.G_CURREDITOR.keydownNodeForTableCaret.tdNode,"table");if(39==b){var Q=O.nextSibling;try{if(3==Q.nodeType){var da=Q.nodeValue,da=da.replace(/\n/g,
""),da=da.replace(/\t/g,""),da=da.replace(/ /g,"");""==da&&(Q=X.childNodes[q.startOffset+1])}null==Q?restoreSelection(DEXTTOP.G_CURREDITOR.keydownNodeForTableCaret.backupRange,!0):"P"!=Q.tagName&&"TABLE"!=Q.tagName&&"DIV"!=Q.tagName||!Q.firstChild||(Q=getFirstChildNodeForCaret(Q.firstChild),doSetCaretPosition(Q,0),setMenuIconRealable(Q),X=Q)}catch($a){}}else if(37==b||38==b){Q=O.previousSibling;try{if(3==Q.nodeType&&(da=Q.nodeValue,da=da.replace(/\n/g,""),da=da.replace(/\t/g,""),da=da.replace(/ /g,
""),""==da&&(1==q.startContainer.nodeType&&"BODY"==q.startContainer.tagName?Q=X.childNodes[q.startOffset-2]:3==q.startContainer.nodeType&&(Q=q.startContainer.previousSibling))),null==Q)restoreSelection(DEXTTOP.G_CURREDITOR.keydownNodeForTableCaret.backupRange,!0);else if("P"==Q.tagName||"TABLE"==Q.tagName||"DIV"==Q.tagName)Q=getLastChildNodeForCaret(Q),doSetCaretPosition(Q,1),setMenuIconRealable(Q),X=Q}catch(Ka){}}}else if(37==b&&0<q.startOffset)try{var xa=X.childNodes[q.startOffset-1];!xa||"TABLE"!=
xa.tagName&&"P"!=xa.tagName||(Q=getLastChildNodeForCaret(xa),doSetCaretPosition(Q,1),setMenuIconRealable(Q),X=Q)}catch(sa){}else if(39==b)try{var pa=X.childNodes[q.startOffset];pa&&"TABLE"==pa.tagName&&(Q=pa.rows[0].cells[0],Q.firstChild&&(Q=getFirstChildNodeForCaret(Q.firstChild),doSetCaretPosition(Q,0),setMenuIconRealable(Q),X=Q))}catch(Ra){}_iframeDoc_MouseUpMenu(a,X)}}catch(ya){}showWordCount(a);setRulerPositionForNode();setContentChangeKeyEvent(a,b)}}
function recursionBase64ImageToServer(){if(DEXTTOP.DEXT5.browser.ie)dummy=document.getElementById("pasteDiv");else try{var a=document.getElementById("pasteIframe");a&&(dummy=getIframeDocument(a).body)}catch(b){dummy=null}for(var c=null,c=dummy?dummy.getElementsByTagName("img"):_iframeDoc.getElementsByTagName("img"),d=c.length-1;0<=d;d--){var a=c[d],e=a.src;if("data:"==e.substring(0,5))if("1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64_remove)a.parentNode.removeChild(a);else if(e=e.split(","),
2==e.length){c=getExtFromImageDataSrc(e[0]);postBase64ImageToServer(e[1],c,a,!0);break}}}
function fn_PasteIE(a){var b=DEXTTOP.G_CURREDITOR;setTimeout(function(a){DEXTTOP.G_CURREDITOR=b;var d=null;if(DEXTTOP.DEXT5.browser.ie)d=document.getElementById("pasteDiv");else try{var e=document.getElementById("pasteIframe");e&&(d=getIframeDocument(e).body)}catch(f){d=null}if(d){d.blur();e=d.innerHTML;"1"==DEXTTOP.G_CURREDITOR._config.removeHwpDummyTag&&(e=e.replace(/\&lt;!--\[if !supportEmptyParas\]--\&gt;/gi,""),e=e.replace(/\&lt;!--\[if !supportLists\]--\&gt;/gi,""),e=e.replace(/\&lt;!--\[endif\]--\&gt;/gi,
""),e=e.replace(/\&lt;!\[if !supportEmptyParas\]\&gt;/gi,""),e=e.replace(/\&lt;!\[endif\]\&gt;/gi,""));if(DEXTTOP.G_CURREDITOR.setTextPaste)if("1"==DEXTTOP.G_CURREDITOR.setTextPasteMode)for(var g="span font strong i em u strike s sub sup".split(" "),h=g.length,e=e.replace(/<b>/gi,""),e=e.replace(/<b ([^>?+])*>/gi,""),e=e.replace(/<\/b>/gi,""),n=0;n<h;n++)var m=new RegExp("</"+g[n]+">","gi"),e=e.replace(new RegExp("<"+g[n]+" *([^>?+])*>","gi"),""),e=e.replace(m,"");else e=DEXTTOP.DEXT5.convertHtmlToText(e);
e=e.replace(RegExp('(text-underline.*?)(;|(?="))',"gi"),"");e=e.replace(RegExp("(<colgroup*[^>?+]*>)<span*[^>?+]*>","gim"),"$1");e=e.replace(RegExp("(<col*[^>?+]*>)</span>","gim"),"$1");"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(e=e.replace(/--\x3e\s</gi,"--\x3e<"));e=dummyTagClassClear(e);restoreSelection(DEXTTOP.G_CURREDITOR._LastRange);g=d.getElementsByTagName("img");h=g.length;if(0==h&&1==e.length&&"undefined"!=typeof a&&1==DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion)try{for(var m=
-1,p=!0,n=0;n<a.clipboardData.items.length;n++)"file"==a.clipboardData.items[n].kind&&"image/png"==a.clipboardData.items[n].type?m=n:p=!1;if(p&&-1!=m){var t=a.clipboardData.items[m].getAsFile(),q=new FileReader;q.onload=function(){var a=document.createElement("img");a.src=q.result;d.appendChild(a);var b=q.result;if("data:"==b.substring(0,5)&&(b=b.split(","),2==b.length)){var c=getExtFromImageDataSrc(b[0]);a.parentNode.removeChild(a);postBase64ImageToServer(b[1],c);checkPasteImage(d.innerHTML);pasteHtmlAtCaretHuge(d.innerHTML);
document.body.removeChild(d);DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}q=void 0};q.readAsDataURL(t);return null}}catch(u){}checkPasteImage(e);a=!1;for(n=0;n<h;n++)if(t=g[n].src,"data:"==t.substring(0,5)&&2==t.split(",").length){a=!0;break}!a||G_dext5plugIn&&"base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod||(recursionBase64ImageToServer(),e=d.innerHTML);e=removeDummyfontTagInTable(e);"1"==DEXTTOP.G_CURREDITOR._config.ie_BugFixed_Hyfont&&(e=DEXTTOP.DEXT5.util.replaceHyFont(e,DEXTTOP.G_CURREDITOR));
d.innerHTML=e;"2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode&&(adjustOlUlTag(d),e=d.innerHTML);n=d.innerHTML;a=RegExp("<li.*?(mso-list).*?>","gi");if(DEXTTOP.DEXT5.browser.ie&&11<=DEXTTOP.DEXT5.browser.ieVersion&&a.test(n)){a=d.getElementsByTagName("ol");t=a.length;g=d.getElementsByTagName("ul");h=g.length;for(n=0;n<t;n++){m=a[n].getElementsByTagName("li")[0];if(""==m.style.fontFamily){var p=m.innerHTML,v=RegExp("mso-hansi-font-family:([^;]*)","g"),w="";v.exec(p)&&(w=RegExp.$1);m.style.fontFamily=
""!=w?w:"\ub9d1\uc740 \uace0\ub515"}m.firstChild.style&&""==m.firstChild.style.fontFamily&&(m.firstChild.style.fontFamily=""!=w?w:"\ub9d1\uc740 \uace0\ub515")}for(n=0;n<h;n++)m=g[n].getElementsByTagName("li")[0],""==m.style.fontFamily&&(p=m.innerHTML,v=RegExp("mso-hansi-font-family:([^;]*)","g"),w="",v.exec(p)&&(w=RegExp.$1),m.style.fontFamily=""!=w?w:"\ub9d1\uc740 \uace0\ub515"),m.firstChild.style&&""==m.firstChild.style.fontFamily&&(m.firstChild.style.fontFamily=""!=w?w:"\ub9d1\uc740 \uace0\ub515")}w=
replaceSpanToDivContainAbsolute(d);h=!1;n="";a=d.childNodes.length;for(t=0;t<a;t++)g=d.childNodes[t],1==g.nodeType&&"FONT"==g.tagName?(h="",""!=g.color&&(h+="color:"+g.color+";"),""!=g.face&&(h+="font-family:"+g.face+";"),""!=g.style.cssText&&(h+=g.style.cssText),0<h.length&&(h=" style='"+h+"'"),n+="<span"+h+">"+g.innerHTML+"</span>",h=!0):3==g.nodeType?n+=g.nodeValue:8==g.nodeType?"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(n=void 0!=g.text?n+g.text:n+g.nodeValue):n+=g.outerHTML;if(1==h||w)e=
n;if(DEXTTOP.DEXT5.browser.ie)document.body.removeChild(d);else try{document.body.removeChild(document.getElementById("pasteIframe"))}catch(y){}setFocusToBody();"1"==DEXTTOP.G_CURREDITOR._config.useHtmlCorrection?(w=!1,G_dext5plugIn&&6==G_dext5plugIn.getHTMLFormatFromType&&(w=!0),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},
editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"htmlTagRevision",callFnParam:[e,!0,w],callBackFn:fn_PasteIE_htmlTagRevision_After})):(e=htmlTagRevision(e,!0,w),fn_PasteIE_htmlTagRevision_After(e))):fn_PasteIE_htmlTagRevision_After(e)}},0,a)}
function fn_PasteIE_htmlTagRevision_After(a){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();a=removeTagStyle(a);a=ReplaceAll(a,unescape("%uFEFF"),"");a=ReplaceAll(a,unescape("%u200B"),"");if(0<a.length){a=SetCorrectOfficeHtml(a);a=SetCorrectOfficeHtmlForDOM(a);var b=!1;G_dext5plugIn&&(b=!0);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(a=DEXTTOP.DEXT5.util.officeCleanByDom(a,b),showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,
ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"DEXTTOP.DEXT5.util.officeClean",callFnParam:[a,b],callBackFn:fn_PasteIE_officeClean_After})):(a=DEXTTOP.DEXT5.util.officeClean(a,b),fn_PasteIE_officeClean_After(a))}else"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}
function fn_PasteIE_officeClean_After(a){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();a=DEXTTOP.DEXT5.util.emptyTagRemove(a);a=IEPasteRemoveEmptyNodes(a);a=DEXTTOP.DEXT5.util.htmlRevision(a);a=xssReplaceScript(null,a);if(DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.gecko){a=OfficePasteClean(a);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&a&&""!=a&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount){var b=getBase64ImageCountEx(a);if(0<b&&getBase64ImageCount()+
b>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10)){a=dext5_lang.msg.max_base64file_count;a=a.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount);alert(a);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}"1"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjustInPaste&&/<table/i.test(a)&&(a=command_AdjustTableAndCellWidth(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,{type:"paste",htmlData:a}));if("function"==typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event){b=
a;try{b=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(a)}catch(c){b=a}if(b)a=b;else if(0==b||""==b){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}if(!pasteWordCount(a)){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}-1<a.indexOf("dext5customdata")&&(a=checkExistCustomData(a));var d=GetTableSelectionCells(),b=document.createElement("div");b.innerHTML=a;b=b.childNodes;if(1==b.length&&b[0].tagName&&"table"==b[0].tagName.toLowerCase()&&
0<d.length)0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,b[0]),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;else{d=!1;if("1"==DEXTTOP.G_CURREDITOR._config.useTablePasteDialog){var e=getFirstRange().range,f=null;e.startContainer==e.endContainer&&(f=e.startContainer,3==f.nodeType&&(f=f.parentNode),f=GetTDTHCell(f));f&&1==b.length&&b[0].tagName&&"table"==
b[0].tagName.toLowerCase()&&(d=!0)}d?(DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=b[0],DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=a,DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=f,DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=GetParentbyTagName(f,"table"),DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.paste_table)):pasteHtmlAtCaretHuge(a)}0>a.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=
!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),ClearDraggingTableAllTable());setAdjustTableBorder(DEXTTOP.G_CURREDITOR._DOC)}"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();try{contentChangeEventWrapper()}catch(g){}}
function IEPasteRemoveEmptyNodes(a){function b(a){function b(a){for(var c=a.childNodes,d=[],e=0,f=c.length;e<f;++e)a=c[e],a.TEXT_NODE==a.nodeType?d.push(a.data):a.ELEMENT_NODE==a.nodeType&&d.push(b(a));return d.join("").replace(/\s+/g," ")}"string"==typeof a&&(a=_iframeDoc.getElementById(a));return"string"==typeof a.textContent?a.textContent:"string"==typeof a.innerText?a.innerText:b(a)}if(DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR._config.pasteRemoveEmptyTag)try{var c=_iframeDoc.createElement("div");
c.innerHTML=a;for(var d,e=c.getElementsByTagName("*"),f,g=newline=!1,h=/^\s*$/,n,m,p=0;p<e.length;p++)if(d=e[p],n=new RegExp("\\b"+d.tagName+"\\b","i"),!n.test("base basefont body br col hr html img input isindex link meta param title")&&n.test("span div b strong i em strike u sup sub")&&h.test(b(d))){f=d.getElementsByTagName("*");for(var t=0,q=f.length;t<q;t++)if(m=new RegExp("\\b"+f[t].tagName+"\\b","i"),m.test("base basefont body br col hr html img input isindex link meta param title")){g=!0;break}var u=
d.innerHTML;-1<u.indexOf("&nbsp;")&&(newline=!0);u=u.replace(/(<([^>]+)>)/gi,"");" "==u&&(g=!0);g||newline||(d.parentNode.removeChild(d),--p);newline=g=!1}a=c.innerHTML}catch(v){}return a}
function pasteHtmlAtCaretHuge(a,b,c){try{if(0!=a.length){var d,e,f=getFirstRange();d=f.sel;e=f.range;if(d.getRangeAt&&d.rangeCount){var g=getBlockContainer(e.startContainer),h,n,m,p;if(g){var t=_iframeDoc.createElement("div");t.innerHTML=a;n=_iframeDoc.createDocumentFragment();for(var q=!1;p=t.firstChild;)if(n.appendChild(p),0==q&&1==p.nodeType){var u=p.tagName.toLowerCase(),v=",p,table,div,hr,ol,ul,figure,";1!=b&&(v+="input,select,button,textarea,");-1<v.indexOf(","+u+",")&&(q=!0)}try{t&&(t.innerHTML=
"",delete null)}catch(w){}var y=g.tagName.toLowerCase();"div"==y&&(q=!1);if(q){e.deleteContents();try{h=extractBlockContentsFromCaret(!0);m=extractBlockContentsFromCaret(!1);b="";var x=h.childNodes.length,z,A;z=A;f=getFirstRange();d=f.sel;e=f.range;e.selectNode(g);e.deleteContents();if(0<x){var B=h.childNodes[0];if(1!=x||3!=B.nodeType||0!=B.nodeValue.length){var G=!0;if("p"==y&&1==x)try{var D=B.innerHTML.toLowerCase(),D=D.replace(/<(span|strong|font|i|u|strike|sup|sub|b|em|s|)>/gi,""),D=D.replace(/<(span .*?|strong .*?|font .*?|i .*?|u .*?|strike .*?|sup .*?|sub .*?|b .*?|em .*?|s .*?)>/gi,
""),D=D.replace(/<(\/span|\/strong|\/font|\/i|\/u|\/strike|\/sup|\/sub|\/b|\/em|\/s|)>/gi,"");if(""==D||"<br>"==D||"<br />"==D)G=!1}catch(I){}G&&(z=_iframeDoc.createElement(y),z.appendChild(h),setCopyAllObjectAtributes(g,z,!1),e.insertNode(z),e.setStartAfter(z),x=m?m.childNodes.length:0,0==x&&doSetCaretPosition(z,1),e.collapse(!0))}}var K;if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie||c)K=_iframeDoc.createElement("span"),K.innerHTML=DEXTTOP.DEXT5.browser.gecko?"<br>":"&nbsp;",e.insertNode(K),
e.setStartAfter(K),e.collapse(!0);x=m?m.childNodes.length:0;if(0<x&&(B=m.childNodes[0],1!=x||3!=B.nodeType||0!=B.nodeValue.length)){G=!0;if("p"==y&&1==x)try{if(D=B.innerHTML.toLowerCase(),D=D.replace(/<(span|strong|font|i|u|strike|sup|sub|b|em|s|)>/gi,""),D=D.replace(/<(span .*?|strong .*?|font .*?|i .*?|u .*?|strike .*?|sup .*?|sub .*?|b .*?|em .*?|s .*?)>/gi,""),D=D.replace(/<(\/span|\/strong|\/font|\/i|\/u|\/strike|\/sup|\/sub|\/b|\/em|\/s|)>/gi,""),""==D||"<br>"==D||"<br />"==D)G=!1}catch(E){}G&&
(A=_iframeDoc.createElement(y),A.appendChild(m),setCopyAllObjectAtributes(g,A,!1),e.insertNode(A),rangy.getSelection(_iframeWin).removeAllRanges(),e.selectNode(A),e.setEndBefore(A),d.addRange(e),e.collapse(!0))}b="";var N=n.childNodes.length;d=!1;for(f=0;f<N;f++){var H=n.childNodes[f];1==H.nodeType&&checkBlockTag(H.tagName)?(1==d&&(b+="</p>",d=!1),b+=H.outerHTML):1==H.nodeType&&0==checkBlockTag(H.tagName)?(0==d&&(b+="<p>",d=!0),b+=H.outerHTML):3==H.nodeType&&0<H.nodeValue.length?(0==d&&(b+="<p>",
d=!0),b+=H.nodeValue):8==H.nodeType&&"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(b=void 0!=H.text?b+H.text:b+H.nodeValue);f==N-1&&1==d&&(b+="</p>",d=!1)}if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie||c)rangy.getSelection(_iframeWin).removeAllRanges(),e.selectNode(K),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e);pasteHtmlAtCaretMini(b);try{if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie)K.removeNode?K.removeNode():K.outerHTML=
"";else if(!(_iframeWin.getSelection||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)){var J=g.lastChild;J&&"table"==J.tagName.toLowerCase()&&doSetCaretPosition(J.cells[0],1)}}catch(M){}}catch(L){pasteHtmlAtCaretMini(a)}}else pasteHtmlAtCaretMini(a)}else pasteHtmlAtCaretMini(a)}}}catch(F){}}
function pasteHtmlAtCaretMini(a){if(0!=a.length){var b,c,d=getFirstRange();b=d.sel;c=d.range;if(_iframeWin.getSelection||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks){if(b.getRangeAt&&b.rangeCount||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks){c.deleteContents(!0);var e;try{if(""==_iframeDoc.body.innerHTML){e=_iframeDoc.createElement("div");e.innerHTML=a;for(var f=e.childNodes,d="",g=!0,h=f.length,n=0;n<h;n++){var m=f[n];if(!m||1!=m.nodeType||"P"!=m.tagName&&
"TABLE"!=m.tagName&&"DIV"!=m.tagName&&"HR"!=m.tagName&&"OL"!=m.tagName&&"UL"!=m.tagName)if(3==m.nodeType){var p=m.nodeValue,p=p.replace(/&/g,"&amp;"),p=p.replace(/</g,"&lt;"),p=p.replace(/>/g,"&gt;"),p=p.replace(/\r\n/g,"<br />"),p=p.replace(/\r?\n/g,"<br />"),p=p.replace(/\n/g,"<br />");0==g?d+=p:(d=d+"<p>"+p,g=!1)}else 8!=m.nodeType?0==g?d+=m.outerHTML:(d=d+"<p>"+m.outerHTML,g=!1):"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(d+=m.text);else 0==g&&(d+="</p>",g=!0),d+=m.outerHTML,g=!0}0==g&&
(d+="</p>");0<d.length&&(a=d)}}catch(t){}try{e&&(e.innerHTML="",delete null)}catch(q){}e=_iframeDoc.createElement("div");e.innerHTML=a;if((a=getMyElementNode(c.startContainer))&&1==a.nodeType&&"BODY"==a.tagName){f=e.childNodes;d="";g=!0;h=f.length;for(n=0;n<h;n++)!(m=f[n])||1!=m.nodeType||"P"!=m.tagName&&"TABLE"!=m.tagName&&"DIV"!=m.tagName&&"HR"!=m.tagName&&"OL"!=m.tagName&&"UL"!=m.tagName?3==m.nodeType?(p=m.nodeValue,p=p.replace(/&/g,"&amp;"),p=p.replace(/</g,"&lt;"),p=p.replace(/>/g,"&gt;"),p=
p.replace(/\r\n/g,"<br />"),p=p.replace(/\r?\n/g,"<br />"),p=p.replace(/\n/g,"<br />"),0==g?d+=p:(d=d+"<p>"+p,g=!1)):8!=m.nodeType&&(0==g?d+=m.outerHTML:(d=d+"<p>"+m.outerHTML,g=!1)):(0==g&&(d+="</p>",g=!0),d+=m.outerHTML,g=!0);0==g&&(d+="</p>");0<d.length&&(a=d)}a=_iframeDoc.createDocumentFragment();for(var u;m=e.firstChild;)u=a.appendChild(m);c.insertNode(a);if(u)if(3==u.nodeType){c.selectNodeContents(u);c=c.cloneRange();try{c.setEnd(c.endContainer,c.endOffset),c.collapse(!1)}catch(v){c.setStartBefore(u),
c.collapse(!0)}b.removeAllRanges();b.addRange(c)}else if(!u||1!=u.nodeType||0!=u.outerHTML.indexOf("<table")&&0!=u.outerHTML.indexOf("<TABLE")){c.selectNodeContents(u);c=c.cloneRange();try{"IMG"==u.tagName||"HR"==u.tagName||"IFRAME"==u.tagName||"EMBED"==u.tagName?("0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?c.setStartBefore(u):c.setStartAfter(u),c.collapse(!0)):(DEXTTOP.DEXT5.browser.gecko||8<DEXTTOP.DEXT5.browser.ieVersion?("0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?
c.setEnd(c.startContainer,c.startOffset):c.setEnd(c.endContainer,c.endOffset),c.collapse(!1)):("0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?c.setStartBefore(u):c.setStartAfter(u),c.collapse(!0)),"OL"!=u.tagName&&"UL"!=u.tagName||setTimeout(function(){doSetCaretPosition(c.endContainer.lastChild.lastChild,1)},0))}catch(w){c.setStartBefore(u),c.collapse(!0)}try{b.removeAllRanges(),b.addRange(c)}catch(y){c.startContainer&&1==c.startContainer.nodeType&&setTimeout(function(){doSetCaretPosition(c.startContainer,
1)},0)}}else if(a=u.getElementsByTagName("td"))if(m=null,m="0"==DEXTTOP.G_CURREDITOR._config.afterPasteCaretPosition?u.rows[u.rows.length-1].cells[0].childNodes[0]:a[a.length-1].childNodes[0],0==m.length)doSetCaretPosition(cell,1);else{for(;0!=m.childNodes.length&&"BR"!=m.childNodes[0].tagName;)m=m.childNodes[0];doSetCaretPosition(m,0)}try{e&&(e.innerHTML="",delete null)}catch(x){}}}else(b=_iframeDoc.selection)&&"Control"!=b.type&&(u=b.createRange(),u.collapse(!0),b.createRange().pasteHTML(a),c=b.createRange(),
c.setEndPoint("StartToStart",u));try{if(c.startContainer&&c.startContainer.tagName&&"BR"==c.startContainer.tagName){for(var z=c.startContainer;;){if(null==z||void 0==z){z=z.parentNode;break}if("BR"!=z.tagName)break;z=z.previousSibling}c.setStartAfter(z);c.collapse(!0);b.removeAllRanges();b.addRange(c)}}catch(A){}showWordCount();DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}}function getBlockContainer(a){for(;a;){if(1==a.nodeType&&/^(P|H[1-6]|DIV)$/i.test(a.nodeName))return a;a=a.parentNode}}
function getContainerForRemoveCss(a){for(;a;){if(1==a.nodeType&&/^(P|H[1-6]|DIV|LI|BLOCKQUOTE|HR|OL|UL|TD|TH)$/i.test(a.nodeName))return a;a=a.parentNode}}
function extractBlockContentsFromCaretForRemoveCss(a){var b=getFirstRange(),c=b.range;if(b.sel.rangeCount)if(a){if(a=getContainerForRemoveCss(c.startContainer))return b=c.cloneRange(),b.selectNodeContents(a),b.setEnd(c.startContainer,c.startOffset),b.extractContents()}else if(a=getContainerForRemoveCss(c.endContainer))return b=c.cloneRange(),b.selectNodeContents(a),b.setStart(c.endContainer,c.endOffset),b.extractContents()}
function extractBlockContentsFromCaret(a){var b=getFirstRange(),c=b.range;if(b.sel.rangeCount)if(a){if(b=getBlockContainer(c.startContainer))return a=c.cloneRange(),a.selectNodeContents(b),a.setEnd(c.startContainer,c.startOffset),a.extractContents()}else if(b=getBlockContainer(c.endContainer)){a=c.cloneRange();a.selectNodeContents(b);if(DEXTTOP.DEXT5.browser.ie)a.setStart(c.endContainer,c.endOffset);else{b=c.endOffset;try{c.endContainer.childNodes.length>=c.endOffset&&(b=c.endContainer.childNodes.length-
1-c.endOffset,0>b&&(b=0))}catch(d){}a.setStart(c.endContainer,b)}return a.extractContents()}}function insertNodeAtCaret(a){var b=DEXTTOP.G_CURREDITOR._DOC.createElement("span");b.id=a;b.innerHTML="&nbsp;";if(a=getFirstRange().range)a.collapse(!1),a.insertNode(b)}
function replacePasteHTML(){if(null!=startBookmark&&null!=endBookmark)try{var a=getFirstRange().range;a.setStart(startBookmark.startContainer,startBookmark.startOffset);a.setEnd(endBookmark.startContainer,endBookmark.startOffset);var b=a.toHtml();if(0<b.length){var b=SetCorrectOfficeHtml(b),b=SetCorrectOfficeHtmlForDOM(b),c=DEXTTOP.DEXT5.util.officeClean(b,!1),c=DEXTTOP.DEXT5.util.htmlRevision(c),c=xssReplaceScript(null,c);a&&(a.deleteContents(),a.pasteHtml(c))}}catch(d){}}
function dext_src_init(a){_iframeWin=rangy.dom.getIframeWindow(a);_iframeDoc=rangy.dom.getIframeDocument(a)}
function setBodyDefaultValue(){try{if(!(0<getFirstRange().range.toString().length)){var a=_iframeDoc.body.childNodes.length,b=_iframeDoc.body.childNodes,c=null,d=null;if(0==a)c=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?c.innerHTML="&nbsp;":(d=_iframeDoc.createElement("br"),c.appendChild(d)),_iframeDoc.body.appendChild(c),doSetCaretPosition(c,0);else if(3!==b[0].nodeType)if(1==a&&1===b[0].nodeType)if(c=b[0],"p"==c.nodeName.toLowerCase())""!=c.innerHTML&&
" "!=c.innerHTML&&"&nbsp;"!=c.innerHTML||DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(d=_iframeDoc.createElement("br"),c.appendChild(d)),doSetCaretPosition(c,0);else{if("br"==c.nodeName.toLowerCase()){var e=_iframeDoc.createElement("p");_iframeDoc.body.appendChild(e);e.appendChild(c);doSetCaretPosition(e,0)}}else 2<=a&&setFocusToBody()}}catch(f){}}
function setFocusToBody(){try{1!=DEXTTOP.DEXT5.config.ForceSkipFocus&&(0==DEXTTOP.G_CURREDITOR._config.initFocus&&DEXTTOP.G_CURREDITOR.isInitFocusHandler||"view"!=DEXTTOP.G_CURREDITOR._config.mode&&(DEXTTOP.DEXT5.browser.ie?setTimeout(function(){try{_iframeWin.focus(),_iframeDoc.focus(),_iframeDoc.body.focus()}catch(a){}},0):setTimeout(function(){try{_iframeWin.focus(),_iframeDoc.body.focus()}catch(a){}},0)))}catch(a){}}
function _iframeDoc_ContextMenu(a){setDEXTWINDOC();var b=getEditrFromEvent(a);DEXTTOP.G_CURREDITOR=b;if(isViewMode(b))"1"==b._config.viewModeBrowserMenu&&DEXTTOP.DEXT5.util.cancelEvent(a);else{var c=a?a:_iframeWin.event;G_CURSOR_ELEMENT=currElem=c.target?c.target:c.srcElement;if("1"!=b._config.formMode&&"1"==b._config.userTableLock.use){var d=GetTDTHCell(currElem),e;d&&(e=GetParentbyTagName(currElem,"table"));var f=b._config.userTableLock.defaultTableLockMode;e&&e.getAttribute("lock_mode")&&""!=e.getAttribute("lock_mode")&&
(f=e.getAttribute("lock_mode"));var g=!0;"1"==f&&(g=!1);if(d){if(checkLockAttr(e)){if(b.lastElemForLock)setFocusForLock(b.lastElemForLock);else{var h=findNoLockElem(e);h?setFocusForLock(h):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(d,!g)){b.lastElemForLock?setFocusForLock(b.lastElemForLock):setFocusForLock(findNoLockCell(e));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}b.lastElemForLock=
d}}if("1"==b._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("contextmenu",c,currElem)}catch(n){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(c);return}}c=GetParentbyTagName(currElem,"table");null==c?(ClearDraggingTableCellSelected(),ActiveCurrTable=null):(DEXTTOP.G_SELECTED_ELEMENT=currElem,ActiveCurrTable=c);try{var m=currElem.tagName.toLowerCase();if("html"==m||"body"==m){c=!1;500>a.clientX&&10>a.clientY&&
(c=!0);repairBodyFirstLastTag(c);if(DEXTTOP.DEXT5.browser.ie&&0==DEXTTOP.DEXT5.browser.quirks&&7!=DEXTTOP.DEXT5.browser.ieVersion){if((h=getFirstRange().range)&&0==h.toString().length&&_iframeDoc.body.createTextRange){var h=_iframeDoc.body.createTextRange(),p=a.clientX,t=a.clientY;"None"==b._setting.doctype&&(p<h.boundingLeft&&(p=h.boundingLeft),"html"==m&&t>h.boundingHeight-(h.offsetTop-h.boundingTop)&&("None"!=b._setting.doctype&&(p=h.boundingWidth+h.boundingLeft),t=h.boundingHeight-(h.offsetTop-
h.boundingTop),"None"==b._setting.doctype&&--t));h.moveToPoint(p,t);h.select()}setFocusToBody()}else if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var q=getFirstRange().range;if(0==q.toString().length){b=null;try{createSelectionFromPoint(a.clientX,a.clientY,a.clientX,a.clientY),setFocusToBody(),q=getFirstRange().range,b=_iframeDoc.createElement("dexttemp"),q.insertNode(b),null!=b.nextSibling&&doSetCaretPosition(b.nextSibling,!1)}catch(u){}b&&b.parentNode.removeChild(b)}}else setFocusToBody();
(h=getFirstRange().range)&&h.startContainer==h.endContainer&&1==h.collapsed&&(currElem=getMyElementNode(h.startContainer));setMenuIconRealable(currElem)}else setTimeout(function(){var a=getFirstRange().range;a&&a.startContainer==a.endContainer&&1==a.collapsed&&(currElem=getMyElementNode(a.startContainer));setMenuIconRealable(currElem)},0)}catch(v){}if(!IsMousePointOnBorder(a)){if(getApplyDragResize(DEXTTOP.G_CURREDITOR)&&!DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_showContext){DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_showContext=
!0;DEXTTOP.DEXT5.util.cancelEvent(a);return}if(DEXTTOP.DEXT5.browser.mobile)return;setContextMenu(a)}DEXTTOP.DEXT5.util.cancelEvent(a)}}function _iframeDoc_BlurHandler(a){a=getEditrFromEvent(a);a._LastRange||a._RangeBlurBug||(a._LastRange=saveSelection(a.ID))}
function _iframeDoc_FocusHandler(a){if(a.target?a.target:a.srcElement)a=getEditrFromEvent(a),setCurrentEditor(a),1==a.isInitFocusHandler&&0==a._config.initFocus&&DEXTTOP.DEXT5.browser.ie&&(setBodyDefaultValue(),a.isInitFocusHandler=!1),a._LastRange&&restoreSelection(a._LastRange)}
function setCurrentEditor(a){var b=a._EDITOR.design;a._DOC=b.contentDocument?b.contentDocument:b.contentWindow.document;a._BODY=a._DOC.body;DEXTTOP.G_CURREDITOR=a;G_USE_EDITOR_ID=a.ID;LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID);dext_src_init(b)}
function InsertFontElement(a,b){var c=getFirstRange(),d=c.range;if(d){d.collapse(!1);var e=null,e=GetParentbyTagName(d.startContainer,"span");!e||e.innerHTML!=unescape("%u200B")&&e.innerHTML!=unescape("%uFEFF")&&""!=e.innerText&&"\n"!=e.innerHTML&&"<br>"!=e.innerHTML&&"<br />"!=e.innerHTML&&"<br>"!=e.innerHTML?(e=_iframeDoc.createElement("span"),0==DEXTTOP.DEXT5.browser.gecko&&(DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?e.innerHTML=unescape("%u200B"):e.innerHTML=
unescape("%uFEFF")),e.style[a]=b,d.insertNode(e),d.selectNodeContents(e),rangy.getSelection(_iframeWin).removeAllRanges(),c.sel.addRange(d),doSetCaretPosition(e,1),!DEXTTOP.DEXT5.browser.ie||"fontFamily"!=a&&"fontSize"!=a||(DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID))):(e.style[a]=b,DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?e.innerHTML=unescape("%u200B"):e.innerHTML=unescape("%uFEFF"),d.selectNodeContents(e),rangy.getSelection(_iframeWin).removeAllRanges(),
c.sel.addRange(d),doSetCaretPosition(e,1))}}function execCommand(a,b,c){b.document=_iframeDoc;rangy.execCommand(a,b,c)}
function getFirstRange(){retValue={};try{var a=rangy.getSelection(_iframeWin);retValue.sel=a;if(0==a.rangeCount){var b=rangy.createRange(_iframeDoc),a=rangy.getSelection(_iframeWin);a.setSingleRange(b);retValue.sel=a;retValue.range=b}else retValue.range=a.getRangeAt(0),DEXTTOP.DEXT5.browser.chrome&&retValue.range.startContainer==retValue.range.endContainer&&retValue.range.startOffset==retValue.range.endOffset&&retValue.range.startContainer.tagName&&"br"==retValue.range.startContainer.tagName.toLowerCase()&&
retValue.range.startContainer.parentNode&&retValue.range.startContainer.parentNode.lastChild==retValue.range.startContainer&&(retValue.range.setStartBefore(retValue.range.startContainer),retValue.range.setEndBefore(retValue.range.endContainer),retValue.sel.removeAllRanges(),retValue.sel.addRange(retValue.range))}catch(c){try{b=rangy.createRange(_iframeDoc),a=rangy.getSelection(_iframeWin),a.setSingleRange(b),retValue.sel=a,retValue.range=b}catch(d){}}return retValue}
function setRestoreCaretPos(a){var b=getFirstRange().range;b&&(0==a&&b.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))}
function DoExecuteCommand(a,b,c,d){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var e="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,f=DEXTTOP.DEXT5.browser.quirks;if(0==b.toString().length){var g=GetTableSelectionCells();if(0==g.length){try{DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&
"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&1==b.startContainer.nodeType&&""==b.startContainer.innerHTML&&(b.startContainer.innerHTML=unescape("%u200B"))}catch(h){}_iframeDoc.execCommand(c,!1,null);setMenuIconRealable(getMyElementNode(b.startContainer))}else{var n=[];switch(c){case "bold":n=["b","strong"];break;case "italic":n=["em","i"];break;case "underline":n=["u"];break;case "strikeThrough":n=["strike"];break;case "superscript":n=["sup"];break;case "subscript":n=["sub"]}var m=!0;if(0<
g.length){for(var p=!1,t=0;t<g.length;t++){var q=getAllTextNodeByNode(g[t]);if(q&&0<q.length){p=getElementInParentTag(q[0].parentNode,n);break}}p&&(m=!1)}for(t=0;t<g.length;t++)if(a.removeAllRanges(),b.selectNode(g[t]),a.addRange(b),"0"!=DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag||""!=DEXTTOP.DEXT5.util.replaceAll(g[t].innerHTML," ","")&&g[t].innerHTML!=getCellDefValue()&&"<p><br></p>"!=g[t].innerHTML.toLowerCase()&&"<p><br/></p>"!=g[t].innerHTML.toLowerCase()&&"<p><br /></p>"!=g[t].innerHTML.toLowerCase()){DEXTTOP.DEXT5.browser.ie&&
(8>=DEXTTOP.DEXT5.browser.ieVersion||1==e||1==f)&&("<p></p>"==g[t].innerHTML.toLowerCase()?g[t].innerHTML="<p>&nbsp;</p>":"<span></span>"==g[t].innerHTML.toLowerCase()&&(g[t].innerHTML="<span>&nbsp;</span>"));"underline"==c||"strikeThrough"==c?_iframeDoc.execCommand(c,!1,null):(d.ignoreWhiteSpace=!0,rangy.queryCommandValue(c,d),execCommand(c,d,b));q=!1;switch(c){case "bold":if(0<g[t].getElementsByTagName("b").length||0<g[t].getElementsByTagName("strong").length)q=!0;break;case "italic":if(0<g[t].getElementsByTagName("em").length||
0<g[t].getElementsByTagName("i").length)q=!0;break;case "underline":0<g[t].getElementsByTagName("u").length&&(q=!0);break;case "strikeThrough":0<g[t].getElementsByTagName("strike").length&&(q=!0);break;case "superscript":0<g[t].getElementsByTagName("sup").length&&(q=!0);break;case "subscript":0<g[t].getElementsByTagName("sub").length&&(q=!0)}if(m&&!q||!m&&q)"underline"==c||"strikeThrough"==c?_iframeDoc.execCommand(c,!1,null):(d.ignoreWhiteSpace=!0,rangy.queryCommandValue(c,d),execCommand(c,d,b))}else DEXTTOP.G_CURREDITOR._formatPainterList&&
"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&(DEXTTOP.DEXT5.browser.ie&&(g[t].innerHTML="<p>&nbsp;</p>"),"underline"==c||"strikeThrough"==c?_iframeDoc.execCommand(c,!1,null):(d.ignoreWhiteSpace=!0,rangy.queryCommandValue(c,d),execCommand(c,d,b)));a.removeAllRanges();var u=DrageEndCell.lastChild;try{for(;u;){if(3==u.nodeType){u=u.parentNode;break}else if(1==u.nodeType&&void 0!=u.tagName&&-1<",img,br,".indexOf(","+u.tagName.toLowerCase()+",")){u=u.parentNode;break}u=u.lastChild}doSetCaretPosition(u,
1)}catch(v){doSetCaretPosition(DrageEndCell.lastChild,1)}DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==e||1==f)&&(DEXTTOP.G_CURREDITOR._LastRange=null);var w=getFirstRange().range,y=getMyChildElementNode(w.startContainer);y&&w.selectNode(y);_iframeDoc_MouseUpMenu(null,DrageEndCell);setMenuIconRealable(u)}}else{if("underline"!=c&&"strikeThrough"!=c&&DEXTTOP.DEXT5.browser.ie)d.ignoreWhiteSpace=!0,rangy.queryCommandValue(c,d),execCommand(c,d,b),DEXTTOP.DEXT5.browser.gecko&&a.removeAllRanges(),
a.addRange(b);else{_iframeDoc.execCommand(c,!1,null);try{var x=getFirstRange(),m=x.range,n=x.sel;a=!1;m.startContainer!=b.startContainer&&1==m.startContainer.nodeType&&3==b.startContainer.nodeType&&(m.setStart(b.startContainer,b.startOffset),a=!0);if(m.endContainer&&1==m.endContainer.nodeType){var p=m.endContainer.childNodes[m.endOffset-1],z;p&&(1==p.nodeType?(z=(m.endContainer.innerText||m.endContainer.textContent).length,p=p.firstChild):3==p.nodeType&&(z=p.length));m.setEnd(p,z);a=!0}a&&(n.removeAllRanges(),
n.addRange(m))}catch(A){}}setMenuIconRealable(getMyElementNode(b.startContainer))}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(B){}}
function getCommandIconState(a){"strikeThrough"==a&&(a="strike_through");return-1<document.getElementById("dext_span_"+DEXTTOP.G_CURREDITOR.ID+a).className.indexOf("uebutton_span_enter")?!0:!1}
function DoExecuteCommandFormatting(a,b,c){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=a.sel,e=a.range;if(0==e.toString().length){var f=GetTableSelectionCells();if(0==f.length)if(c){DEXTTOP.DEXT5.browser.ie&&(b="<"+b+">");try{if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&e.startContainer==
e.endContainer){var g,h="";1==e.startContainer.nodeType?(g=e.startContainer,h=e.startContainer.innerHTML):3==e.startContainer.nodeType&&(g=e.startContainer.parentNode,h=g.innerHTML);g&&""!=h&&(h=h.replace(/<br>$/ig,""),g.innerHTML=h)}}catch(n){}_iframeDoc.execCommand("formatBlock",!1,b)}else if(DEXTTOP.DEXT5.browser.ie){var m=GetParentbyTagName(e.startContainer,"h1");null==m&&(m=GetParentbyTagName(e.startContainer,"h2"));null==m&&(m=GetParentbyTagName(e.startContainer,"h3"));null==m&&(m=GetParentbyTagName(e.startContainer,
"h4"));null==m&&(m=GetParentbyTagName(e.startContainer,"h5"));null==m&&(m=GetParentbyTagName(e.startContainer,"h6"));if(m){var p=m,t=_iframeDoc.createElement(b);t.innerHTML=p.innerHTML;_iframeDoc.body.appendChild(t);p.parentNode.replaceChild(t,p);doSetCaretPosition(t,0)}}else _iframeDoc.execCommand("formatBlock",!1,b);else for(var q=f.length,u=0,d=0;d<q;d++){for(var v=getFormattingNode(f[d],b,c,!0),u=v.length,w=0;w<u;w++){p=v[w];t=_iframeDoc.createElement(b);h=1==p.nodeType?p.innerHTML:p.nodeValue;
if(DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&11==DEXTTOP.DEXT5.browser.ieVersion)try{h=h.replace(/<br>$/ig,""),""==h&&(h=unescape("%u200B"))}catch(y){}t.innerHTML=h;_iframeDoc.body.appendChild(t);p.parentNode.replaceChild(t,p)}0==v.length&&c&&(t=_iframeDoc.createElement(b),t.innerHTML=""==f[d].innerHTML?DEXTTOP.DEXT5.browser.ie?"&nbsp;":"<br />":f[d].innerHTML,f[d].innerHTML="",f[d].appendChild(t))}}else{f=[];v=getFormattingNode(e,b,c);u=v.length;for(w=0;w<
u;w++)if(p=v[w],t=_iframeDoc.createElement(b),!c||"td"!=p.tagName.toLowerCase()&&"th"!=p.tagName.toLowerCase()||!DEXTTOP.DEXT5.browser.ie||""!=p.innerHTML&&"&nbsp;"!=p.innerHTML&&p.innerHTML!=p.innerText){if(DEXTTOP.DEXT5.browser.ie&&c&&1==p.nodeType){var x=p.tagName.toLowerCase();if("h1"!=x&&"h2"!=x&&"h3"!=x&&"h4"!=x&&"h5"!=x&&"h6"!=x&&GetTDTHCell(p))continue}try{if(p&&1==p.nodeType){h=p.innerHTML;if(DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&11==DEXTTOP.DEXT5.browser.ieVersion)try{h=
p.innerHTML.replace(/<br>$/ig,""),""==h&&(h=unescape("%u200B"))}catch(z){}t.innerHTML=h}}catch(A){}_iframeDoc.body.appendChild(t);p.parentNode.replaceChild(t,p);f.push(t)}else t.innerHTML=p.innerHTML,""==t.innerHTML&&(t.innerHTML="&nbsp;"),p.innerHTML="",p.appendChild(t);u=f.length;if(0<u){d.removeAllRanges();e.selectNodeContents(f[0]);var B=e.cloneRange();e.selectNodeContents(f[u-1]);e.setStart(B.startContainer,B.startOffset);e.setEnd(e.endContainer,e.endOffset);d.addRange(e)}}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||
DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(G){}}
function getFormattingNode(a,b,c,d){b=[];var e=null;if(d){if(e=a.childNodes,0==e.length)return e}else e=getNodesInRange(a);a=!1;for(var f=e.length,g=0;g<f;g++){var h=e[g];if(1==h.nodeType){var n=h.tagName.toLowerCase();"html"!=n&&"body"!=n&&(a=!0,c?("h1"==n||"h2"==n||"h3"==n||"h4"==n||"h5"==n||"h6"==n||"p"==n||"pre"==n||DEXTTOP.DEXT5.browser.ie&&1!=d&&("td"==n||"th"==n))&&b.push(h):"h1"!=n&&"h2"!=n&&"h3"!=n&&"h4"!=n&&"h5"!=n&&"h6"!=n||b.push(h))}else d&&3==h.nodeType&&c&&(a=!0,b.push(h))}if(0==a)for(e=
getAllNodesInBody(_iframeDoc.body,!0),f=e.length,g=0;g<f;g++)h=e[g],1==h.nodeType?(n=h.tagName.toLowerCase(),c?("h1"==n||"h2"==n||"h3"==n||"h4"==n||"h5"==n||"h6"==n||"p"==n||"pre"==n||DEXTTOP.DEXT5.browser.ie&&1!=d&&("td"==n||"th"==n))&&b.push(h):"h1"!=n&&"h2"!=n&&"h3"!=n&&"h4"!=n&&"h5"!=n&&"h6"!=n||b.push(h)):d&&3==h.nodeType&&c&&b.push(h);return b}
function DoExecuteCommand2(a,b,c,d,e){try{(0==!!e&&null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(0==b.toString().length||0!=b.endOffset){var f=GetTableSelectionCells();-1<c.indexOf("justify")&&7==DEXTTOP.DEXT5.browser.ieVersion&&null!=ActiveCurrTable&&0==d&&(d=!1,"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&
(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="1",d=!0),setAdjustTableWidthHeight(ActiveCurrTable),d&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0"));if(0==f.length)"justifyLeft"!=c||DEXTTOP.DEXT5.browser.ie||_iframeDoc.execCommand("justifyFull",!1,null),-1<c.indexOf("justify")?b.commonAncestorContainer&&"BODY"!=b.commonAncestorContainer.tagName&&_iframeDoc.execCommand(c,!1,null):_iframeDoc.execCommand(c,!1,null),-1<c.indexOf("justify")&&executeTextAlign(b,c),setMenuIconRealable(getMyElementNode(b.startContainer));
else{var g=f.length;d=[];for(var h=0;h<g;h++){var n=f[h].innerHTML,n=ReplaceAll(n,unescape("\r\n"),""),n=ReplaceAll(n,unescape("\r"),""),n=ReplaceAll(n,unescape("\n"),""),n=ReplaceAll(n,unescape("%20%20"),"");f[h].innerHTML=n;a.removeAllRanges();b.selectNodeContents(f[h]);a.addRange(b);"removeFormat"==c&&d.push(f[h].getAttribute("cellOrgBgColor"));_iframeDoc.execCommand(c,!1,null);if(-1<c.indexOf("justify")){for(var m=f[h].getElementsByTagName("p"),p=m.length,t=f[h].getElementsByTagName("div"),q=
t.length,u="",u="justifyFull"==c?"justify":c.substring(7),v=null,w=0;w<p;w++)v=m[w],v.style.textAlign!=u&&(v.style.textAlign=u);for(w=0;w<q;w++)v=t[w],v.style.textAlign!=u&&(v.style.textAlign=u)}}a.removeAllRanges();if("removeFormat"==c)for(g=f.length,a=0;a<g;a++){var y=f[a];y.setAttribute("cellOrgBgColor",d[a]);y.style.backgroundColor=ColorCellBackColor;y.setAttribute("dext_select","true")}doSetCaretPosition(DrageEndCell.childNodes[0],1);var x=getFirstRange().range,z=getMyChildElementNode(x.startContainer);
x.selectNode(z);setMenuIconRealable(z);_iframeDoc_MouseUpMenu(null,DrageEndCell)}}else _iframeDoc.execCommand(c,!1,null),-1<c.indexOf("justify")&&executeTextAlign(b,c);if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)if(x=getFirstRange().range,f=null,x&&x.startContainer&&(f=getMyElementNode(x.startContainer)),f){var A=GetParentbyTagName(f,"td");if(A){for(var B=A.getElementsByTagName("li"),h=B.length-1;0<=h;h--)if("OL"!=B[h].parentNode.tagName&&"UL"!=B[h].parentNode.tagName){n=
_iframeDoc.createElement("div");n.innerHTML=B[h].innerHTML;var G=n.firstChild;B[h].parentNode.replaceChild(G,B[h]);doSetCaretPosition(G,1)}if("<p></p>"==A.innerHTML||""==A.innerHTML)A.innerHTML=getCellDefValue()}}if(0==!!e&&null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(D){}}
function DoExecuteCommand3(a,b,c,d,e){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(0==b.toString().length){var f=GetTableSelectionCells();if(0==f.length)"fontcolor"==c&&(c="color"),"fontbgcolor"==c&&(c="backgroundColor"),"lineheight"==c&&(c="lineHeight"),InsertFontElement(c,e);else{var g=f.length;e=[];
var h="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,n=DEXTTOP.DEXT5.browser.quirks;if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==h||1==n))for(var m=0;m<g;m++){var p=f[m];"<p></p>"==p.innerHTML.toLowerCase()?p.innerHTML="<p>&nbsp;</p>":"<span></span>"==p.innerHTML.toLowerCase()?p.innerHTML="<span>&nbsp;</span>":""==p.innerHTML.toLowerCase()&&(p.innerHTML="&nbsp;")}for(m=0;m<g;m++){"1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag&&(f[m].innerHTML=f[m].innerHTML.replace(/<p><br ?\/?><\/p>/gi,
"<p>&nbsp;</p>"));a.removeAllRanges();b.selectNode(f[m]);a.addRange(b);rangy.queryCommandValue(c,d);if("fontbgcolor"==c&&(e.push(f[m].getAttribute("cellOrgBgColor")),DEXTTOP.DEXT5.browser.ie)){var t=colorToHex(d.fontcolor),q=colorToHex(f[m].style.backgroundColor);t==q&&(f[m].style.backgroundColor="")}execCommand(c,d);rangy.getSelection(_iframeWin).removeAllRanges()}a.removeAllRanges();if("fontbgcolor"==c)for(g=f.length,a=0;a<g;a++){var u=f[a];u.setAttribute("cellOrgBgColor",e[a]);u.style.backgroundColor=
ColorCellBackColor;u.setAttribute("dext_select","true")}var v=DrageEndCell.lastChild;try{for(;v;){if(3==v.nodeType){v=v.parentNode;break}else if(1==v.nodeType&&void 0!=v.tagName&&-1<",img,br,".indexOf(","+v.tagName.toLowerCase()+",")){v=v.parentNode;break}v=v.lastChild}doSetCaretPosition(v,1)}catch(w){doSetCaretPosition(DrageEndCell.childNodes[0],1)}!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=h&&1!=n||(DEXTTOP.G_CURREDITOR._LastRange=null)}}else{d.ignoreWhiteSpace=!0;rangy.queryCommandValue(c,
d);f=null;g="";try{if("fontbgcolor"==c){var y=b.commonAncestorContainer.parentNode;y&&1==y.nodeType&&(f=GetTDTHCell(y));f&&(g=f.style.backgroundColor)}}catch(x){f=null}if(!b.commonAncestorContainer.tagName||"BODY"!=b.commonAncestorContainer.tagName&&"DIV"!=b.commonAncestorContainer.tagName)execCommand(c,d,b);else try{var z=b.getNodes(),A=z.length;if(500<A){h=[];for(m=0;m<A;m++)if(3==z[m].nodeType){var B=z[m].parentNode;1==B.nodeType&&"BODY"!=B.tagName&&h.push(B)}for(m=0;m<h.length;m++)"fontcolor"==
c?h[m].style.color=e:"fontbgcolor"==c?h[m].style.backgroundColor=e:"lineheight"==c?h[m].style.lineHeight=e:"fontSize"==c?h[m].style.fontSize=e:"fontFamily"==c&&(h[m].style.fontFamily=e)}else execCommand(c,d,b)}catch(G){execCommand(c,d,b)}f&&(f.style.backgroundColor=g);DEXTTOP.DEXT5.browser.ie&&(9>DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)||a.removeAllRanges();a.addRange(b);!DEXTTOP.DEXT5.browser.ie||"fontFamily"!=c&&"fontSize"!=c||(DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID))}if(null==
DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(D){}}
function getSelectionTable(a){if(DEXTTOP.DEXT5.browser.ie&&!(11<DEXTTOP.DEXT5.browser.ieVersion)){a=getFirstRange().range;var b,c,d=a.collapsed,e;try{if(!d){b=_iframeDoc.createElement("span");b.style.display="none";b.innerHTML="&nbsp;";c=a.cloneRange();c.collapse();c.insertNode(b);var f;b&&(f=b.previousSibling);f&&1==f.nodeType&&"table"==f.tagName.toLowerCase()&&(e=f)}}catch(g){}b&&b.parentNode&&b.parentNode.removeChild(b);return e}}
function setBlockTag(a,b,c,d){for(var e="p li dt dd h1 h2 h3 h4 h5 h6 pre table hr blockquote address iframe figure".split(" "),f=["body","td","th","div"],g="b big i small tt abbr acronym cite code dfn em kbd strong samp var a bdo br img map object q script span sub sup button input label select textarea u s strike".split(" "),h=a.length,n=0;n<h;n++)if(a[n]){var m=a[n].tagName;m&&(m=m.toLowerCase());if(3!=a[n].nodeType||/\S/.test(a[n].nodeValue))if(3==a[n].nodeType||-1<g.indexOf(m)){for(var p=a[n];;){if(-1<
e.indexOf(p.parentNode.tagName.toLowerCase())){-1<b.indexOf(p.parentNode.tagName.toLowerCase())&&("lineHeight"==c?"span"==p.parentNode.tagName.toLowerCase()?""!=p.parentNode.style.lineHeight&&(p.parentNode.style.lineHeight=d):p.parentNode.style.lineHeight=d:"letterSpacing"==c?"span"==p.parentNode.tagName.toLowerCase()?""!=p.parentNode.style.letterSpacing&&(p.parentNode.style.letterSpacing=d):p.parentNode.style.letterSpacing=d:"align"==c?(""!=p.parentNode.style.layoutGridMode&&(p.parentNode.style.layoutGridMode=
"none"),p.parentNode.style.textAlign=d):"paragraphAttribute"==c&&(""!=d.marginLeft.toString()&&(p.parentNode.style.marginLeft=d.marginLeft+"px"),""!=d.marginRight.toString()&&(p.parentNode.style.marginRight=d.marginRight+"px"),""!=d.marginTop.toString()&&(p.parentNode.style.marginTop=d.marginTop+"px"),""!=d.marginBottom.toString()&&(p.parentNode.style.marginBottom=d.marginBottom+"px"),""!=d.letterSpacing.toString()&&(p.parentNode.style.letterSpacing=d.letterSpacing+"px"),""!=d.wordSpacing.toString()&&
(p.parentNode.style.wordSpacing=d.wordSpacing+"px"),""!=d.textIndent.toString()&&(p.parentNode.style.textIndent=d.textIndent+"px"),""!=d.fontSize.toString()&&(p.parentNode.style.fontSize=d.fontSize+"pt"),""!=d.fontFamily.toString()&&("default"==d.fontFamily?p.parentNode.style.fontFamily="":p.parentNode.style.fontFamily=d.fontFamily)));p=null;break}else if(-1<f.indexOf(p.parentNode.tagName.toLowerCase()))break;p=p.parentNode}if(p){for(var m=[p],t=p.previousSibling;;){try{if(null==t||-1<e.indexOf(t.tagName.toLowerCase())||
"div"==t.tagName.toLowerCase())break}catch(q){}m.unshift(t);t=t.previousSibling}for(p=p.nextSibling;;){try{if(null==p||-1<e.indexOf(p.tagName.toLowerCase())||"div"==p.tagName.toLowerCase())break}catch(u){}m.push(p);p=p.nextSibling}p=_iframeDoc.createElement("p");"lineHeight"==c?p.style.lineHeight=d:"letterSpacing"==c?p.style.letterSpacing=d:"align"==c?p.style.textAlign=d:"indent"==c?(t=parseIntOr0(p.style.marginLeft),0<t?p.style.marginLeft=t+d+"px":(t=parseIntOr0(p.style.paddingLeft),p.style.paddingLeft=
t+d+"px")):"paragraphAttribute"==c&&(""!=d.marginLeft.toString()&&(p.style.marginLeft=d.marginLeft+"px"),""!=d.marginRight.toString()&&(p.style.marginRight=d.marginRight+"px"),""!=d.marginTop.toString()&&(p.style.marginTop=d.marginTop+"px"),""!=d.marginBottom.toString()&&(p.style.marginBottom=d.marginBottom+"px"),""!=d.letterSpacing.toString()&&(p.style.letterSpacing=d.letterSpacing+"px"),""!=d.wordSpacing.toString()&&(p.style.wordSpacing=d.wordSpacing+"px"),""!=d.textIndent.toString()&&(p.style.textIndent=
d.textIndent+"px"),""!=d.fontSize.toString()&&(p.style.fontSize=d.fontSize+"pt"),""!=d.fontFamily.toString()&&("default"==d.fontFamily?p.style.fontFamily="":p.style.fontFamily=d.fontFamily));m[0].parentNode.insertBefore(p,m[0]);var t=m.length,v,w,y;if("lineHeight"==c||"align"==c||"letterSpacing"==c)try{v=getFirstRange(),w=v.range,y=v.sel}catch(x){}for(var z=0;z<t;z++)p.appendChild(m[z]);if("lineHeight"==c||"align"==c||"letterSpacing"==c)if(m=DEXTTOP.G_CURREDITOR.beforeOffset)try{var A=GetTableSelectionCells();
if(A&&0==A.length){var B,G,t=!0;"TD"==m[2].tagName?B=p:(B=m[2],t=!1);if("TD"==m[3].tagName){if(G=p,0==t){for(var t=B,D=t.parentNode;D!=p;)t=D,D=D.parentNode;G=t.nextSibling;for(var I=m[4],I=I-((B.innerText||B.textContent).length-m[0]),p=0;null!=G;){var K=(G.innerText||G.textContent).length;if(I<K){p=I;m[1]=p;break}else I-=K,G=G.nextSibling}}}else G=m[3];w.setStart(B.firstChild,m[0]);1==G.nodeType&&(G=G.firstChild);w.setEnd(G,m[1]);y.removeAllRanges();y.addRange(w);DEXTTOP.G_CURREDITOR._LastRange=
saveSelection(DEXTTOP.G_CURREDITOR.ID)}else DEXTTOP.G_CURREDITOR.beforeOffset=null}catch(E){}}}}}function GetParentbyTagName(a,b,c){null==a&&1==c&&(c=getFirstRange().range)&&c.startContainer&&(a=getMyElementNode(c.startContainer),a=GetTDTHCell(a),DEXTTOP.G_SELECTED_ELEMENT=a);for(;!(null==a||a.tagName&&a.tagName.toLowerCase()==b||a.tagName&&a.tagName.toLowerCase()==b&&null==a.parentNode);)a=a.parentNode;return a}
function _iframeDoc_DBClick(a){setDEXTWINDOC();var b=getEditrFromEvent(a);if(!isViewMode(b)){b=a?a:event;a=b.target?b.target:b.srcElement;if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var c=GetTDTHCell(a),d;c&&(d=GetParentbyTagName(a,"table"));var e=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;d&&d.getAttribute("lock_mode")&&""!=d.getAttribute("lock_mode")&&(e=d.getAttribute("lock_mode"));var f=!0;"1"==e&&(f=!1);if(c){if(f&&
checkLockAttr(d)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(a=findNoLockElem(d))?setFocusForLock(a):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(b);DEXTTOP.DEXT5.util.cancelEvent(b);return}if(checkLockAttr(c,!f)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):setFocusForLock(findNoLockCell(d));DEXTTOP.DEXT5.util.stopEvent(b);DEXTTOP.DEXT5.util.cancelEvent(b);return}}}if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=
!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("dblclick",b,a)}catch(g){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(b);return}}d=a.tagName.toLowerCase();"img"!=d&&"hr"!=d&&"a"!=d&&"input"!=d&&"textarea"!=d&&"select"!=d&&(b=GetParentbyTagName(a,"a"))&&(a=b,d=a.tagName.toLowerCase());switch(d){case "img":DEXTTOP.G_SELECTED_ELEMENT=a;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){d=!0;try{d=DEXTTOP.DEXTWIN.dext_editor_img_event(a,DEXTTOP.G_CURREDITOR.ID)}catch(h){}null!=d&&
void 0!=d&&0==d&&(d=!1);if(!d)break}setSelectoinElement(a);d=a.getAttribute("dext5customdata");if(null!=d&&void 0!=d)if(b=getDextCustomData(d),"iframe"==b.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.iframe);else if("flash"==b.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.flash);else if("media"==b.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.media);else if("link_media"==b.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.insert_link_media);else if("hidden"==b.type){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){d=!0;a={};a.type=b.type;a.id=b.id;a.name=b.name;a.value=b.value;a.className=b.className;a.title=b.title;try{d=DEXTTOP.DEXTWIN.dext_editor_input_event(a,DEXTTOP.G_CURREDITOR.ID)}catch(n){}null!=d&&void 0!=d&&0==d&&(d=!1);if(!d)break;
DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_hidden)}}else"video_media"==b.type&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.video);else!a.getAttribute("raon_chart")||"Windows"==DEXTTOP.DEXT5.UserAgent.os.name&&DEXTTOP.DEXT5.browser.safari||DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion?""==DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick||
a.className!=DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick&&a.alt!=DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick?G_dext5plugIn?showSetImageProperty(a):DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.image):command_custom(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick,a):DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.chart);
break;case "flash":DEXTTOP.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.flash);break;case "media":DEXTTOP.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.media);break;case "hr":DEXTTOP.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.horizontal_line);break;case "a":DEXTTOP.G_SELECTED_ELEMENT=a;setSelectoinElement(a);d=getFirstRange();d=d.range;b=getFirstRange().sel;b.removeAllRanges();d.selectNode(a);b.addRange(d);d=a.getAttribute("DEXT5InsertFile");""==DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick||a.className!=DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick&&a.title!=DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick?""==a.href&&a.name==a.id?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.bookmark):""==d?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.insert_file):DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.hyperlink):command_custom(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._config.customEventCmd.hyperLink.ondbclick,a);break;case "iframe":DEXTTOP.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.iframe);break;case "table":DEXTTOP.G_SELECTED_ELEMENT=a;if("1"==DEXTTOP.G_CURREDITOR._config.formMode||"1"!=DEXTTOP.G_CURREDITOR._config.userTableLock.use)d=getFirstRange(),(b=d.sel)&&b.docSelection&&"Control"==b.docSelection.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT):(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT));break;case "input":DEXTTOP.G_SELECTED_ELEMENT=a;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){d=!0;try{d=DEXTTOP.DEXTWIN.dext_editor_input_event(a,DEXTTOP.G_CURREDITOR.ID)}catch(m){}null!=d&&void 0!=d&&0==d&&(d=!1);if(!d)break}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(""==a.type||"text"==a.type||"password"==a.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_text):
"radio"==a.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_radio):"checkbox"==a.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_checkbox):"button"==a.type||"reset"==a.type||"submit"==a.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_button):"hidden"==a.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.input_hidden):"image"==a.type&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_image));break;case "select":DEXTTOP.G_SELECTED_ELEMENT=a;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){d=!0;try{d=DEXTTOP.DEXTWIN.dext_editor_select_event(a,DEXTTOP.G_CURREDITOR.ID)}catch(p){}null!=d&&void 0!=d&&0==d&&(d=!1);if(!d)break}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.input_select);break;case "textarea":DEXTTOP.G_SELECTED_ELEMENT=a;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){d=!0;try{d=DEXTTOP.DEXTWIN.dext_editor_textarea_event(a,DEXTTOP.G_CURREDITOR.ID)}catch(t){}null!=d&&void 0!=d&&0==d&&(d=!1);if(!d)break}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_textarea)}}}
function setSelectoinElement(a){var b=getFirstRange().range;if(b)if(""==b.toString()&&a){var c=getFirstRange().sel;c.removeAllRanges();b.selectNode(a);c.addRange(b)}else rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)}
function _iframeBody_Click(a){setDEXTWINDOC();var b=DEXTTOP.G_CURREDITOR.ID,c=getEditrFromEvent(a);b!=c.ID&&(DEXTTOP.G_CURREDITOR=c);if(!checkDefaultMessage(a)){var d,e;try{e=a?a:event,e.srcElement?d=e.srcElement:e.target&&(d=e.target)}catch(f){setFocusToBody();return}if(isViewMode(c)&&d){if("a"!=d.tagName.toLowerCase()&&(d=GetParentbyTagName(d,"a")),d&&d.getAttribute("href")&&!(-1<d.getAttribute("href").indexOf("#")))if(G_FIRST_CLICK_EVENT)G_FIRST_CLICK_EVENT=!1;else{G_FIRST_CLICK_EVENT=!0;var g=
d.getAttribute("target");d.setAttribute("target","_blank");setTimeout(function(){g&&""!=g?d.setAttribute("target",g):d.removeAttribute("target")},1)}}else{if(d.tagName&&"INPUT"==d.tagName&&(b=!1,DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari?b=!0:0==d.isContentEditable&&(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.gecko)&&(b=!0),b&&(b=null,b=a?a:_iframeWin.event,b=b.target?b.target:b.srcElement,"checkbox"==b.type.toLowerCase()||
"radio"==b.type.toLowerCase())))if(1==b.checked){if("radio"==b.type.toLowerCase())for(var h=_iframeDoc.getElementsByName(b.name),n=h.length,m=0;m<n;m++)h[m].checked=!1,h[m].removeAttribute("checked");b.checked=!0;b.setAttribute("checked","checked")}else b.checked=!1,b.removeAttribute("checked");if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var b=GetTDTHCell(d),p;b&&(p=GetParentbyTagName(d,"table"));h=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;
p&&p.getAttribute("lock_mode")&&""!=p.getAttribute("lock_mode")&&(h=p.getAttribute("lock_mode"));n=!0;"1"==h&&(n=!1);if(b){if(n&&checkLockAttr(p)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(a=findNoLockElem(p))?setFocusForLock(a):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(e);DEXTTOP.DEXT5.util.cancelEvent(e);return}if(checkLockAttr(b,!n)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):
setFocusForLock(findNoLockCell(p));DEXTTOP.DEXT5.util.stopEvent(e);DEXTTOP.DEXT5.util.cancelEvent(e);return}c.lastElemForLock=b}}if("1"==c._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("click",e,d)}catch(t){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(e);return}}if((e=d.tagName?d.tagName.toLowerCase():null)&&("textarea"==e||"input"==e||"select"==e||"div"==e))return!1;if(DEXTTOP.DEXT5.browser.ie&&7==DEXTTOP.DEXT5.browser.ieVersion)try{var q=
getFirstRange().range;q&&q.startContainer&&(d=getMyElementNode(q.startContainer));if(void 0==d)return}catch(u){return}e=d.tagName.toLowerCase();try{if("html"==e||"body"==e){p=!1;500>a.clientX&&10>a.clientY&&(p=!0);repairBodyFirstLastTag(p);if(DEXTTOP.DEXT5.browser.ie&&0==DEXTTOP.DEXT5.browser.quirks&&7!=DEXTTOP.DEXT5.browser.ieVersion){if((q=getFirstRange().range)&&0==q.toString().length&&_iframeDoc.body.createTextRange){var q=_iframeDoc.body.createTextRange(),v=a.clientX,w=a.clientY;"None"==c._setting.doctype&&
(v<q.boundingLeft&&(v=q.boundingLeft),"html"==e&&w>q.boundingHeight-(q.offsetTop-q.boundingTop)&&("None"!=c._setting.doctype&&(v=q.boundingWidth+q.boundingLeft),w=q.boundingHeight-(q.offsetTop-q.boundingTop),"None"==c._setting.doctype&&--w));q.moveToPoint(v,w);q.select()}setFocusToBody()}else if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){var y=getFirstRange().range;if(0==y.toString().length){c=null;try{createSelectionFromPoint(a.clientX,a.clientY,a.clientX,a.clientY),setFocusToBody(),
y=getFirstRange().range,c=_iframeDoc.createElement("dexttemp"),y.insertNode(c),null!=c.nextSibling&&doSetCaretPosition(c.nextSibling,!1)}catch(x){}c&&c.parentNode.removeChild(c)}}else setFocusToBody();if((d=getFirstRange().sel.focusNode)&&3==d.nodeType)for(;1!=d.nodeType;)if(d.parentNode)d=d.parentNode;else break;else(q=getFirstRange().range)&&q.startContainer==q.endContainer&&1==q.collapsed&&(d=getMyElementNode(q.startContainer));setMenuIconRealable(d)}else setTimeout(function(){if((d=getFirstRange().sel.focusNode)&&
3==d.nodeType)for(;1!=d.nodeType;)if(d.parentNode)d=d.parentNode;else break;else{var a=getFirstRange().range;a&&a.startContainer==a.endContainer&&1==a.collapsed&&(d=getMyElementNode(a.startContainer))}setMenuIconRealable(d)},0)}catch(z){}}}}
function createCollapsedRangeFromPoint(a,b){var c=_iframeDoc,d,e=null;if("undefined"!=typeof c.body.createTextRange)e=c.body.createTextRange(),e.moveToPoint(a,b);else if("undefined"!=typeof c.caretPositionFromPoint)d=c.caretPositionFromPoint(a,b),e=c.createRange(),e.setStart(d.offsetNode,d.offset),e.collapse(!0);else if("undefined"!=typeof c.caretRangeFromPoint)c.caretRangeFromPoint(a,b);else return e}
function createSelectionFromPoint(a,b,c,d){var e=_iframeDoc,f,g,h=null;"undefined"!=typeof e.caretPositionFromPoint?(f=e.caretPositionFromPoint(a,b),g=e.caretPositionFromPoint(c,d),h=e.createRange(),h.setStart(f.offsetNode,f.offset),h.setEnd(g.offsetNode,g.offset)):"undefined"!=typeof e.caretRangeFromPoint&&(f=e.caretRangeFromPoint(a,b),g=e.caretRangeFromPoint(c,d),h=e.createRange(),h.setStart(f.startContainer,f.startOffset),h.setEnd(g.startContainer,g.startOffset));null!==h&&"undefined"!=typeof _iframeWin.getSelection?
(c=_iframeWin.getSelection(),c.removeAllRanges(),c.addRange(h)):"undefined"!=typeof e.body.createTextRange&&(h=e.body.createTextRange(),h.moveToPoint(a,b),a=h.duplicate(),a.moveToPoint(c,d),h.setEndPoint("EndToEnd",a),h.select())}
function insertPtagTableNear(a,b){var c=getFirstRange().range;if(c&&b){c.selectNode(b);a?(c.setStartBefore(b),c.collapse(!0)):(c.setEndAfter(b),c.collapse(!1));var d=_iframeDoc.createElement("p");DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(d.innerHTML=getDefaultParagraphValue(!1));c.insertNode(d);doSetCaretPosition(d,0)}}
function moveCaret(a){var b;if(_iframeWin.getSelection){if(b=_iframeWin.getSelection(),0<b.rangeCount){var c=b.focusNode;b.collapse(c,Math.min(c.length,b.focusOffset+a))}}else(b=_iframeDoc.selection)&&"Control"!=b.type&&(b=b.createRange(),b.move("character",a),b.select())}
function setMenuIconRealable(a){if(null!=a&&void 0!=a){if("body"==a.tagName.toLowerCase()){var b=getSelectionTable(DEXTTOP.G_CURREDITOR);b&&(a=b)}var c=getElementInParentTag(a,G_FORMATTING),d="";try{d=getFontStyle(a).fontFamily}catch(e){d=getElementInParentStyleProperty(a,"fontFamily")}var f=getElementInParentStyleProperty(a,"fontSize"),g=getElementInParentStyleProperty(a,"lineHeight");"1"!=DEXTTOP.G_CURREDITOR._config.lineHeightMode&&(d=getFontFamilyStyle(d),""==f&&(f=DEXTTOP.DEXT5.util.getStyle(a,
"fontSize")),""==g&&(g=DEXTTOP.DEXT5.util.getStyle(a,"lineHeight")),f=getFontSizeStyle(f,g),g=getLineHeightStyle(f,g,a),-1<g.toString().indexOf("normal")||-1<g.toString().indexOf("inherit"))&&(g=dext5_lang.icon.line_height);b=getElementInParentStyleProperty(a,"letterSpacing");""==b&&(b=dext5_lang.icon.letter_spacing);if("0"==DEXTTOP.G_CURREDITOR._setting.show_font_real)f==DEXTTOP.G_CURREDITOR._setting.font_size&&(f=dext5_lang.icon.font_size),d==DEXTTOP.G_CURREDITOR._setting.font_family&&(d=dext5_lang.icon.font_family),
""==f&&(f=dext5_lang.icon.font_size),""==d&&(d=dext5_lang.icon.font_family),""==g&&(g=dext5_lang.icon.line_height);else{var h,n,m;if(""==f||""==d||""==g)n=getFontStyle(a),h=n.fontFamily,m=n.lineHeight,n=getFontStyle(a,!0),n=n.fontSize;""==f&&(f=""!=n&&void 0!=n?n:dext5_lang.icon.font_size);""==d&&(d=""!=h?h:dext5_lang.icon.font_family);""==g&&(g=m&&""!=m&&"normal"!=m?m:dext5_lang.icon.line_height);if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion){try{g=
g.toString()}catch(p){g=""}try{if(h=!1,0>g.indexOf("%")&&0>g.indexOf("px")&&0>g.indexOf("pt")&&0>g.indexOf("em")&&(h=!0),"1"!=DEXTTOP.G_CURREDITOR._config.lineHeightMode)if(h)t=DEXTTOP.G_CURREDITOR._setting.line_height,q="",-1<t.indexOf("%")?q=parseInt(t,10)/100+.01:0>t.indexOf("px")&&0>t.indexOf("pt")&&0>t.indexOf("em")&&(q=parseFloat(t)+.01),q=q.toString(),g==q&&(-1<t.indexOf("%")?g=parseFloat(t)/100:0>t.indexOf("px")&&0>t.indexOf("pt")&&0>t.indexOf("em")&&(g=t));else{if(-1<g.indexOf("%")){var t=
DEXTTOP.G_CURREDITOR._setting.line_height,q="";-1<t.indexOf("%")?q=parseInt(t,10)+1:0>t.indexOf("px")&&0>t.indexOf("pt")&&0>t.indexOf("em")&&(q=100*parseFloat(t)+1);q=q.toString();g==q+"%"&&(-1<t.indexOf("%")?g=t+"%":0>t.indexOf("px")&&0>t.indexOf("pt")&&0>t.indexOf("em")&&(g=100*parseFloat(t)+"%"))}}else t=DEXTTOP.G_CURREDITOR._setting.line_height,q="",-1<t.indexOf("%")?q=parseInt(t,10)/100+.01:0>t.indexOf("px")&&0>t.indexOf("pt")&&0>t.indexOf("em")&&(q=parseFloat(t)+.01),q=q.toString(),g==q&&(g=
100*parseFloat(t)+"%")}catch(u){}}}""==c&&(c=dext5_lang.icon.formatting);if(t=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"formatting"))t.innerHTML="<span>"+c+"</span>";c=null;if("1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin){if(c=document.getElementById("txtara_"+DEXTTOP.G_CURREDITOR.ID+"line_height"))c.value=g}else if(c=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"line_height"))c.innerHTML="<span>"+g+"</span>";g=null;if(g="1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?
document.getElementById("txtara_"+DEXTTOP.G_CURREDITOR.ID+"font_size"):document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"font_size")){try{if(-1<f.indexOf(".")){c="";-1<f.indexOf("px")||-1<f.indexOf("pt")||-1<f.indexOf("em")?c=f.substring(f.length-2):-1<f.indexOf("%")&&(c=f.substring(f.length-1));var v=parseFloat(f),v=Math.round(v),f=v+c}}catch(w){}"1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?g.value=f:g.innerHTML="<span>"+f+"</span>"}v=null;if("1"==DEXTTOP.G_CURREDITOR._config.useFontFamilyKeyin){if(v=
document.getElementById("txtara_"+DEXTTOP.G_CURREDITOR.ID+"font_family"))v.value=d}else if(v=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"font_family"))v.innerHTML="<span>"+d+"</span>";if(d=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"letter_spacing"))d.innerHTML="<span>"+b+"</span>";b=[];""!=getElementInParentTag(a,["b","strong"])&&b.push("bold");""!=getElementInParentTag(a,["em","i"])&&b.push("italic");""!=getElementInParentTag(a,["u"])&&b.push("underline");""!=getElementInParentTag(a,
["strike"])&&b.push("strike_through");""!=getElementInParentTag(a,["sup"])&&b.push("superscript");""!=getElementInParentTag(a,["sub"])&&b.push("subscript");""!=getElementInParentTag(a,["ol"])&&b.push("list_number");""!=getElementInParentTag(a,["ul"])&&b.push("list_bullets");var y;DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&(y=GetParentbyTagName(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem,"figure"));if("table"==a.tagName.toLowerCase()){if(y=
a.getAttribute("align"),null==y||""==y)y="justify"}else y?(y="cssFloat"in y.style?y.style.cssFloat:y.style.styleFloat,""==y&&(y=DEXTTOP.DEXT5.util.getStyle(a,"textAlign"),""==y&&(y=getElementInParentProperty(a,"align")))):(y=DEXTTOP.DEXT5.util.getStyle(a,"textAlign"),""==y&&(y=getElementInParentProperty(a,"align")));"left"==y&&b.push("align_left");"center"==y&&b.push("align_center");"right"==y&&b.push("align_right");"justify"==y&&b.push("align_full");y=getElementInParentProperty(a,"dir").toLowerCase();
"rtl"==y&&b.push("dirrtl");"ltr"==y&&b.push("dirltr");try{null==DrageEndCell&&""==getElementInParentTag(a,"h1 h2 h3 h4 h5 h6".split(" "))&&(_iframeDoc.queryCommandState("bold")?b.push("bold"):removeArrayItemByValue(b,"bold"))}catch(x){removeArrayItemByValue(b,"bold")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("italic")?b.push("italic"):removeArrayItemByValue(b,"italic"))}catch(z){removeArrayItemByValue(b,"italic")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("underline")?b.push("underline"):
removeArrayItemByValue(b,"underline"))}catch(A){removeArrayItemByValue(b,"underline")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("strikeThrough")?b.push("strike_through"):removeArrayItemByValue(b,"strike_through"))}catch(B){removeArrayItemByValue(b,"strike_through")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("superscript")?b.push("superscript"):removeArrayItemByValue(b,"superscript"))}catch(G){removeArrayItemByValue(b,"superscript")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("subscript")?
b.push("subscript"):removeArrayItemByValue(b,"subscript"))}catch(D){removeArrayItemByValue(b,"subscript")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("insertOrderedList")?b.push("list_number"):removeArrayItemByValue(b,"list_number"))}catch(I){removeArrayItemByValue(b,"list_number")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("insertUnOrderedList")?b.push("list_bullets"):removeArrayItemByValue(b,"list_bullets"))}catch(K){removeArrayItemByValue(b,"list_bullets")}"full_size"==DEXTTOP.G_CURREDITOR.FrameStatus?
b.push("full_screen"):removeArrayItemByValue(b,"full_screen");"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks?b.push("show_blocks"):removeArrayItemByValue(b,"show_blocks");1==DEXTTOP.G_CURREDITOR.ShowTableBorder?b.push("table_border"):removeArrayItemByValue(b,"table_border");y=GetTDTHCell(a);checkLockAttr(y,!0)?b.push("cell_lock"):removeArrayItemByValue(b,"cell_lock");a=GetParentbyTagName(a,"table");checkLockAttr(a,!0)?b.push("table_lock"):removeArrayItemByValue(b,"table_lock");DEXTTOP.G_CURREDITOR._iconSelected(b)}}
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;b<c;){if(this[b]===a)return b;++b}return-1});function removeArrayItemByValue(a){for(var b,c=arguments,d=c.length,e;1<d&&a.length;)for(b=c[--d];-1!==(e=a.indexOf(b));)a.splice(e,1)}
function dialogCancel(){var a=getEditrFromEvent(null);"shortcut"==G_LAST_CMD&&G_ShortCutClick?(G_ShortCutClose=!0,G_ShortCutClick=!1,0==DEXTTOP.DEXT5.browser.ie&&window.focus(),document.getElementById("ue_"+a.ID+"shortcut").focus()):((a._LastRange||void 0!=a._LastRange)&&restoreSelection(a._LastRange),setFocusToBody())}
function RepaireTagInTag(a,b){for(var c=_iframeDoc.body.getElementsByTagName(b),d=c.length,e=null,f=0;f<d;f++){var e=c[f],g=GetParentbyTagName(e,a);g&&(g.removeChild(e),e=getFirstRange().range)&&(e.selectNode(g),e.setStartBefore(g),e.collapse(!0),g=_iframeDoc.createElement("hr"),e.insertNode(g),e.selectNode(g),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges())}}
function doSetCaretPosition(a,b){try{if((0!=DEXTTOP.G_CURREDITOR._config.initFocus||!DEXTTOP.G_CURREDITOR.isInitFocusHandler)&&"view"!=DEXTTOP.G_CURREDITOR._config.mode){var c=!0;0<b&&(c=!1);moveCursorToTag(a,c);setFocusToBody()}}catch(d){}}function setFocusTopWindow(){try{DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXTWIN.focus(),DEXTTOP.DEXTDOC.body.focus()}catch(a){}}
function setDextCustomData(a,b){b.keyid=getNextNumber();a.setAttribute("dext5customdata",b.keyid);DEXTTOP.G_CURREDITOR._dextCustomData.push(b);return b.keyid}function getDextCustomData(a){for(var b=DEXTTOP.G_CURREDITOR._dextCustomData.length,c=0;c<b;c++)if(DEXTTOP.G_CURREDITOR._dextCustomData[c].keyid==a)return DEXTTOP.G_CURREDITOR._dextCustomData[c];return null}
function removeDextCustomData(a){for(var b=DEXTTOP.G_CURREDITOR._dextCustomData.length,c=0;c<b;c++)DEXTTOP.G_CURREDITOR._dextCustomData[c].keyid===a&&DEXTTOP.G_CURREDITOR._dextCustomData.splice(c,1)}function removeAllDextCustomData(){DEXTTOP.G_CURREDITOR._dextCustomData=[]}var getNextNumber=function(){var a=0;return function(){return++a+""}}();
function isSameCustomData(a){for(var b=DEXTTOP.G_CURREDITOR._dextCustomData.length,c=0;c<b;c++)if(DEXTTOP.G_CURREDITOR._dextCustomData[c].keyid===a)return DEXTTOP.G_CURREDITOR._dextCustomData[c];return null}
function ReplaceImageToRealObject(a,b){if((0!=!!b||"0"!=DEXTTOP.G_CURREDITOR._config.useReplaceImage)&&1!=DEXTTOP.G_CURREDITOR._dextCustomDataMode){DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0;displayPageBreak(!1);for(var c=_iframeDoc.getElementsByTagName("img"),d=c.length-1;0<=d;d--){var e=c[d],f=e.getAttribute("dext5customdata");if(null!=f&&void 0!=f&&(f=getDextCustomData(f)))if("iframe"==f.type||"iframe"==f.type2){var g=_iframeDoc.createElement("iframe");if("undefined"!=typeof f.attributes)for(var h=
",src,id,name,title,class,width,height,align,scrolling,frameborder,caption,",n=f.attributes.length,m=0;m<n;m++){var p=f.attributes[m];p.specified&&0>h.indexOf(","+p.name.toLowerCase()+",")&&("style"==p.name.toLowerCase()?g.style.cssText=p.value:g.setAttribute(p.name,p.value))}g.width=""==e.style.width&&0==parseIntOr0(e.style.width)?e.width:e.style.width;g.height=""==e.style.height&&0==parseIntOr0(e.style.height)?e.height:e.style.height;""!=g.style.width&&(g.style.width=g.width+"px");""!=g.style.height&&
(g.style.height=g.height+"px");-1<f.src.indexOf("dext5player/media_player")?(m=f.src.lastIndexOf("&"),m=f.src.substring(0,m),m+="&size="+parseIntOr0(g.width)+"^"+parseIntOr0(g.height),g.src=m):g.src=f.src;g.id=f.id;g.name=f.name;g.title=f.title;g.className=f.className;null!=e.align&&void 0!=e.align&&(f.align=e.align);g.align=f.align;g.scrolling=f.scrolling;g.frameBorder=f.frameBorder?1:0;f.caption&&""!=f.caption&&g.setAttribute("DEXT_fiVe_Media_Caption",f.caption);g.style.position=e.style.position;
g.style.left=e.style.left;g.style.top=e.style.top;e.parentNode.replaceChild(g,e)}else if("flash"==f.type||"flash"==f.type2){g=_iframeDoc.createElement("div");m="";m+="<embed src='"+f.src+"'";""!=f.hspace&&(m+=" hspace='"+f.hspace+"px'");""!=f.vspace&&(m+=" vspace='"+f.vspace+"px'");""!=f.scale&&(m+=" scale='"+f.scale+"'");""!=f.allowScriptAccess&&(m+=" allowScriptAccess='"+f.allowScriptAccess+"'");""!=f.quality&&(m+=" quality='"+f.quality+"'");""!=f.align&&(m+=" align='"+f.align+"'");m=0==f.menu?
m+" menu='false'":m+" menu='true'";m=0==f.play?m+" play='false'":m+" play='true'";m=0==f.loop?m+" loop='false'":m+" loop='true'";m=0==f.allowFullScreen?m+" allowFullScreen='false'":m+" allowFullScreen='true'";f.flashvars&&""!=f.flashvars&&(m+=" flashvars='"+f.flashvars+"'");f.caption&&""!=f.caption&&(m+=" DEXT_fiVe_Media_Caption='"+f.caption+"'");0>f.src.indexOf("dext5player/")&&(m+=' wmode="transparent"');m+=" pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' />";
g.innerHTML=m;g=g.firstChild;if("undefined"!=typeof f.attributes)for(h=",src,width,height,hspace,vspace,marginLeft,marginright,marginTop,marginbottom,scale,allowscriptaccess,quality,menu,play,loop,allowfullscreen,flashvars,caption,",n=f.attributes.length,m=0;m<n;m++)p=f.attributes[m],p.specified&&0>h.indexOf(","+p.name.toLowerCase()+",")&&("style"==p.name.toLowerCase()?g.style.cssText=p.value:"class"==p.name.toLowerCase()?g.className=p.value:g.setAttribute(p.name,p.value));g.style.marginLeft=e.style.marginLeft;
g.style.marginRight=e.style.marginRight;g.style.marginTop=e.style.marginTop;g.style.marginBottom=e.style.marginBottom;g.style.width=""==e.style.width&&0==parseIntOr0(e.style.width)?e.width+"px":e.style.width;g.style.height=""==e.style.height&&0==parseIntOr0(e.style.height)?e.height+"px":e.style.height;g.style.position=e.style.position;g.style.left=e.style.left;g.style.top=e.style.top;e.parentNode.replaceChild(g,e)}else if("media"==f.type){g=_iframeDoc.createElement("div");h="";h+="<embed style='width:"+
f.width+"px; height:"+f.height+"px;' ";h+=" type='application/x-mplayer2'";h+=" pluginspage='http://www.microsoft.com/windows/windowsmedia/download/' ";h+=" src='"+f.src+"'";m=1==f.autoStart?"1":"0";h+=" AutoStart='"+m+"'";m=1==f.playCount?"1":"0";h+=" loop='"+m+"'";m=1==f.showTracker?"1":"0";h+=" ShowTracker='"+m+"'";m=1==f.showStatusBar?"1":"0";h+=" ShowStatusBar='"+m+"'";m=1==f.showControls?"1":"0";h+=" ShowControls='"+m+"'";m=1==f.showAudioControls?"1":"0";h+=" ShowAudioControls='"+m+"'";m=1==
f.showDisplay?"1":"0";h+=" ShowDisplay='"+m+"'";m=1==f.showPositionControls?"1":"0";h+=" ShowPositionControls='"+m+"'";h+=" />";g.innerHTML=h;var t=g.firstChild;if("undefined"!=typeof f.attributes)for(h=",src,width,height,autostart,playcount,showtracker,showstatusbar,showcontrols,showaudiocontrols,showdisplay,showpositioncontrols,",n=f.attributes.length,m=0;m<n;m++)p=f.attributes[m],p.specified&&0>h.indexOf(","+p.name.toLowerCase()+",")&&("style"==p.name.toLowerCase()?t.style.cssText=p.value:"class"==
p.name.toLowerCase()?t.className=p.value:t.setAttribute(p.name,p.value));t.style.width=""==e.style.width&&0==parseIntOr0(e.style.width)?e.width:e.style.width;t.style.height=""==e.style.height&&0==parseIntOr0(e.style.height)?e.height:e.style.height;t.style.position=e.style.position;t.style.left=e.style.left;t.style.top=e.style.top;e.parentNode.replaceChild(t,e);g.innerHTML=""}else if("hidden"==f.type){g=_iframeDoc.createElement("input");if("undefined"!=typeof f.attributes)for(h=",id,name,value,class,title,",
n=f.attributes.length,m=0;m<n;m++)p=f.attributes[m],p.specified&&0>h.indexOf(","+p.name.toLowerCase()+",")&&("style"==p.name.toLowerCase()?g.style.cssText=p.value:g.setAttribute(p.name,p.value));g.type=f.type;g.id=f.id;g.name=f.name;g.value=f.value;g.className=f.className;g.title=f.title;e.parentNode.replaceChild(g,e)}else if("video_media"==f.type){g=_iframeDoc.createElement("div");h="";h+="<video style='width:"+f.width+"px; height:"+f.height+"px;'";1==f.autoPlay&&(h+=" autoplay=''");1==f.loop&&(h+=
" loop=''");1==f.controls&&(h+=" controls=''");1==f.muted&&(h+=" muted=''");h+=">";n=f.src;m=!1;0<=n.indexOf("|")&&(m=!0);n=n.split("|");p="";if(m)for(m=0;m<n.length;m++)""!=n[m]&&null!=n[m]&&void 0!=n[m]&&(p=n[m].slice(n[m].lastIndexOf(".")+1),"ogv"==p&&(p="ogg"),h+="<source src='"+n[m]+"' type='video/"+p+"' />");else h+="<source src='"+n[0].slice(0,n[0].lastIndexOf("."))+".mp4' type='video/mp4' />",h+="<source src='"+n[0].slice(0,n[0].lastIndexOf("."))+".ogv' type='video/ogg' />",h+="<source src='"+
n[0].slice(0,n[0].lastIndexOf("."))+".webm' type='video/webm' />",h+="HTML5 Video\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ube0c\ub77c\uc6b0\uc800";h+="</video>";g.innerHTML=h;t=g.firstChild;if("undefined"!=typeof f.attributes)for(h=",src,width,height,autoplay,loop,controls,muted,",n=f.attributes.length,m=0;m<n;m++)p=f.attributes[m],p.specified&&0>h.indexOf(","+p.name.toLowerCase()+",")&&("style"==p.name.toLowerCase()?t.style.cssText=p.value:"class"==p.name.toLowerCase()?t.className=p.value:t.setAttribute(p.name,
p.value));t.style.width=""==e.style.width&&0==parseIntOr0(e.style.width)?e.width:e.style.width;t.style.height=""==e.style.height&&0==parseIntOr0(e.style.height)?e.height:e.style.height;t.style.position=e.style.position;t.style.left=e.style.left;t.style.top=e.style.top;e.parentNode.replaceChild(t,e);g.innerHTML=""}}}}
function ReplaceRealObjectToImage(a){if("0"!=DEXTTOP.G_CURREDITOR._config.useReplaceImage&&0!=DEXTTOP.G_CURREDITOR._dextCustomDataMode){DEXTTOP.G_CURREDITOR._dextCustomDataMode=!1;0!=a&&removeAllDextCustomData();displayPageBreak(!0);var b=_iframeDoc.getElementsByTagName("iframe");for(a=b.length-1;0<=a;a--){var c=b[a],d={},e=getLinkMediaType(c.src);d.type=""==e?"iframe":e;d.type2="iframe";d.src=c.getAttribute("src");try{d.src||(d.src=""),c.src=""}catch(f){}d.id=c.id;d.name=c.name;d.title=c.title;d.className=
c.className;d.width=""==c.style.width&&0==parseIntOr0(c.style.width)?c.width:c.style.width;d.height=""==c.style.height&&0==parseIntOr0(c.style.height)?c.height:c.style.height;d.align=c.align;d.scrolling=c.scrolling;d.frameBorder="1"==c.frameBorder?!0:!1;c.getAttribute("DEXT_fiVe_Media_Caption")&&(d.caption=c.getAttribute("DEXT_fiVe_Media_Caption"));d.attributes=c.attributes;d=makeImageElementForObject(d);d.style.position=c.style.position;d.style.left=c.style.left;d.style.top=c.style.top;c.parentNode.replaceChild(d,
c)}b=_iframeDoc.getElementsByTagName("embed");for(a=b.length-1;0<=a;a--){c=b[a];d=c.getAttribute("type");if(void 0==d||null==d)d="";e=c.getAttribute("pluginspage");if(void 0==e||null==e)e="";if(c.getAttribute("wmode")||-1<d.indexOf("x-shockwave-flash")||-1<c.src.indexOf("dext5player/")){d={};e=getLinkMediaType(c.src);d.type=""==e?"flash":e;d.type2="flash";d.src=c.getAttribute("src");try{c.src=""}catch(g){}d.width=""==c.style.width&&0==parseIntOr0(c.style.width)?c.width:c.style.width;d.height=""==
c.style.height&&0==parseIntOr0(c.style.height)?c.height:c.style.height;d.hspace=null==c.getAttribute("hspace")?"":c.getAttribute("hspace").replace("px","");d.vspace=null==c.getAttribute("vspace")?"":c.getAttribute("vspace").replace("px","");d.scale=null==c.getAttribute("scale")?"":c.getAttribute("scale");d.allowScriptAccess=null==c.getAttribute("allowScriptAccess")?"":c.getAttribute("allowscriptaccess");d.quality=null==c.getAttribute("quality")?"":c.getAttribute("quality");d.align=null==c.getAttribute("align")?
"":c.getAttribute("align");d.margin_left=c.style.marginLeft;d.margin_right=c.style.marginRight;d.margin_top=c.style.marginTop;d.margin_bottom=c.style.marginBottom;null==c.getAttribute("menu")?d.menu=!0:d.menu=c.getAttribute("menu");null==c.getAttribute("play")?d.play=!0:d.play=c.getAttribute("play");null==c.getAttribute("loop")?d.loop=!0:d.loop=c.getAttribute("loop");null==c.getAttribute("allowFullScreen")?d.allowFullScreen=!0:d.allowFullScreen=c.getAttribute("allowFullScreen");null==c.getAttribute("DEXT_fiVe_Media_Caption")?
d.caption="":d.caption=c.getAttribute("DEXT_fiVe_Media_Caption");c.getAttribute("flashvars")&&(d.flashvars=c.getAttribute("flashvars"));d.attributes=c.attributes;d=makeImageElementForObject(d);d.style.position=c.style.position;d.style.left=c.style.left;d.style.top=c.style.top;c.parentNode.replaceChild(d,c)}else if(c.getAttribute("AutoStart")||-1<d.indexOf("application/")||-1<e.indexOf("windowsmedia")){d={type:"media"};d.src=c.getAttribute("src");try{c.src=""}catch(h){}d.width=""==c.style.width&&0==
parseIntOr0(c.style.width)?c.width:c.style.width;d.height=""==c.style.height&&0==parseIntOr0(c.style.height)?c.height:c.style.height;1==c.getAttribute("AutoStart")?d.autoStart=!0:d.autoStart=!1;1==c.getAttribute("loop")?d.playCount=!0:d.playCount=!1;1==c.getAttribute("ShowTracker")?d.showTracker=!0:d.showTracker=!1;1==c.getAttribute("ShowStatusBar")?d.showStatusBar=!0:d.showStatusBar=!1;1==c.getAttribute("ShowControls")?d.showControls=!0:d.showControls=!1;1==c.getAttribute("ShowAudioControls")?d.showAudioControls=
!0:d.showAudioControls=!1;1==c.getAttribute("ShowDisplay")?d.showDisplay=!0:d.showDisplay=!1;1==c.getAttribute("ShowPositionControls")?d.showPositionControls=!0:d.showPositionControls=!1;d.attributes=c.attributes;d=makeImageElementForObject(d);d.style.position=c.style.position;d.style.left=c.style.left;d.style.top=c.style.top;c.parentNode.replaceChild(d,c)}}b=_iframeDoc.getElementsByTagName("input");for(a=b.length-1;0<=a;a--)c=b[a],"hidden"==c.type&&(d={type:"hidden"},d.id=c.id,d.name=c.name,d.value=
c.value,d.className=c.className,d.title=c.title,d.attributes=c.attributes,d=makeImageElementForObject(d),c.parentNode.replaceChild(d,c));b=_iframeDoc.getElementsByTagName("video");for(a=b.length-1;0<=a;a--){for(var c=b[a],d={type:"video_media"},e="",n=c.getElementsByTagName("source"),m=0;m<n.length;m++)e+=n[m].getAttribute("src")+"|";d.src=e;try{for(m=0;m<n.length;m++)n[m]&&(n[m].src="")}catch(p){}d.width=""==c.style.width&&0==parseIntOr0(c.style.width)?c.width:c.style.width;d.height=""==c.style.height&&
0==parseIntOr0(c.style.height)?c.height:c.style.height;d.autoPlay=null==c.getAttribute("autoplay")?!1:!0;d.loop=null==c.getAttribute("loop")?!1:!0;d.controls=null==c.getAttribute("controls")?!1:!0;d.muted=null==c.getAttribute("muted")?!1:!0;d.attributes=c.attributes;d=makeImageElementForObject(d);d.style.position=c.style.position;d.style.left=c.style.left;d.style.top=c.style.top;c.parentNode.replaceChild(d,c)}}}
function ReplaceBase64ImageToArray(a,b){if("html5"==a.runtimes&&"base64"==a.uploadMethod)try{var c=b.getElementsByTagName("img");if(c&&0<c.length){G_ImagesBase64Data=[];for(var d=0,e=c.length;d<e;d++)G_ImagesBase64Data.push(c[d].src),c[d].src="DEXT5ImagesBase64Data_"+d.toString()}}catch(f){}}
function ReplaceArrayToBase64Image(a,b,c){var d=c;if("html5"==a.runtimes&&"base64"==a.uploadMethod){try{var e=b.getElementsByTagName("img");if(e&&0<e.length){a=0;for(var f=e.length;a<f;a++)e[a].src=G_ImagesBase64Data[a],d=d.replace("DEXT5ImagesBase64Data_"+a,G_ImagesBase64Data[a])}}catch(g){d=c}G_ImagesBase64Data=[]}return d}
function FixFlashError(){var a=DEXTTOP.G_CURREDITOR;if(null!=a){var b;if(b=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document){for(var c=b.getElementsByTagName("iframe"),a=c.length-1;0<=a;a--){var d=c[a];try{d.src="",d.parentNode.removeChild(d)}catch(e){}}b=b.getElementsByTagName("embed");for(a=b.length-1;0<=a;a--){c=b[a];try{c.src="",c.parentNode.removeChild(c)}catch(f){}}}}}
function FixFlashError2(a){if(a){for(var b=a.getElementsByTagName("iframe"),c=b.length-1;0<=c;c--){var d=b[c];try{d.src="",d.parentNode.removeChild(d)}catch(e){}}a=a.getElementsByTagName("embed");for(c=a.length-1;0<=c;c--){b=a[c];try{b.src="",b.parentNode.removeChild(b)}catch(f){}}}}
function makeImageElementForObject(a){var b="";"iframe"==a.type?b=-1<a.src.indexOf("dext5player/media_player")?"dialog/custom_insert_image.jpg":"dialog/objectiframe.jpg":"flash"==a.type?b=-1<a.src.indexOf("dext5player/")?"dialog/custom_insert_image.jpg":"dialog/objectflash.jpg":"media"==a.type?b="dialog/objectmedia.jpg":"youtube"==a.type?b="dialog/youtube.jpg":"daum"==a.type?b="dialog/daum.jpg":"naver"==a.type?b="dialog/naver.jpg":"link_media"==a.type?b="dialog/link_media.jpg":"hidden"==a.type?b=
"dialog/hidden.jpg":"video_media"==a.type&&(b="dialog/video.jpg");var c=_iframeDoc.createElement("img");c.src=DEXTTOP.G_CURREDITOR._config.webPath.image+b;b={};b.attributes=a.attributes;""!=a.width&&null!=a.width&&void 0!=a.width&&""!=a.height&&null!=a.height&&void 0!=a.height&&(a.width=a.width.toString(),a.height=a.height.toString(),-1<a.width.indexOf("px")||-1<a.width.indexOf("%")||-1<a.width.indexOf("pt")?c.style.width=a.width:c.style.width=a.width+"px",-1<a.height.indexOf("px")||-1<a.height.indexOf("%")||
-1<a.height.indexOf("pt")?c.style.height=a.height:c.style.height=a.height+"px");"iframe"==a.type||"iframe"==a.type2?(b.type=a.type,b.type2=a.type2,b.src=a.src?a.src:"",b.width=a.width?a.width:"",b.height=a.height?a.height:"",b.id=a.id?a.id:"",b.name=a.name?a.name:"",b.title=a.title?a.title:"",b.className=a.className?a.className:"",b.align=a.align?a.align:"",b.scrolling=a.scrolling?a.scrolling:"",b.frameBorder=a.frameBorder?a.frameBorder:"",b.caption=a.caption?a.caption:"",c.align=a.align):"flash"==
a.type||"flash"==a.type2?(b.type=a.type,b.type2=a.type2,b.src=a.src,b.width=a.width,b.height=a.height,b.hspace=a.hspace?a.hspace:"",b.vspace=a.vspace?a.vspace:"",b.margin_left=a.margin_left,b.margin_right=a.margin_right,b.margin_top=a.margin_top,b.margin_bottom=a.margin_bottom,b.scale=a.scale,b.allowScriptAccess=a.allowScriptAccess,b.quality=a.quality,b.menu=a.menu,b.play=a.play,b.loop=a.loop,b.allowFullScreen=a.allowFullScreen,b.flashvars=a.flashvars,b.caption=a.caption,b.align="",a.hspace&&(c.hspace=
a.hspace),a.vspace&&(c.vspace=a.vspace),a.margin_left&&(-1<a.margin_left.indexOf("px")||-1<a.margin_left.indexOf("%")||-1<a.margin_left.indexOf("pt")?c.style.marginLeft=a.margin_left:c.style.marginLeft=a.margin_left+"px"),a.margin_right&&(-1<a.margin_right.indexOf("px")||-1<a.margin_right.indexOf("%")||-1<a.margin_right.indexOf("pt")?c.style.marginRight=a.margin_right:c.style.marginRight=a.margin_right+"px"),a.margin_top&&(-1<a.margin_top.indexOf("px")||-1<a.margin_top.indexOf("%")||-1<a.margin_top.indexOf("pt")?
c.style.marginTop=a.margin_top:c.style.marginTop=a.margin_top+"px"),a.margin_bottom&&(-1<a.margin_bottom.indexOf("px")||-1<a.margin_bottom.indexOf("%")||-1<a.margin_bottom.indexOf("pt")?c.style.marginBottom=a.margin_bottom:c.style.marginBottom=a.margin_bottom+"px"),c.align="",-1<",absbottom,absmiddle,absmiddle,bottom,left,middle,right,texttop,top,".indexOf(","+a.align+",")&&(c.align=a.align,b.align=a.align)):"media"==a.type?(b.type=a.type,b.src=a.src,b.width=a.width,b.height=a.height,b.autoStart=
a.autoStart,b.playCount=a.playCount,b.showTracker=a.showTracker,b.showStatusBar=a.showStatusBar,b.showControls=a.showControls,b.showAudioControls=a.showAudioControls,b.showDisplay=a.showDisplay,b.showPositionControls=a.showPositionControls):"hidden"==a.type?(b.type=a.type,b.id=a.id,b.name=a.name,b.value=a.value,b.className=a.className,b.title=a.title):"video_media"==a.type&&(b.type=a.type,b.src=a.src,b.width=a.width,b.height=a.height,b.autoPlay=a.autoPlay,b.loop=a.loop,b.controls=a.controls,b.muted=
a.muted);setDextCustomData(c,b);return c}var dragPopup=null,currentScrollPos;
function startDrag(a){var b=getDialogWindow(),c=getDialogDocument();a||(a=b.event);offsetX=a.clientX;offsetY=a.clientY;dragPopup.style.left||(dragPopup.style.left="0px");dragPopup.style.top||(dragPopup.style.top="0px");var b=dragPopup.getElementsByTagName("div")[1],d=!1;b&&(b=getClientRect(b),d=point_in_rectagnle(offsetX,offsetY,b.left,b.top,b.right,b.bottom));0==d&&(coordX=parseInt(dragPopup.style.left),coordY=parseInt(dragPopup.style.top),drag=!0,DEXTTOP.DEXT5.util.addEvent(c,"mousemove",dragDiv),
DEXTTOP.DEXT5.util.addEvent(c,"mouseup",stopDrag),11<=DEXTTOP.DEXT5.browser.ieVersion&&dragPopup.getElementsByTagName("iframe")[0].focus());DEXTTOP.DEXT5.util.cancelEvent(a)}
function dragDiv(a){if(drag){var b=getDialogWindow();getDialogDocument();a||(a=b.event);var c=dragPopup.getElementsByTagName("iframe")[0],d=dragPopup.getElementsByTagName("div")[2],e=dragPopup.getElementsByTagName("iframe")[1];d.style.width="100%";d.style.height="100%";c&&d&&e&&(c.style.zIndex="-1");c=getWindowClientSize(b);d=[dragPopup.offsetWidth||0,dragPopup.offsetHeight||0];currentScrollPos=getWindowScrollPos(b);b=coordX+a.clientX-offsetX;e=coordY+a.clientY-offsetY;0>=b-currentScrollPos[0]&&(b=
currentScrollPos[0]);0>=e-currentScrollPos[1]&&(e=currentScrollPos[1]);b+d[0]>=c[0]+currentScrollPos[0]&&(b=c[0]-d[0]+currentScrollPos[0]);e+d[1]>=c[1]+currentScrollPos[1]&&(e=c[1]-d[1]+currentScrollPos[1]);dragPopup.style.left=b+"px";dragPopup.style.top=e+"px";DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a)}}
function stopDrag(a){a=getDialogDocument();drag=!1;dragPopup.style.cursor="";var b=dragPopup.getElementsByTagName("iframe")[0],c=dragPopup.getElementsByTagName("div")[2],d=dragPopup.getElementsByTagName("iframe")[1];b&&c&&d&&(b.style.zIndex="1");DEXTTOP.DEXT5.util.removeEvent(a,"mousemove",dragDiv);DEXTTOP.DEXT5.util.removeEvent(a,"mouseup",stopDrag)}
function makeDragPopup(a){drag=!1;var b=getDialogWindow();DEXTTOP.DEXT5.util.addEvent(a,"mousedown",startDrag);DEXTTOP.DEXT5.util.addEvent(a,"mouseover",function(){a.style.cursor="move"});DEXTTOP.DEXT5.util.addEvent(a,"mouseout",function(){a.style.cursor="pointer"});DEXTTOP.DEXT5.util.addEvent(b,"scroll",function(a){drag&&b.scroll(currentScrollPos[0],currentScrollPos[1])});dragPopup=a}var originScrollSize=null,originfull={},relativePos=!1,originStylebackup=[];
function isRelativePosition(a){for(;null!=a&&(!a.tagName||"body"!=a.tagName.toLowerCase());)if(a=a.parentNode,"relative"==a.style.position)return!0;return!1}
function setBackupHiddenStyle(a,b){originStylebackup=[];for(var c=a;null!=c&&(!c.tagName||"body"!=c.tagName.toLowerCase());){if(c!=a){var d;(d=b.getComputedStyle?b.getComputedStyle(c,""):c.currentStyle)&&d.overflow&&"hidden"==d.overflow&&(originStylebackup.push(c),c.style.setProperty?c.style.setProperty("overflow","visible",null):c.style.setAttribute("overflow","visible"))}c=c.parentNode}}
function setRestorreHiddenStyle(){for(var a=originStylebackup.length,b=0;b<a;b++){var c=originStylebackup[b];c.style.setProperty?c.style.setProperty("overflow","hidden",null):c.style.setAttribute("overflow","hidden")}originStylebackup=[]}
function resizeDextWin(){var a=DEXTTOP.G_CURREDITOR._config.fullScreenTop,b=DEXTTOP.G_CURREDITOR._config.fullScreenLeft,c=DEXTTOP.G_CURREDITOR._config.fullScreenRight,d=DEXTTOP.G_CURREDITOR._config.fullScreenBottom,e=window.frameElement,f=getWindowClientSize(DEXTTOP.DEXTWIN);if(relativePos){e.style.left="0px";e.style.top="0px";var g=getClientRect(e),h=0,n=0,h=-1*g.left,n=-1*g.top;e.style.left=parseIntOr0(e.style.left)+h+"px";e.style.top=parseIntOr0(e.style.top)+n+"px"}else 1==DEXTTOP.DEXT5.browser.ie&&
1==DEXTTOP.DEXT5.browser.quirks?(e.style.left=originScrollSize[0]+"px",e.style.top=originScrollSize[1]+"px"):(e.style.left="0px",e.style.top="0px");0<b&&(e.style.left=DEXTTOP.DEXT5.util.parseIntOr0(e.style.left)+b+"px");0<a&&(e.style.top=DEXTTOP.DEXT5.util.parseIntOr0(e.style.top)+a+"px");0<c&&(e.style.right=DEXTTOP.DEXT5.util.parseIntOr0(e.style.right)+c+"px");0<d&&(e.style.bottom=DEXTTOP.DEXT5.util.parseIntOr0(e.style.bottom)+d+"px");var m=document.getElementById("ue_editor_holder_"+DEXTTOP.G_CURREDITOR.ID);
0<f[0]-b-c&&(e.style.width=f[0]-b-c+"px");0<f[1]-a-d&&(e.style.height=f[1]-a-d+"px");setTimeout(function(){var a=document.getElementById("dext_topstatusbar_"+DEXTTOP.G_CURREDITOR.ID),b=document.getElementById("dext_menu_"+DEXTTOP.G_CURREDITOR.ID),c=document.getElementById("dext_toolbar_"+DEXTTOP.G_CURREDITOR.ID),d=document.getElementById("dext_statusbar_"+DEXTTOP.G_CURREDITOR.ID),f,g,h,n;a&&(f=getClientRect(a));b&&(g=getClientRect(b));c&&(h=getClientRect(c));d&&(n=getClientRect(d));a=0;g&&(a+=g.bottom-
g.top);h&&(a+=h.bottom-h.top);a=f?a+(f.bottom-f.top):a+1;a=n?a+(n.bottom-n.top):a+1;DEXTTOP.G_CURREDITOR.baseMenuToolbarHeight=a;0<DEXTTOP.DEXT5.util.parseIntOr0(e.style.height)-DEXTTOP.G_CURREDITOR.baseMenuToolbarHeight&&(m.style.height=DEXTTOP.DEXT5.util.parseIntOr0(e.style.height)-DEXTTOP.G_CURREDITOR.baseMenuToolbarHeight+"px")},50)}
function getCustomParam(a){var b={},c=document.createElement("div");c.innerHTML=a;a=c.getElementsByTagName("embed")[0];var d=c.getElementsByTagName("iframe")[0];if(null!=a){b.attributes=a.attributes;b.src=a.getAttribute("src")?a.getAttribute("src"):"";var e=0!=parseIntOr0(a.style.width)?a.style.width:a.getAttribute("width");0==parseIntOr0(e)&&(e="300");b.width=e;e=0!=parseIntOr0(a.style.height)?a.style.height:a.getAttribute("height");0==parseIntOr0(e)&&(e="300");b.height=e;b.hspace=a.getAttribute("hspace")?
a.getAttribute("hspace"):"";b.vspace=a.getAttribute("vspace")?a.getAttribute("vspace"):"";b.margin_left=a.style.marginLeft;b.margin_right=a.style.marginRight;b.margin_top=a.style.marginTop;b.margin_bottom=a.style.marginBottom;b.scale=a.getAttribute("scale")?a.getAttribute("scale"):"";b.allowScriptAccess=a.getAttribute("allowScriptAccess")?a.getAttribute("allowScriptAccess"):"";b.quality=a.getAttribute("quality")?a.getAttribute("quality"):"";b.align=a.getAttribute("align")?a.getAttribute("align"):
"";b.menu=a.getAttribute("menu")?a.getAttribute("menu"):!1;b.play=a.getAttribute("play")?a.getAttribute("play"):!1;b.loop=a.getAttribute("loop")?a.getAttribute("loop"):!1;b.allowFullScreen=a.getAttribute("allowFullScreen")?a.getAttribute("allowFullScreen"):!0;a.getAttribute("flashvars")&&(b.flashvars=a.getAttribute("flashvars"));a=getLinkMediaType(b.src);b.type=""==a?"flash":a;b.type2="flash"}else null!=d&&(b.attributes=d.attributes,b.src=d.getAttribute("src")?d.getAttribute("src"):"",b.id=d.getAttribute("id")?
d.getAttribute("id"):"",b.name=d.getAttribute("name")?d.getAttribute("name"):"",b.title=d.getAttribute("title")?d.getAttribute("title"):"",e=0!=parseIntOr0(d.style.width)?d.style.width:d.getAttribute("width"),0==parseIntOr0(e)&&(e="300"),b.width=e,e=0!=parseIntOr0(d.style.height)?d.style.height:d.getAttribute("height"),0==parseIntOr0(e)&&(e="300"),b.height=e,b.align=d.getAttribute("align")?d.getAttribute("align"):"",b.scrolling=d.getAttribute("scrolling")?d.getAttribute("scrolling"):"no",d.getAttribute("frameBorder")&&
("yes"==d.getAttribute("frameBorder").toLowerCase()||"1"==d.getAttribute("frameBorder")?b.frameBorder=!0:("no"==d.getAttribute("frameBorder")||d.getAttribute("frameBorder"),b.frameBorder=!1)),a=getLinkMediaType(b.src),b.type=""==a?"iframe":a,b.type2="iframe");c.innerHTML="";return b}
function getLinkMediaType(a){var b="";-1!=a.search("youtube.com/embed/")?b="link_media":-1!=a.search("videofarm.daum.net/")?b="link_media":-1!=a.search("naver.com/flash/")?b="link_media":-1!=a.search("channel.pandora.tv/")||-1!=a.search("flvr.pandora.tv/")?b="link_media":-1!=a.search("mgoon.com/Video")?b="link_media":-1!=a.search("dext5player/media_player")&&(b="iframe");return b}
function showSetImageProperty(a){if(null==a){var b,c="";try{c=G_dext5plugIn.getDext5PluginVersion()}catch(d){}b=""==c||"3,6,0,23">c?G_dext5plugIn.showImageProperty("","","","","","","","","","","",""):G_dext5plugIn.showImagePropertyEx("","","","","","","","","","","","","","","","");if(""!=b){dialogCancel();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();-1<b.toLowerCase().indexOf("<br")&&(b=b.replace(/<br.*?>/gim,""));if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod){var e=
b.indexOf('src="')+5,f=e+b.substr(e).indexOf('"'),e=b.substring(e,f),g;try{g=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_dext5plugIn.getBase64ImageFromLocalImage(e)}catch(h){}if(g&&""!=g){g=g.replace(/\r\n/g,"");g=g.replace(/\n/g,"");g=g.replace(/\t/g,"");try{var n=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,g);null!=n&&void 0!=n&&(g=n)}catch(m){}}g&&""!=g&&(b=b.replace(e,g))}insertNodeLikePasteHtml(b);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0;try{contentChangeEventWrapper()}catch(p){}}else dialogCancel()}else{var t=null,t=a.parentNode,q=a.getAttribute("src");(b=a.outerHTML.match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi")))&&0<b.length&&(q=b[0].replace("src=",""),q=q.replace(/\'/g,""),q=q.replace(/\"/g,""),q=q.replace(/\&amp;/g,"&"));b=q;var e=a.style.width,f=a.style.height,q=a.border,u=a.align,v=a.vspace,w=a.hspace,y=a.style.marginTop,x=a.style.marginRight,z=a.style.marginBottom,A=a.style.marginLeft,B=a.id,G=a.className,D=a.title,
I=a.alt,K="",E="",N="";if(""==e||null==e)e=a.width;if(""==f||null==f)f=a.height;try{t&&"a"==t.tagName.toLowerCase()?(E=t.getAttribute("href"),K=t.title,N=t.target):t=null}catch(H){t=null}c="";try{c=G_dext5plugIn.getDext5PluginVersion()}catch(J){}""==c||"3,6,0,23">DEXTTOP.DEXT5.cabVersion?b=G_dext5plugIn.showImageProperty(b,e,f,q,u,v,w,D,I,K,E,N):(""==y.toString()&&(""==v.toString()?y="":y=v),""==z.toString()&&(""==v.toString()?z="":z=v),""==x.toString()&&(""==w.toString()?x="":x=w),""==A.toString()&&
(""==w.toString()?A="":A=w),w=v=c=q="",q=a.style.borderStyle,""==q?a.getAttribute("border")&&""!=a.getAttribute("border")&&(q="solid",c="",v="#000000",w=a.getAttribute("border")):(v=0>a.style.borderColor.indexOf("rgb")&&0>a.style.borderColor.indexOf("#")?"":a.style.borderColor,""!=a.style.borderWidth&&(-1<a.style.borderWidth.indexOf("px")?w=a.style.borderWidth:c=a.style.borderWidth)),""==q&&(q="solid"),""==c&&(c="default"),""==v&&(v="#000000"),""!=v&&-1<v.indexOf("rgb")&&(v=DEXTTOP.DEXT5.util.rgb2hex(v)),
""==w&&(w="0"),-1<w.indexOf("px")&&(w=DEXTTOP.DEXT5.util.parseIntOr0(w)),q=w+"^"+q+"^"+c+"^"+v,b=G_dext5plugIn.showImagePropertyEx(b,e,f,q,u,y,x,z,A,B,G,D,I,K,E,N));if(""!=b){setTimeout(function(){dialogCancel()},100);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&(e=b.indexOf('src="')+5,f=e+b.substr(e).indexOf('"'),e=b.substring(e,f),0==e.indexOf("file:/"))){try{g=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_dext5plugIn.getBase64ImageFromLocalImage(e)}catch(M){}if(g&&""!=g){g=g.replace(/\r\n/g,"");
g=g.replace(/\n/g,"");g=g.replace(/\t/g,"");try{n=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,g),null!=n&&void 0!=n&&(g=n)}catch(L){}}g&&""!=g&&(b=b.replace(e,g))}n=getBorderAndCustomInfo(b);g=n.borderJson;b=n.imageText;try{var F=document.createElement("div");F.innerHTML=b;var C=F.getElementsByTagName("img")[0],n="";C.getAttribute("border")&&""!=C.getAttribute("border")&&(n=C.getAttribute("border"));for(var W=a.attributes.length,e=0;e<W;e++){var V=a.attributes[e];V.specified&&
!C.getAttribute(V.name)&&0>",id,class,align,alt,title,".indexOf(V.name)&&C.setAttribute(V.name,V.value)}""==n&&""!=q&&""==g.borderColor&&""==g.borderKind&&""==g.borderStyle&&""==g.borderWidth?""!=a.style.border&&(C.style.border=a.style.border):setImageBorder(C,g);b=F.innerHTML}catch(P){}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();F=getFirstRange().range;t?F.selectNode(t):F.selectNode(a);F.deleteContents();F.collapse(!0);F.pasteHtml(b);F.collapse(!1);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper()}catch(S){}}else setTimeout(function(){dialogCancel()},100)}}
function insertNodeLikePasteHtml(a){if(""!=a&&null!=a){dialogCancel();var b=getFirstRange().range;if(b){b.deleteContents();var c=getBorderAndCustomInfo(a),d=c.originalSizeCheck,e=c.borderJson;a=c.imageText;c=_iframeDoc.createElement("span");c.innerHTML=a;a=a.match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi"));var f=a.length;if(a&&0<a.length)for(var g=0;g<f;g++)a[g]=a[g].replace("src=",""),a[g]=a[g].replace(/\'/g,""),a[g]=a[g].replace(/\"/g,""),a[g]=a[g].replace(/\&amp;/g,"&");f=c.childNodes.length;
for(g=0;g<f;g++){var h=c.childNodes[g];h.src=a[g];h=h.cloneNode(!0);h.src=a[g];var n=h.src,m=G_dext5plugIn.getImageWidthHeight(n);if(0<m.length){var p=h.style.width.replace("px","");""==p&&(p=h.width);var t=h.style.height.replace("px","");""==t&&(t=h.height);p=p+"^"+t;d||p!=m||(n=n+"?"+m,h=SetImageAutoFitSize(h,n))}h=setImageBorder(h,e);try{b.insertNode(h),b.selectNode(h)}catch(q){b.pasteHtml(h.outerHTML)}b.collapse(!1)}setFocusToBody()}}}
function getEditrFromEvent(a){var b=null;try{if(null!=a){var c=a.target?a.target:a.srcElement;if(c){a=null;a=9!=c.nodeType?c.ownerDocument:c;try{a=a.defaultView?a.defaultView:a.parentWindow,b=DEXTTOP.DEXT5.DEXTMULTIPLE[a.parent.frameElement.id]}catch(d){b=DEXTTOP.G_CURREDITOR}}else b=DEXTTOP.G_CURREDITOR}else b=DEXTTOP.G_CURREDITOR}catch(e){b=DEXTTOP.G_CURREDITOR}return b}
function getEditorFromUnloadEvent(a){var b=null;try{if(null!=a){var c=a.target?a.target:a.srcElement;if(c)try{a="",c._dext_editor?a="dext_frame_"+c._dext_editor.ID:c.defaultView&&(a="dext_frame_"+c.defaultView.G_USE_EDITOR_ID),b=DEXTTOP.DEXT5.DEXTMULTIPLE[a]}catch(d){b=DEXTTOP.G_CURREDITOR}else b=DEXTTOP.G_CURREDITOR}else b=DEXTTOP.G_CURREDITOR}catch(e){b=DEXTTOP.G_CURREDITOR}return b}
function setPasteImageFromClipboard(a,b){if(!DEXTTOP.DEXT5.browser.gecko)try{if(0==DEXTTOP.DEXT5.browser.ie){var c=a.clipboardData.items,d=c.length;0==d&&null!=DEXTTOP.G_CURREDITOR.clipImageBlob&&(d=1);if("base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&c&&0<d&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount){for(var e=0,f=0;f<d;++f)(DEXTTOP.G_CURREDITOR.clipImageBlob||"file"==c[f].kind&&-1!==c[f].type.indexOf("image/"))&&e++;if(0<e&&getBase64ImageCount()+e>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,
10)){var g=dext5_lang.msg.max_base64file_count,g=g.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount);alert(g);return}}for(f=0;f<d;++f)if(DEXTTOP.G_CURREDITOR.clipImageBlob||"file"==c[f].kind&&-1!==c[f].type.indexOf("image/")){var g=null,g=DEXTTOP.G_CURREDITOR.clipImageBlob?DEXTTOP.G_CURREDITOR.clipImageBlob:c[f].getAsFile(),h=new FileReader;h.onload=function(a){var c=a.target.result.split(",");2==c.length&&(checkPasteImage('<img src="'+a.target.result+'" />'),a=getExtFromImageDataSrc(c[0]),
postBase64ImageToServer(c[1],a,void 0,void 0,b));h=void 0};h.readAsDataURL(g)}}else if(11<=DEXTTOP.DEXT5.browser.ieVersion)for(var c=_iframeWin.clipboardData,e=c.files,n=e.length,f=0;f<n;f++){var m=e[f],p=URL.createObjectURL(m);a.msConvertURL(m,"base64",p);h=new FileReader;h.onload=function(a){a=a.target.result.split(",");if(2==a.length){var b=getExtFromImageDataSrc(a[0]);postBase64ImageToServer(a[1],b)}h=void 0};h.readAsDataURL(m)}}catch(t){}}
function postBase64ImageToServer(a,b,c,d,e,f){if(G_dext5plugIn&&!c.getAttribute("raon_chart"))try{var g=G_dext5plugIn.getLocalImageFromBase64Image(a,b);if(0<g.length)if(void 0==c||null==c){var h=_iframeDoc.createElement("img");h.src=g;h.alt="";var n=getFirstRange().range;n.deleteContents();n.collapse(!0);n.pasteHtml(h.outerHTML);n.collapse(!1)}else c=SetImageAutoFitSize(c,g)}catch(m){}else if("1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64)void 0==c||null==c?(h=_iframeDoc.createElement("img"),
h.onload=function(a){if(h){0==!!e&&""==h.style.width&&h.width&&(e={width:0,height:0,checkOriginSize:!1},e.width=h.width,""==h.style.height&&h.height&&(e.height=h.height));e&&0<e.width&&0<e.height&&(h=SetImageAutoFitSize(h,h.src,e));a=h.outerHTML;h=null;h=void 0;var b=getFirstRange().range;b.deleteContents();b.collapse(!0);b.pasteHtml(a);b.collapse(!1)}},h.src="data:image/"+b+";base64,"+a,h.alt=""):void 0!=b&&""!=b&&void 0!=a&&""!=a&&(c.src="data:image/"+b+";base64,"+a,""==c.style.width&&c.width&&
(c.src+="?"+c.width,""==c.style.height&&c.height&&(c.src+="^"+c.height)),c=SetImageAutoFitSize(c,c.src,e));else{g=null;"CCODE_001"==DEXTTOP.G_CURREDITOR._config.custom_code&&(g="hello");var n=DEXTTOP.G_CURREDITOR._config.image_convert_width,p=DEXTTOP.G_CURREDITOR._config.image_convert_height;"1"==DEXTTOP.G_CURREDITOR._config.imageAutoConvert&&(p=n="");if("undefined"==typeof FormData||null==g&&""!=DEXTTOP.G_CURREDITOR._config.proxy_url&&"1"!=DEXTTOP.G_CURREDITOR._config.uploadImageFileObject){var t=
document.createElement("form");t.method="post";t.target="upload_frame";t.enctype="multipart/form-data";var q='<input type="hidden" id="imagedata" name="imagedata" value="'+a+'" />';"0"!=DEXTTOP.G_CURREDITOR._config.security.encryptParam?(q+='<input type="hidden" id="pe" name="pe" value="'+DEXTTOP.G_CURREDITOR._config.security.encryptParam+'" />',q+='<input type="hidden" id="savefileext" name="savefileext" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(b)+'" />',q+='<input type="hidden" id="serverdomain" name="serverdomain" value="'+
DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.serverDomain)+'" />',q+='<input type="hidden" id="tosavepathurl" name="tosavepathurl" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.toSavePathURL)+'" />',q+='<input type="hidden" id="savafoldernamerule" name="savafoldernamerule" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.saveFolderNameRule)+'" />',q+='<input type="hidden" id="savafilenamerule" name="savafilenamerule" value="'+
DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.saveFileNameRule)+'" />',q+='<input type="hidden" id="proxy_url" name="proxy_url" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.proxy_url)+'" />',q+='<input type="hidden" id="image_convert_format" name="image_convert_format" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.image_convert_format)+'" />',q+='<input type="hidden" id="image_convert_width" name="image_convert_width" value="'+
DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.image_convert_width)+'" />',q+='<input type="hidden" id="image_convert_height" name="image_convert_height" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.image_convert_height)+'" />',q+='<input type="hidden" id="uploadtype" name="uploadtype" value="'+DEXTTOP.DEXT5.util.makeEncryptParamFinal("image")+'" />'):(q=q+('<input type="hidden" id="savefileext" name="savefileext" value="'+b+'" />')+('<input type="hidden" id="serverdomain" name="serverdomain" value="'+
DEXTTOP.G_CURREDITOR._config.serverDomain+'" />'),q+='<input type="hidden" id="tosavepathurl" name="tosavepathurl" value="'+DEXTTOP.G_CURREDITOR._config.toSavePathURL+'" />',q+='<input type="hidden" id="savafoldernamerule" name="savafoldernamerule" value="'+DEXTTOP.G_CURREDITOR._config.saveFolderNameRule+'" />',q+='<input type="hidden" id="savafilenamerule" name="savafilenamerule" value="'+DEXTTOP.G_CURREDITOR._config.saveFileNameRule+'" />',q+='<input type="hidden" id="proxy_url" name="proxy_url" value="'+
DEXTTOP.G_CURREDITOR._config.proxy_url+'" />',q+='<input type="hidden" id="image_convert_format" name="image_convert_format" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_format+'" />',q+='<input type="hidden" id="image_convert_width" name="image_convert_width" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_width+'" />',q+='<input type="hidden" id="image_convert_height" name="image_convert_height" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_height+'" />',q+='<input type="hidden" id="uploadtype" name="uploadtype" value="image" />');
q+='<input type="hidden" id="'+DEXTTOP.G_CURREDITOR._config.userFieldID+'" name="'+DEXTTOP.G_CURREDITOR._config.userFieldID+'" value="'+DEXTTOP.G_CURREDITOR._config.userFieldValue+'" />';q+='<iframe id="upload_frame" name="upload_frame" frameborder="0" style="width:0px; height:0px;" title="DEXT5Editor Upload"></iframe>';t.innerHTML=q;document.body.appendChild(t);t.action=DEXTTOP.G_CURREDITOR._config.post_url;t.submit();var u=document.getElementById("upload_frame");DEXTTOP.DEXT5.util.addEvent(u,"load",
function(){var a;try{a=u.contentDocument?u.contentDocument.body:u.contentWindow.document.body}catch(b){a=u.document.body}a="textContent"in a?a.textContent:a.innerText;document.body.removeChild(t);if(a&&""!=a)try{var e=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=e&&void 0!=e&&(a=e)}catch(f){}if("[FAIL]"==a.substring(0,6))try{DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a})}catch(g){}if(void 0==c||null==c)e=_iframeDoc.createElement("img"),
e=SetImageAutoFitSize(e,a),a=getFirstRange().range,a.collapse(!0),a.insertNode(e),a.selectNode(e),a.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(a);else{if(e=_iframeDoc.getElementsByTagName("img"))for(var h=e.length,m=0;m<h;m++)if(e[m].src==c.src){var n=_iframeDoc.createElement("img");try{n.attributes=e[m].attributes}catch(p){n.outerHTML=e[m].outerHTML}n.src=a;e[m].parentNode.replaceChild(n,e[m]);c=n}c=SetImageAutoFitSize(c,a);d&&recursionBase64ImageToServer()}},
!0)}else{var g=new FormData,v=DEXTTOP.G_CURREDITOR._config.proxy_url;"1"==DEXTTOP.G_CURREDITOR._config.uploadImageFileObject&&(v="");"0"!=DEXTTOP.G_CURREDITOR._config.security.encryptParam?(g.append("savefileext",DEXTTOP.DEXT5.util.makeEncryptParamFinal(b)),g.append("serverdomain",DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.serverDomain)),g.append("tosavepathurl",DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.toSavePathURL)),g.append("savafoldernamerule",
DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.saveFolderNameRule)),g.append("savafilenamerule",DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.saveFileNameRule)),g.append("proxy_url",DEXTTOP.DEXT5.util.makeEncryptParamFinal(v)),g.append("image_convert_format",DEXTTOP.DEXT5.util.makeEncryptParamFinal(DEXTTOP.G_CURREDITOR._config.image_convert_format)),g.append("image_convert_width",DEXTTOP.DEXT5.util.makeEncryptParamFinal(n)),g.append("image_convert_height",
DEXTTOP.DEXT5.util.makeEncryptParamFinal(p)),g.append("originalfilename",DEXTTOP.DEXT5.util.makeEncryptParamFinal(f?f.name:"")),g.append("uploadtype",DEXTTOP.DEXT5.util.makeEncryptParamFinal("image")),g.append("pe",DEXTTOP.G_CURREDITOR._config.security.encryptParam)):(g.append("savefileext",b),g.append("serverdomain",DEXTTOP.G_CURREDITOR._config.serverDomain),g.append("tosavepathurl",DEXTTOP.G_CURREDITOR._config.toSavePathURL),g.append("savafoldernamerule",DEXTTOP.G_CURREDITOR._config.saveFolderNameRule),
g.append("savafilenamerule",DEXTTOP.G_CURREDITOR._config.saveFileNameRule),g.append("proxy_url",v),g.append("image_convert_format",DEXTTOP.G_CURREDITOR._config.image_convert_format),g.append("image_convert_width",n),g.append("image_convert_height",p),g.append("originalfilename",f?f.name:""),g.append("uploadtype","image"));"1"==DEXTTOP.G_CURREDITOR._config.uploadImageFileObject?(""!=DEXTTOP.G_CURREDITOR._config.userFieldID&&g.append(DEXTTOP.G_CURREDITOR._config.userFieldID,DEXTTOP.G_CURREDITOR._config.userFieldValue),
0==!!f?(f=a,0>f.indexOf("data:image/")&&(f=b,"jpg"==f&&(f="jpeg"),f="data:image/"+b+";base64,"+a),b=DEXTTOP.DEXT5.util.dataURItoBlob(f),g.append(DEXTTOP.G_CURREDITOR._config.fileFieldID,b)):g.append(DEXTTOP.G_CURREDITOR._config.fileFieldID,f)):g.append("imagedata",a);if((g=DEXTTOP.DEXT5.ajax.postMultiPart(DEXTTOP.G_CURREDITOR._config.post_url,g))&&""!=g)try{q=DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,g),null!=q&&void 0!=q&&(g=q)}catch(w){}if("[FAIL]"==g.substring(0,
6))try{DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:g})}catch(y){}if(void 0==c||null==c){h=_iframeDoc.createElement("img");h=SetImageAutoFitSize(h,g,e);b=h.outerHTML;if("function"==typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event){q=b;try{q=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(b)}catch(x){q=b}if(q)b=q;else if(0==q||""==q)return}pasteWordCount(b)&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.gecko?_iframeDoc.execCommand("inserthtml",
!1,b):pasteHtmlAtCaretHuge(b,!0),n=getFirstRange().range)&&(rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n))}else c=SetImageAutoFitSize(c,g),d&&recursionBase64ImageToServer()}}}
function SetImageAutoFitSize(a,b,c){var d=0,e=0,f="";null!=b&&void 0!=b&&(b=b.replace(/\r\n/g,""),b=b.replace(/\n/g,""),b=b.replace(/\t/g,""));f=b;if("CCODE_001"==DEXTTOP.G_CURREDITOR._config.custom_code){var g=f.split("|");a.setAttribute("src",g[2]);a.setAttribute("filemimeinfo",f);insertImageSrc(DEXTTOP.G_CURREDITOR,g[2])}else{g=[];"0"!=DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter&&(g=b.split(DEXTTOP.G_CURREDITOR._config.imageCustomPropertyDelimiter),1<g.length&&(b=g[0]));b=b.split("?");
2==b.length&&(f=b[0],b=b[1].split("^"),2==b.length?(d=b[0],e=b[1]):3==b.length&&(d=b[0],e=b[1],f+="?"+b[2]));b=!1;c&&0<c.width&&0<c.height&&(d=c.width,e=c.height,b=c.checkOriginSize);if(0==b){var h=getWidthForAutoBodyFit(DEXTTOP.G_CURREDITOR,"img");if("1"==DEXTTOP.G_CURREDITOR._config.imageAutoConvert){var h=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.G_CURREDITOR._config.image_convert_width),n=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.G_CURREDITOR._config.image_convert_height),m=!1,p=!1;c=e;b=DEXTTOP.DEXT5.util.parseIntOr0(d);
c=DEXTTOP.DEXT5.util.parseIntOr0(c);if(0!=h&&0==n)b>h&&(m=!0);else if(0==h&&0!=n)c>n&&(p=!0);else{var t=1*h/b,q=1*n/c;t<q?1>t&&(m=!0):1>q&&(p=!0)}m?(b=h/b,d=h,e=DEXTTOP.DEXT5.util.parseIntOr0(b*c)):p&&(e=n,d=DEXTTOP.DEXT5.util.parseIntOr0(n/c*b))}else"1"==DEXTTOP.G_CURREDITOR._config.image_auto_fit&&d>h?(b=h/d,d=h,e=parseInt(b*e)):"2"==DEXTTOP.G_CURREDITOR._config.image_auto_fit&&(b=d,c=e,b>h||c>DEXTTOP.G_CURREDITOR._defaultHeight)&&(d=DEXTTOP.G_CURREDITOR._defaultHeight,e=d/h,n=c/b,n>e?c>d?(e=d,
d=Math.round(b*e/c)):(d=b,e=c):n<e?b>h?(d=h,e=Math.round(c*d/b)):(d=b,e=c):(d=b,e=c))}a.src=f;0<d&&0<e&&(a.style.width=d+"px",a.style.height=e+"px",a.removeAttribute("width"),a.removeAttribute("height"));"0"==DEXTTOP.G_CURREDITOR._config.allowImgSize&&(a.style.width="",a.style.height="");if(g&&1<g.length)for(d=g.length,e=1;e<d;e++)c=g[e].split("^"),2==c.length&&a.setAttribute(c[0],c[1]);insertImageSrc(DEXTTOP.G_CURREDITOR,f)}return a}
function SetCorrectOfficeHtmlForDOM(a){var b=a;try{var c=document.createElement("div");c.innerHTML=a;for(var d=c.getElementsByTagName("table"),e=d.length,f=0;f<e;f++){var g=0,h=0;null!=d[f].getAttribute("width")&&""!=d[f].getAttribute("width")&&0>d[f].getAttribute("width").indexOf("%")&&(g=parseInt(d[f].getAttribute("width"),10),d[f].removeAttribute("width"));null!=d[f].getAttribute("height")&&""!=d[f].getAttribute("height")&&(h=parseInt(d[f].getAttribute("height"),10),d[f].removeAttribute("height"));
""==d[f].style.width&&0!=g&&(d[f].style.width=g+"px");""==d[f].style.height&&0!=h&&(d[f].style.height=h+"px")}if("HWP"==G_wordProcessorType)for(var n=c.getElementsByTagName("span"),m=n.length,f=0;f<m;f++){var p=n[f];if("#ffffff"==colorToHex(p.style.backgroundColor)||"#ffffff"==p.style.backgroundColor)p.style.backgroundColor=""}a=c.innerHTML}catch(t){a=b}if("undefined"!=typeof c)try{c.innerHTML="",delete null}catch(q){}G_wordProcessorType="";return a}
function GetMsPptHtml(a){var b=a,b=a.indexOf("\x3c!--StartFragment--\x3e"),c=a.indexOf("\x3c!--EndFragment--\x3e");if(-1<b&&-1<c&&(b=a.substr(b+20),c=b.indexOf("\x3c!--EndFragment--\x3e"),-1<c)){for(;;)if(a=b.indexOf("\x3c!--EndFragment--\x3e",c+18),-1<a)c=a;else break;a=b=b.substring(0,c)}return a}function ReplaceAll(a,b,c){a&&""!=a&&(a=a.split(b).join(c));return a}
function getExtFromImageDataSrc(a){var b="";a=a.replace("data:","").split(";");0<a.length&&(a=a[0].split("/"),2==a.length&&(b=a[1]));return b}function htmlAsciiToChar(a){return a=a.replace(/&#39;/g,"'")}
function xssReplaceScript(a,b){var c="",d=b;try{var c=b=removeGarbageTag(b),e=DEXTTOP.G_CURREDITOR._config.xss_use,f=DEXTTOP.G_CURREDITOR._config.xss_remove_tags,g=DEXTTOP.G_CURREDITOR._config.xss_remove_events;if("1"!=e&&""==f&&""==g||null==a&&""==b)return c;if(a){var h=getAllNodesInBody(a,!0);DEXTTOP.DEXT5.util.removeTags(a,f);DEXTTOP.DEXT5.util.removeEvents(a,g,h);if("1"==e)for(var n=","+DEXTTOP.G_CURREDITOR._config.xss_check_attribute.join(",")+",",m=h.length,p=0;p<m;p++)-1<n.indexOf(",src,")&&
h[p].src&&xssCheckPattern(h[p].src)&&h[p].src!=DEXTTOP.G_CURREDITOR._config.userJsUrl&&(h[p].src=""),-1<n.indexOf(",background,")&&(h[p].background&&xssCheckPattern(h[p].background)&&(h[p].background=""),h[p].style.backgroundImage&&xssCheckPattern(h[p].style.backgroundImage)&&(h[p].style.backgroundImage="")),-1<n.indexOf(",url,")&&h[p].url&&xssCheckPattern(h[p].url)&&(h[p].url=""),-1<n.indexOf(",href,")&&h[p].href&&xssCheckPattern(h[p].href)&&(h[p].href="")}h="";"1"==e&&(h="script,vbscript");n=!1;
void 0==b||""==b?a&&(e=!1,1==RegExp("<[^>]+\\sdext5customdata\\b[^>]*>","gim").test(a.innerHTML)&&(e=!0,ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData()),b=a==_iframeDoc.body?a.innerHTML:a.body.innerHTML,b=DEXTTOP.DEXT5.util.replaceForXSS(b,h,f,g,n),""!=b?DEXTTOP.DEXT5.setBodyValue(b,DEXTTOP.G_CURREDITOR._config.editor_id,!0,null,e):e&&ReplaceRealObjectToImage(!1)):("1"==e&&(n=!0),b=DEXTTOP.DEXT5.util.replaceForXSS(b,h,f,g,n),""!=b&&(c=b))}catch(t){c=
d}return c}function removeGarbageTag(a){var b=a;if("string"==typeof a)try{var c=RegExp("<\\?xml[^>]*/>","gim");1==c.test(b)&&(b=b.replace(c,""));c=RegExp("</ustyle[^>]*>","gim");1==c.test(b)&&(b=b.replace(c,""));c=RegExp("<ustyle[^>]*>","gim");1==c.test(b)&&(b=b.replace(c,""))}catch(d){b=a}return b}function xssCheckPattern(a){return-1<a.indexOf("javascript")||-1<a.indexOf("vbscript")||-1<a.indexOf(".js?")||a.lastIndexOf(".js")+3==a.length?!0:!1}
function checkCellBRValue(){var a=!1;"<p><br /></p>"==getCellDefValue()&&(a=!0);return a}function checkCellBRValue2(a){var b=!1;a=a.toLowerCase();a=ReplaceAll(a," ","");a=ReplaceAll(a,"<br>","<br />");a=ReplaceAll(a,"<br/>","<br />");"<p><br /></p>"==a&&(b=!0);return b}function checkCellDefValue(a){var b=!1,c=getCellDefValue();a=a.toLowerCase();a=ReplaceAll(a," ","");a=ReplaceAll(a,"<br>","<br />");a=ReplaceAll(a,"<br/>","<br />");c==a&&(b=!0);return b}
function getCellDefValue(){var a=10;"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&(a=12);return DEXTTOP.DEXT5.browser.ie&&DEXTTOP.DEXT5.browser.ieVersion<=a?"<p>&nbsp;</p>":"<p><br /></p>"}function setCellDefValue(a){DEXTTOP.DEXT5.browser.ie&&a&&(""==a.innerHTML||"<p></p>"==a.innerHTML)&&(a.innerHTML=getCellDefValue())}
function setTableAllCellDefValue(a){if(DEXTTOP.DEXT5.browser.ie){var b=GetParentbyTagName(a,"table");if(b){var c=a.cellIndex,d=GetParentbyTagName(a,"tr").cells;a=[];for(var e=b.rows.length,f=0;f<e;f++)b.rows[f]&&b.rows[f].cells[c]&&a.push(b.rows[f].cells[c]);b=d.length;for(f=0;f<b;f++)setCellDefValue2(d[f]);b=a.length;for(f=0;f<b;f++)setCellDefValue2(a[f])}}}
function setCellDefValue2(a){RegExp("<p([^>?+]*)></p>","gi").test(a.innerHTML);var b=ReplaceAll(a.innerHTML,RegExp.$1,"");if(""!=RegExp.$1&&"<p></p>"==b)-1<getCellDefValue().indexOf("&nbsp;")?a.innerHTML="<p "+RegExp.$1+">&nbsp;</p>":a.innerHTML="<p "+RegExp.$1+"><br /></p>";else if(""==a.innerHTML||"<p></p>"==a.innerHTML)a.innerHTML=getCellDefValue();"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&(RegExp("<p([^>?+]*)><br /></p>","gi").test(b),b=ReplaceAll(a.innerHTML,RegExp.$1,""),checkCellBRValue2(b)&&
(""!=RegExp.$1?-1<getCellDefValue().indexOf("&nbsp;")?a.innerHTML="<p "+RegExp.$1+">&nbsp;</p>":a.innerHTML="<p "+RegExp.$1+"><br /></p>":a.innerHTML=getCellDefValue()))}
function createTableCellDefValue(a){if(a&&DEXTTOP.DEXT5.browser.ie){var b=GetParentbyTagName(a,"table");if(b)for(var c=b.rows.length,d=0;d<c;d++)for(var e=b.rows[d],f=e.cells.length,g=0;g<f;g++){var h=e.cells[g];h!=a&&""==h.innerHTML&&(h.innerHTML=getCellDefValue())}3==a.childNodes[0].nodeType?a.innerHTML="":""==a.innerHTML&&(a.innerHTML=getCellDefValue())}return""}
function removeCellDefValue(a,b){var c="";if(a)if(1==b)var d=c=a.innerHTML,c=c.replace(/<p *([^>?+])*>(\s+)*(&nbsp;+)*(\s+)*<\/p>/i,""),d=d.replace(/<p *([^>?+])*>(<br *\/*>+)*<\/p>/i,""),c=1==checkCellDefValue(a.innerHTML)||""==a.innerHTML||""==c||""==d?"":a.innerHTML;else{var e=GetParentbyTagName(a,"table");if(e)for(var f=e.rows.length,d=0;d<f;d++)for(var g=e.rows[d],h=g.cells.length,n=0;n<h;n++){var m=g.cells[n],p=RegExp("<p([^>?+]*)></p>","gi");p.test(m.innerHTML);p=ReplaceAll(m.innerHTML,RegExp.$1,
"");m==a||"<p></p>"!=p&&""!=p||(""!=RegExp.$1?-1<getCellDefValue().indexOf("&nbsp;")?m.innerHTML="<p "+RegExp.$1+">&nbsp;</p>":m.innerHTML="<p "+RegExp.$1+"><br /></p>":m.innerHTML=getCellDefValue())}if(0<a.childNodes.length)for(e=a.childNodes.length,d=0;d<e&&1!=a.childNodes[d].nodeType;d++);200>a.innerHTML.length&&(p=RegExp("<p([^>?+]*)>&nbsp;</p>","gi"),p.test(a.innerHTML),p=ReplaceAll(a.innerHTML,RegExp.$1,""),1==checkCellDefValue(p)?(""!=RegExp.$1?a.innerHTML="<p "+RegExp.$1+"></p>":0==checkCellBRValue()&&
(a.innerHTML="<p></p>"),"view"!=DEXTTOP.G_CURREDITOR._config.mode&&moveCursorToTag(a.childNodes[0],!0),c=!0):c=!1)}return c}
function setShiftTabkeyAction(){try{var a=null,b=getFirstRange(),c=b.range,d=b.sel;c&&c.startContainer&&(a=getMyElementNode(c.startContainer));if(a){var e=GetTDTHCell(a);if(null==e&&"tr"==a.tagName.toLowerCase()){var f=a.cells.length;0<f&&(e=a.cells[f-1])}var b=!1,g=GetParentbyTagName(a,"li");if(g)if(e)for(var h=e.getElementsByTagName("li"),n=h.length,m=0;m<n;m++){if(g==h[m]){b=!0;break}}else b=!0;var p=a.tagName.toLowerCase();if(-1<",li,ul,ol,".indexOf(","+p+",")||b)if("2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode)if(0==
c.toString().length){var t=c.startContainer;3==t.nodeType&&(t=t.parentNode);if("OL"==t.tagName||"UL"==t.tagName)t=t.getElementsByTagName("li")[0];var t=GetParentbyTagName(t,"li"),q=createNodeForCaret(1)[0];c.collapse(!0);c.insertNode(q);moveLiNode(t,0);c.setStartBefore(q);c.setEndBefore(q);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c);q.parentNode.removeChild(q);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else{var q=
createNodeForCaret(2),u=q[0],v=q[1],w=!0,y=c.cloneRange();try{c.collapse(!1);c.insertNode(v);d.removeAllRanges();d.addRange(y);c=getFirstRange().range;c.collapse(!0);for(c.insertNode(u);;){var x=v.previousSibling;if(!x||"LI"!=x.tagName&&"OL"!=x.tagName&&"UL"!=x.tagName)break;else x.appendChild(v)}c.setStartBefore(u);c.setEndBefore(v);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c)}catch(z){removeNodeForCaret(),w=!1}if(0==w)try{w=!0;q=createNodeForCaret(2);
u=q[0];v=q[1];try{c.setStart(c.endContainer,c.endOffset),c.setEnd(c.endContainer,c.endOffset)}catch(A){3==c.endContainer.nodeType&&(c.setStart(c.endContainer,c.endContainer.length),c.setEnd(c.endContainer,c.endContainer.length))}c.insertNode(v);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(y);c=getFirstRange().range;try{c.setStart(c.startContainer,c.startOffset),c.setEnd(c.startContainer,c.startOffset)}catch(B){3==c.startContainer.nodeType&&(c.setStart(c.startContainer,
0),c.setEnd(c.startContainer,0))}c.insertNode(u);(x=v.previousSibling)&&"LI"==x.tagName&&x.appendChild(v);c.setStartBefore(u);c.setEndBefore(v);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c)}catch(G){removeNodeForCaret(),w=!1}if(w){c=getFirstRange().range;t=c.startContainer;3==t.nodeType&&(t=t.parentNode);var D=c.endContainer;3==D.nodeType&&(D=D.parentNode);t=GetParentbyTagName(t,"li");D=GetParentbyTagName(D,"li");if(t&&D){if(t==D)moveLiNode(t,0);else{w=
[];if(t.parentNode==D.parentNode){w.push(t);for(var I=t.nextSibling;I!=D;)w.push(I),I=I.nextSibling;w.push(D)}for(var K=w.length,m=0;m<K;m++)moveLiNode(w[m],0)}c.setStartBefore(u);c.setEndAfter(v);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c);removeNodeForCaret();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else removeNodeForCaret()}else rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(y)}else{for(var E=
getNodesInRange(c),w=[],N=E.length,m=0;m<N;m++)"1"==E[m].nodeType&&"li"==E[m].tagName.toLowerCase()&&w.push(E[m]);for(var K=w.length,H=w[0],J=w[K-1],d=!0,m=0;m<K;m++){var M=w[m],L=M.parentNode,F=M.nextSibling,C=M.previousSibling,W=C&&C.tagName?C.tagName.toLowerCase():"",V=F&&F.tagName?F.tagName.toLowerCase():"";if(!(0>",li,ul,ol,".indexOf(","+L.parentNode.tagName.toLowerCase()+","))){if(F&&C&&(-1<",ul,ol,".indexOf(","+W+",")||-1<",ul,ol,".indexOf(","+V+","))||!F&&"li"==W||!C&&"li"==V||"li"==W&&"li"==
V||!F&&!C){for(var P=document.createElement(M.parentNode.tagName);M.previousSibling;)P.childNodes?P.insertBefore(M.previousSibling,P.firstChild):P.appendChild(M.previousSibling);for(var S=document.createElement(M.parentNode.tagName);M.nextSibling;)S.appendChild(M.nextSibling);for(var fa=L.attributes,ba=fa.length,t=0;t<ba;t++){var U=fa[t];U.specified&&("style"==U.name.toLowerCase()?(P.style.cssText=L.style.cssText,S.style.cssText=L.style.cssText):(P.setAttribute(U.name,U.value),S.setAttribute(U.name,
U.value)))}L.parentNode.insertBefore(S,L);S.parentNode.insertBefore(P,S);S.parentNode.insertBefore(M,S);0==S.childNodes.length&&S.parentNode.removeChild(S);0==P.childNodes.length&&P.parentNode.removeChild(P)}else!C&&-1<",ul,ol,".indexOf(","+L.parentNode.tagName.toLowerCase()+",")?L.parentNode.insertBefore(M,L):!F&&-1<",ul,ol,".indexOf(","+L.parentNode.tagName.toLowerCase()+",")&&(L.nextSibling?L.parentNode.insertBefore(M,L.nextSibling):L.parentNode.appendChild(M));1==K&&""==M.innerText&&(d=!1,doSetCaretPosition(M,
0));0==L.childNodes.length&&L.parentNode.removeChild(L)}}d&&(c.setStartBefore(H.firstChild),c.setEndAfter(J.lastChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(c));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else if(e&&"1"!=DEXTTOP.G_CURREDITOR._config.disableTabletap){var ea=GetParentbyTagName(e,"tr");if(ea){var ga=e.cellIndex,aa=ea.rowIndex;if(0<ga){var X=ea.cells[ga-1];if(X){X.focus();removeCellDefValue(X,
!1);var ka=getFirstChildNodeForCaret(X);doSetCaretPosition(ka,0)}}else{var O=GetParentbyTagName(ea,"table");if(O&&(aa=ea.rowIndex,0<aa)){var Q=O.rows[aa-1];Q&&(X=Q.cells[Q.cells.length-1])&&(X.focus(),removeCellDefValue(X,!1),ka=getFirstChildNodeForCaret(X),doSetCaretPosition(ka,0))}}}}}}catch(da){}}
function setTabkeyAction(){try{var a=null,b=getFirstRange().range;b&&b.startContainer&&(a=getMyElementNode(b.startContainer));if(a){var c=GetTDTHCell(a);if(null==c&&"tr"==a.tagName.toLowerCase()){var d=a.cells.length;0<d&&(c=a.cells[d-1])}var d=!1,e=GetParentbyTagName(a,"li");if(e)if(c)for(var f=c.getElementsByTagName("li"),g=f.length,h=0;h<g;h++){if(e==f[h]){d=!0;break}}else d=!0;var n=a.tagName.toLowerCase();if(-1<",li,ul,ol,".indexOf(","+n+",")||d)if("2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode)if(0==
b.toString().length){var m=b.startContainer;3==m.nodeType&&(m=m.parentNode);if("OL"==m.tagName||"UL"==m.tagName)m=m.getElementsByTagName("li")[0];var m=GetParentbyTagName(m,"li"),p=createNodeForCaret(1)[0];b.collapse(!0);b.insertNode(p);canMoveLiNode(m,1)&&moveLiNode(m,1);b.setStartBefore(p);b.setEndBefore(p);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);p.parentNode.removeChild(p);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0}else{var p=createNodeForCaret(2),t=p[0],q=p[1],u=!0,v=b.cloneRange();try{b.collapse(!1);b.insertNode(q);sel.removeAllRanges();sel.addRange(v);b=getFirstRange().range;b.collapse(!0);b.insertNode(t);var w=q.previousSibling;w&&"LI"==w.tagName&&w.appendChild(q);b.setStartBefore(t);b.setEndBefore(q);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b)}catch(y){removeNodeForCaret(),u=!1}if(0==u)try{u=!0;p=createNodeForCaret(2);t=p[0];q=p[1];try{b.setStart(b.endContainer,
b.endOffset),b.setEnd(b.endContainer,b.endOffset)}catch(x){3==b.endContainer.nodeType&&(b.setStart(b.endContainer,b.endContainer.length),b.setEnd(b.endContainer,b.endContainer.length))}b.insertNode(q);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(v);b=getFirstRange().range;try{b.setStart(b.startContainer,b.startOffset),b.setEnd(b.startContainer,b.startOffset)}catch(z){3==b.startContainer.nodeType&&(b.setStart(b.startContainer,0),b.setEnd(b.startContainer,
0))}b.insertNode(t);(w=q.previousSibling)&&"LI"==w.tagName&&w.appendChild(q);b.setStartBefore(t);b.setEndBefore(q);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b)}catch(A){removeNodeForCaret(),u=!1}if(u){b=getFirstRange().range;m=b.startContainer;3==m.nodeType&&(m=m.parentNode);var B=b.endContainer;3==B.nodeType&&(B=B.parentNode);m=GetParentbyTagName(m,"li");B=GetParentbyTagName(B,"li");if(m&&B){if(m==B)canMoveLiNode(m,1)&&moveLiNode(m,1);else{u=[];if(m.parentNode==
B.parentNode&&canMoveLiNode(m,1)){u.push(m);for(var G=m.nextSibling;G!=B;)u.push(G),G=G.nextSibling;u.push(B)}for(var D=u.length,h=0;h<D;h++)moveLiNode(u[h],1)}b.setStartBefore(t);b.setEndAfter(q);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);removeNodeForCaret();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else removeNodeForCaret()}else rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(v)}else{for(var I=
getNodesInRange(b),u=[],K=I.length,h=0;h<K;h++)"1"==I[h].nodeType&&"li"==I[h].tagName.toLowerCase()&&u.push(I[h]);for(var D=u.length,E,N,m=!0,h=0;h<D;h++){var H,J=u[h],M=J.previousSibling,L=J.nextSibling,F=M&&M.tagName?M.tagName.toLowerCase():"",C=L&&L.tagName?L.tagName.toLowerCase():"";if(!L&&"li"==F||!M&&"li"==C||"li"==F&&"li"==C||!L&&!M){p="";switch(J.parentNode.style.listStyleType.toLowerCase()){case "decimal":p="upper-alpha";break;case "decimal-leading-zero":p="upper-alpha";break;case "upper-alpha":p=
"lower-alpha";break;case "lower-alpha":p="upper-roman";break;case "upper-roman":p="lower-roman";break;case "lower-roman":p="lower-greek";break;case "lower-greek":p="decimal";break;case "disc":p="circle";break;case "circle":p="square";break;case "square":p="disc";break;default:p="upper-alpha"}var W=document.createElement(J.parentNode.tagName);W.style.listStyleType=p;W.innerHTML=J.outerHTML;J.parentNode.replaceChild(W,J);H=W.firstChild}else M&&-1<",ul,ol,".indexOf(","+F+",")?(M.appendChild(J),H=M.lastChild):
L&&-1<",ul,ol,".indexOf(","+C+",")&&(L.insertBefore(J,L.firstChild),H=L.firstChild);0==h&&(E=H);if(h==D-1){N=H;var V=N.parentNode,P=V.nextSibling;if(P&&P.tagName&&P.tagName==V.tagName){for(;P.childNodes[0];)V.appendChild(P.childNodes[0]);P.parentNode.removeChild(P)}}1==D&&""==H.innerText&&(m=!1,doSetCaretPosition(H,0))}m&&(b.setStartBefore(E.firstChild),b.setEndAfter(N.lastChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}else if(c&&"1"!=DEXTTOP.G_CURREDITOR._config.disableTabletap){var S=GetParentbyTagName(c,"tr");if(S){var fa=c.cellIndex,ba=S.rowIndex;if(S.cells.length>fa+1){var U=S.cells[fa+1];if(U){U.focus();removeCellDefValue(U,!1);var ea=getFirstChildNodeForCaret(U);doSetCaretPosition(ea,0)}}else{var ga=GetParentbyTagName(S,"table");if(ga&&(ba=S.rowIndex,ga.rows.length>ba+1)){var aa=ga.rows[ba+1];aa&&(U=aa.cells[0])&&(U.focus(),removeCellDefValue(U,!1),ea=getFirstChildNodeForCaret(U),
doSetCaretPosition(ea,0))}}}}else 0==GetTableSelectionCells().length&&(pasteHtmlAtCaretMini(DEXTTOP.G_CURREDITOR._config.tabSpace),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}}catch(X){}}
function setTableArrowKeyDownAction(a){G_CURSOR_BEFORE_INTABLE=!1;G_BEFORE_INTABLE=null;a="which"in a?a.which:a.keyCode;var b=getFirstRange().range;try{var c=null;b&&(c=getMyElementNode(b.startContainer));if(c){var d=GetTDTHCell(c);if(null==d&&"tr"==c.tagName.toLowerCase()){var e=c.cells.length;0<e&&(d=c.cells[e-1])}if(d){G_CURSOR_BEFORE_INTABLE=!0;G_BEFORE_INTABLE=GetParentbyTagName(d,"table");var f=GetParentbyTagName(d,"tr");if(f){var g=f.cells[d.cellIndex],h=getTopOrBottomBoundNextCell(d,a);if(null!=
h.nextCell){var n=GetParentbyTagName(f,"table");if(n){var m=n.rows[h.rowIndex];if(m){var p=m.cells[h.cellIndex];p&&200>p.innerHTML.length&&(""==ReplaceAll(p.innerHTML," ","")||1==checkCellDefValue(p.innerHTML))&&0==checkCellBRValue()&&"1"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&(p.innerHTML="<p></p>")}else setCellDefValue(g)}}else setCellDefValue(g)}}}}catch(t){}}
function setTableArrowKeyUpAction(a){a="which"in a?a.which:a.keyCode;var b=getFirstRange().range;try{var c=null;b&&(c=getMyElementNode(b.startContainer));if(c){var d=GetTDTHCell(c);if(null==d&&"tr"==c.tagName.toLowerCase()){var e=c.cells.length;0<e&&(d=c.cells[e-1])}if(d){var f=GetParentbyTagName(d,"tr");if(f){var g=f.cells[d.cellIndex];setTableAllCellDefValue(g);if(200>g.innerHTML.length){RegExp("<p([^>?+]*)>&nbsp;</p>","gi").test(g.innerHTML);var h=ReplaceAll(g.innerHTML,RegExp.$1,"");if(""==ReplaceAll(g.innerHTML,
" ","")||1==checkCellDefValue(h)||h=="<p>"+unescape("%u200B")+"</p>")DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&h=="<p>"+unescape("%u200b")+"</p>"&&(g.innerHTML=""!=RegExp.$1?"<p "+RegExp.$1+"></p>":"<p></p>"),0==checkCellBRValue()&&(g.innerHTML=""!=RegExp.$1?"<p "+RegExp.$1+"></p>":"<p></p>"),doSetCaretPosition(g.childNodes[0],0)}}}else if(G_CURSOR_BEFORE_INTABLE&&"body"==c.tagName.toLowerCase()&&(d=!0,37==a||38==a?null==G_BEFORE_INTABLE.previousSibling&&
(d=!1):39!=a&&40!=a||null!=G_BEFORE_INTABLE.nextSibling||(d=!1),0==d)){var n=_iframeDoc.createElement("p");n.innerHTML=getDefaultParagraphValue(!1);b.insertNode(n);doSetCaretPosition(n,0)}}}catch(m){}}
function getTopOrBottomBoundNextCell(a,b){var c={rowIndex:-1,cellIndex:-1,nextCell:null},d;switch(b){case 38:d=1;break;case 39:d=2;break;case 40:d=3;break;case 37:d=4;break;default:return c}try{var e=GetParentbyTagName(a,"tr");if(e){var f=GetParentbyTagName(a,"table");if(f){var g=f.rows.length,h=e.rowIndex,n=a.cellIndex,m=e.cells.length;if(1==d){if(0==h)return c;for(var p=h-1;0<=p;p--)for(var t=f.rows[p],q=t.cells.length,u=getClientRect(a),v=0;v<q;v++){var w=t.cells[v],y=getClientRect(w);if(1>u.top-
y.bottom&&-1<u.top-y.bottom&&(u.left==y.left||u.left>y.left&&u.left<y.right)){var x=GetParentbyTagName(w,"tr");if(x)return c.rowIndex=x.rowIndex,c.cellIndex=w.cellIndex,c.nextCell=w,c}}}else if(2==d){if(n!=m-1?(c.rowIndex=h,c.cellIndex=n+1):(c.rowIndex=e.rowIndex+1,c.cellIndex=0),f&&(t=f.rows[c.rowIndex]))if(w=t.cells[c.cellIndex])return c.nextCell=w,c}else if(3==d){if(g==h)return c;for(p=h+1;p<g;p++)for(t=f.rows[p],q=t.cells.length,u=getClientRect(a),v=0;v<q;v++)if(w=t.cells[v],y=getClientRect(w),
1>u.bottom-y.top&&-1<u.bottom-y.top&&(u.left==y.left||u.left>y.left&&u.left<y.right)&&(x=GetParentbyTagName(w,"tr")))return c.rowIndex=x.rowIndex,c.cellIndex=w.cellIndex,c.nextCell=w,c}else if(4==d)if(0!=n){if(c.rowIndex=h,c.cellIndex=n-1,f&&(t=f.rows[c.rowIndex]))if(w=t.cells[c.cellIndex])return c.nextCell=w,c}else if(c.rowIndex=h-1,f&&(t=f.rows[c.rowIndex]))return c.cellIndex=t.cells.length-1,c.nextCell=t.cells[t.cells.length-1],c}}}catch(z){}return c}function setArrowKeyAction(a){return!1}
function setDeleteKeyAction(a){a=!1;try{for(var b=GetTableSelectionCells(),c=b.length,d=0;d<c;d++)b[d].innerHTML=getCellDefValue();0<c&&(ClearDraggingTableCellSelected(),removeCellDefValue(b[0],!1),removeCellDefValue(b[c-1],!1),doSetCaretPosition(b[0].childNodes[0],0),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&"&nbsp;"==b[0].innerHTML&&(b[0].innerHTML=""),a=!0)}catch(e){}return a}
function getCopyCellData(a){DEXTTOP.G_COPIEDTABLE=null;DEXTTOP.G_COPIEDCELLDATA=null;a=!1;if(null!=ActiveLastTable){var b=CellSelectedCopy(ActiveLastTable);1==b.selected&&(DEXTTOP.G_COPIEDTABLE=b.Table,DEXTTOP.G_COPIEDCELLDATA=b.cellValue,a=!0)}return a}function dextWriteLog(a,b){void 0==b&&(b=!1);if(0==DEXTTOP.DEXT5.isRelease)try{b?parent.parent.document.getElementById("txtTestValue").value+=a:parent.parent.document.getElementById("txtTestValue").value=a}catch(c){}}
function _dextiframe_BeforeUnload(a){try{var b=getEditorFromUnloadEvent(a);if(b)try{if(b._config.auditLogEnable&&"1"==b._config.auditLogEnable&&DEXTTOP&&DEXTTOP.DEXT5&&DEXTTOP.DEXT5.browser.LocalStorageSupported){var c=ALS.toString(),c=c.replace(/,/gi,""),d=DEXTTOP.window.localStorage[c];a=!1;if(null!=d&&void 0!=d&&""!=d)for(var e=d.split(","),f=e.length,g=0;g<f;g++)if(e[g]==b._config.productKey){a=!0;break}if(null==d||void 0==d||""==d||!a){DEXTTOP.window.localStorage[c]=null==d||void 0==d||""==d?
b._config.productKey:d+","+b._config.productKey;var h=DEXTTOP.DEXT5.util.makeEncryptParam("ED"+b._config.unitAttributeDelimiter+___+b._config.unitAttributeDelimiter+b._config.productKey);try{_C="https:"!=location.protocol?C1.toString():C2.toString(),_C=_C.replace(/,/gi,""),_C=_C+"?p="+h,(new Image).src=_C}catch(n){}}}}catch(m){}}catch(p){}}function _dextiframe_Unload(a){try{var b=getEditorFromUnloadEvent(a);if(b&&"1"==b._config.autoDestroy.use)try{DEXTTOP.DEXT5.destroy(b)}catch(c){}}catch(d){}}
function _dextiframe_Keyup(a){var b="which"in a?a.which:a.keyCode,c=a.target?a.target:a.srcElement,d=null,d=9!=c.nodeType?c.ownerDocument:c;if((d=d.activeElement)&&d.tagName&&"body"!=d.tagName.toLowerCase()&&"html"!=d.tagName.toLowerCase()){var e=d.parentNode,f=d.tagName.toLowerCase(),e=e.tagName.toLowerCase();if(!("span"!=e&&"li"!=e||"a"!=f&&"button"!=f))if(13==b){f=d.id.split(":")[0];e=d.id.split(":")[1];void 0==e&&(e=f.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,""));"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&
-1<e.indexOf("tool_bar_grouping")&&(DEXTTOP.G_CURREDITOR.groupingBoxOpen=!0);var g=isMenuItemEnable(f,e);!g||"shortcut"==e&&1==G_ShortCutClose||(DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,e),DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),G_ShortCutClose=!1)}else if(9==b)f=d.id.split(":")[0],e=d.id.split(":")[1],void 0==e&&(e=f.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,"")),g=isMenuItemEnable(f,e),g||(a=moveNextMenu(f,e))&&a.focus();else if(39==b){if(f=d.id.split(":")[0],
e=d.id.split(":")[1],void 0==e&&(e=f.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,"")),d=moveNextMenu(f,e))for(f=d.id.split(":")[0],e=d.id.split(":")[1];;)if(g=isMenuItemEnable(f,e)){d.focus();break}else if(d=moveNextMenu(f,e))f=d.id.split(":")[0],e=d.id.split(":")[1];else break}else if(37==b&&(f=d.id.split(":")[0],e=d.id.split(":")[1],void 0==e&&(e=f.replace("ue_"+DEXTTOP.G_CURREDITOR.ID,"")),d=movePrevMenu(f,e)))for(f=d.id.split(":")[0],e=d.id.split(":")[1];;)if(g=isMenuItemEnable(f,e)){d.focus();break}else if(d=
movePrevMenu(f,e))f=d.id.split(":")[0],e=d.id.split(":")[1];else break;if(27==b&&"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping){b=c;for(c=!1;"BODY"!=b.tagName;)if(-1<b.id.indexOf("dext_div_tool_bar_grouping_box")){c=!0;break}else b=b.parentNode;c&&(hideGroupingBox(),setTimeout(function(){setFocusToBody()},1))}}}
function _dextiframe_Keydown(a){var b=a.target||a.srcElement,c="which"in a?a.which:a.keyCode;try{var d=DEXTTOP.G_CURREDITOR,e=d.getEditorMode();if(b&&b.tagName&&"textarea"==b.tagName.toLowerCase()){if(13==c){var f=b.id;switch(f){case "ue_"+d.ID+"zoom_text":case "txtara_"+d.ID+"font_family":case "txtara_"+d.ID+"font_size":case "txtara_"+d.ID+"line_height":DEXTTOP.DEXT5.util.stopEvent(a),DEXTTOP.DEXT5.util.cancelEvent(a),d.dextiframeKeydown=!0}switch(f){case "ue_"+d.ID+"zoom_text":command_zoom(d.ID,
d);break;case "txtara_"+d.ID+"font_family":d._dextFontFamily.click_func(d.ID,null,b.value);break;case "txtara_"+d.ID+"font_size":d._dextFontSize.click_func(d.ID,null,b.value);break;case "txtara_"+d.ID+"line_height":d._dextLineHeight.click_func(d.ID,null,b.value)}}return}if(8==c&&"design"==e){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(g){}a.ctrlKey&&!a.altKey&&nextTabKeyAccess(a,c)&&DEXTTOP.DEXT5.util.cancelEvent(a)}
function nextTabKeyAccess(a,b){var c=!1;try{var d=null;switch(b){case 48:var e=DEXTTOP.DEXTDOC.getElementById(DEXTTOP.G_CURREDITOR._config.nextTabElementId);e?setTimeout(function(){e.focus()},0):setFocusTopWindow();var f=getEditrFromEvent(a);f&&(f._dextframeHasFocus=!1);c=!0;break;case 49:d=getFirstCmdElementInBar("dext_tab_menu_"+DEXTTOP.G_CURREDITOR.ID);c=!0;break;case 50:d=getFirstCmdElementInBar("dext_tab_tool1_"+DEXTTOP.G_CURREDITOR.ID);c=!0;break;case 51:d=getFirstCmdElementInBar("dext_tab_tool2_"+
DEXTTOP.G_CURREDITOR.ID);c=!0;break;case 52:setFocusToBody();c=!0;break;case 53:d=getFirstCmdElementInBar("dext_tab_status_"+DEXTTOP.G_CURREDITOR.ID);c=!0;break;case 54:var g=document.getElementById("dext_topstatusbar_"+DEXTTOP.G_CURREDITOR.ID),d=g&&g.getElementsByTagName("a")[0]?g.getElementsByTagName("a")[0]:null,c=!0;break;case 123:DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"shortcut");c=!0;break;case 66:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"bold"),c=!0;break;case 73:if(f=
getEditrFromEvent(a))f._dextCommands(f.ID,"italic"),c=!0;break;case 85:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"underline"),c=!0;break;case 68:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"strike_through"),c=!0;break;case 76:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"align_left"),c=!0;break;case 69:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"align_center"),c=!0;break;case 72:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"align_right"),c=!0;break;case 75:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,
"hyperlink_property"),c=!0;break;case 222:if(f=getEditrFromEvent(a))a.shiftKey?f._dextCommands(f.ID,"superscript"):f._dextCommands(f.ID,"subscript"),c=!0;break;case 221:(f=getEditrFromEvent(a))&&a.shiftKey&&(f._dextCommands(f.ID,"table_indent"),c=!0);break;case 219:(f=getEditrFromEvent(a))&&a.shiftKey&&(f._dextCommands(f.ID,"table_outdent"),c=!0)}if(d){var h=d.id.split(":")[0],n=d.id.split(":")[1];if(isMenuItemEnable(h,n)){if(DEXTTOP.DEXT5.browser.chrome)try{window.focus()}catch(m){}d.focus()}else{var p=
moveNextMenu(h,n);if(p){if(DEXTTOP.DEXT5.browser.chrome)try{window.focus()}catch(t){}p.focus()}}}}catch(q){}return c}function isMenuItemEnable(a,b){var c=!0,d=document.getElementById("dext_span_"+a+b);d&&(d=DEXTTOP.DEXT5.util.getClass(d))&&-1<d.indexOf("_off")&&(c=!1);return c}
function moveNextMenu(a,b){var c=null,d=document.getElementById("dext_span_"+a+b);if(d&&d.nextSibling){var d=d.nextSibling,e="";d.tagName&&(e=d.tagName.toLowerCase());"span"==e&&1==d.childNodes.length&&(d=d.nextSibling);if("span"==e&&1<d.childNodes.length&&(c=d.childNodes[1],d=c.id.split(":")[1],!isMenuItemEnable(a,d)))return moveNextMenu(a,d)}return c}
function movePrevMenu(a,b){var c=null,d=document.getElementById("dext_span_"+a+b);if(d&&d.previousSibling){var d=d.previousSibling,e=d.tagName.toLowerCase();"span"==e&&1==d.childNodes.length&&(d=d.previousSibling);if("span"==e&&1<d.childNodes.length&&(c=d.childNodes[1],d=c.id.split(":")[1],!isMenuItemEnable(a,d)))return movePrevMenu(a,d)}return c}
function getFirstCmdElementInBar(a){var b=null;try{var c=document.getElementById(a),d=c.childNodes.length;for(a=0;a<d;a++){var e=c.childNodes[a];if(1===e.nodeType&&0<e.childNodes.length){for(var f=e.childNodes.length,g=0;g<f;g++){var h=e.childNodes[g];if(1===h.nodeType&&("a"==h.tagName.toLowerCase()||"button"==h.tagName.toLowerCase())){b=h;break}}if(b)break}}}catch(n){b=null}return b}
function getImageAutoFitForPasteHtml(a){var b=document.createElement("div");b.innerHTML=a;a=!1;1==b.firstChild.nodeType&&"IMG"==b.firstChild.tagName&&3==b.lastChild.nodeType&&"|"==b.lastChild.nodeValue&&2==b.childNodes.length&&(a=!0,b.removeChild(b.lastChild));for(var c=b.getElementsByTagName("img"),d=null,e=c.length,f=0;f<e;f++){var d=c[f],g=d.src,h=G_dext5plugIn.getImageWidthHeight(g);if(0<h.length){var n=d.style.width.replace("px","");""==n&&(n=d.width);var m=d.style.height.replace("px","");""==
m&&(m=d.height);n=n+"^"+m;a||n!=h||(g=g+"?"+h,SetImageAutoFitSize(d,g))}}return a=b.innerHTML}function removeHistory(a){}
function set_view_mode_auto_height(a){try{setTimeout(function(){var b=DEXTTOP.G_CURREDITOR;a&&(b=a);if(("1"==b._config.view_mode_auto_height||"1"==b._config.view_mode_auto_width)&&"view"==b._config.mode){var d=b._BODY,e=b._DOC.documentElement,f=b._config.style.height,g=b._config.style.width,h=0;if(0>f.indexOf("%"))h=parseInt(f,10);else if("1"==b._config.view_mode_auto_height)return;var n=0;if(0>g.indexOf("%"))n=parseInt(g,10);else if("1"==b._config.view_mode_auto_width)return;var m=0,p=0;"1"==b._config.view_mode_auto_height?
(f="",DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&(f=d.style,d.style="overflow:initial !important"),m=Math.max(d.scrollHeight,d.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight),DEXTTOP.DEXT5.browser.mobile&&DEXTTOP.DEXT5.browser.iOS&&(d.style=f),m>=h&&(m+=30)):(m=h,-1<f.indexOf("%")&&(m=f));"1"==b._config.view_mode_auto_width?(p=Math.max(d.scrollWidth,d.offsetWidth,e.clientWidth,e.scrollWidth,e.offsetWidth),p>=n&&(p+=10)):(p=n,-1<g.indexOf("%")&&(p=g));DEXTTOP.DEXT5.setSize(p,
m,b.ID)}},250)}catch(b){}}function getFontStyle(a,b){var c,d={fontFamily:"",fontSize:"",lineHeight:""};b?window.getComputedStyle?c=window.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle):a.currentStyle?c=a.currentStyle:window.getComputedStyle&&(c=window.getComputedStyle(a,""));d.fontFamily=getFontFamilyStyle(c.fontFamily);d.fontSize=getFontSizeStyle(c.fontSize,c.lineHeight);d.lineHeight=getLineHeightStyle(d.fontSize,c.lineHeight,a);return d}
function getFontFamilyStyle(a){0<a.length&&(a=a.replace(/"/gi,""),a=a.replace(/'/gi,""),a=a.split(",")[0]);return a}
function getFontSizeStyle(a,b){var c,d="pt";try{-1<DEXTTOP.G_CURREDITOR._dextFontSize._fontSize[DEXTTOP.G_CURREDITOR.ID][0].indexOf("px")&&(d="px")}catch(e){-1<DEXTTOP.G_CURREDITOR._config.defaultFontSize.indexOf("px")&&(d="px")}a=a.toString();-1<a.indexOf("px")?"pt"==d?(c=.75*parseFloat(a),c=Math.round(c)+"pt"):"px"==d&&(c=a):-1<a.indexOf("pt")?"pt"==d?c=a:"px"==d&&(c=parseFloat(a)*(4/3),c=Math.round(c)+"px"):-1<a.indexOf("em")?"pt"==d?-1<b.indexOf("px")?(c=.75*parseFloat(b),c*=parseFloat(a),c=Math.round(c)+
"pt"):-1<b.indexOf("pt")?(c=parseFloat(b)*parseFloat(a),c=Math.round(c)+"pt"):c="":"px"==d&&(-1<b.indexOf("px")?(c=parseFloat(b)*parseFloat(a),c=Math.round(c)+"px"):-1<b.indexOf("pt")?(c=parseFloat(b)*(4/3),c*=parseFloat(a),c=Math.round(c)+"px"):c=""):c="";return c}
function getLineHeightStyle(a,b,c){if(!DEXTTOP.DEXT5.browser.ie){if(1==c.nodeType&&0>",p,li,dt,dd,h1,h2,h3,h4,h5,h6,pre,table,hr,blockquote,address,body,td,th,div,".indexOf(","+c.tagName.toLowerCase()+","))for(;0>",p,li,dt,dd,h1,h2,h3,h4,h5,h6,pre,table,hr,blockquote,address,body,td,th,div,".indexOf(","+c.tagName.toLowerCase()+",");)c=c.parentNode;c.currentStyle?compStyle=c.currentStyle:window.getComputedStyle&&(compStyle=window.getComputedStyle(c,""));a=compStyle.fontSize;b=compStyle.lineHeight}var d=
!0,e=DEXTTOP.G_CURREDITOR._config.lineHeightList[0];e&&0>e.indexOf("%")&&(d=!1);e=b;-1<b.indexOf("px")?(e=parseFloat(a),b=parseFloat(b),-1<a.indexOf("pt")&&(e=96*e/72),b=Math.round(b/e*10)/10,e=d?parseInt(100*b,10)+"%":b):-1<b.indexOf("pt")?(e=parseFloat(a),b=parseFloat(b),-1<a.indexOf("pt")&&(e=96*e/72),b=96*b/72/e,b=Math.round(10*b)/10,e=d?parseInt(100*b,10)+"%":b):-1<b.indexOf("normal")||-1<b.indexOf("inherit")?e=b:"1"==DEXTTOP.G_CURREDITOR._config.lineHeightMode&&d&&(e=Math.round(100*parseFloat(b))+
"%");c=c.tagName.toLowerCase();if("h1"==c||"h2"==c||"h3"==c||"h4"==c||"h5"==c||"h6"==c||""==a)e="";return e}
function setAutoSave(a,b){try{var c=a._setting.auto_save.toString().split(",");a._setting.auto_save_fn&&DEXTTOP.DEXTWIN.clearInterval(a._setting.auto_save_fn);if(DEXTTOP.DEXT5.browser.LocalStorageSupported)if("1"==c[0]){DEXTTOP.DEXTWIN.localStorage["dext_"+a.ID+"_auto_save"]=c[1];var d=6E4*c[1],e=a._config.setAutoSave.use_encrypt,f=a._config.setAutoSave.unique_key,g="dext_"+a.ID;""!=f&&(g+="_"+f);if(b){var h=DEXTTOP.DEXTWIN.localStorage["dext_"+a.ID];null!=h&&void 0!=h&&""==f&&(DEXTTOP.DEXT5.util.saveJsonToLocalStorage(g+
"_0",{date:a._DOC.lastModified,html:h}),DEXTTOP.DEXTWIN.localStorage.removeItem("dext_"+a.ID))}localSaveValue(g,e);a._setting.auto_save_fn=DEXTTOP.DEXTWIN.setInterval(function(){if(DEXTTOP&&DEXTTOP.G_CURREDITOR){if(!isViewMode(DEXTTOP.G_CURREDITOR)){var b="",c=a.getEditorMode();if("design"==c)b=DEXTTOP.DEXT5.getHtmlValueExWithDocType(a.ID,!0);else if("source"==c){c=a._EDITOR.source.value;c=c.replace(/\t/g,"");if("1"==a._config.sourceViewtype||"2"==a._config.sourceViewtype)c=removeCRLFChar(c);c=DEXTTOP.DEXT5.util.htmlRevision(c);
c=xssReplaceScript(null,c);"0"==DEXTTOP.G_CURREDITOR._config.viewImgBase64Source&&(c=DEXTTOP.DEXT5.util.ImageSrcConvert(c,!0,DEXTTOP.G_CURREDITOR.ID));var b=a._docType[a._PageProp.doctype],d=a._PageProp.lang,f=a._PageProp.xmlnsname,h=_iframeDoc.getElementsByTagName("head")[0].outerHTML,m=_iframeDoc.getElementsByTagName("body")[0],n="<html";0<d.length&&(-1<d.indexOf("-")&&(d=d.split("-")[0]),n+=' lang="'+d+'" xml:lang="'+d+'"');0<f.length&&(n+=' xmlns="'+f+'"');f=m.id;d="<body>";""!=f&&null!=f&&void 0!=
f&&(d="<body id='"+m.id+"'>");b=b+(n+">")+h+d+c+"<body></html>"}else"preview"==c?(c=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document,b=a._docType[a._PageProp.doctype],b+=c.documentElement.outerHTML):"text"==c&&(b=a._EDITOR.text.value);h=DEXTTOP.DEXT5.isEmpty(a.ID,!0);m="";c=5;for(n=4;0<=n;n--)m=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(g+"_"+n),null==m&&void 0==m&&(c=n);0==h&&(h="",h="1"==e?DEXTTOP.DEXT5.util.makeEncryptParam(b):b,b={date:a._DOC.lastModified,
html:h},4<c&&(--c,pushAutoSave(g,0)),DEXTTOP.DEXT5.util.saveJsonToLocalStorage(g+"_"+c,b));autoSaveEnable(a.ID)}}else try{clearInterval(a._setting.auto_save_fn)}catch(x){}},d);var n=DEXTTOP.DEXTWIN.localStorage[g+"_0"];null!=n&&void 0!=n&&autoSaveEnable(a.ID)}else"2"==c[0]&&(DEXTTOP.DEXTWIN.localStorage.removeItem("dext_"+a.ID+"_auto_save"),DEXTTOP.DEXTWIN.localStorage.removeItem("dext_"+a.ID),a._iconEnable(""))}catch(m){}}
function getAutoSaveHtml(a){var b=void 0;try{b=DEXTTOP.DEXTWIN.localStorage["dext_"+a]}catch(c){}return b}
function getAutoSaveHtml_userID(a,b){var c=void 0,d=[],e,f={},g="dext_"+a;""!=b&&null!=b&&void 0!=b&&(g+="_"+b);try{for(var h=0;5>h;h++)if(c=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(g+"_"+h),null!=c&&void 0!=c){var n=c.html.toLowerCase().indexOf("<html");-1<n?e=c.html:0>n&&(e=DEXTTOP.DEXT5.util.makeDecryptReponseMessage(c.html));f={date:c.date,html:e};d.push(f)}}catch(m){}return 0<d.length?d:c}
function getAutoSave(a){try{var b=DEXTTOP.DEXTWIN.localStorage["dext_"+a.ID+"_auto_save"];return b?"1,"+b:"2"}catch(c){return"0"}}
function _iframeDoc_Scroll(a){setDEXTWINDOC();try{if(DEXTTOP.G_CURREDITOR.isStopScroll){var b=Math.max(_iframeDoc.documentElement.scrollLeft,_iframeDoc.body.scrollLeft);_iframeWin.scroll(b,DEXTTOP.G_CURREDITOR.previousScrollTop);DEXTTOP.DEXT5.util.cancelEvent(a);DEXTTOP.DEXT5.util.stopEvent(a);return!1}DEXTTOP.DEXT5.browser.ie&&(DEXTTOP.G_CURREDITOR.previousScrollTop=Math.max(_iframeDoc.documentElement.scrollTop,_iframeDoc.body.scrollTop))}catch(c){}if(getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv){var b=
getElementOffset(_iframeWin.frameElement),d=getClientRect(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem);DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv.style.left=b.left+d.left-DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDivBorder+"px";DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv.style.top=b.top+d.top-DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDivBorder+"px";DEXTTOP.G_CURREDITOR.dext_dragresize.setHandlePosition()}moveRulerPosition(a)}
function moveRulerPosition(a){if(1==DEXTTOP.G_CURREDITOR._config.ruler.use){var b=getEditrFromEvent(a);if(null==b||void 0==b)b=DEXTTOP.G_CURREDITOR;if((a=getEditorFrameDoc(b).getElementById("dext_tab_tool3_"+b.ID))&&"none"!=a.style.display){var c=a.style.backgroundPosition,d=a.style.backgroundPosition.indexOf("px"),c=parseInt(c.substring(0,d),10),d=b._DOC.documentElement.scrollLeft||b._BODY.scrollLeft||0;c!=d&&(a.style.backgroundPosition="-"+d+"px top",set_ruler_point_position(b));setTimeout(function(){set_ruler_pointline_position(b)},
0)}}}
function set_ruler_point_position(a){if("1"==a._config.ruler.viewPointer){var b=getEditorFrameDoc(a),c=a._setting.ruler_position.split(","),d=c.length;"2"==a._config.ruler.mode&&(d=3);var e=b.getElementById("dext_tab_tool3_"+a.ID),f=e.getElementsByTagName("img"),g=f.length,h=!0;if(d!=g)for(h=!1,--g;0<=g;g--)f[g].parentNode.removeChild(f[g]);for(g=0;g<d;g++){if(0==h){var n=b.createElement("img");n.id="dext_ruler_point_"+g+"_"+a.ID;n.src="../images/bg/point.gif";n.style.verticalAlign="top";n.style.border="0px";
n.style.width="14px";n.style.height="9px";n.style.margin="0 0 0 -7";n.style.display="none";n.style.position="absolute";n.style.top="-1px";e.appendChild(n)}var f=b.getElementById("dext_ruler_point_"+g+"_"+a.ID),n=parseIntOr0(f.style.width),m=parseIntOr0(c[g])-n/2,n=_iframeDoc.documentElement.scrollLeft||_iframeDoc.body.scrollLeft||0,m=m-n;f.style.marginLeft=m+"px";"2"!=a._config.ruler.mode&&(f.style.display=0>=m?"none":"")}"1"==a._config.autoBodyFit&&("2"!=a._config.ruler.mode||"2"==a._config.ruler.mode&&
a.isInitBodyAutoFit)&&(b=parseIntOr0(_iframeDoc.body.style.width),c=parseIntOr0(c[c.length-1]),0<c&&c!=b&&(_iframeDoc.body.style.width=c-10+"px"));"2"==a._config.ruler.mode&&(c=document.getElementById("dext_ruler_area_0"),a=document.getElementById("dext_ruler_area_1"),b=G_RULER_MOVE_AREA.realX1,d=G_RULER_MOVE_AREA.realX2,b-=n,d-=n,c.style.width=(0>=b?0:b)+"px",a.style.left=d+"px",n=getCurrEditorWidth()-d,0>n&&(n=0),a.style.width=n+"px")}}
function set_ruler_pointline_position(a){if("1"==a._config.ruler.viewGuideLine){var b=getEditorFrameDoc(a),c=a._setting.ruler_position.split(","),d=c.length;"2"==a._config.ruler.mode&&(d=3);var e=b.getElementById("dext_ruler_pointline_div"),f=e.getElementsByTagName("div"),g=f.length,h=!0;if(d!=g)for(h=!1,--g;0<=g;g--)f[g].parentNode.removeChild(f[g]);for(g=0;g<d;g++){0==h&&(f=b.createElement("div"),f.id="dext_ruler_pointline_"+g+"_"+a.ID,f.style.position="absolute",f.style.zIndex="9999",f.style.borderLeft=
a._config.ruler.guideLineStyle+" 1px "+a._config.ruler.guideLineColor,f.style.display="none",e.appendChild(f));var f=b.getElementById("dext_ruler_point_"+g+"_"+a.ID),n=parseIntOr0(f.style.width),f=parseIntOr0(c[g])-n/2,m=_iframeDoc.documentElement.scrollLeft||_iframeDoc.body.scrollLeft||0,f=f-m,m="ue_editor_holder_"+a.ID,p=b.getElementById(m),m=b.getElementById("dext_ruler_pointline_"+g+"_"+a.ID);m.style.top=p.offsetTop+"px";m.style.left=f+n/2+"px";m.style.height=p.style.height;"2"!=a._config.ruler.mode?
(n=b.getElementById("dext_tab_tool3_"+a.ID),0>=f?m.style.display="none":"none"!=n.style.display&&(m.style.display="")):m.style.display="none"}if("1"==a._config.autoBodyFit)if(c=parseIntOr0(c[d-1]),"1"==a._config.usePersonalSetting&&0==c)_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("width"):_iframeDoc.body.style.removeAttribute("width"),(b=getDefaultStyleTag(_iframeDoc,a))&&-1<b.innerHTML.toLowerCase().indexOf("width")&&(a=createEditorDefaultStyleInnerHTML(a._config,a._setting.font_family,
a._setting.font_size,a._setting.line_height),c=_iframeDoc.createElement("style"),c.type="text/css",c.styleSheet?(c.styleSheet.cssText=a,""==c.innerHTML&&(c.innerHTML=a)):c.appendChild(_iframeDoc.createTextNode(a)),b.parentNode.insertBefore(c,b),b.parentNode.removeChild(b));else{if("2"!=a._config.ruler.mode||"2"==a._config.ruler.mode&&a.isInitBodyAutoFit)a.isInitBodyAutoFit=!1,d=parseIntOr0(_iframeDoc.body.style.width),0<c&&c!=d&&(_iframeDoc.body.style.width=c-10+"px");"2"==a._config.ruler.mode&&(n=
b.getElementById("dext_tab_tool3_"+a.ID),"none"!=n.style.display&&(c=a._config.ruler.rulerInitPosition.split(",")[2],f=parseIntOr0(c),m=_iframeDoc.documentElement.scrollLeft||_iframeDoc.body.scrollLeft||0,f-=m,m="ue_editor_holder_"+a.ID,p=b.getElementById(m),m=b.getElementById("dext_ruler_pointline_3_"+a.ID),m.style.top=p.offsetTop+"px",m.style.left=f+"px",m.style.height=p.style.height,m.style.display=""))}}}
function changeSpanPageBreakProperty(a){var b=function(a){for(var b=a.length,c=0;c<b;c++){var g=a[c];if("always"==g.style.pageBreakAfter||"page"==g.style.breakAfter)g.getElementsByTagName("span")[0].innerText="",g.style.borderStyle="none",g.style.borderWidth="0px"}},c=a.getElementsByTagName("span");a=a.getElementsByTagName("div");b(c);b(a)}
function restoreSpanPageBreakProperty(a){a=a.getElementsByTagName("span");for(var b=a.length,c=0;c<b;c++){var d=a[c];"always"==d.style.pageBreakAfter&&(d.getElementsByTagName("span")[0].innerText="\ud398\uc774\uc9c0 \ubd84\ud560",d.style.borderColor="red",d.style.borderStyle="dashed",d.style.borderWidth="1px")}}
function setLineHeightForBgColor(){if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion)try{var a=getFirstRange().range,b=getMyElementNode(a.startContainer);if("SPAN"==b.tagName&&(""!=b.style.color||""!=b.style.backgroundColor)){for(var c,a=b;"BODY"!=a.parentNode.tagName;)if("P"==a.parentNode.tagName){c=a;break}else a=a.parentNode;currLineHeight=getFontStyle(b).lineHeight;var d=DEXTTOP.G_CURREDITOR._setting.line_height,a=!1;if(""==currLineHeight)a=!0;
else{var e=currLineHeight.indexOf("%");if(-1<e){var f=parseInt(currLineHeight,10);currLineHeight=f/=100}e=d.indexOf("%");-1<e&&(f=parseInt(d,10),d=f/100)}currLineHeight==d&&(a=!0);var g;1==a&&(g=1*currLineHeight+.01);g&&c&&"SPAN"==c.tagName&&a&&(c.style.lineHeight=g,c!=b&&(b.style.lineHeight=currLineHeight))}}catch(h){}}function isMsHtmlorHugeHtml(a){var b=!0;return 11>DEXTTOP.DEXT5.browser.ieVersion?b:b=RegExp('mso-[^:]+:[^;">]+;',"gi").test(a.innerHTML)}
function setEditorBorder(a,b){var c="",d="";borderYN=void 0==b?"1"==a._config.editorborder?!0:!1:b;a._config.editorborder=1==borderYN?"1":"0";borderYN?(c="_xxx",d=""):(c="",d="_xxx");var e=a._config.style.skinName,f=document.getElementById("dext_menu_"+a.ID);null!=f&&(borderYN?(f.style.borderTopWidth="1px",f.style.borderLeftWidth="1px",f.style.borderRightWidth="1px"):(f.style.borderTopWidth="0px",f.style.borderLeftWidth="0px",f.style.borderRightWidth="0px"));f=getElementsByClass("ue_table_"+e+c,document);
0<f.length&&(f[0].className="ue_table_"+e+d,getElementsByClass("ue_tg_"+e+c,document)[0].className="ue_tg_"+e+d,getElementsByClass("ue_editor_"+e+"_lr"+c,document)[0].className="ue_editor_"+e+"_lr"+d)}function getDefaultParagraphValue(a){var b="";return b=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?a?"<p>&nbsp;</p>":"&nbsp;":a?"<p><br /></p>":"<br />"}
function repairBodyFirstLastTag(a){try{var b=_iframeDoc.body.childNodes,c=b.length,d=!1,e,f;if(0==c.length)d=!0;else{f=b[0];e=b[c-1];if(1==a&&1==f.nodeType&&("table"==f.tagName.toLowerCase()||"blockquote"==f.tagName.toLowerCase())){insertPtagTableNear(!0,f);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;return}if(1!=e.nodeType||"p"!=e.tagName.toLowerCase())d=!0;if(1==e.nodeType&&"p"==e.tagName.toLowerCase()){var g=e.childNodes,h=g.length;""==e.innerText&&0<
h&&1==g[h-1].nodeType&&("img"==g[h-1].tagName.toLowerCase()||"table"==g[h-1].tagName.toLowerCase())&&(d=!0)}}if(d){var n=_iframeDoc.createElement("p");DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(n.innerHTML=getDefaultParagraphValue(!1));_iframeDoc.body.appendChild(n)}}catch(m){}}
function OfficePasteClean(a){var b=a;try{a=ReplaceAll(a,unescape("%uFEFF"),"");a=ReplaceAll(a,unescape("%u200B"),"");a=a.replace(/\r\n/g,"");a=a.replace(/\r/g,"");a=removeDummyTag(a);var c=RegExp("<span *([^>?+])*>(\\n)</span>","gi"),d="";try{var e=a.match(c);if(e)for(var f=e.length,g=0;g<f;g++)var h=e[g],n=/>\n</.exec(h),m=n[0].replace(RegExp("\\n","gi")," "),h=h.replace(n,m),d=a.replace(e[g],h)}catch(p){}""!=d&&(a=d);a=a.replace(/>\n+</g,"><");a=a.replace(/\t/g,"");a=a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,
"");a=a.replace(/<font/gi,"<span");a=a.replace(/<\/font/gi,"</span");d="(<span[^>]*?raon_placeholder.*?>)(?:\\s|<br>|<br />|  | |)</span>";c=new RegExp(d,"gim");a=a.replace(c,"$1"+unescape("%u200B")+"</span>");if(DEXTTOP.DEXT5.browser.ie){a=ReplaceAll(a,unescape("%u3000"),"");d="<font[^>]*>(?:\\s|&nbsp;|  |)</font>";a=a.replace(new RegExp(d,"gim"),"");var d="<span[^>]*>(?:|  |)</span>",t=new RegExp(d,"gim")}else a=ReplaceAll(a,"\u3000","<p><br></p>"),d="<span[^>]*>(?:|  |)</span>",t=new RegExp(d,
"gim");a=a.replace(t,"");d="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>";c=new RegExp(d,"gim");a=a.replace(c,"$1</span>");var q=document.createElement("div");q.innerHTML=a;for(var u=q.getElementsByTagName("span"),v=u.length,c=0;c<v;c++)if(null!=u[c].getAttribute("face")&&void 0!=u[c].getAttribute("face")&&""!=u[c].getAttribute("face")&&(""==u[c].style.fontFamily&&(u[c].style.fontFamily=u[c].getAttribute("face")),removeAttribute(u[c],"face")),null!=u[c].getAttribute("color")&&
void 0!=u[c].getAttribute("color")&&""!=u[c].getAttribute("color")&&(""==u[c].style.color&&(u[c].style.color=u[c].getAttribute("color")),removeAttribute(u[c],"color")),null!=u[c].getAttribute("size")&&void 0!=u[c].getAttribute("size")&&""!=u[c].getAttribute("size")){var w;switch(u[c].getAttribute("size")){case "1":w="7pt";break;case "2":w="9pt";break;case "3":w="12pt";break;case "4":w="14pt";break;case "5":w="18pt";break;case "6":w="24pt";break;case "7":w="36pt";break;default:w=""}""!=w&&""==u[c].style.fontSize&&
(u[c].style.fontSize=w);removeAttribute(u[c],"size")}if("1"==DEXTTOP.G_CURREDITOR._config.useCorrectInOutdent){var y=q.innerHTML,x=q.getElementsByTagName("p"),z=x.length;try{for(c=0;c<z;c++){var A=x[c].style.textIndent,B,G;A&&0<A.length&&(B=parseFloat(A),G=A.replace(B,"").toLowerCase());var D=x[c].style.marginLeft,I,K;D&&0<D.length&&(I=parseFloat(D),K=D.replace(I,"").toLowerCase());if(B&&I){if(G==K)var E=B+I;else"pt"==G?B=4*B/3:"cm"==G&&(B*=37.795275593333),"pt"==K?I=4*I/3:"cm"==K&&(I*=37.795275593333),
E=B+I;0>E&&(x[c].style.textIndent="",x[c].style.marginLeft="")}else B?0>B&&(x[c].style.textIndent=""):I&&0>I&&(x[c].style.marginLeft="")}}catch(N){q.innerHTML=y}}a=q.innerHTML;a=officePasteCleanForTable(a)}catch(H){a=b}return a}function removeAttributeForPasteTable(a){for(var b=["height","style"],c=b.length,d=0;d<c;d++)removeAttribute(a,b[d])}
function makeRangeSelectionMarkInDesign(){try{restoreSelection();setFocusToBody();var a=getFirstRange().range,b=getFirstRange().sel;if(a&&0<a.toString().length)if(a.startContainer==a.endContainer&&3==a.startContainer.nodeType){var c=a.startOffset,d=a.endOffset,e=a.cloneRange(),f=_iframeDoc.createElement("dextmark");f.setAttribute("class","dextmark");a.collapse(!0);a.insertNode(f);a.selectNode(f);a.setStartAfter(f);a.setEndAfter(f);a.setStart(f.nextSibling,d-c);a.setEnd(f.nextSibling,d-c);var g=_iframeDoc.createElement("dextmark");
g.setAttribute("class","dextmark");a.insertNode(g)}else e=a.cloneRange(),g=_iframeDoc.createElement("dextmark"),g.setAttribute("class","dextmark"),a.collapse(!1),a.insertNode(g),b.removeAllRanges(),b.addRange(e),a=getFirstRange().range,f=_iframeDoc.createElement("dextmark"),f.setAttribute("class","dextmark"),a.collapse(!0),a.insertNode(f);else c=a.startOffset,d=a.endOffset,a.cloneRange(),f=_iframeDoc.createElement("dextmark"),f.setAttribute("class","dextmark"),a.collapse(!0),a.insertNode(f),a.selectNode(f),
a.setStartAfter(f),f.nextSibling&&1!=f.nextSibling.nodeType&&(a.setEndAfter(f),a.setStart(f.nextSibling,d-c),a.setEnd(f.nextSibling,d-c)),g=_iframeDoc.createElement("dextmark"),g.setAttribute("class","dextmark"),a.insertNode(g)}catch(h){removeDextMarkInFrame()}}
function setRangeSelectionMarkInDesign(a){try{_iframeDoc.body.innerHTML.match(/<dextmark ([^>]+)><\/dextmark>/i);var b=getElementsByClass("dextmark",_iframeDoc,"dextmark"),c=b.length;if(0<c){var d,e,f=!0;1==c?(d=b[0],e=b[0]):2==c&&(f=!1,d=b[0],e=b[1]);setTimeout(function(){var g=getFirstRange().range;getFirstRange();g.setStartAfter(d);g.setEndBefore(e);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(g);try{var n=g.startContainer;3==n.nodeType&&(n=n.parentNode);
setMenuIconRealable(n)}catch(m){}for(n=c-1;0<=n;n--){var p=b[n];p.parentNode.removeChild(p)}b=_iframeDoc.getElementsByTagName("/dextmark");c=b.length;for(n=c-1;0<=n;n--){var p=b[n],t=p.parentNode;t.removeChild(p);DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion&&1==c&&("P"==t.tagName||"SPAN"==t.tagName)&&""==t.innerHTML&&(t.innerHTML=unescape("%uFEFF"),doSetCaretPosition(t,!0))}n=null;0==DEXTTOP.DEXT5.browser.ie&&(n=getFirstRange().range);var q=g.startContainer,g=function(){if(0==!!a){var b=
getSelectionCoords(_iframeWin);if(b&&0!=b.x&&0!=b.y){var c=getClientRect(_iframeDoc.body),d=0,e=b.y;b.x>=c.right-c.left&&(d=b.x);_iframeWin.scroll(d,e)}else b=getElementOffset(q),_iframeWin.scroll(b.left,b.top)}};f?"BODY"==q.tagName?setFocusFirstChildForStyle(q):g():g();n&&(rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(n))},0)}}catch(g){removeDextMarkInFrame()}}
function makeRangeSelectionMarkInSource(a){try{var b,c,d='<dextmark class="dextmark"></dextmark>',e=a.value.match(/<dextmark class=(.+?)><\/dextmark>/i);null!=e&&(d=e[0]);b=c=d;if(document.selection){a.focus();var f=document.selection.createRange(),g=f.text,h=g.indexOf("<"),n=g.indexOf(">");-1<n&&(h>n||-1==h)&&f.moveStart("character",n+1);h=n=-1;h=g.lastIndexOf("<");n=g.lastIndexOf(">");-1<h&&(h>n||-1==n)&&f.moveEnd("character",-(g.length-h));var m=f.duplicate();preCheckSpecialCharTextAreaOld(m)||
(f=checkSpecialCharTextAreaOldIE(f),g=f.text,f.text=b+g,""!=g&&(f.text+=c))}else if(a.selectionStart||"0"==a.selectionStart){var p=a.selectionStart,t=a.selectionEnd,q=a.value.substring(0,p),u=a.value.substring(p,t),v=a.value.substring(t,a.value.length),h=u.indexOf("<"),n=u.indexOf(">");-1<n&&(h>n||-1==h)&&(p+=n+1);h=n=-1;h=u.lastIndexOf("<");n=u.lastIndexOf(">");-1<h&&(h>n||-1==n)&&(t-=u.length-h);if(!preCheckSpecialCharTextArea(a)){var q=a.value.substring(0,p),u=a.value.substring(p,t),v=a.value.substring(t,
a.value.length),w=checkSpecialCharTextArea(q,u);0<w&&(p-=w);w=0;w=checkSpecialCharTextArea(u,v);0<w&&(t-=w);q=a.value.substring(0,p);u=a.value.substring(p,t);v=a.value.substring(t,a.value.length);a.value=q+b+u;a.value=p!=t?a.value+(c+v):a.value+v}}}catch(y){a.value=removeDextMarkInString(a.value)}}
function preCheckSpecialCharTextArea(a){var b=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],c=!1,d=a.selectionStart,e=a.selectionEnd,f=a.value.substring(0,d),d=a.value.substring(d,e);a=a.value.substring(e,a.value.length);e=f.lastIndexOf("<");f=f.lastIndexOf(">");if(e>=f)return!0;f=a.lastIndexOf(">");a=a.lastIndexOf("<");if(f<a&&-1<f)return!0;d=d.toLowerCase();if(""!=d&&-1==d.indexOf("&")&&-1==d.indexOf(";")&&4>=d.length)for(f=0;f<b.length;f++)if(-1<b[f].indexOf(d)){c=!0;break}return c}
function preCheckSpecialCharTextAreaOld(a){var b=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],c=!1,d=a.duplicate(),e=a.text,e=ReplaceAll(e,unescape("\r"),""),e=e.toLowerCase();a.moveEnd("character",-e.length);for(var f=1;1E4>=f;f++){a.moveStart("character",-f);var g=a.text;if(/>\s*</.test(g))return d.duplicate(),!0;if(-1<g.lastIndexOf(">"))break;if(-1<g.lastIndexOf("<"))return d.duplicate(),!0}a=d.duplicate();a.moveStart("character",e.length);for(f=1;1E4>=f;f++){a.moveEnd("character",f);g=a.text;if(/>\s*</.test(g))return d.duplicate(),
!0;if(-1<g.lastIndexOf("<"))break;if(-1<g.lastIndexOf(">"))return d.duplicate(),!0}if(""!=e&&-1==e.indexOf("&")&&-1==e.indexOf(";")&&4>=e.length)for(a=b.length,f=0;f<a;f++)if(-1<b[f].indexOf(e)){c=!0;break}d.duplicate();return c}
function checkSpecialCharTextArea(a,b){var c=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],d=0;a=a.toLowerCase();b=b.toLowerCase();var e=a.split("&");if(1>=e.length)return d;var f=b.split(";");if(1>=f.length)return d;for(var g=!1,h="",h="&"+e[e.length-1]+f[0]+";",f=0;f<c.length;f++)if(c[f]==h){g=!0;break}g&&(d=e[e.length-1].length+1);return d}
function checkSpecialCharTextAreaOldIE(a){var b=a.duplicate(),c=a.text,c=ReplaceAll(c,unescape("\r"),"");a.moveStart("character",-7);a.moveEnd("character",-c.length);var d=a.text;a=b.duplicate();a.moveStart("character",c.length);a.moveEnd("character",7);var e=a.text;a=b.duplicate();b=checkSpecialCharTextArea(d,c);0<b&&a.moveStart("character",-b);b=checkSpecialCharTextArea(c,e);0<b&&a.moveEnd("character",-b);return a}
function setRangeSelectionMarkInSource(a){try{var b=a.value,c='<dextmark class="dextmark"></dextmark>',d=b.match(/<dextmark ([^>]+)><\/dextmark>/i);null!=d&&(c=d[0]);var b=ReplaceAll(b,unescape("\r"),""),e,f;e=f=0;var g=b.indexOf(c);if(-1!=g){e=g;var b=b.replace(c,""),h=b.indexOf(c,e);-1!=h&&(f=h,b=b.replace(c,""),1<b.split(/^\s/g).length&&(b=b.replace(/^\s/g,""),--e),a.value=b,setTimeout(function(){a.focus();if(e==f)if(a.createTextRange){var b=a.createTextRange();b.move("character",e);b.select()}else a.selectionStart?
setTimeout(function(){window.focus();a.focus();a.setSelectionRange(e,e)},1):a.focus();else"setSelectionRange"in a?setTimeout(function(){window.focus();a.focus();a.setSelectionRange(e,f)},1):(b=a.createTextRange(),b.collapse(!0),b.moveEnd("character",f),b.moveStart("character",e),a.focus(),b.select());if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)window.focus(),document.body.focus(),a.focus();if(DEXTTOP.DEXT5.browser.ie&&9<=DEXTTOP.DEXT5.browser.ieVersion&&
e!=f||!DEXTTOP.DEXT5.browser.ie&&!DEXTTOP.DEXT5.browser.gecko){var b=a.value.substr(0,e),b=b.replace(/&/gi,"&amp;"),b=b.replace(/</gi,"&lt;"),b=b.replace(/>/gi,"&gt;"),b=b.replace(/\t/gi,"<tempTab>"),b=b.replace(/<tempTab>/gi,"\t"),c=document.createElement("div"),d="";"2"==DEXTTOP.G_CURREDITOR._config.sourceViewtype&&(d='style="word-wrap: break-word; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-break: normal;"');c.innerHTML="<pre "+d+"></pre>";
c=c.firstChild;c.style.width=DEXTTOP.G_CURREDITOR._config.style.width;c.style.height="auto";c.style.fontSize=a.style.fontSize;c.style.fontFamily=a.style.fontFamily;document.body.appendChild(c);c.innerHTML="&lt;test&gt;";var g=getClientRect(c),d=g.bottom-g.top;c.innerHTML=b;g=getClientRect(c);b=g.bottom-g.top;b-=d;0>b&&(b=0);document.body.removeChild(c);c=null;a.scrollTop=b}},0))}}catch(n){a.value=removeDextMarkInString(a.value)}}
function removeDextMarkInFrame(a){a=a?a:_iframeDoc;for(var b=a.getElementsByTagName("dextmark"),c=b.length,c=c-1;0<=c;c--)b[c].parentNode.removeChild(b[c]);b=a.getElementsByTagName("/dextmark");c=b.length;for(--c;0<=c;c--)b[c].parentNode.removeChild(b[c])}function removeDextMarkInString(a){return a.replace(/<dextmark ([^>]+)><\/dextmark>/ig,"")}
function getSelectionCoords(a){try{a=a||window;var b=a.document,c=b.selection,d,e,f,g=0,h=0;if(c)"Control"!=c.type&&(d=c.createRange(),d.collapse(!0),g=d.boundingLeft,h=d.boundingTop);else if(a.getSelection&&(c=a.getSelection(),c.rangeCount&&(d=c.getRangeAt(0).cloneRange(),d.getClientRects&&(d.collapse(!0),e=d.getClientRects(),0<e.length&&(f=e[0]),f?(g=f.left,h=f.top):h=g=0),0==g&&0==h))){var n=b.createElement("span");if(n.getClientRects){n.appendChild(b.createTextNode("\u200b"));d.insertNode(n);
f=n.getClientRects()[0];var g=f.left,h=f.top,m=n.parentNode;m.removeChild(n);m.normalize()}}return{x:g,y:h}}catch(p){}}
function setRemoveClass(a,b){if(checkIfIncluded("editor_layout.css")){for(var c=DEXTTOP.G_CURREDITOR.remove_item.length,d=0;d<c;d++)if("layout"==DEXTTOP.G_CURREDITOR.remove_item[d])return;for(var c=b.length,e=!1,f=_iframeDoc.body.innerHTML,d=0;d<c;d++)if(-1<f.indexOf(b[d])){e=!0;break}if(e)for(e=a.length,d=0;d<e;d++)for(var f=_iframeDoc.getElementsByTagName(a[d]),g=f.length,h=0;h<g;h++)for(var n=0;n<c;n++){var m=new RegExp("(\\s|^)"+b[n]+"(\\s|$)");m.test(f[h].className)&&(f[h].className=DEXTTOP.DEXT5.util.trim(f[h].className.replace(m,
" ")));""==DEXTTOP.DEXT5.util.trim(f[h].className)&&f[h].removeAttribute("class")}}}
function setAddClass(a,b){if(checkIfIncluded("editor_layout.css")){for(var c=DEXTTOP.G_CURREDITOR.remove_item.length,d=0;d<c;d++)if("layout"==DEXTTOP.G_CURREDITOR.remove_item[d])return;c=a.length;for(d=0;d<c;d++)for(var e=_iframeDoc.getElementsByTagName(a[d]),f=e.length,g=0;g<f;g++)for(var h=b.length,n=0;n<h;n++)(new RegExp("(\\s|^)"+b[n]+"(\\s|$)")).test(e[g].className)||(e[g].className+=" "+b[n],e[g].className=DEXTTOP.DEXT5.util.trim(e[g].className))}}
function checkIfIncluded(a,b){var c;c=void 0==b?_iframeDoc.getElementsByTagName("link"):b.getElementsByTagName("link");for(var d=0;d<c.length;d++)if(-1<c[d].href.indexOf(a))return!0;return!1}
function getDirectionNode(a,b,c,d){a=[];c=GetTDTHCell(c);b=GetTableSelectionCells();if(null==c&&0==b.length){b=",body,";var e=d.length;for(c=0;c<e;c++)null!=d[c]&&null!=d[c].parentNode&&void 0!=d[c].parentNode.tagName&&-1<b.indexOf(","+d[c].parentNode.tagName.toLowerCase()+",")&&-1<",a,abbr,acronym,address,applet,area,b,baseFont,bdo,big,blink,blockQuote,body,button,caption,center,cite,code,col,colGroup,dd,del,dfn,dir,div,dl,dt,em,embed,fieldSet,font,form,H1,H2,H3,H4,H5,H6,head,hr,html,i,iframe,img,input:button,input:checkbox,input:file,input:image,input:password,input:radio,input:range,input:reset,input:search,input:submit,input:text,ins,isIndex,kbd,keygen,label,legend,li,link,listing,map,marquee,menu,meta,nobr,noFrames,noScript,object,ol,optGroup,option,p,plainText,pre,q,rt,ruby,s,samp,select,small,span,strike,strong,style,sub,sup,table,tBody,td,textArea,tFoot,th,tHead,title,tr,tt,u,ul,var,xmp,".indexOf(","+d[c].tagName.toLowerCase()+
",")&&a.push(d[c])}else if(null!=c&&0==b.length)for(b=",th,td,",e=d.length,c=0;c<e;c++)null!=d[c]&&null!=d[c].parentNode&&void 0!=d[c].parentNode.tagName&&-1<b.indexOf(","+d[c].parentNode.tagName.toLowerCase()+",")&&(null==d[c].firstChild?a.push(d[c].parentNode):-1<",a,abbr,acronym,address,applet,area,b,baseFont,bdo,big,blink,blockQuote,body,button,caption,center,cite,code,col,colGroup,dd,del,dfn,dir,div,dl,dt,em,embed,fieldSet,font,form,H1,H2,H3,H4,H5,H6,head,hr,html,i,iframe,img,input:button,input:checkbox,input:file,input:image,input:password,input:radio,input:range,input:reset,input:search,input:submit,input:text,ins,isIndex,kbd,keygen,label,legend,li,link,listing,map,marquee,menu,meta,nobr,noFrames,noScript,object,ol,optGroup,option,p,plainText,pre,q,rt,ruby,s,samp,select,small,span,strike,strong,style,sub,sup,table,tBody,td,textArea,tFoot,th,tHead,title,tr,tt,u,ul,var,xmp,".indexOf(","+
d[c].tagName.toLowerCase()+",")?a.push(d[c]):void 0==d[c].firstChild.tagName?a.push(d[c].parentNode):a.push(d[c]));else if(null!=c&&0<b.length)for(c=0;c<b.length;c++){d=b[c].getElementsByTagName("*");for(idx2=0;idx2<d.length;idx2++)d[idx2].dir="";a.push(b[c])}return a}
function CheckCommand(a,b){if("bold"==a){var c=b.getElementsByTagName("b"),d=b.getElementsByTagName("strong");return 0<c.length+d.length?!0:!1}return"italic"==a?(c=b.getElementsByTagName("em"),d=b.getElementsByTagName("i"),0<c.length+d.length?!0:!1):"underline"==a?0<b.getElementsByTagName("u").length?!0:!1:"strike_through"==a?0<b.getElementsByTagName("strike").length?!0:!1:"superscript"==a?0<b.getElementsByTagName("sup").length?!0:!1:"subscript"==a?0<b.getElementsByTagName("sub").length?!0:!1:"list_number"==
a?0<b.getElementsByTagName("ol").length?!0:!1:"list_bullets"==a?0<b.getElementsByTagName("ul").length?!0:!1:!1}
function officePasteCleanForTable(a){var b=document.createElement("div");b.innerHTML=a;a=b.getElementsByTagName("table");for(var c=a.length,d=0;d<c;d++){"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&adjustTableForIEJASOBug(a[d]);"left"!=a[d].align&&"1"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign||"2"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO||(a[d].align="",a[d].removeAttribute("align"));var e="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode;if((DEXTTOP.DEXT5.browser.ie&&
7<DEXTTOP.DEXT5.browser.ieVersion&&!e||DEXTTOP.DEXT5.browser.gecko)&&"1"==DEXTTOP.G_CURREDITOR._config.removeColgroup){var e=a[d].getElementsByTagName("colgroup"),f=e.length;if(0<f){e=!1;try{for(var g=a[d].getElementsByTagName("td"),h=g.length,f=0;f<h;f++)if(g[f].getAttribute("width")&&""!=g[f].getAttribute("width")||""!=g[f].style.width){e=!0;break}}catch(n){e=!0}if(e)for(e=a[d].getElementsByTagName("colgroup"),f=e.length,--f;0<=f;f--)try{a[d].removeChild(e[f])}catch(m){}}}for(var p=a[d].rows.length,
f=0;f<p;f++){var t=a[d].rows[f];removeAttributeForPasteTable(t);var q=t.cells.length;if(0==q)t.innerHTML="";else for(e=0;e<q;e++){var u=t.cells[e];1==u.childNodes.length?""!=u.childNodes[0].innerHTML&&"&nbsp;"!=u.childNodes[0].innerHTML||0!=u.innerHTML.indexOf("<p")||(u.innerHTML=getCellDefValue()):0!=u.childNodes.length||""!=u.innerHTML&&"&nbsp;"!=u.innerHTML||(u.innerHTML=getCellDefValue())}}if(DEXTTOP.DEXT5.browser.gecko)for(""==a[d].style.borderCollapse&&(a[d].style.borderCollapse="collapse"),
p=a[d].rows.length,f=0;f<p;f++)for(t=a[d].rows[f],removeAttribute(t,"width"),removeAttribute(t,"height"),removeAttribute(t,"style"),q=t.cells.length,e=0;e<q;e++)u=t.cells[e],""==u.style.borderTop&&(u.style.borderTop="1px solid #000000"),""==u.style.borderRight&&(u.style.borderRight="1px solid #000000"),""==u.style.borderBottom&&(u.style.borderBottom="1px solid #000000"),""==u.style.borderLeft&&(u.style.borderLeft="1px solid #000000"),"\u3000"==u.innerHTML&&(u.innerHTML="<p><br /></p>"),0==parseIntOr0(u.style.height)&&
0==parseIntOr0(u.height)&&(u.style.height="20px");if("0"!=DEXTTOP.G_CURREDITOR._config.showLineForBorderNone)for(f=a[d].rows.length,e=0;e<f;e++)for(p=a[d].rows[e].cells.length,t=0;t<p;t++)showBorderForNoneClass(a[d].rows[e].cells[t],"dext_table_border_t"),showBorderForNoneClass(a[d].rows[e].cells[t],"dext_table_border_l"),showBorderForNoneClass(a[d].rows[e].cells[t],"dext_table_border_r"),showBorderForNoneClass(a[d].rows[e].cells[t],"dext_table_border_b")}return a=b.innerHTML}
function checkExistCustomData(a){var b="",b=_iframeDoc.createElement("div");b.innerHTML=a;a=b.getElementsByTagName("img");for(var c=!1,d=a.length-1;0<=d;d--){var e=a[d].getAttribute("dext5customdata");null!=e&&void 0!=e&&(e=getDextCustomData(e),null==e||void 0==e)&&(c=a[d].parentNode,c.removeChild(a[d]),""==c.innerHTML&&(c.innerHTML="&nbsp;"),c=!0)}c&&alert(dext5_lang.msg.checkCustomData);""==b.innerHTML&&(b.innerHTML="&nbsp");return b=b.innerHTML}
function getEditorFrameDoc(a){setDEXTWINDOC();a=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+a.ID);return getIframeDocument(a)}
function getMyFirstChildElementNode(a){try{if(3==a.nodeType)return a.parentNode;for(;null!=a.childNodes&&0<a.childNodes.length;)if(a=a.firstChild,3==a.nodeType||8==a.nodeType){if(3==a.nodeType&&""!=textCheckInString(a.data))return a.parentNode;a=a.nextSibling}else{if("P"==a.tagName)return a;if("BR"==a.tagName||"IMG"==a.tagName)return a.parentNode;if("TABLE"==a.tagName){var b=null,b=a.getElementsByTagName("th")[0]?a.getElementsByTagName("th")[0]:a.getElementsByTagName("td")[0];return getMyFirstChildElementNode(b)}if("OL"==
a.tagName||"UL"==a.tagName)return getMyFirstChildElementNode(a.getElementsByTagName("li")[0])}return 1==a.nodeType&&a.parentNode&&"BODY"!=a.parentNode.tagName?a:null}catch(c){return null}}
function setFocusFirstChildForStyle(a){var b=getMyFirstChildElementNode(a);if(null==b)setFocusToBody();else if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){for(var b=a.childNodes,c=b.length,d=!0,e=0;e<c;e++)if(1==b[e].nodeType&&-1<",p,h1,h2,h3,h4,h5,h6,pre,b,big,i,small,strong,span,sub,sup,u,s,strike,".indexOf(","+b[e].tagName.toLowerCase()+",")){doSetCaretPosition(b[e],0);setMenuIconRealable(b[e]);d=!1;break}if(d){b=a.lastChild;if(3==b.nodeType||
"table"==b.tagName.toLowerCase())b=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?b.innerHTML="&nbsp;":(c=_iframeDoc.createElement("br"),b.appendChild(c)),a.appendChild(b);doSetCaretPosition(b,0);setMenuIconRealable(b)}}else if("TEXTAREA"==b.tagName)setFocusToBody();else try{if(("P"==b.tagName||"TABLE"==b.tagName||"DIV"==b.tagName)&&b.firstChild)for(c=b.firstChild;;)if(3==c.nodeType||-1<",img,input,iframe,object,video,".indexOf(","+c.tagName.toLowerCase()+
",")){b=c.parentNode;break}else if("BR"==c.tagName){b=c.parentNode;break}else if(null!=c.firstChild)c=c.firstChild;else{b=c;break}doSetCaretPosition(b,0);setMenuIconRealable(b)}catch(f){}}
function repairPasteTextInCell(a){if(0==DEXTTOP.DEXT5.browser.ie||6!=G_dext5plugIn.getHTMLFormatFromType)return a;var b=a,c=a.substring(0,6);if("<TABLE"==c||"<table"==c){if(getFirstRange(),c=document.createElement("div"),c.innerHTML=a,1==c.childNodes.length&&1==c.childNodes[0].nodeType&&"TABLE"==c.childNodes[0].tagName){a=c.getElementsByTagName("td");if(1==a.length){var b=a[0].innerHTML,d=a[0].childNodes,e=a[0].getElementsByTagName("p");1==e.length&&d[0]&&1==d[0].nodeType&&"P"==d[0].tagName&&(b=d[0].innerHTML)}0==
a.length&&(a=c.getElementsByTagName("th"),1==a.length&&(b=a[0].innerHTML,d=a[0].childNodes,e=a[0].getElementsByTagName("p"),1==e.length&&d[0]&&1==d[0].nodeType&&"P"==d[0].tagName&&(b=d[0].innerHTML)))}}else c=a.toLowerCase(),-1<c.indexOf("starthtml")&&-1<c.indexOf("startfragment")&&-1<c.indexOf("<body ")&&-1<c.indexOf("</body")&&(c="<BODY",-1==a.indexOf(c)&&(c="<body"),b="</BODY>",-1==a.indexOf(b)&&(b="</body>"),a=a.substring(a.indexOf(c)),a=a.substring(a.indexOf(">")+1),b=a=a.substring(0,a.indexOf(b)));
return b}function findParentNode(a,b){var c=b.parentNode;if("HTML"==c.tagName||"BODY"==c.tagName)return!1;for(;"BODY"!=c.tagName;){if(c==a)return!0;c=c.parentNode}return!1}
function executeTextAlign(a,b){var c=null,c=DEXTTOP.DEXT5.browser.ie?getElementsFromSelection():getNodesInRange(a),d=GetTDTHCell(a.startContainer);if(null!=d)for(var e=c,f=e.length,c=[],g=0;g<f;g++)1==findParentNode(d,e[g])&&c.push(e[g]);d=c.length;e=chkAlign="";e=null;for(g=0;g<d;g++)if(e=c[g].nodeName.toLowerCase(),"p"==e||"div"==e)chkAlign="justifyFull"==b?"justify":b.substring(7).toLowerCase(),e=c[g],e.style.textAlign!=chkAlign&&(e.style.textAlign=chkAlign)}
function removeNbspInPTag(a){try{if(DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion){var b=a._BODY.childNodes,c=b.length;for(a=0;a<c;a++){var d=b[a];1==d.nodeType&&-1<",p,h1,h2,h3,h4,h5,".indexOf(","+d.tagName.toLowerCase()+",")&&"&nbsp;"==d.innerHTML&&(d.innerHTML="")}}}catch(e){}}function _iframeDoc_OnDropOver(a){DEXTTOP.DEXT5.util.cancelEvent(a)}
function getElementsFromSelection(a){function b(a){var b=null;a.parentElement?b=a.parentElement():a.commonAncestorContainer?b=a.commonAncestorContainer:a.commonParentElement&&(b=a.commonParentElement());return b}function c(a,b){var c=null;a.compareEndPoints?c={method:"compareEndPoints",StartToStart:"StartToStart",StartToEnd:"StartToEnd",EndToEnd:"EndToEnd",EndToStart:"EndToStart"}:a.compareBoundaryPoints&&(c={method:"compareBoundaryPoints",StartToStart:0,StartToEnd:1,EndToEnd:2,EndToStart:3});return c&&
!(1==b[c.method](c.StartToStart,a)&&1==b[c.method](c.EndToEnd,a)&&1==b[c.method](c.StartToEnd,a)&&1==b[c.method](c.EndToStart,a)||-1==b[c.method](c.StartToStart,a)&&-1==b[c.method](c.EndToEnd,a)&&-1==b[c.method](c.StartToEnd,a)&&-1==b[c.method](c.EndToStart,a))}function d(a){var b=null;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion?_iframeDoc.body.createTextRange?(b=_iframeDoc.body.createTextRange(),b.moveToElementText(a)):_iframeDoc.createRange&&(b=_iframeDoc.createRange(),b.selectNodeContents(a)):
_iframeDoc.createRange?(b=_iframeDoc.createRange(),b.selectNodeContents(a)):_iframeDoc.body.createTextRange&&(b=_iframeDoc.body.createTextRange(),b.moveToElementText(a));return b}var e=null,f=[],g,h;a||(a="body");if(h=function(){var a=null;_iframeWin.getSelection?(a=_iframeWin.getSelection())&&a.rangeCount&&a.getRangeAt&&(a=a.getRangeAt(0)):_iframeDoc.selection&&(a=_iframeDoc.selection.createRange());return a}())if(g=b(h)){for(;1!=g.nodeType;)g=g.parentNode;if(g.nodeName.toLowerCase()!=a.toString()){e=
g;do e=e.parentNode,f[f.length]=e;while(e.nodeName.toLowerCase()!=a.toString())}e=g.all||g.getElementsByTagName("*");for(a=0;a<e.length;a++)f[f.length]=e[a];e=[g];for(g=0;g<f.length;g++)(a=d(f[g]))&&c(h,a)&&(e[e.length]=f[g])}return e}
function checkCopyInCellFormInertnNet(a){var b="";if(DEXTTOP.DEXT5.browser.ie&&/body[^>]*>(\s+)*<div *([^>])*>/i.test(a)){var c=a.indexOf("\x3c!--StartFragment--\x3e"),d=a.lastIndexOf("\x3c!--EndFragment--\x3e");-1<c&&-1<d&&(a=a.substr(c+20),d=a.lastIndexOf("\x3c!--EndFragment--\x3e"),-1<d&&(b=a=a.substring(0,d)))}return b}function setGlobalTableDefaultValue(){try{ActiveLastTable=ActiveCurrTable=DrageEndCell=DrageStartCell=null}catch(a){}}
function replaceBrTag(a){if("1"==a._config.wrapPtagToSource||"2"==a._config.wrapPtagToSource)try{for(var b=a._DOC,c=a._BODY,d=c.childNodes,e=d.length-1;0<=e;e--){var f=d[e];if(1==f.nodeType&&"BR"==f.tagName&&(null==f.previousSibling||f.previousSibling&&3!=f.previousSibling.nodeType)){var g=b.createElement("p");c.insertBefore(g,f);DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?(g.innerHTML="&nbsp;",c.removeChild(f)):g.appendChild(f)}}if("1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO){for(var h=
b.getElementsByTagName("table"),n=h.length,e=0;e<n;e++)adjustTableForIEJASOBug(h[e]);h=b.getElementsByTagName("p");n=h.length;for(e=0;e<n;e++)endBrForIEJASOBug(h[e])}else if("2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO)for(h=b.getElementsByTagName("table"),n=h.length,e=0;e<n;e++)if("left"==h[e].align||"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign)h[e].align="",h[e].removeAttribute("align")}catch(m){}}
function showImageEditor(){if(G_dext5plugIn){setFocusTopWindow();var a=G_dext5plugIn.setScreenCapture(1);""!=a?(dialogCancel(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),insertNodeLikePasteHtml(a),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):dialogCancel()}}function checkCanPasteToIamge(){var a=!1;try{G_dext5plugIn&&1==G_dext5plugIn.canPasteImageFromClipBoard()&&(a=!0)}catch(b){a=!1}return a}
function removeEmptySpanBRTag(a){if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&a.childNodes)for(var b=a.childNodes.length,c=0;c<b;c++){var d=a.childNodes[c];if(1===d.nodeType&&"p"==d.tagName.toLowerCase()){var e=d.innerHTML;if(""==(d.innerText||d.textContent))for(;;){var f=RegExp("<span[^>]*>(?:\\s|<br>|<br />|  | |)(</span>)","gim"),e=e.replace(f,"$1"+unescape("%u200B")+"</span>");if(0==f.test(e))break}""==e&&(e=DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":
"<br />",d.innerHTML=e)}}}
function wrapPtagForNotBlockTag(a){if("1"==a._config.wrapPtagToSource||"2"==a._config.wrapPtagToSource)try{for(var b=a._BODY.innerHTML,c=a._BODY.childNodes,d=[],e=c.length-1;0<=e;e--){if(c[e].tagName&&checkBlockTag(c[e].tagName)){if(0<d.length){for(var f=_iframeDoc.createElement("p"),g=d.length-1;0<=g;g--)f.appendChild(d[g]),c[e].nextSibling?_iframeDoc.body.insertBefore(f,c[e].nextSibling):_iframeDoc.body.appendChild(f);d=[]}}else if(3==c[e].nodeType){var h=c[e].data,h=h.replace(/\r\n/,"\n"),h=h.replace(/^\n/,
""),h=h.replace(/\n$/,"");c[e].data=h;h=textCheckInString(h);""!=h&&d.push(c[e])}else 8!=c[e].nodeType&&d.push(c[e]);if(0==e&&0<d.length){f=_iframeDoc.createElement("p");for(g=d.length-1;0<=g;g--)f.appendChild(d[g]),_iframeDoc.body.insertBefore(f,_iframeDoc.body.firstChild);d=[]}if(c[e].tagName&&"P"==c[e].tagName){var n=void 0!=c[e].innerText?c[e].innerText:c[e].textContent,n=n.replace(/\r\n/gi,""),n=n.replace(/\r/gi,""),n=n.replace(/\n/gi,""),m=!1;try{-1<c[e].innerHTML.toLowerCase().indexOf("<dextmark")&&
(m=!0)}catch(p){}if(""==n&&!m&&"1"==a._config.removeEmptyTag){for(var t=c[e].innerHTML,m="(<span[^>]*?raon_placeholder.*?>)(?:\\s|<br>|<br />|  | |)</span>",q=new RegExp(m,"gim"),t=t.replace(q,"$1"+unescape("%u200B")+"</span>");m="<span[^>]*>(?:\\s|<br>|<br />|  | |)</span>",q=new RegExp(m,"gim"),t=t.replace(q,""),0!=q.test(t););m="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>";q=new RegExp(m,"gim");for(t=t.replace(q,"$1</span>");m="<font[^>]*>(?:\\s|<br>|<br />|  | |)</font>",
q=new RegExp(m,"gim"),t=t.replace(q,""),0!=q.test(t););t=CleanZeroChar(t);""==t&&(t=getDefaultParagraphValue(!1));c[e].innerHTML=t}}}}catch(u){a._BODY.innerHTML=b}}function checkBlockTag(a){if(void 0!=a&&""!=a){var b=!1,c="p div table ol ul hr h1 h2 h3 h4 h5 h6 dl blockquote iframe pre c:if c:choose c:foreach c:set script style center dextmark /dextmark figure figcaption".split(" "),d=c.length;a=a.toLowerCase();for(var e=0;e<d;e++)if(c[e]==a){b=!0;break}return b}}
function checkExistClassName(a,b){for(var c=a.split(" "),d=c.length,e=!1,f=0;f<d;f++)if(c[f]==b){e=!0;break}return e}function setClassName(a,b){for(var c=b,d=a.className,e=!1,f=d.split(" "),g=f.length,h=0;h<g;h++)if(f[h]==b){e=!0;break}0==e&&(""!=d&&(c=" "+c),a.className=d+c)}function removeClassName(a,b){var c=b,d=a.className;0<d.indexOf(c)&&(c=" "+c);d=d.replace(c,"");""==d?a.getAttribute("class")?a.removeAttribute("class"):a.removeAttribute("className"):a.className=d}
function showBorderForNoneClass(a,b){if("0"!=DEXTTOP.G_CURREDITOR._config.showLineForBorderNone){if(""!=DEXTTOP.DEXT5.util.trim(DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipClass))for(var c=DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipClass.split(","),d=c.length,e=0;e<d;e++)if(checkExistClassName(a.className,c[e]))return;if(""!=DEXTTOP.DEXT5.util.trim(DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipAttribute))for(c=DEXTTOP.G_CURREDITOR._config.showLineForBorderNoneSkipAttribute.split(","),
e=0;e<d;e++)if(a.getAttribute(c[e])&&""!=a.getAttribute(c[e]))return;e="";switch(b){case "dext_table_border_b":e="Bottom";break;case "dext_table_border_t":e="Top";break;case "dext_table_border_l":e="Left";break;case "dext_table_border_r":e="Right"}d=checkExistClassName(a.className,b);""==a.style["border"+e+"Width"]&&""==a.style["border"+e+"Style"]?(e=a.parentNode.parentNode.parentNode,!d&&(""==e.border||0>=parseInt(e.border))&&setClassName(a,b)):-1<a.style["border"+e+"Width"].indexOf("0")&&0==parseFloat(a.style["border"+
e+"Width"])||"none"==a.style["border"+e+"Style"]?d||setClassName(a,b):d&&removeClassName(a,b)}}
function setBorderTableAndAllCell(a,b){for(var c=a.rows.length,d=0;d<c;d++)for(var e=a.rows[d],f=e.cells.length,g=0;g<f;g++){var h=e.cells[g];0==g&&(""!=b.outsideLeft&&(h.style.borderLeft=b.outsideLeft,showBorderForNoneClass(h,"dext_table_border_l")),g!=f-1&&""!=b.insideCol&&(h.style.borderRight=b.insideCol,showBorderForNoneClass(h,"dext_table_border_r")),""!=b.insideRow&&(0==d&&d!=c-1&&(h.style.borderBottom=b.insideRow,showBorderForNoneClass(h,"dext_table_border_b")),0<d&&d==c-1&&(h.style.borderTop=
b.insideRow,showBorderForNoneClass(h,"dext_table_border_t")),0<d&&d!=c-1&&(h.style.borderTop=b.insideRow,showBorderForNoneClass(h,"dext_table_border_t"),h.style.borderBottom=b.insideRow,showBorderForNoneClass(h,"dext_table_border_b"))));g==f-1&&(""!=b.outsideRight&&(h.style.borderRight=b.outsideRight,showBorderForNoneClass(h,"dext_table_border_r")),0!=g&&""!=b.insideCol&&(h.style.borderLeft=b.insideCol,showBorderForNoneClass(h,"dext_table_border_l")),""!=b.insideRow&&(0==d&&d!=c-1&&(h.style.borderBottom=
b.insideRow,showBorderForNoneClass(h,"dext_table_border_b")),0<d&&d==c-1&&(h.style.borderTop=b.insideRow,showBorderForNoneClass(h,"dext_table_border_t")),0<d&&d!=c-1&&(h.style.borderTop=b.insideRow,showBorderForNoneClass(h,"dext_table_border_t"),h.style.borderBottom=b.insideRow,showBorderForNoneClass(h,"dext_table_border_b"))));0<g&&g!=f-1&&""!=b.insideCol&&(h.style.borderLeft=b.insideCol,showBorderForNoneClass(h,"dext_table_border_l"),h.style.borderRight=b.insideCol,showBorderForNoneClass(h,"dext_table_border_r"));
0==d&&(""!=b.outsideTop&&(h.style.borderTop=b.outsideTop,showBorderForNoneClass(h,"dext_table_border_t")),d!=c-1&&""!=b.insideRow&&(h.style.borderBottom=b.insideRow,showBorderForNoneClass(h,"dext_table_border_b")));d==c-1&&(""!=b.outsideBottom&&(h.style.borderBottom=b.outsideBottom,showBorderForNoneClass(h,"dext_table_border_b")),0!=d&&""!=b.insideRow&&(h.style.borderTop=b.insideRow,showBorderForNoneClass(h,"dext_table_border_t")));0<d&&d!=c-1&&0<g&&g!=f-1&&(""!=b.insideRow&&(h.style.borderTop=b.insideRow,
showBorderForNoneClass(h,"dext_table_border_t"),h.style.borderBottom=b.insideRow,showBorderForNoneClass(h,"dext_table_border_b")),""!=b.insideCol&&(h.style.borderLeft=b.insideCol,showBorderForNoneClass(h,"dext_table_border_l"),h.style.borderRight=b.insideCol,showBorderForNoneClass(h,"dext_table_border_r")))}}
function replaceClassForBorder(a,b,c){var d=["dext_table_border_t","dext_table_border_r","dext_table_border_b","dext_table_border_l"];if("0"!=a._config.showLineForBorderNone&&"show"==c){var e=b.getElementsByTagName("table"),f=e.length;for(a=0;a<f;a++)for(var g=e[a].rows.length,h=0;h<g;h++)for(var n=e[a].rows[h].cells.length,m=0;m<n;m++){var p=e[a].rows[h].cells[m].className,p=p.replace("_"+d[0],""),p=p.replace("_"+d[1],""),p=p.replace("_"+d[2],""),p=p.replace("_"+d[3],""),p=p.replace(d[0],""),p=p.replace(d[1],
""),p=p.replace(d[2],""),p=p.replace(d[3],""),p=DEXTTOP.DEXT5.util.trim(p);if(""==p){if(e[a].rows[h].cells[m].getAttribute("class")?e[a].rows[h].cells[m].removeAttribute("class"):e[a].rows[h].cells[m].removeAttribute("className"),""!=e[a].rows[h].cells[m].className||e[a].rows[h].cells[m].className!=p)e[a].rows[h].cells[m].className=""}else e[a].rows[h].cells[m].className!=p&&(e[a].rows[h].cells[m].getAttribute("class")?e[a].rows[h].cells[m].setAttribute("class",p):e[a].rows[h].cells[m].setAttribute("className",
p),e[a].rows[h].cells[m].className!=p&&(e[a].rows[h].cells[m].className=p));showBorderForNoneClass(e[a].rows[h].cells[m],d[0]);showBorderForNoneClass(e[a].rows[h].cells[m],d[1]);showBorderForNoneClass(e[a].rows[h].cells[m],d[2]);showBorderForNoneClass(e[a].rows[h].cells[m],d[3])}}if("hidden"==c)for(a=0;a<d.length;a++)for(c=[],c=getElementsByClass(d[a],b),e=c.length,f=0;f<e;f++)removeClassName(c[f],d[a]),p=c[f].className,""==DEXTTOP.DEXT5.util.trim(p)?(c[f].className="",c[f].getAttribute("class")?
c[f].removeAttribute("class"):c[f].removeAttribute("className")):c[f].className=DEXTTOP.DEXT5.util.trim(p)}
function attachFileImage(a,b){var c="url("+DEXTTOP.G_CURREDITOR._config.webPath.image+"icon/",c=-1<b.file_ext.indexOf("doc")?c+"word.png":-1<b.file_ext.indexOf("ppt")?c+"ppt.png":-1<b.file_ext.indexOf("xls")?c+"excel.png":-1<b.file_ext.indexOf("hwp")?c+"hwp.png":-1<b.file_ext.indexOf("pdf")?c+"pdf.png":-1<b.file_ext.indexOf("txt")?c+"txt.png":c+"file.png";a.style.paddingLeft="22px";a.style.paddingTop="3px";a.style.paddingBottom="3px";a.style.background=c+")";a.style.backgroundRepeat="no-repeat";a.style.backgroundPosition=
"0% 50%";a.style.lineHeight="1.4"}function replaceClassForBookmark(a,b,c){a=a._contentsClass;for(var d=a.length,e=0;e<d;e++){var f=[];"hidden"==c?f=getElementsByClass(a[e],b):"show"==c&&(f=getElementsByClass("_"+a[e],b));for(var g=f.length,h=0;h<g;h++){var n=f[h].className;"hidden"==c?n=n.replace(a[e],"_"+a[e]):"show"==c&&(n=n.replace("_"+a[e],a[e]));f[h].className=n}}}
function removeIncorrectSpaceInTag(a){var b=a;if("1"==DEXTTOP.G_CURREDITOR._config.removeSpaceInTagname)if(void 0==a||""==a)b="";else try{var c=RegExp("<(\\s+)[a-z|/]","gi"),d=b.match(c);if(d)for(var e=d.length,f=0;f<e;f++)var g=d[f],h=/\s+/.exec(g),n=h[0].replace(RegExp("\\s","gi"),""),g=g.replace(h,n),b=b.replace(d[f],g);c=RegExp("<\\/(\\s+)[a-z]","gi");if(d=b.match(c))for(e=d.length,f=0;f<e;f++)g=d[f],h=/\s+/.exec(g),n=h[0].replace(RegExp("\\s","gi"),""),g=g.replace(h,n),b=b.replace(d[f],g)}catch(m){b=
a}return b}
function removeDummyfontTagInTable(a){var b=a;try{var c=RegExp("(<font ([^>]+)>\\s+</font>(s+)?)(<colgroup>)","gi");a=a.replace(c,"$4");c=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(<tbody>)","gi");a=a.replace(c,"$4");c=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(<td)","gi");a=a.replace(c,"$4");c=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(</tr>)","gi");a=a.replace(c,"$4");c=RegExp("(<font ([^>]+)>\\s+</font>(\\s+)?)(</tbody>)","gi");a=a.replace(c,"$4");c=RegExp("<font ([^>]+)>\\s</font>","gi");a=a.replace(c,
"<font $1>&nbsp;</font>");c=RegExp("<font ([^>]+)>\\s+</font>","gi");b=a=a.replace(c,"<font $1></font>")}catch(d){}return b}
function setChangeModeForSetApi(a,b){if(1!=b&&"design"!=a._currentMode){var c="design";ClearDraggingTableCellSelected();Mouse_Status=Mouse_IsPlain;g_findRepalceRange=ActiveCurrTable=DrageStartCell=null;a._iconSelected();for(var d=null,e=["top_design","top_source","top_preview","top_text"],f=0,g=e.length;f<g;f++)d=document.getElementById("ue_"+a.ID+e[f]),null!=d&&((0>c.indexOf("top_")?"top_"+c:c)==e[f]?d.className="on":d.className="");for(var h=e=null,d=["design","source","preview","text"],c=c.replace("top_",
""),f=0,g=d.length;f<g;f++)e=document.getElementById("ue_"+a.ID+d[f]),h=document.getElementById("dext5_"+d[f]+"_"+a.ID),null!=e&&(c==d[f]?(e.className=a._config.style.skinName,e.getElementsByTagName("A")[0].className="color_on",e.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+"/ue_btn_bg.gif)",h.style.height="100%",h.style.width="100%",DEXTTOP.DEXT5.browser.gecko||(h.style.display="",h.style.overflow=""),a._LastRange=null,setFocusToBody()):(e.className="",e.getElementsByTagName("A")[0].className=
"",e.style.backgroundImage="",h.style.width="0px",h.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(h.style.display="none",h.style.overflow="hidden"),h.blur()),e=document.getElementById("ue_diabled_div_"+a.ID),"BackCompat"==document.compatMode&&(e.style.height=document.getElementById("ue_toolbar_"+a.ID).scrollHeight+"px"),document.getElementById("ue_toolbar_"+a.ID).style.position="relative",e.style.width="design"==c?"0px":document.getElementById("ue_toolbar_"+a.ID).scrollWidth+"px");switch(a._currentMode){case "source":switch(c){case "design":ReplaceRealObjectToImage(),
xssReplaceScript(_iframeDoc),setAddClass(["td","th"],["DEXT_dot"])}break;case "preview":switch(c){case "design":FixFlashError(),ReplaceRealObjectToImage(),setAddClass(["td","th"],["DEXT_dot"])}}a._currentMode=c;-1<c.indexOf("design")&&setFocusFirstChildForStyle(a._BODY)}}function insertElementsSrc(a,b){b&&0>b.indexOf("file:/")&&0>b.indexOf(DEXTTOP.DEXT5.rootPath+"images")&&a.setElementsArr.push(b)}
function insertImageSrc(a,b,c){if(1!=c)try{if(b)0>b.indexOf("file:/")&&0>b.indexOf(DEXTTOP.DEXT5.rootPath+"images")&&(a.setImageArr.push(b),a.setElementsArr.push(b));else{a.setImageArr=[];a.setElementsArr=[];var d=a._DOC.getElementsByTagName("img"),e=d.length;for(b=0;b<e;b++)"1"==DEXTTOP.G_CURREDITOR._config.xss_use&&(d[b].alt&&(d[b].alt=DEXTTOP.DEXT5.util.replaceAll(d[b].alt,"<",""),d[b].alt=DEXTTOP.DEXT5.util.replaceAll(d[b].alt,">","")),d[b].title&&(d[b].title=DEXTTOP.DEXT5.util.replaceAll(d[b].alt,
"<",""),d[b].title=DEXTTOP.DEXT5.util.replaceAll(d[b].alt,">",""))),""==d[b].style.marginRight.toString()&&""==d[b].style.marginLeft.toString()&&d[b].getAttribute("hspace")&&""!=d[b].hspace.toString()&&(d[b].style.marginLeft=d[b].hspace+"px",d[b].style.marginRight=d[b].hspace+"px",d[b].removeAttribute("hspace")),""==d[b].style.marginTop.toString()&&""==d[b].style.marginBottom.toString()&&d[b].getAttribute("vspace")&&""!=d[b].vspace.toString&&(d[b].style.marginTop=d[b].vspace+"px",d[b].style.marginBottom=
d[b].vspace+"px",d[b].removeAttribute("vspace"));var f=a._DOC.body.outerHTML,d="",g=RegExp("<img[^>]*src=(.*?)>","gi"),h=RegExp("<embed[^>]*src=(.*?)>","gi"),n=RegExp("<a[^>]*href=(.*?)>","gi"),m=f.match(RegExp("<[^>]*url\\((.*?)\\)","gi")),p=f.match(g),t=f.match(h),q=f.match(n);if(m){var u=m.length;for(b=0;b<u;b++)d="",0>m[b].indexOf(DEXTTOP.DEXT5.rootPath+"images")&&m[b].match("url\\((.*?)\\)")&&(d=m[b].match("url\\((.*?)\\)")[1].replace(/"/gi,"").replace(/'/gi,"").replace(/&quot;/gi,"")),d&&""!=
d&&(a.setImageArr.push(d),a.setElementsArr.push(d))}if(p){var v=p.length;for(b=0;b<v;b++)d="",p[b].match("src=\"(.*?)\"|src='(.*?)'")&&(d=p[b].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,"")),d&&""!=d&&(a.setImageArr.push(d),a.setElementsArr.push(d))}if(t){var w=t.length;for(b=0;b<w;b++)d="",t[b].match("src=\"(.*?)\"|src='(.*?)'")&&(d=t[b].match("src=\"(.*?)\"|src='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,"")),d&&""!=d&&a.setElementsArr.push(d)}if(q){var y=q.length;for(b=
0;b<y;b++)d="",-1<q[b].toLowerCase().indexOf("dext5insertfile")&&q[b].match("href=\"(.*?)\"|href='(.*?)'")&&(d=q[b].match("href=\"(.*?)\"|href='(.*?)'")[1].replace(/"/gi,"").replace(/'/gi,"")),d&&""!=d&&a.setElementsArr.push(d)}}}catch(x){}}
function checkPasteImage(a){if("1"==DEXTTOP.G_CURREDITOR._config.eventForPasteImage){var b=_iframeDoc.createElement("div");b.innerHTML=a;a=b.getElementsByTagName("img");if(0<a.length&&"function"==typeof DEXTTOP.DEXTWIN.dext_paste_image_event)try{DEXTTOP.DEXTWIN.dext_paste_image_event(a)}catch(c){}}}
function replaceSpanToDivContainAbsolute(a){var b=a.innerHTML,c=!1;try{for(var d=a.getElementsByTagName("table"),e=d.length-1;0<=e;e--){var f=GetParentbyTagName(d[e],"span");if(f&&"absolute"==f.style.position){var g=document.createElement("div");setCopyAllObjectAtributes(f,g,!0);f.parentNode.insertBefore(g,f);f.parentNode.removeChild(f);c=!0}}}catch(h){a.innerHTML=b}return c}
function insertCarriageReturn(a,b){"1"==a._config.insertCarriageReturn&&(b=b.replace(/<\/style>/gi,"</style>\r\n"),b=b.replace(/<\/p>/gi,"</p>\r\n"),b=b.replace(/<br>/gi,"<br>\r\n"),b=b.replace(/<br \/>/gi,"<br />\r\n"),b=b.replace(/<br\/>/gi,"<br/>\r\n"),b=b.replace(/<\/span><\/span>/gi,"</span></span\r\n>"),b=b.replace(/<\/tr>/gi,"</tr>\r\n"),b=b.replace(/<\/td>/gi,"</td>\r\n"),b=b.replace(/<\/th>/gi,"</th>\r\n"));return b}
function removeCarriageReturn(a,b){"1"==a._config.insertCarriageReturn&&(b=b.replace(/<\/style>\r\n/gi,"</style>"),b=b.replace(/<\/p>\r\n/gi,"</p>"),b=b.replace(/<br>\r\n/gi,"<br>"),b=b.replace(/<br \/>\r\n/gi,"<br />"),b=b.replace(/<br\/>\r\n/gi,"<br/>"),b=b.replace(/<\/style>\s/gi,"</style>"),b=b.replace(/<\/p>\s/gi,"</p>"),b=b.replace(/<br>\s/gi,"<br>"),b=b.replace(/<br \/>\s/gi,"<br />"),b=b.replace(/<br\/>\s/gi,"<br/>"),b=b.replace(/<\/tr>\r\n/gi,"</tr>"),b=b.replace(/<\/tr>\s/gi,"</tr>"),b=
b.replace(/<\/td>\r\n/gi,"</td>"),b=b.replace(/<\/td>\s/gi,"</td>"),b=b.replace(/<\/th>\r\n/gi,"</th>"),b=b.replace(/<\/th>\s/gi,"</th>"));var c=RegExp("(<table *[^>?+]*>)\\s+<","gi");b=b.replace(c,"$1<");c=RegExp("(<caption *[^>?+]*>)\\s+<","gi");b=b.replace(c,"$1<");c=RegExp("(<tbody *[^>?+]*>)\\s+<","gi");b=b.replace(c,"$1<");c=RegExp("(<tr *[^>?+]*>)\\s+<","gi");b=b.replace(c,"$1<");c=RegExp("(<td *[^>?+]*>)\\s+<","gi");b=b.replace(c,"$1<");c=RegExp("(<th *[^>?+]*>)\\s+<","gi");b=b.replace(c,
"$1<");c=RegExp("</tbody>\\s+<","gi");b=b.replace(c,"</tbody><");c=RegExp("</caption>\\s+<","gi");b=b.replace(c,"</caption><");c=RegExp("</tr>\\s+<","gi");b=b.replace(c,"</tr><");c=RegExp("</td>\\s+<","gi");b=b.replace(c,"</td><");c=RegExp("</th>\\s+<","gi");b=b.replace(c,"</th><");c=RegExp("</div>\\s+<","gi");b=b.replace(c,"</div><");c=RegExp("(<span *[^>?+]*>)([\r?\n]+)(</ ?span>)","gi");return b=b.replace(c,"$1&nbsp;$3")}
function removeStripTags(a,b){var c=b&&0!=b.length?"<\\/?(?!("+b.join("|")+"))\\b[^>]*>":"<(\"[^\"]*\"|'[^']*'|[^'\">])*>";return a.replace(new RegExp(c,"gi"),"")}function unhtmlSpecialChars(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;/g,"&")}function htmlSpecialChars(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")}var StringBuffer=function(){this.buffer=[]};
StringBuffer.prototype.append=function(a){this.buffer[this.buffer.length]=a};StringBuffer.prototype.toString=function(){return this.buffer.join("")};
function addLineBreaker(a,b){if("br"===a.toLowerCase())return"<p>"+b.replace(/\r?\n/g,"<BR />")+"</p>";b=b.replace(/\r?\n/g,"\n");for(var c=new StringBuffer,d=b.split("\n"),e=d.length,f="",g=0;g<e;g++){f=DEXTTOP.DEXT5.util.trim(d[g]);if(g===e-1&&""===f)break;null!==f&&""!==f?(c.append("<P>"),c.append(d[g]),c.append("</P>")):DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion?c.append("<P>&nbsp;</P>"):c.append("<P><BR></P>")}return c.toString()}
function checkContainClass(a,b){var c=!1;if(""!=b&&a.className&&""!=a.className)for(var d=a.className.split(" "),e=d.length,f=0;f<e;f++)if(d[f]==b){c=!0;break}return c}
function addDisalbeItemForNoActionTable(a){return a=a.concat("table_selection table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column convert_table_to_text cell_border cell_bg_color table_indent table_outdent table_tool insert_row insert_column table_select align_vertical table_copy cell_size".split(" "))}
function dropMousePosition(a){try{var b=getEditrFromEvent(a),c=_iframeDoc.body.topMargin,d=_iframeDoc.body.leftMargin;b.mouseDropPosition.clientX=a.clientX<d?d:a.clientX;b.mouseDropPosition.clientY=a.clientY<c?c:a.clientY}catch(e){}}
function insertDropImage(a){var b=a.dataTransfer.files;if(0<b.length){var c=getEditrFromEvent(a);DEXTTOP.G_CURREDITOR=c;if(c._DOC.body.isContentEditable){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(DEXTTOP.DEXT5.browser.ie)try{if(dropMousePosition(a),_iframeDoc.caretPositionFromPoint){var d=_iframeDoc.caretPositionFromPoint(c.mouseDropPosition.clientX,c.mouseDropPosition.clientY),e=_iframeDoc.createRange();e.setStart(d.offsetNode,d.offset);e.collapse()}else if(_iframeDoc.caretRangeFromPoint)_iframeDoc.caretRangeFromPoint(c.mouseDropPosition.clientX,
c.mouseDropPosition.clientY);else if(_iframeDoc.body.createTextRange){var e=_iframeDoc.body.createTextRange();e.moveToPoint(c.mouseDropPosition.clientX,c.mouseDropPosition.clientY);e.select()}}catch(f){d=c._BODY.lastChild;if(1!=d.nodeType||"P"!=d.tagName)d=c._DOC.createElement("p"),c._BODY.appendChild(d);doSetCaretPosition(d,1)}else if(d=getFirstRange().range,0==d.toString().length){e=null;try{createSelectionFromPoint(a.clientX,a.clientY,a.clientX,a.clientY),setFocusToBody(),d=getFirstRange().range,
e=_iframeDoc.createElement("dexttemp"),d.insertNode(e),null!=e.nextSibling&&doSetCaretPosition(e.nextSibling,!1)}catch(g){}e&&e.parentNode.removeChild(e)}a.stopPropagation();a.preventDefault();handleFiles(b[0],c)}}}
function handleFiles(a,b){for(var c=b._config.allowImageFileType.concat([]),d=!1,e=a.name.substring(a.name.lastIndexOf(".")+1).toLowerCase(),f=0;f<c.length;f++)if(c[f]==e){d=!0;break}if(1==d)if("txt"==e){var g=new FileReader;g.onload=function(a){a=htmlSpecialChars(a.target.result);a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a);DEXTTOP.DEXT5.browser.ie?pasteHtmlAtCaretHuge(a):b._DOC.execCommand("inserthtml",!1,a);g=void 0};g.readAsText(a)}else a&&DEXTTOP.DEXT5.browser.HTML5Supported&&0!=
DEXTTOP.G_CURREDITOR._config.maxImageFileSize&&a.size>DEXTTOP.G_CURREDITOR._config.maxImageFileSize?(c=dext5_lang.msg.max_file_size,c=c.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(DEXTTOP.G_CURREDITOR._config.maxImageFileSize).toString),alert(c)):"base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&a&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount&&getBase64ImageCount()>=parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10)?(c=dext5_lang.msg.max_base64file_count,c=c.replace("{0}",
DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount),alert(c)):"1"==DEXTTOP.G_CURREDITOR._config.uploadImageFileObject?(postBase64ImageToServer("",e,null,null,null,a),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){}},500)):(g=new FileReader,g.onload=function(c){b!=DEXTTOP.G_CURREDITOR&&(DEXTTOP.G_CURREDITOR=b);c=c.target.result;if("data:"==c.substring(0,5)&&(c=c.split(","),2==c.length)){var d=getExtFromImageDataSrc(c[0]);if("jpeg"==d){var e=a.name;"jpg"==e.substring(e.lastIndexOf(".")+
1).toLowerCase()&&(d="jpg")}postBase64ImageToServer(c[1],d,null,null,null,a);window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){}},500)}g=void 0},g.readAsDataURL(a))}
function setScrollOverflow(a){switch(a._config.scrollOverflow){case "0":a._BODY.style.overflowX="";a._BODY.style.overflowY="";break;case "1":a._BODY.style.overflowX="scroll";break;case "2":a._BODY.style.overflowY="scroll";break;case "3":a._BODY.style.overflowX="scroll";a._BODY.style.overflowY="scroll";break;case "4":a._BODY.style.overflowX="hidden";break;case "5":a._BODY.style.overflowY="hidden";break;case "6":a._BODY.style.overflowX="hidden",a._BODY.style.overflowY="hidden"}}
function removeEditorCss(a,b){var c=a,d;try{var e=["editor_layout.css","editor_contents.css","editor_showblocks.css","editor_form.css","editor_adjust_table.css"],f=e.length,g=a.match(new RegExp(/<link [^<>]*>/gi)),h=g.length;if(g)for(var n=0;n<f;n++)for(var m=0;m<h;m++)-1<g[m].indexOf(e[n])&&(a=a.replace(g[m],""));d=a}catch(p){d=c}return d}
function createEvent(a,b,c){var d=document.createElement("script");d.setAttribute("for",a);d.event=b;d.appendChild(document.createTextNode(c));document.body.appendChild(d)}function PL_Event_BeforeOpenHtmlConvert(a,b){try{a&&0==a.indexOf("htm")&&(DEXTTOP.G_CURREDITOR.strOldSaveFileName=b)}catch(c){}try{DEXTTOP.DEXTWIN.dext5EventBeforeOpenHtmlConvert(a,b)}catch(d){}}function PL_Event_AfterOpenHtmlConvert(a,b){try{setFileOpenData(a)}catch(c){}}
function PL_Event_dropZone_drop(a,b,c){if(!isViewMode(DEXTTOP.G_CURREDITOR)&&a&&0<a.length&&(b=a.lastIndexOf("."),-1<b&&(b=a.substring(b+1),-1<",jpg,jpeg,png,bmp,gif,tif,tiff,".indexOf(b.toLowerCase()))))if(a.indexOf("\\")&&(a=a.replace(/\\/g,"/")),0!=a.indexOf("file://")&&(a="file:///"+a),"base64"==DEXTTOP.G_CURREDITOR._config.uploadMethod&&"-1"!=DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount&&getBase64ImageCount()+1>parseInt(DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount,10))a=dext5_lang.msg.max_base64file_count,
a=a.replace("{0}",DEXTTOP.G_CURREDITOR._config.maxImageBase64fileCount),alert(a);else{b=_iframeDoc.createElement("img");c=G_dext5plugIn.getImageWidthHeight(a);SetImageAutoFitSize(b,a+"?"+c);b.src=a;b.alt="";dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();try{9>DEXTTOP.DEXT5.browser.ieVersion&&(DEXTTOP.G_CURREDITOR.mouseDropPosition.clientX=_iframeWin.event.clientX,DEXTTOP.G_CURREDITOR.mouseDropPosition.clientY=_iframeWin.event.clientY);
var d=_iframeDoc.body.createTextRange();d.moveToPoint(DEXTTOP.G_CURREDITOR.mouseDropPosition.clientX,DEXTTOP.G_CURREDITOR.mouseDropPosition.clientY);d.select()}catch(e){a=DEXTTOP.G_CURREDITOR._BODY.lastChild;if(1!=a.nodeType||"P"!=a.tagName)a=DEXTTOP.G_CURREDITOR._DOC.createElement("p"),DEXTTOP.G_CURREDITOR._BODY.appendChild(a);doSetCaretPosition(a,1)}d=getFirstRange().range;d.collapse(!0);d.insertNode(b);d.selectNode(b);d.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(d);
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper(b)}catch(f){}}}function setEnableDrapDropFile(){try{G_dext5plugIn.SetEnableDrapDropFile(),11<=DEXTTOP.DEXT5.browser.ieVersion?createEvent(G_dext5plugIn.id,"d5_event_dropZone_drop(strFileFolderName, bFolder, nOrder)","PL_Event_dropZone_drop(strFileFolderName, bFolder, nOrder)"):G_dext5plugIn.attachEvent("d5_event_dropZone_drop",PL_Event_dropZone_drop)}catch(a){}}
function file_open_plugin(){if("1"==DEXTTOP.G_CURREDITOR._config.openDocument.beforeOpenEvent)try{11<=DEXTTOP.DEXT5.browser.ieVersion?createEvent(G_dext5plugIn.id,"DEXT5_Event_BeforeOpenHtmlConvert(strFileFormat, strFileFullPath)","PL_Event_BeforeOpenHtmlConvert(strFileFormat, strFileFullPath)"):G_dext5plugIn.attachEvent("DEXT5_Event_BeforeOpenHtmlConvert",PL_Event_BeforeOpenHtmlConvert)}catch(a){}11<=DEXTTOP.DEXT5.browser.ieVersion?createEvent(G_dext5plugIn.id,"DEXT5_Event_AfterOpenHtmlConvert(strHTML, strReserved)",
"PL_Event_AfterOpenHtmlConvert(strHTML, strReserved)"):G_dext5plugIn.attachEvent("DEXT5_Event_AfterOpenHtmlConvert",PL_Event_AfterOpenHtmlConvert);var b=G_dext5plugIn.openDocumentDialog();"0"==DEXTTOP.G_CURREDITOR._config.useHybrid&&setFileOpenData(b)}
function setFileOpenData(a){if(a){var b=!0;0==DEXTTOP.DEXT5.isEmpty()&&0==confirm(dext5_lang.msg.newDocument)&&(b=!1);b&&(b=a.substring(0,3).toLowerCase(),a=a.substring(3),"txt"==b&&(a=htmlSpecialChars(a),a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a)),"doc"==b||"ppt"==b||"xls"==b?setBodyValueToEditor(a):DEXTTOP.DEXT5.setHtmlContents(a))}}
function removeLastBrTag(a){if("1"==a._config.removeLastBrTag)try{var b=a._DOC.getElementsByTagName("p"),c=b.length;for(a=0;a<c;a++){var d=b[a].lastChild;if(1==d.nodeType&&"BR"==d.tagName){var e=d.previousSibling;!e||1==e.nodeType&&"BR"==e.tagName||d.parentNode.removeChild(d)}}}catch(f){}}
function changeRealTagToReplaceString(a){var b=a;if(a){var c=a.match(RegExp("<textarea *([^>?+])*>*([^>?+])*</textarea>","gi"));if(c){DEXTTOP.G_CURREDITOR.sTextareaArr=c;for(var d=c.length,e=0;e<d;e++)b=a.replace(c[e],"{_dext5_textarea_"+e+"}")}}return b}function changeReplaceStringToRealTag(a){var b=a;if(a){for(var c=DEXTTOP.G_CURREDITOR.sTextareaArr,d=c.length,e=0;e<d;e++)b=a.replace("{_dext5_textarea_"+e+"}",c[e]);DEXTTOP.G_CURREDITOR.sTextareaArr=[]}return b}
function getViolationNodes(a){dext_src_init(a._EDITOR.design);var b=[];if(""==a._config.accessibilityValidationItems)b=["table","frame","iframe","img","a"];else for(var c=a._config.accessibilityValidationItems.split(","),d=c.length,e=0;e<d;e++)if("duplicate_id"!=c[e].toLowerCase()){var f=c[e].split("_")[0];0>b.indexOf(f)&&b.push(f)}d=b.length;c=[];for(e=0;e<d;e++)for(var f="iframe"==b[e]?_iframeDoc.body.getElementsByTagName("img"):_iframeDoc.body.getElementsByTagName(b[e]),g=f.length,h=0;h<g;h++){var n=
f[h].getAttribute("dext5webaccskip");if(null==n||void 0==n)if("table"==b[e])-1<a._config.accessibilityValidationItems.indexOf("table_caption")&&-1<a._config.accessibilityValidationItems.indexOf("table_summary")||""==a._config.accessibilityValidationItems?null!=f[h].caption&&""!=f[h].caption.innerHTML&&""!=f[h].summary||c.push(f[h]):-1<a._config.accessibilityValidationItems.indexOf("table_caption")?null!=f[h].caption&&""!=f[h].caption.innerHTML||c.push(f[h]):-1<a._config.accessibilityValidationItems.indexOf("table_summary")&&
""==f[h].summary&&c.push(f[h]);else if(-1<"frame,a".indexOf(b[e]))"a"==b[e]?null!=f[h].href&&""!=f[h].href&&""==f[h].title&&c.push(f[h]):""==f[h].title&&c.push(f[h]);else if("iframe"==b[e]){if(n=f[h].getAttribute("dext5customdata"),null!=n&&void 0!=n&&(elemData=getDextCustomData(n),"iframe"==elemData.type||"iframe"==elemData.type2))void 0!=elemData.title&&""!=elemData.title||c.push(f[h])}else"img"==b[e]&&(n=f[h].getAttribute("dext5customdata"),void 0==n||null==n)&&(void 0!=f[h].alt&&""!=f[h].alt||
c.push(f[h]))}b=[];if(-1<a._config.accessibilityValidationItems.indexOf("duplicate_id")||""==a._config.accessibilityValidationItems)for(a=_iframeDoc.body.getElementsByTagName("*"),d=a.length,f=[],e=0;e<d;e++)!a[e].getAttribute("id")||-1<f.indexOf(a[e].getAttribute("id"))||(g=getElementsById(a[e].getAttribute("id"),_iframeDoc))&&1<g.length&&(b.push(g),f.push(a[e].getAttribute("id")));return{violateNodes:c,idSamNodes:b}}
function setAdjustTableBorder(a){for(var b=a.getElementsByTagName("link"),c=null,d=b.length-1;0<=d;d--)-1<b[d].href.indexOf("editor_adjust_table.css")&&(c=b[d],c.parentNode.removeChild(c));DEXTTOP.DEXT5.browser.ie&&(11>DEXTTOP.DEXT5.browser.ieVersion&&7<DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)&&0<a.getElementsByTagName("table").length&&(b=DEXTTOP.G_CURREDITOR._config.webPath.css,DEXTTOP.DEXT5.isRelease||(b=DEXTTOP.G_CURREDITOR._config.webPath.css_dev),c=a.getElementsByTagName("head")[0],
createDynamicCssLinkToHeadTag(a,c,b+"editor_adjust_table.css?ver="+DEXTTOP.DEXT5.ReleaseVer),setTimeout(function(){for(var b=a.getElementsByTagName("link"),c=null,d=b.length-1;0<=d;d--)-1<b[d].href.indexOf("editor_adjust_table.css")&&(c=b[d],c.parentNode.removeChild(c))},0))}function hiddenBlocks(a){a=a.getElementsByTagName("link");for(var b=null,c=a.length-1;0<=c;c--)-1<a[c].href.indexOf("editor_showblocks.css")&&(b=a[c],b.parentNode.removeChild(b))}
function removeDummyTag(a){a=DEXTTOP.DEXT5.util.replaceAll(a,"<![if !mso]>","");return a=DEXTTOP.DEXT5.util.replaceAll(a,"<![if !mso & !vml]>","")}function dummyTagClassClear(a){"1"==DEXTTOP.G_CURREDITOR._config.useSelectionMark&&(a=a.replace(RegExp("<dextmark[^>]+class=.*?dextmark.*?></dextmark>","gi"),""));1==DEXTTOP.G_CURREDITOR.ShowTableBorder&&(a=a.replace(" DEXT_tableborder",""),a=a.replace("DEXT_tableborder ",""),a=a.replace("DEXT_tableborder",""),a=a.replace('class=""',""));return a}
function ReplaceCustomDataToRealEvent(){try{for(var a=_iframeDoc.getElementsByTagName("input"),b=a.length-1;0<=b;b--){var c=a[b],d=c.getAttribute("dext5customdata");if(null!=d&&void 0!=d){var e=getDextCustomData(d);if(e.type&&"event"==e.type){var f=e.eventName,g=e.eventFunction,h=f.split("\x0B"),n=g.split("\x0B"),m=h.length;for(i=0;i<m;i++)c.setAttribute(h[i],n[i])}c.removeAttribute("dext5customdata")}}for(var p=_iframeDoc.getElementsByTagName("textarea"),b=p.length-1;0<=b;b--){var t=p[b],d=t.getAttribute("dext5customdata");
if(null!=d&&void 0!=d){e=getDextCustomData(d);if(e.type&&"event"==e.type)for(f=e.eventName,g=e.eventFunction,h=f.split("\x0B"),n=g.split("\x0B"),m=h.length,i=0;i<m;i++)t.setAttribute(h[i],n[i]);t.removeAttribute("dext5customdata")}}for(var q=_iframeDoc.getElementsByTagName("select"),b=q.length-1;0<=b;b--){var u=q[b],d=u.getAttribute("dext5customdata");if(null!=d&&void 0!=d){e=getDextCustomData(d);if(e.type&&"event"==e.type)for(f=e.eventName,g=e.eventFunction,h=f.split("\x0B"),n=g.split("\x0B"),m=
h.length,i=0;i<m;i++)u.setAttribute(h[i],n[i]);u.removeAttribute("dext5customdata")}}}catch(v){}}
function ReplaceRealEventToCustomData(){for(var a=_iframeDoc.getElementsByTagName("input"),b=a.length-1;0<=b;b--){for(var c=a[b],d=DEXTTOP.G_CURREDITOR._config.eventList.length,e="",f="",g=!1,h=0;h<d;h++)c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h])&&(g&&(e+="\x0B",f+="\x0B"),g=!0,e+=DEXTTOP.G_CURREDITOR._config.eventList[h],f+=c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h]));""!=e&&(d={type:"event"},d.eventName=e,d.eventFunction=f,setDextCustomData(c,d))}a=_iframeDoc.getElementsByTagName("textarea");
for(b=a.length-1;0<=b;b--){c=a[b];d=DEXTTOP.G_CURREDITOR._config.eventList.length;f=e="";g=!1;for(h=0;h<d;h++)c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h])&&(g&&(e+="\x0B",f+="\x0B"),g=!0,e+=DEXTTOP.G_CURREDITOR._config.eventList[h],f+=c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h]));""!=e&&(d={type:"event"},d.eventName=e,d.eventFunction=f,setDextCustomData(c,d))}a=_iframeDoc.getElementsByTagName("select");for(b=a.length-1;0<=b;b--){c=a[b];d=DEXTTOP.G_CURREDITOR._config.eventList.length;
f=e="";g=!1;for(h=0;h<d;h++)c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h])&&(g&&(e+="\x0B",f+="\x0B"),g=!0,e+=DEXTTOP.G_CURREDITOR._config.eventList[h],f+=c.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h]));""!=e&&(d={type:"event"},d.eventName=e,d.eventFunction=f,setDextCustomData(c,d))}}
function checkLockAttr(a,b){for(var c=!1,d=[],d="1"==DEXTTOP.G_CURREDITOR._config.formMode?DEXTTOP.G_CURREDITOR._config.adminTableLock.checkLockName:DEXTTOP.G_CURREDITOR._config.userTableLock.lockName,e=d.length;null!=a;){for(var f=0;f<e;f++)if(void 0!=a.getAttribute(d[f])){c=!0;break}if(b)break;else a=!a.tagName||"TD"!=a.tagName&&"TH"!=a.tagName?a.tagName&&"TABLE"==a.tagName?GetTDTHCell(a):null:GetParentbyTagName(a,"table")}return c}
function removeLockAttr(a){var b=DEXTTOP.G_CURREDITOR._config.adminTableLock.checkLockName,c=b.length;if(a)for(var d=0;d<c;d++)a.removeAttribute(b[d])}
function setClassTableAndCellLock(a){if("0"!=a._config.formMode||"0"!=a._config.userTableLock.use){""==a._config.tableNoResizeClass&&(a._config.tableNoResizeClass="dext_no_resize");""==a._config.tableNoActionClass&&(a._config.tableNoActionClass="dext_no_action");for(var b=a._config.tableNoResizeClass,c=a._config.tableNoActionClass,d=a._DOC.getElementsByTagName("table"),e=d.length,f=0;f<e;f++)if(checkLockAttr(d[f],!0))if("1"==a._config.formMode)setClassName(d[f],"DEXT_five_table_lock");else{if("1"==
a._config.userTableLock.use){var g=a._config.userTableLock.defaultShowLockIcon;d[f].getAttribute("show_icon")&&""!=d[f].getAttribute("show_icon")&&(g=d[f].getAttribute("show_icon"));"1"==g?setClassName(d[f],"DEXT_five_table_lock"):removeClassName(d[f],"DEXT_five_table_lock");setClassName(d[f],b);setClassName(d[f],c)}}else"1"==a._config.userTableLock.use&&(g=a._config.userTableLock.defaultTableLockMode,d[f].getAttribute("lock_mode")&&""!=d[f].getAttribute("lock_mode")&&(g=d[f].getAttribute("lock_mode")),
"2"==g?checkLockAttr(d[f])&&(setClassName(d[f],b),setClassName(d[f],c)):(removeClassName(d[f],b),removeClassName(d[f],c)));b=a._DOC.getElementsByTagName("td");c=b.length;for(f=0;f<c;f++)checkLockAttr(b[f],!0)&&("1"==a._config.formMode?setClassName(b[f],"DEXT_five_cell_lock"):(d=a._config.userTableLock.defaultShowLockIcon,e=GetParentbyTagName(b[f],"table"),e.getAttribute("show_icon")&&""!=e.getAttribute("show_icon")&&(d=e.getAttribute("show_icon")),"1"==a._config.userTableLock.use&&("1"==d?setClassName(b[f],
"DEXT_five_cell_lock"):removeClassName(b[f],"DEXT_five_cell_lock"))))}}function findNoLockCell(a){var b=null;if(a){var c=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;a.getAttribute("lock_mode")&&""!=a.getAttribute("lock_mode")&&(c=a.getAttribute("lock_mode"));var d=!0;"1"==c&&(d=!1);a=a.getElementsByTagName("td");for(var c=a.length,e=0;e<c;e++)if(0==checkLockAttr(a[e],!d)){b=a[e];break}}return b}
function setFocusForLock(a){try{a&&("TD"==a.tagName||"TH"==a.tagName?"P"==a.firstChild.tagName?(doSetCaretPosition(a.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):(doSetCaretPosition(a,0),DEXTTOP.G_CURREDITOR._iconEnable("")):(doSetCaretPosition(a,0),DEXTTOP.G_CURREDITOR._iconEnable("")))}catch(b){}}
function findNoLockElem(a){var b=null;if(a){var c=a.previousSibling;c&&1==c.nodeType&&!checkLockAttr(c)&&(b=c);null==b&&(a=a.nextSibling)&&1==a.nodeType&&!checkLockAttr(a)&&(b=a)}return b}
function checkLockElemInSelectionRange(){try{var a=getFirstRange(),b=a.range;if(0<b.toString().length){var c=[[],[]];c[0]=getNodesInRange(b);if(null!=b.startContainer.previousSibling&&"HEAD"==b.startContainer.previousSibling.tagName&&null==b.endContainer.nextSibling){var d=_iframeDoc.getElementsByTagName("table"),e=_iframeDoc.getElementsByTagName("td");c[0]=d;c[1]=e}for(var f=c.length-1;0<=f;f--)for(var g=c[f].length-1;0<=g;g--){var h;h="TD"==c[f][g].tagName||"TABLE"==c[f][g].tagName;if(c[f][g].tagName&&
h&&checkLockAttr(c[f][g],!0)){a.sel.removeAllRanges();DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(window.focus(),document.body.focus());break}}}}catch(n){}}function IsExistTableLock(a){var b=!1,c=a._DOC;a=c.getElementsByTagName("table");var d=c.getElementsByTagName("td"),c=c.getElementsByTagName("th");a=[a,d,c];d=a.length;for(c=0;c<d;c++){for(var e=a[c].length,f=0;f<e;f++)if(checkLockAttr(a[c][f],!0)){b=!0;break}if(b)break}return b}
function setDEXTWINDOC(){null!=DEXTTOP.DEXT5.config.DialogWindow&&(setDEXTWINwindow(),setDEXTDOCdocument())}function groupingIcon(a){a&&(DEXTTOP.G_CURREDITOR=a);"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&("0"!=DEXTTOP.G_CURREDITOR._config.tool_bar&&"2"!=DEXTTOP.G_CURREDITOR._config.tool_bar||makeGrouping(1,a),"0"!=DEXTTOP.G_CURREDITOR._config.tool_bar&&"1"!=DEXTTOP.G_CURREDITOR._config.tool_bar||makeGrouping(2,a))}
function makeGrouping(a,b){b&&(DEXTTOP.G_CURREDITOR=b);for(var c=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("dext_tab_tool"+a+"_"+DEXTTOP.G_CURREDITOR.ID),d=DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].length,d=d-1;0<=d;d--)c.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[a-1][d]);DEXTTOP.G_CURREDITOR.Toolbar_group[a-1]=[];DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("ul_tool_bar_grouping_list"+a).innerHTML="";for(var e=c.childNodes,f=e.length,c=[],d=0;d<f;d++)1==e[d].nodeType&&(-1<
e[d].className.indexOf("uebutton")||-1<e[d].className.indexOf("ue_SM"))&&c.push(e[d]);d=c.length;e=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("ue_editor_main_"+DEXTTOP.G_CURREDITOR.ID);e=getClientRect(e);for(--d;0<=d;d--)if(getClientRect(c[d]).right>=e.right-18)-1<c[d].id.indexOf("detail_table_insert")?(DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].push(c[d]),DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].push(c[d-1]),--d):-1<c[d].id.indexOf("detail_list_")||-1<c[d].id.indexOf("_group_detail")||-1<
c[d].id.indexOf("detail_font_")||-1<c[d].id.indexOf("detail_cell_")?(DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].push(c[d]),DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].push(c[d-1]),--d):DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].push(c[d]);else break;d=DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].length;c=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("dext_span_"+DEXTTOP.G_CURREDITOR.ID+"tool_bar_grouping"+a);if(0==d)c.style.display="none";else{for(--d;0<=d;d--)e=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.createElement("li"),
-1<DEXTTOP.G_CURREDITOR.Toolbar_group[a-1][d].id.indexOf("list_")?(e.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[a-1][d]),e.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[a-1][d-1]),--d):e.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[a-1][d]),DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("ul_tool_bar_grouping_list"+a).appendChild(e);c.style.display=""}}
function setPositionGroupingDiv(a){var b=document.getElementById("dext_div_tool_bar_grouping_box"+a),c=document.getElementById("dext_span_"+DEXTTOP.G_CURREDITOR.ID+"tool_bar_grouping"+a),c=getClientRect(c);a=getClientRect(document.getElementById("ul_tool_bar_grouping_list"+a));b.style.left=c.right-(a.right-a.left)-2+"px";b.style.top=c.bottom+"px"}
function showGroupingBackground(){var a=document.getElementById("dext_grouping_background");a||(a=document.createElement("div"),a.setAttribute("id","dext_grouping_background"),a.style.zIndex=G_MAIN_ZINDEX+800,document.body.appendChild(a),DEXTTOP.DEXT5.util.addEvent(a,"click",function(){hideGroupingBox()}),a.onmousedown=function(){return!1},a.unselectable="on");DEXT5_EDITOR.prototype.dialog.set_full_size(a);a.style.display="block"}
function hideGroupingBox(){dialogCancel();var a=document.getElementById("dext_div_tool_bar_grouping_box1");a&&(a.style.display="none");if(a=document.getElementById("dext_div_tool_bar_grouping_box2"))a.style.display="none";if(a=document.getElementById("dext_grouping_background"))a.style.display="none"}
function isGroupingIcon(a,b,c){var d=!1;"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&(a=c?c:document.getElementById("ue_"+a+b),(a=GetParentbyTagName(a,"ul"))&&-1<a.id.indexOf("ul_tool_bar_grouping")&&(d=!0));return d}
function userCssSet(a){var b=strRetvalue=a,c='<link href="'+DEXTTOP.G_CURREDITOR._config.userCssUrl+'" rel="stylesheet" type="text/css">';try{if(-1==a.indexOf(c)){var d=a.indexOf("</head>");if(-1==d){var e=a.indexOf("<body");strRetvalue=-1==e?"<head>"+c+"</head><body>"+a+"</body>":a.substring(0,e)+"<head>"+c+"</head>"+a.substring(e)}else strRetvalue=a.substring(0,d)+c+a.substring(d)}}catch(f){strRetvalue=b}return strRetvalue}
function loadDirectEditHtmlUrl(a){if(""!=a.directEditHtmlUrl){var b=DEXTTOP.G_CURREDITOR._EDITOR.design;DEXTTOP.DEXT5.util.addEvent(b,"load",loadDirectEditHtmlUrlEvent);"1"==DEXTTOP.G_CURREDITOR._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){b.src=a.directEditHtmlUrl},G_Progress_LoadTime)):b.src=a.directEditHtmlUrl}}
function loadDirectEditHtmlUrlEvent(){try{var a=DEXTTOP.G_CURREDITOR._EDITOR.design,b=DEXTTOP.G_CURREDITOR._setting.encoding,c=DEXTTOP.G_CURREDITOR._setting.lang,d=DEXTTOP.G_CURREDITOR._setting.xmlnsname,e=DEXTTOP.G_CURREDITOR._setting.font_family,f=DEXTTOP.G_CURREDITOR._setting.font_size,g=DEXTTOP.G_CURREDITOR._setting.line_height,h=a.contentWindow,n=getIframeDocument(a),m=h.document.documentElement.getElementsByTagName("head")[0];if(null==m||void 0==m)m=n.createElement("head"),n.insertBefore(m,
n.body);if(""!=DEXTTOP.G_CURREDITOR._config.imageBaseUrl){for(var p=m.getElementsByTagName("base"),t=p.length,q=0;q<t;q++)if(p[q].href&&-1<p[q].href.indexOf(DEXTTOP.G_CURREDITOR._config.imageBaseUrl)){sameCheck=!0;break}var u=n.createElement("base");u.href=DEXTTOP.G_CURREDITOR._config.imageBaseUrl;m.appendChild(u)}if(""!=DEXTTOP.G_CURREDITOR._config.ieCompatible){for(var v=m.getElementsByTagName("meta"),w=v.length,q=0;q<w;q++)if(v[q].getAttribute("content")&&-1<v[q].getAttribute("content").indexOf("IE="+
DEXTTOP.G_CURREDITOR._config.ieCompatible)){sameCheck=!0;break}var y=n.createElement("meta");y.setAttribute("http-equiv","X-UA-Compatible");y.setAttribute("content","IE="+DEXTTOP.G_CURREDITOR._config.ieCompatible);m.appendChild(y)}for(var x=m.getElementsByTagName("style"),z=x.length,h=!1,q=0;q<z;q++)if(1==defaultStyleSameCheck(x[q].innerHTML,DEXTTOP.G_CURREDITOR)){h=!0;break}if(!h){var A=createEditorDefaultStyleInnerHTML(DEXTTOP.G_CURREDITOR._config,e,f,g);addDynamicCssToHeadTag(n,m,A)}e="";e=DEXTTOP.DEXT5.isRelease?
DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev;createDynamicCssLinkToHeadTag(n,m,e+"editor_contents.css?ver="+DEXTTOP.DEXT5.ReleaseVer);"1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"!=DEXTTOP.G_CURREDITOR._config.userTableLock.use||createDynamicCssLinkToHeadTag(n,m,e+"editor_form.css?ver="+DEXTTOP.DEXT5.ReleaseVer);if(c&&0<c.length){var B=n.getElementsByTagName("html")[0];B&&(-1<c.indexOf("-")&&(c=c.split("-")[0]),B.setAttribute("lang",c),B.setAttribute("xml:lang",
c),0<d.length&&B.setAttribute("xmlns",d))}""==b&&(b="utf-8");var G=n.createElement("meta");G.setAttribute("http-equiv","Content-Type");G.setAttribute("content","text/html");G.setAttribute("charset",b);m.appendChild(G);5<DEXTTOP.G_CURREDITOR._config.userCssUrl.length&&createDynamicCssLinkToHeadTag(n,m,DEXTTOP.G_CURREDITOR._config.userCssUrl);5<DEXTTOP.G_CURREDITOR._config.userJsUrl.length&&createDynamicJsLinkToHeadTag(n,m,DEXTTOP.G_CURREDITOR._config.userJsUrl);DEXT5_EDITOR.prototype._load_editor_frame(!1);
0==isViewMode(DEXTTOP.G_CURREDITOR)&&(DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,"1"==DEXTTOP.G_CURREDITOR._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage(),0==h&&xssReplaceScript(_iframeDoc));setScrollOverflow(DEXTTOP.G_CURREDITOR);setStyleForTableBorderNodeClass(DEXTTOP.G_CURREDITOR);setCssForFormMode(DEXTTOP.G_CURREDITOR);DEXTTOP.DEXT5.util.removeLineHeightOfTable();DEXTTOP.G_CURREDITOR._iconEnable("");setBodyDefaultValue();try{var D=DEXTTOP.G_CURREDITOR._BODY.innerHTML,
D=addHtmlToSetValue(DEXTTOP.G_CURREDITOR,D),D=removeDummyTag(D),D=removeIncorrectSpaceInTag(D),D=DEXT5_EDITOR.HTMLParser.RemoveOfficeTag2(D);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlCorrection&&0==h&&(D=htmlTagRevision(D,!1));D=removeTagStyle(D);D=htmlAsciiToChar(D);D=RemoveUnnecessaryChar(D);0==h&&(D=CleanZeroChar(D));b=!1;"1"==DEXTTOP.G_CURREDITOR._config.replaceEmptyTagWithSpace&&(b=!0);D=DEXTTOP.DEXT5.util.htmlRevision(D,b);DEXTTOP.G_CURREDITOR._BODY.innerHTML=D}catch(I){}wrapPtagForNotBlockTag(DEXTTOP.G_CURREDITOR);
replaceBrTag(DEXTTOP.G_CURREDITOR);removeLastBrTag(DEXTTOP.G_CURREDITOR);0==isViewMode(DEXTTOP.G_CURREDITOR)&&(removeNbspInPTag(DEXTTOP.G_CURREDITOR),replaceClassForBorder(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._BODY,"show"),replaceClassForBookmark(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._BODY,"show"));setFocusToBody();setFocusFirstChildForStyle(DEXTTOP.G_CURREDITOR._BODY);DEXTTOP.DEXT5.util.setBodyBackground(DEXTTOP.G_CURREDITOR);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0;DEXTTOP.G_CURREDITOR.UndoManager.canUndo=!1;DEXTTOP.G_CURREDITOR.UndoManager.canRedo=!1;DEXTTOP.G_CURREDITOR._iconEnable("");insertImageSrc(DEXTTOP.G_CURREDITOR);showRuler(DEXTTOP.G_CURREDITOR);setClassTableAndCellLock(DEXTTOP.G_CURREDITOR);setAdjustTableBorder(DEXTTOP.G_CURREDITOR._DOC);"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks&&(DEXTTOP.G_CURREDITOR.ShowBlocks="",command_showBlocks(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR))}catch(K){}finally{DEXTTOP.DEXT5.util.removeEvent(a,"load",loadDirectEditHtmlUrlEvent),
"1"==DEXTTOP.G_CURREDITOR._config.statusBarLoading&&hideProcessingBackground()}}
function showProcessingBackground(){var a=document.getElementById("dext_Processing_background"),b=document.getElementById("dext_Processing_text");a||(a=document.createElement("div"),a.setAttribute("id","dext_Processing_background"),a.style.zIndex=G_MAIN_ZINDEX+900,a.style.verticalAlign="middle",b=document.createElement("div"),b.setAttribute("id","dext_Processing_text"),b.style.zIndex=parseIntOr0(a.style.zIndex)+100,b.innerHTML="<b>Processing...</b>",document.body.appendChild(a),document.body.appendChild(b));
DEXT5_EDITOR.prototype.dialog.set_full_size(a);a.style.display="block";b.style.display="block"}function hideProcessingBackground(){var a=document.getElementById("dext_Processing_background"),b=document.getElementById("dext_Processing_text");a&&(a.style.display="none",b.style.display="none")}function textCheckInString(a){a=a.replace(/\r\n/g,"");a=a.replace(/\r/g,"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");return a=a.replace(/\s/g,"")}
function getDialogWindow(){var a=DEXTTOP.window;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(a=DEXTTOP.G_CURREDITOR.dialogWindow);return a}function getDialogDocument(){var a=DEXTTOP.window.document;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(a=DEXTTOP.G_CURREDITOR.dialogWindow.document);return a}
function addHtmlToSetValue(a,b){var c=backValue=b;try{var d=a._config.addHtmlToSetValue.html;if(""!=d){var e=a._config.addHtmlToSetValue.preOrSub,f=-1;if(0==e){var g=b.toLowerCase().indexOf("<body");-1<g&&(f=g+b.substring(g).indexOf(">"))}else f=b.toLowerCase().indexOf("</body")-1;c=0<f?b.substring(0,f+1)+d+b.substring(f+1):0==e?d+b:b+d;a._config.addHtmlToSetValue.html=""}}catch(h){c=backValue}return c}
function adjustTableForIEJASOBug(a){try{if("1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign){a.align="";a.removeAttribute("align");try{"cssFloat"in a.style?a.style.cssFloat="":a.style.styleFloat=""}catch(b){}}for(var c=["td","th","p","span"],d=c.length,e=0;e<d;e++){var f=a.getElementsByTagName(c[e]),g=f.length;if("span"!=c[e])for(var h=0;h<g;h++)1==f[h].childNodes.length&&1==f[h].childNodes[0].nodeType&&"BR"==f[h].childNodes[0].tagName&&(f[h].innerHTML="P"==f[h].tagName?"&nbsp;":"<p>&nbsp;</p>");
else for(h=0;h<g;h++)if(1!=f[h].childNodes.length||"br"!=f[h].childNodes[0].tagName.toLowerCase()){var n=f[h].innerHTML,n=n.replace(/<br>$/ig,""),n=n.replace(/<br ([^>]+)>$/ig,"");11==DEXTTOP.DEXT5.browser.ieVersion&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()&&""==n&&(n=unescape("%u200B"));f[h].innerHTML=n}}}catch(m){}}
function endBrForIEJASOBug(a){if(a.hasChildNodes()&&1==a.lastChild.nodeType&&1<a.childNodes.length)try{var b=a.lastChild;if("br"==b.tagName.toLowerCase()){var c;if(2<a.childNodes.length&&b.previousSibling){var d=b.previousSibling;d&&1==d.nodeType&&"br"==d.tagName.toLowerCase()&&(c=d)}a.removeChild(b);c&&a.removeChild(c)}}catch(e){}}
function startCreationPluginObject(a){if(DEXTTOP.DEXT5UPLOAD&&"2.7.1122996"<=DEXTTOP.DEXT5UPLOAD.ReleaseVer)try{var b=0,c=null,d=function(b){var d=b.length,e=0,f=!1,p=setInterval(function(){try{var b=DEXTTOP.DEXT5UPLOAD.DEXTMULTIPLE["dext5uploader_frame_"+c[e]];b&&b._config&&("1"==b._config.hybridDownload&&(f=!0,clearInterval(p)),e++,0==f&&e==d&&(clearInterval(p),fn_createPluginObject(a)))}catch(g){clearInterval(p),fn_createPluginObject(a)}},100)},e=setInterval(function(){try{c=DEXTTOP.DEXT5UPLOAD.DEXTMULTIPLEID,
0<c.length&&(clearInterval(e),d(c)),b++,10<=b&&(clearInterval(e),fn_createPluginObject(a))}catch(f){clearInterval(e),fn_createPluginObject(a)}},200)}catch(f){}else fn_createPluginObject(a)}
function fn_createPluginObject(a){if(!G_dext5plugIn){var b=a.plugin_root+"dext5editor.cab";!a.pluginInstallType||"1"!=a.pluginInstallType.toString()&&"2"!=a.pluginInstallType.toString()||(b="");var c=document.createElement("div");c.style.display="none";var d="";"1"==a.autoPluginUpdate&&(d=b+"#version="+a.plugin_version);b='<object id="dext5plugin" classid="CLSID:2A28D4A1-467B-48C7-AF21-51F6D88456BD" codebase="'+d+'" width="0" height="0"><param name="saveFileType" value="">';b+='<param name="serverDomain" value="'+
a.serverDomain+'">';b+='<param name="toSavePathUrl" value="'+a.toSavePathURL+'">';b+='<param name="saveFolderNameRule" value="'+a.saveFolderNameRule+'">';b+='<param name="saveFileNameRule" value="'+a.saveFileNameRule+'">';b+='<param name="productKey" value="'+a.productKey+'">';b+='<param name="licenseKeyUrl" value="'+a.plugin_root+'">';b+='<param name="postPageURL" value="'+a.post_url+'">';b+='<param name="accessibility" value="'+a.accessibility+'">';b+='<param name="trustSites" value="'+a.trustSites+
'">';b+='<param name="licenseKey" value="'+a.LicenseKey+'">';b+='<param name="openDialogTitle" value="'+a.userOpenDlgTitle+'">';b+='<param name="mimeBaseURL" value="'+a.mimeBaseURL+'">';b+='<param name="openDialogType" value="'+a.userOpenDlgType+'">';b+='<param name="openDialogInitDir" value="'+a.userOpenDlgInitDir+'">';b+='<param name="imagePropStyle" value="'+a.userImageDlgStyle+'">';b+='<param name="imgDefaultWidth" value="'+a.imgDefaultWidth+'">';b+='<param name="imgDefaultHeight" value="'+a.imgDefaultHeight+
'">';b+='<param name="officeLineFix" value="'+a.officeLineFix+'">';b+='<param name="systemTitle" value="'+a.system_title+'">';b+='<param name="useLog" value="'+a.useLog+'">';b+='<param name="editphotouse" value="'+a.imageEditorUse+'">';"3,5,0,23">=DEXTTOP.DEXT5.cabVersion?(d="",d=-1<a.lang.indexOf("ko")?"ko":-1<a.lang.indexOf("en")?"en":-1<a.lang.indexOf("ja")?"ja":a.lang,b+='<param name="sLang" value="'+d+'">'):b+='<param name="sLang" value="'+a.lang+'">';d=a.style.skinName;"mono"==d&&(d="gray");
b+='<param name="skinName" value="'+d+'">';b+='<param name="sFileDataID" value="'+a.fileFieldID+'">';b+='<param name="sUserFieldID" value="'+a.userFieldID+'">';b+='<param name="sUserFieldValue" value="'+a.userFieldValue+'">';b="1"==a.limitPasteHtmlLength.value&&0<a.limitPasteHtmlLength.length?b+('<param name="nLimitPasteLength" value="'+a.limitPasteHtmlLength.length+'">'):b+'<param name="nLimitPasteLength" value="0">';b+='<param name="sMaxWordFileSize" value="'+a.openDocument.word.maxSize+'">';b+=
'<param name="nMaxWordPageSize" value="'+a.openDocument.word.maxPage+'">';b+='<param name="sMaxExcelFileSize" value="'+a.openDocument.excel.maxSize+'">';b+='<param name="nMaxExcelSheetSize" value="'+a.openDocument.excel.maxSheet+'">';b+='<param name="sMaxPowerPointFileSize" value="'+a.openDocument.powerpoint.maxSize+'">';b+='<param name="nMaxPowerPointSlideSize" value="'+a.openDocument.powerpoint.maxSlide+'">';b+='<param name="nWordToHtml" value="1">';b+='<param name="nUseHwpApp" value="'+a.openDocument.useHwp+
'">';b+='<param name="hasContainer" value="'+a.hasContainer+'">';b+='<param name="nUsePostContentType" value="'+a.imgUploadContenttype+'">';"0"!=a.security.encryptParam&&(b+='<param name="nPe" value="'+a.security.encryptParam+'">');"0"==a.viewModeBrowserMenu&&(b+='<param name="keyInterface" value="ShowIEContextMenu">');b+='<param name="nUseDragDrop" value="'+a.dragAndDropAllow+'">';d="";try{d=window.location.protocol+"//"+window.location.host}catch(e){}b+='<param name="strCookieURL" value="'+d+'">';
b+='<param name="nUseHybrid" value="'+a.useHybrid+'">';b+='<param name="nModalWindow" value="'+a.hybridWindowMode+'">';b+='<param name="strPrintMargin" value="'+a.printMarginltrb+'">';b+='<param name="strKeepVersion" value="'+a.pluginKeepVersion+'">';""!=a.buttonText001&&(b+='<param name="sButtonText001" value="'+a.buttonText001+'">');""!=a.maxImageFileSize&&"0"!=a.maxImageFileSize&&(b+='<param name="sMaxImageFileSize" value="'+a.maxImageFileSize+'">');b+='<param name="nAllowedMultiImg" value="'+
a.insertMultiImage+'">';b+='<param name="sOpenDocFilter" value="'+a.allowOpenFileType+'">';b+='<param name="nExcelImageCorrectly" value="'+a.excelImageFix+'">';b+="</object>";c.innerHTML=b;document.body.appendChild(c);G_dext5plugIn=document.getElementById("dext5plugin");if("1"==a.dragAndDropAllow&&"ieplugin"==a.runtimes)var f=setInterval(function(){a.isLoadedEditor&&(setEnableDrapDropFile(),clearInterval(f))},100)}}
function fn_createDialogHelperObject(){if(!G_dialogHelper){var a=document.createElement("div");a.innerHTML='<object id="dlgHelper" classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0px" height="0px"></object>';document.body.appendChild(a);G_dialogHelper=document.getElementById("dlgHelper")}}
function requestPluginInstall(a,b,c){var d=null,d=c?c:a.DEXTTOP.G_CURREDITOR._config;a=b.createElement("iframe");a.name="download_frame";a.id="download_frame";a.style.display="none";b.body.appendChild(a);a=b.createElement("form");a.target="download_frame";c="";c=""!=d.pluginInstallUrl?d.pluginInstallUrl:d.plugin_root+d.pluginInstallFileName;a.action=c;b.body.appendChild(a);a.submit();b.body.removeChild(a)}
function fnCommaExec(a){a=a.toString();if(3<a.length){var b=a.length%3,c=0<b?a.substring(0,b):"";for(i=0;i<Math.floor(a.length/3);i++)c=0==b&&0==i?c+a.substring(b+3*i,b+3*i+3):c+(","+a.substring(b+3*i,b+3*i+3));return c}return a}
function cleanHTML(a){var b=a.match(RegExp("<img .*?>","ig"));if(b&&0<b.length)for(var c=b.length,d=0;d<c;d++)a=a.replace(b[d].toString(),"<dext_temp_tag"+d+">");a=a.replace(/(\n|\r| class=(")?Mso[a-zA-Z]+(")?)/g," ");a=a.replace(RegExp("\x3c!--(.*?)--\x3e","g"),"");c=RegExp("<(/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>","gi");a=a.replace(c,"");for(var e="style script applet embed noframes noscript".split(" "),d=0;d<e.length;d++)c=new RegExp("<"+e[d]+".*?"+e[d]+"(.*?)>","gi"),a=a.replace(c,"");
c=["style","start"];for(d=0;d<c.length;d++)a=a.replace(new RegExp(" "+c[d]+'="(.*?)"',"gi"),"");if(b&&0<b.length)for(c=b.length,d=0;d<c;d++)a=a.replace("<dext_temp_tag"+d+">",b[d]);return a}function removeCssInSelection(a){a=cleanHTML(a);null!=a&&void 0!=a&&""!=a&&replaceSelectionWithHtml(a)}
function replaceSelectionWithHtml(a){var b=getFirstRange().range;if(0!=b.toString()){var c=!1,d=!1,e=getContainerForRemoveCss(b.startContainer),f=getContainerForRemoveCss(b.endContainer),g,h=!1;e&&0==!!f&&1==b.endContainer.nodeType&&"BODY"==b.endContainer.tagName&&(f=b.endContainer.childNodes[b.endOffset],g=f.cloneNode(!0),h=!0);b.startContainer==b.endContainer&&1==b.startContainer.nodeType&&"BODY"==b.startContainer.tagName?(e=f=b.startContainer,b.selectNodeContents(e)):DEXTTOP.DEXT5.browser.ie&&
9>DEXTTOP.DEXT5.browser.ieVersion&&3==b.startContainer.nodeType&&1==b.endContainer.nodeType&&"BODY"==b.endContainer.tagName&&(e=f=b.startContainer,b.selectNodeContents(e));b.deleteContents();var n=extractBlockContentsFromCaretForRemoveCss(!0);0==!!g&&(g=extractBlockContentsFromCaretForRemoveCss(!1));if(e!=f){var m=!1,p=!1;findParentNode(f,e)&&(m=!0);findParentNode(e,f)&&(p=!0);p?e=f:m&&(f=e)}var t=_iframeDoc.createElement("div");t.innerHTML=a;a=_iframeDoc.createDocumentFragment();for(var q,m=_iframeDoc.createDocumentFragment(),
p=_iframeDoc.createDocumentFragment(),u=t.childNodes.length,v=0;q=t.firstChild;)v+=1,1==v?a.appendChild(q):1<u&&u==v?(DEXTTOP.DEXT5.browser.ie||""!=q.innerHTML||(q.innerHTML="<br>"),p.appendChild(q),h&&(q=f.cloneNode(!0),q.innerHTML=f.innerHTML,p.appendChild(q))):m.appendChild(q);DEXTTOP.G_CURREDITOR.selectionDextmark[0]=_iframeDoc.createElement("dextmark");DEXTTOP.G_CURREDITOR.selectionDextmark[0].innerHTML=unescape("%u200B");DEXTTOP.G_CURREDITOR.selectionDextmark[1]=_iframeDoc.createElement("dextmark");
DEXTTOP.G_CURREDITOR.selectionDextmark[1].innerHTML=unescape("%u200B");if(e==f){e.innerHTML="";if(n&&0<n.childNodes.length)if(IsEmptyNodes(n))c=!0;else for(;0<n.childNodes.length;)e.appendChild(n.childNodes[0]);else c=!0;!c||"P"!=e.tagName&&"DIV"!=e.tagName||(removeAttribute(e,"align"),removeAttribute(e,"style"),removeAttribute(e,"className"),removeAttribute(e,"bgcolor"));try{b.setStartAfter(e.lastChild)}catch(w){b.selectNodeContents(e)}e.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[0]);n=a.childNodes.length;
0<n&&e.appendChild(a);n=m.childNodes.length;0<n&&e.appendChild(m);n=p.childNodes.length;0<n&&e.appendChild(p);e.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[1]);e.lastChild?b.setEndAfter(e.lastChild):b.setEnd(e,e.innerHTML.length);g&&0<g.childNodes.length&&e.appendChild(g)}else{e.innerHTML="";f.innerHTML="";if(n&&0<n.childNodes.length)if(IsEmptyNodes(n))c=!0;else for(;0<n.childNodes.length;)e.appendChild(n.childNodes[0]);else c=!0;if(0==c){e.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[0]);
try{b.setStartAfter(e.lastChild)}catch(y){b.selectNodeContents(e)}}else b.setStartAfter(e);h=b.cloneRange();if(c)b.insertNode(a),b.insertNode(DEXTTOP.G_CURREDITOR.selectionDextmark[0]),b.setEndBefore(f),b.collapse(!1);else if(0<a.childNodes.length)if(q=a.childNodes[0],checkBlockTag(q.tagName))for(;0<q.childNodes.length;)e.appendChild(q.childNodes[0]);else e.appendChild(a);n=m.childNodes.length;0<n&&(b.setEndBefore(f),b.collapse(!1),b.insertNode(m));g&&(0==g.childNodes.length||IsEmptyNodes(g))&&(d=
!0);if(d)b.setEndBefore(f),b.collapse(!1),b.insertNode(DEXTTOP.G_CURREDITOR.selectionDextmark[1]),b.insertNode(p),b.setEndBefore(f);else{if(0<p.childNodes.length&&(q=p.childNodes[0],checkBlockTag(q.tagName)))if(0<q.childNodes.length)for(;0<q.childNodes.length;)f.appendChild(q.childNodes[0]);else f.appendChild(p);f.lastChild?b.setEndAfter(f.lastChild):b.setEnd(f,f.innerHTML.length)}0==d&&f.appendChild(DEXTTOP.G_CURREDITOR.selectionDextmark[1]);g&&0<g.childNodes.length&&!IsEmptyNodes(g)&&f.appendChild(g);
c?(b.setStartBefore(e),e.parentNode.removeChild(e)):b.setStart(h.startContainer,h.startOffset);d&&(b.setEndAfter(f.previousSibling),f.parentNode.removeChild(f))}setSelectionWithDextmark(b)}}function IsEmptyNodes(a){a=a.childNodes;for(var b=a.length,c=!0,d=null,e=0;e<b;e++){if(d=a[e])3===d.nodeType&&d.nodeValue&&0<d.nodeValue.length?c=!1:1===d.nodeType&&"IMG"!=d.tagName&&(d.hasChildNodes()&&0!=d.innerText.length?c=IsEmptyNodes(d):(d.parentNode.removeChild(a[e]),--e,--b));if(0==c)break}return c}
function setSelectionWithDextmark(a,b){2==DEXTTOP.G_CURREDITOR.selectionDextmark.length?(0==!!a&&(getFirstRange().sel.removeAllRanges(),a=getFirstRange().range),1==b?(a.setStart(DEXTTOP.G_CURREDITOR.selectionDextmark[0],1),a.setEnd(DEXTTOP.G_CURREDITOR.selectionDextmark[1],0)):(a.setStartAfter(DEXTTOP.G_CURREDITOR.selectionDextmark[0]),a.setEndBefore(DEXTTOP.G_CURREDITOR.selectionDextmark[1])),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(a)):0<DEXTTOP.G_CURREDITOR.selectionDextmark.length&&
2!=DEXTTOP.G_CURREDITOR.selectionDextmark.length&&(removeDextmark(),rangy.getSelection(_iframeWin).removeAllRanges())}
function removeDextmark(a){for(var b=_iframeDoc.getElementsByTagName("dextmark"),c=b.length,d=c-1;0<=d;d--){if(d==c-1&&a)if(b[d].previousSibling)try{for(var e=b[d].previousSibling;;){if(null==e){e=e.parentNode;break}if(3==e.nodeType)break;if(e.lastChild)e=e.lastChild;else break}var f=getFirstRange(),g=f.range,h=f.sel;3==e.nodeType?g.setEnd(e,e.length):g.setEndAfter(e);g.collapse(!1);h.removeAllRanges();h.addRange(g)}catch(n){doSetCaretPosition(b[d].previousSibling,1)}else b[d].parentNode&&doSetCaretPosition(b[d].parentNode,
0);b[d].parentNode.removeChild(b[d])}DEXTTOP.G_CURREDITOR.selectionDextmark=[]}function parentTouchEndEvent(a){try{DEXTTOP.G_CURREDITOR._DOC.hasFocus()&&(DEXTTOP.G_CURREDITOR._BODY.blur(),setTimeout(function(){DEXTTOP.window.focus()},1))}catch(b){}}var G_IsTouchMoved=!1;function touchEndEvent(a){try{G_IsTouchMoved&&setTimeout(setFocusToBody,0),G_IsTouchMoved=!1}catch(b){}}function touchMoveEvent(a){try{G_IsTouchMoved=!0}catch(b){}}
function adjustInputChecked(a){var b=a,c="";try{var d=a.match(RegExp("<input *([^>?+])*>","gi"));if(d&&0<d.length){for(var e=d.length,f=0;f<e;f++){a=a.replace(d[f],"<dext_temp_input>");var g=d[f].toString();if(-1<g.toLowerCase().indexOf("radio")&&-1<g.toLowerCase().indexOf("checked=")){var h=">";-1<d[f].indexOf("/>")&&(h="/>");d[f]=g.replace(h,' dext5checked=""'+h)}}for(f=0;f<e;f++)a=a.replace("<dext_temp_input>",d[f].toString())}c=a}catch(n){c=b}return c}
function Dext5_PopupCenter(a,b,c,d,e,f,g,h){a=window.open(a,b,g+", width="+c+", height="+d+", top="+(void 0!=e?e:screen.height/2-d/2-40)+", left="+(void 0!=f?f:screen.width/2-c/2));window.focus&&a&&a.focus();return a}
function closePluginInstall(){var a=getDialogDocument();a.getElementById("d5editor_install_div")&&a.getElementById("d5editor_install_div").parentNode.removeChild(a.getElementById("d5editor_install_div"));a.getElementById("d5editor_install_div_back")&&a.getElementById("d5editor_install_div_back").parentNode.removeChild(a.getElementById("d5editor_install_div_back"));a=getDialogWindow();DEXTTOP.DEXT5.util.removeEvent(a,"resize",DEXTTOP.DEXT5.installGuideResizeEvt)}
function adjustScroll(a){try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion){var b=Math.max(a._DOC.documentElement.scrollLeft,a._DOC.body.scrollLeft),c=Math.max(a._DOC.documentElement.scrollTop,a._DOC.body.scrollTop),d=getClientRect(a._EDITOR.design),e=d.bottom-d.top,f=0,g=0;b>d.right-d.left&&(f=b);c>e&&(g=c);(a._DOC.defaultView?a._DOC.defaultView:a._DOC.parentWindow).scroll(f,g)}}catch(h){}}
function setImageBorder(a,b){try{if(""!=b.borderStyle){var c="";if("none"==b.borderStyle){var d=newNode.style.border;""!=d?0==d.indexOf("0px")||0==d.indexOf("none")?b.borderStyle="":c="0px solid rgb(0,0,0)":b.borderStyle=""}else d="",""!=b.borderKind?d=b.borderKind+" ":(""==b.borderWidth&&(b.borderWidth="0"),d=b.borderWidth+"px "),c=d+b.borderStyle+" "+b.borderColor;""!=c&&(a.style.border=c)}}catch(e){}return a}
function getBorderAndCustomInfo(a){var b={originalSizeCheck:!1,borderJson:{borderStyle:"",borderWidth:"",borderColor:"",borderKind:""},imageText:a};try{var c="",d=a.lastIndexOf(">");-1<d&&(c=a.substring(d+1));""!=c&&(b.imageText=a.substring(0,d+1));0==c.indexOf("|")&&(b.originalSizeCheck=!0,c=c.substring(1));if(-1<c.indexOf("\f")){var e,f,g=c.split("\f");b.borderJson.borderWidth=g[0];f=g[1];"dot"==f?f="dotted":"dash"==f&&(f="dashed");b.borderJson.borderStyle=f;e=g[2];"default"==e?e="":"normal"==e&&
(e="medium");b.borderJson.borderKind=e;b.borderJson.borderColor=g[3]}}catch(h){}return b}
function setAutoBodyFit(a){try{if("1"==a._config.autoBodyFit){var b=parseIntOr0(a._setting.ruler_position),c=parseIntOr0(a._BODY.style.width);0<b&&b!=c&&(b=null,a._BODY.currentStyle?b=a._BODY.currentStyle:a._FRAMEWIN._iframeWin.getComputedStyle&&(b=a._FRAMEWIN._iframeWin.getComputedStyle(a._BODY,"")),b&&(c="",c=b.getProperty?b.getProperty("wordWrap"):b.wordWrap,"break-word"!=c&&(a._BODY.style.wordWrap="break-word")))}}catch(d){}}
function removeDivInLiTag(){var a=getFirstRange().range,a=getNodesInRange(a),b=a.length,c=!1;try{for(var d=0;d<b;d++)a[d].tagName&&"DIV"==a[d].tagName&&a[d].parentNode&&a[d].parentNode.tagName&&"LI"==a[d].parentNode.tagName&&(c=!0)}catch(e){}if(c){makeRangeSelectionMarkInDesign();try{for(d=0;d<b;d++){var f=a[d].nodeName.toLowerCase();if("ol"==f||"ul"==f){for(var g=a[d].getElementsByTagName("li"),h=g.length,f=0;f<h;f++)g[f].firstChild&&g[f].firstChild.tagName&&"DIV"==g[f].firstChild.tagName&&(g[f].style.cssText=
g[f].firstChild.style.cssText,g[f].innerHTML=g[f].firstChild.innerHTML,5>g[f].innerHTML.length&&0==g[f].innerHTML.indexOf("<br")&&(g[f].innerHTML=""));break}}}catch(n){}setRangeSelectionMarkInDesign(!0)}}function isSelected(a){var b=!1;try{var c=null,c=a?a:getFirstRange().range;if(c.startContainer!=c.endContainer||c.startOffset!=c.endOffset)b=!0}catch(d){b=!1}return b}
function correctionRange(a){DEXTTOP.DEXT5.browser.chrome&&a.startContainer==a.endContainer&&a.startOffset==a.endOffset&&a.startContainer.tagName&&"br"==a.startContainer.tagName.toLowerCase()&&(a.setStartBefore(a.startContainer),a.setEndAfter(a.startContainer),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(a))}
function removeTagStyle(a){if("1"==DEXTTOP.G_CURREDITOR._config.removeStyle.use)if(""==DEXTTOP.G_CURREDITOR._config.removeStyle.tag)for(var b=DEXTTOP.G_CURREDITOR._config.removeStyle.style.split(","),c=b.length,d=0;c>d;d++)""!=b[d]&&(a=a.replace(new RegExp(b[d]+':(([^;"]*;)|([^"]*))',"gi"),""));else for(var e=DEXTTOP.G_CURREDITOR._config.removeStyle.tag.split(","),f=e.length,b=DEXTTOP.G_CURREDITOR._config.removeStyle.style.split(","),c=b.length,d=0;f>d;d++)if(""!=e[d])for(var g=0;c>g;g++)""!=b[g]&&
(a=a.replace(new RegExp("(<"+e[d]+"[^>]*)("+b[g]+':(([^;"]*;)|([^"]*)))',"gi"),"$1"));return a}function displayPageBreak(a){var b=null,c="";a?(b=getElementsByClass("DEXT_fiVe_Page_Break_None",_iframeDoc),c="DEXT_fiVe_Page_Break"):(b=getElementsByClass("DEXT_fiVe_Page_Break",_iframeDoc),c="DEXT_fiVe_Page_Break_None");a=b.length;for(var d=0;a>d;d++)b[d].className=c}
function getPersonalData(a){var b={email:null,phone:null,RRN:null};try{var c=getInnerText(_iframeDoc.body),d=RegExp("[_A-Za-z0-9-\\\\+]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})","ig"),e=RegExp("((\\+\\d{1,3}(-| |\\.)?\\(?\\d\\)?(-| |\\.)?\\d{1,5})|(\\d{2,6}\\)?))(-| |\\.)?(\\d{3,4})(-| |\\.)?(\\d{4})","g"),f=RegExp("(\\d{2}(:?1[0-2]|0[1-9])(:?0[1-9]|[1-2]\\d|3[0-1])-?[1-4]\\d{6})","gm");-1<a._config.personalData.toLowerCase().indexOf("email")&&(b.email=c.match(d));-1<
a._config.personalData.toLowerCase().indexOf("phone")&&(b.phone=c.match(e));-1<a._config.personalData.toLowerCase().indexOf("rrn")&&(b.RRN=c.match(f));if(b.phone){for(var g=b.phone.length-1;0<=g;g--)/(:?^\d{6}-\d{7})/.test(b.phone[g])&&b.phone.splice(g,1);0==b.phone.length&&(b.phone=null)}}catch(h){}return b}
function getForbiddenWord(a){dext_src_init(a._EDITOR.design);var b=null;try{var c=getInnerText(_iframeDoc.body),d=a._config.forbiddenWord.split(","),e=d.length;for(a=0;a<e;a++){var f=null;(f=c.match(new RegExp(""+d[a]+"","ig")))&&(b=b?b.concat(f):f)}}catch(g){}return b}
function getInnerText(a,b){var c="";try{c=a.innerHTML,c=c.replace(/\r/g,""),c=c.replace(/[\n|\t]/g,""),c=c.replace(/[\v|\f]/g,""),c=c.replace(/<span[^>]*>/gi,""),c=c.replace(/<\/span(\s[^\/]*)?>/gi,""),c=c.replace(/<p[^>]*><br><\/p(\s[^\/]*)?>/gi,"\n"),b||(c=c.replace(/<p[^>]*>&nbsp;<\/p(\s[^\/]*)?>/gi,"\n")),c=c.replace(/<br(\s)*\/?><\/p(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<br(\s[^\/]*)?><\/p(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<br(\s)*\/?><\/li(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<br(\s[^\/]*)?><\/li(\s[^\/]*)?>/gi,
"\n"),c=c.replace(/<br(\s)*\/?>/gi,"\n"),c=c.replace(/<br(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<\/p(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<\/li(\s[^\/]*)?>/gi,"\n"),c=c.replace(/<\/tr(\s[^\/]*)?>/gi,"\n"),c=ReplaceAll(c,unescape("%u200B"),""),c=removeStripTags(c,null),c=unhtmlSpecialChars(c)}catch(d){}return c}
function removeFindText(a,b){try{dext_src_init(b)}catch(c){}restoreSelection();setFocusToBody();if(0!=a.length)try{var d=rangy.createRange(_iframeDoc);d.selectNodeContents(_iframeDoc.body);for(var e={caseSensitive:!1,wholeWordsOnly:!1,direction:"forward"};d.findText(a,e);){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();d.select();d.deleteContents();var f=d.getDocument().createTextNode(" ");d.insertNode(f);d.selectNode(f);d.select();d.collapse(!1);var g=getFirstRange().range.commonAncestorContainer;
!g||1!=g.nodeType||""!=g.innerText&&" "!=g.innerText||(g.innerHTML="&nbsp;");d=rangy.createRange(_iframeDoc);d.selectNodeContents(_iframeDoc.body);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}catch(h){}}function canConversion(){var a=!0,b;try{b=getFirstRange().range,"BODY"==b.commonAncestorContainer.tagName&&1<b.commonAncestorContainer.childNodes.length&&(a=!1),a&&-1<b.text().indexOf("\n")&&(a=!1)}catch(c){}return a}
function getCheckSpelling(a){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();if(null!=a.DEXT5WordApp){var b=_iframeDoc.body.innerText,b=b.replace(/[\r\n]+/gi,"\n"),b=b.split("\n"),c=b.length,d=[];try{for(var e=0;e<c;++e){var f=[],g=b[e];if(!/^\s*$/.test(g)&&!a.DEXT5WordApp.Application.CheckSpelling(g)){a.DEXT5WordDoc.Content=g;for(var h=1;h<=a.DEXT5WordDoc.SpellingErrors.Count;h++)for(var n=a.DEXT5WordDoc.SpellingErrors.Item(h),m=n.Words.Count,p=1;p<=m;p++){var t=n.Words.Item(p),
q={};q.word=DEXTTOP.DEXT5.util.trim(t.Text);q.start=t.Start;q.length=DEXTTOP.DEXT5.util.trim(t.Text).length;q.suggestions=[];for(var u=t.GetSpellingSuggestions(),v=u.Count,w=1;w<=v;w++)q.suggestions.push(u.Item(w).Name);0<v&&1<DEXTTOP.DEXT5.util.trim(q.word).length&&f.push(q)}0<f.length&&(d=d.concat(f))}}}catch(y){}finally{a.DEXT5WordApp&&a.DEXT5WordApp.Quit(0),a.DEXT5WordApp=null,a.DEXT5WordDoc=null}return d}}
function getAllTextNodeByNode(a){var b=[];if(a)for(a=a.firstChild;null!=a;)3==a.nodeType?b[b.length]=a:b=b.concat(getAllTextNodeByNode(a)),a=a.nextSibling;return b}
function putUndoWordCount(a){if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.use&&"1"==DEXTTOP.G_CURREDITOR._config.wordCount.limit&&"undefined"!=typeof a){var b="which"in a?a.which:a.keyCode;if(b&&(-1==",18,19,20,27,33,34,35,36,37,38,39,40,91,92,93,144,145,".indexOf(","+b+",")||a.shiftKey&&16!=b))try{if(0<DEXTTOP.G_CURREDITOR._config.wordCount.limitcount||0<DEXTTOP.G_CURREDITOR._config.wordCount.limitline){var c=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount,d=DEXTTOP.G_CURREDITOR._config.wordCount.limitline,
e=getInnerText(_iframeDoc.body,!0);a=0;e.match(/\n/gi)&&(a=e.match(/\n/gi).length);e=e.replace(/\r\n/gi,"");e=e.replace(/\n/gi,"");0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(e=e.replace(/\s/gim,""));var b=!1,f;f="char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?e.length:DEXTTOP.DEXT5.getByteLength(e);"byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit&&0<c&&f+3>c?b=!0:0<c&&f==c?b=!0:0<d&&a==d&&(b=!0);b&&0<c&&f>c&&(b=!1);b&&(DEXTTOP.G_CURREDITOR.WordCountUndoManager.reset(),
DEXTTOP.G_CURREDITOR.WordCountUndoManager.putUndo())}}catch(g){}}}
function showWordCount(a){try{if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.use&&(0<=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount||0<DEXTTOP.G_CURREDITOR._config.wordCount.limitline)){if("undefined"!=typeof a){var b="which"in a?a.which:a.keyCode;if(0<=",18,19,20,27,33,34,35,36,37,38,39,40,91,92,93,144,145,".indexOf(","+b+",")||a.shiftKey&&16==b)return}var c=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount,d=DEXTTOP.G_CURREDITOR._config.wordCount.limitline,e=getInnerText(_iframeDoc.body,!0);
a=0;e.match(/\n/gi)&&(a=e.match(/\n/gi).length);e=e.replace(/\r\n/gi,"");e=e.replace(/\n/gi,"");0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(e=e.replace(/\s/gim,""));b=!0;""!=DEXTTOP.G_CURREDITOR._config.defaultMessage&&(b=!1);var f="",g=dext5_lang.wordCount.Maximum_Line_Exceed.replace("{0}",d),f="byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?dext5_lang.wordCount.Maximum_Bytes_Exceed.replace("{0}",c):dext5_lang.wordCount.Maximum_Characters_Exceed.replace("{0}",c);if(b){var h;
h="char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?e.length:DEXTTOP.DEXT5.getByteLength(e);if(0<c&&h>c||0<d&&a>d){if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.limitmessage){var n="";0<c&&h>c&&(n=f+"\n");0<d&&a>d&&(n+=g);alert(n)}0==DEXTTOP.G_CURREDITOR.WordCountUndoManager.charCount&&DEXTTOP.G_CURREDITOR.WordCountUndoManager.putUndo();DEXTTOP.G_CURREDITOR.WordCountUndoManager.execUndo()}}b&&(e=getInnerText(_iframeDoc.body,!0),a=0,e.match(/\n/gi)&&(a=e.match(/\n/gi).length),e=e.replace(/\r\n/gi,
""),e=e.replace(/\n/gi,""),0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(e=e.replace(/\s/gim,"")));g="";0<d&&(g="/"+d);var m="["+dext5_lang.wordCount.Line+a+g+"]",p=document.getElementById("count_line_span_"+DEXTTOP.G_CURREDITOR.ID);p.innerHTML=m;p.style.color=0!=d&&a>=d?"red":"black";d="";0<c&&(d="/"+c);h="char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?e.length:DEXTTOP.DEXT5.getByteLength(e);var e="",e="byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?"["+dext5_lang.wordCount.Bytes+
h+d+"]":"["+dext5_lang.wordCount.Characters+h+d+"]",t=document.getElementById("count_characters_span_"+DEXTTOP.G_CURREDITOR.ID);t.innerHTML=e;t.style.color=0!=c&&h>=c?"red":"black"}}catch(q){}}
function pasteWordCount(a){var b=!0;if("1"==DEXTTOP.G_CURREDITOR._config.wordCount.use&&"1"==DEXTTOP.G_CURREDITOR._config.wordCount.limit)try{if(0<DEXTTOP.G_CURREDITOR._config.wordCount.limitcount||0<DEXTTOP.G_CURREDITOR._config.wordCount.limitline){var c=DEXTTOP.G_CURREDITOR._config.wordCount.limitcount,d=DEXTTOP.G_CURREDITOR._config.wordCount.limitline,e=getInnerText(_iframeDoc.body,!0),f=document.createElement("div");f.innerHTML=a;a=getInnerText(f,!0);e.match(/\n/gi);a.match(/\n/gi)&&a.match(/\n/gi);
e=e.replace(/\r\n/gi,"");e=e.replace(/\n/gi,"");a=a.replace(/\r\n/gi,"");a=a.replace(/\n/gi,"");0==DEXTTOP.G_CURREDITOR._config.wordCount.countwhitespace&&(e=e.replace(/\s/gim,""),a=a.replace(/\s/gim,""));var g,h,n;"char"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?(g=e.length,h=a.length,n=getFirstRange().range.toString().length):(g=DEXTTOP.DEXT5.getByteLength(e),h=DEXTTOP.DEXT5.getByteLength(a),n=DEXTTOP.DEXT5.getByteLength(getFirstRange().range.toString()));a="";dext5_lang.wordCount.Maximum_Line_Exceed.replace("{0}",
d);a="byte"==DEXTTOP.G_CURREDITOR._config.wordCount.limitunit?dext5_lang.wordCount.Maximum_Bytes_Exceed.replace("{0}",c):dext5_lang.wordCount.Maximum_Characters_Exceed.replace("{0}",c);0<c&&c<g-n+h&&("1"==DEXTTOP.G_CURREDITOR._config.wordCount.limitmessage&&alert(a),b=!1)}}catch(m){}return b}
function pushAutoSave(a,b){for(var c=b;4>c;c++){var d=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(a+"_"+(c+1));""!=d&&null!=d&&void 0!=d&&(DEXTTOP.DEXT5.util.saveJsonToLocalStorage(a+"_"+c,d),localStorage.removeItem(a+"_"+(c+1)))}}function delAutoSaveHtml(a,b){localStorage.removeItem(a+"_"+b);pushAutoSave(a,b);return null==localStorage[a+"_"+b]||void 0==localStorage[a+"_"+b]?!1:!0}
function localSaveValue(a,b){for(var c=0;5>c;c++){var d=a+"_"+c,e=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage(d),f={};null!=e&&void 0!=e&&(f="",f=e.html.toLowerCase().indexOf("<html"),f="1"==b?-1<f?DEXTTOP.DEXT5.util.makeEncryptParam(e.html):e.html:0>f?DEXTTOP.DEXT5.util.makeDecryptReponseMessage(e.html):e.html,f={date:e.date,html:f},localStorage.removeItem(d),DEXTTOP.DEXT5.util.saveJsonToLocalStorage(d,f))}}
function autoSaveEnable(a){if(a=document.getElementById("dext_span_"+a+"load_auto_save")){var b=DEXTTOP.DEXT5.util.getClass(a);b&&-1<b.indexOf("_off")&&DEXTTOP.DEXT5.util.setClass(a,"uebutton_span_on")}}
function setImageSizeForProperty(){for(var a=_iframeDoc.body.getElementsByTagName("img"),b=a.length,c=0;c<b;c++){var d=a[c];try{var e=d.style.width,f=d.style.height;if(-1<e.indexOf("px"))e=DEXTTOP.DEXT5.util.parseIntOr0(e);else var g=getClientRect(d),e=DEXTTOP.DEXT5.util.parseIntOr0(g.right-g.left);-1<f.indexOf("px")?f=DEXTTOP.DEXT5.util.parseIntOr0(f):(g=getClientRect(d),f=DEXTTOP.DEXT5.util.parseIntOr0(g.bottom-g.top));d.setAttribute("width",e);d.setAttribute("height",f)}catch(h){d.removeAttribute("width"),
d.removeAttribute("height")}}}
function removeBackgroundColorInNodes(a,b,c){for(var d=_iframeDoc.createElement("div"),e=a.childNodes.length,f=0;f<e;f++){var g=a.childNodes[f];1==g.nodeType?("P"==g.tagName&&""==g.innerHTML&&("xp"==DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?g.innerHTML=unescape("%uFEFF"):g.innerHTML=DEXTTOP.DEXT5.browser.ie?unescape("%u200B"):"<br>"),d.innerHTML+=g.outerHTML):3==g.nodeType&&(d.innerHTML+=g.data)}d.innerHTML=CleanZeroChar(d.innerHTML);a=[];e=d.getElementsByTagName("*");g=e.length;for(f=0;f<
g;f++){var h=e[f].tagName.toLowerCase();0>c.indexOf(","+h+",")&&""!=e[f].style.backgroundColor&&(e[f].style.removeAttribute?e[f].style.removeAttribute(b):"backgroundColor"==b&&e[f].style.removeProperty("background-color"),void 0!=e[f].style.length?0==e[f].style.length&&1==e[f].attributes.length&&a.push(e[f]):(h=e[f].outerHTML.toLowerCase(),"span"==e[f].tagName.toLowerCase()&&0==h.indexOf("<"+e[f].tagName.toLowerCase()+">")&&a.push(e[f])))}for(f=a.length-1;0<=f;f--){for(;a[f].firstChild;)a[f].parentNode.insertBefore(a[f].firstChild,
a[f]);a[f].parentNode.removeChild(a[f])}return d}
function getApplyNodes(a){try{var b=getFirstRange().range,c,d;c=0==b.toString().length?[b.startContainer]:b.getNodes();if(1==c.length){var e=c[0];if(!(e.tagName&&-1<a.indexOf(e.tagName.toLowerCase())))for(;e=e.parentNode,!e.tagName||"body"!=e.tagName.toLowerCase();)if(e.tagName&&-1<a.indexOf(e.tagName.toLowerCase())){c=[e];break}}else{for(var f=c[0],g=c[c.length-1],e=f,h=g;!e.tagName||"body"!=e.tagName.toLowerCase();){if(e.tagName&&-1<a.indexOf(e.tagName.toLowerCase())){f=e;break}e=e.parentNode}for(;!h.tagName||
"body"!=h.tagName.toLowerCase();){if(h.tagName&&-1<a.indexOf(h.tagName.toLowerCase())){g=h;break}h=h.parentNode}f==g&&(c=[f])}null!=b.startContainer.previousSibling&&"HEAD"==b.startContainer.previousSibling.tagName&&null==b.endContainer.nextSibling&&(c=b.getNodes());if(0<b.toString().length&&1<c.length&&1==c[0].nodeType&&"P"==c[0].tagName){var n=c[0].innerText||c[0].textContent;3==b.startContainer.nodeType&&null==b.startContainer.nextSibling&&(n=b.startContainer.nodeValue);f=!1;n.length==b.startOffset&&
(f=!0);!f&&DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&2<=c.length&&0<b.startOffset&&3!=c[1].nodeType&&1==b.startContainer.nodeType&&(f=!0);f&&(b.setStartAfter(c[0]),c=b.getNodes())}d=c.length;b=[];for(n=0;n<d;n++)null!=c[n].parentNode&&1==c[n].nodeType&&c[n].tagName&&"body"!=c[n].tagName.toLowerCase()&&c[n].tagName&&-1<a.indexOf(c[n].tagName.toLowerCase())&&b.push(c[n]);return b}catch(m){}}
function mouseMoveCaret(a,b){if(DEXTTOP.DEXT5.browser.ie)try{if(_iframeDoc.caretPositionFromPoint){var c=_iframeDoc.caretPositionFromPoint(a,b),d=_iframeDoc.createRange();d.setStart(c.offsetNode,c.offset);d.collapse()}else if(_iframeDoc.caretRangeFromPoint)d=_iframeDoc.caretRangeFromPoint(a,b);else if(_iframeDoc.body.createTextRange){var d=_iframeDoc.body.createTextRange();d.moveToPoint(a,b);d.select()}var e=_iframeDoc.getElementById("raonCaretTemp");e&&e.parentNode.removeChild(e);d.pasteHTML('<span id="raonCaretTemp" style="border:1px solid red;"></span>')}catch(f){console.log("catch : "+
f.toString())}else if(c=getFirstRange().range,0==c.toString().length)try{createSelectionFromPoint(a,b,a,b);setFocusToBody();(e=_iframeDoc.getElementById("raonCaretTemp"))&&e.parentNode.removeChild(e);var c=getFirstRange().range,g=_iframeDoc.createElement("span");g.id="raonCaretTemp";g.style.border="1px solid red";c.insertNode(g);null!=g.nextSibling&&doSetCaretPosition(g.nextSibling,!1)}catch(h){}}
function setUserSetting(a,b){if(DEXTTOP.DEXT5.browser.LocalStorageSupported){var c="",d="";if("personalSetting"==b)c="dext_personal_setting",d={fontFamily:a._setting.personal_font_family.toString(),fontSize:a._setting.personal_font_size.toString(),lineHeight:a._setting.personal_line_height.toString()};else if("ruler"==b){c="dext_"+a.ID+"_ruler";d="";if("2"==a._config.ruler.mode){var e=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_"+a.ID+"_ruler");e&&e.position&&(d=e.position)}else d=a._setting.ruler_position.toString();
d={use:a._setting.ruler.toString(),position:d}}DEXTTOP.DEXT5.util.saveJsonToLocalStorage(c,d)}}function createNodeForCaret(a){for(var b=[],c=0;c<a;c++){var d=_iframeDoc.createElement("dextmark");d.setAttribute("class","dext_temp_caret");d.innerHTML=unescape("%u200B");b.push(d)}return b}function removeNodeForCaret(){for(var a=getElementsByClass("dext_temp_caret",_iframeDoc,"dextmark"),b=a.length-1;0<=b;b--)a[b].parentNode.removeChild(a[b])}
function canMoveLiNode(a,b){var c=!1;if(1==b){var d=a.previousSibling;d&&(d=d.tagName,"LI"==d||"OL"==d||"UL"==d)&&(c=!0)}return c}
function moveLiNode(a,b){var c=a.previousSibling;if(1==b){if(c){var d=c.tagName,e;if("LI"==d)e=c.getElementsByTagName(c.parentNode.tagName),d=c.innerHTML,d=d.replace(/(<([^>]+)>)/ig,""),"<br>"!=d&&""!=d||c.removeChild(c.firstChild),0<e.length?e=e[0]:(e=_iframeDoc.createElement(c.parentNode.tagName),e.style.listStyleType=getNextOlUlListStyle(c.parentNode),c.appendChild(e)),e.appendChild(a);else if("OL"==d||"UL"==d)e=c,e.appendChild(a);c=e.parentNode.innerHTML;c=c.replace(/<[oul].*/gim,"");c=c.replace(/[\r\n]/gim,
"");0>c.indexOf(unescape("%u200B"))&&(c=_iframeDoc.createTextNode(unescape("%u200B")),e.parentNode.insertBefore(c,e));setChildOlUlListStyle(a)}}else{e=a.parentNode;for(var c=e.parentNode,d=getFirstRange().range,f=a;null!=f.nextSibling;)f=f.nextSibling;d.setStartBefore(a);d.setEndAfter(f);for(var g=d.extractContents(),d=g.childNodes.length,f=[],h=d-1;0<=h;h--)f.push(g.childNodes[h]);for(var n=f[f.length-1].childNodes,m=n.length,g=null,p=[],h=0;h<m;h++)if("OL"==n[h].tagName||"UL"==n[h].tagName){g=n[h];
break}else p.push(n[h]);m=p.length;"LI"==c.tagName?(n=c.cloneNode(),n.innerHTML=""):n=_iframeDoc.createElement("p");for(h=0;h<m;h++)n.appendChild(p[h]);"LI"==c.tagName?(h=c.parentNode,c.nextSibling?h.insertBefore(n,c.nextSibling):h.appendChild(n)):e.nextSibling?c.insertBefore(n,e.nextSibling):c.appendChild(n);p=e.cloneNode();p.innerHTML="";if(g){m=g.childNodes;for(h=m.length-1;0<=h;h--)p.firstChild?p.insertBefore(m[h],p.firstChild):p.appendChild(m[h]);g.parentNode.removeChild(g)}for(h=d-2;0<=h;h--)p.appendChild(f[h]);
for(d=!1;e.firstChild;)if(e.firstChild&&"DEXTMARK"==e.firstChild.tagName)e.removeChild(e.firstChild);else{d=!0;break}0==d&&c.removeChild(e);0!=p.hasChildNodes()&&("LI"==n.tagName?(n.appendChild(p),setChildOlUlListStyle(n)):(n.nextSibling?c.insertBefore(p,n.nextSibling):c.appendChild(p),setChildOlUlListStyle(p)))}}
function getNextOlUlListStyle(a){var b="",b=a.tagName.toLowerCase();a=a.style.listStyleType;if("ol"==b)switch(a.toLowerCase()){case "decimal":b="upper-alpha";break;case "decimal-leading-zero":b="upper-alpha";break;case "upper-alpha":b="lower-alpha";break;case "lower-alpha":b="upper-roman";break;case "upper-roman":b="lower-roman";break;case "lower-roman":b="lower-greek";break;case "lower-greek":b="decimal";break;default:b="upper-alpha"}else switch(a.toLowerCase()){case "disc":b="circle";break;case "circle":b=
"square";break;case "square":b="disc";break;default:b="circle"}return b}function setChildOlUlListStyle(a){var b=[],c=a.tagName;if("LI"==c)b=a.getElementsByTagName(a.parentNode.tagName);else if("OL"==c||"UL"==c)for(var d=a.getElementsByTagName(c),e=d.length,c=0;c<e;c++)0==c&&b.push(a),b.push(d[c]);a=b.length;for(c=0;c<a;c++)if(d=b[c],e=GetParentbyTagName(d.parentNode,d.tagName.toLowerCase()))d.style.listStyleType=getNextOlUlListStyle(e)}var G_LastNodeForLi=null,G_IsMulitSelectionInLi=!1;
function checkLastCaretForLi(a,b){if(3==a.nodeType&&a.nodeValue.length==b.endOffset)isLastOfNode=!0;else if(1==a.nodeType){var c=a.childNodes[b.endOffset];3==c.nodeType&&(b=getFirstRange().range,c.nodeValue.length!=b.endOffset||null!=c.nextSibling&&"OL"!=c.nextSibling.tagName&&"UL"!=c.nextSibling.tagName||(isLastOfNode=!0))}}
function adjustLiNodeForArrowKey(a,b,c,d){b=getFirstRange().range;if("keydown"==a)if(0==b.toString().length){G_IsMulitSelectionInLi=!1;var e=b.startContainer,f=e;3==f.nodeType&&(f=f.parentNode);a=GetParentbyTagName(f,"li");if("OL"==f.tagName||"UL"==f.tagName)a=f.getElementsByTagName("li")[0];G_LastNodeForLi=a?a:null;if(a)if(13==c)if("LI"==a.parentNode.parentNode.tagName){if(e=a.innerHTML,e=e.replace(/(<([^>]+)>)/ig,""),""==e||e==unescape("%u200B")||"<br>"==e)DEXTTOP.DEXT5.util.cancelEvent(d),d=a.cloneNode(),
d.id="",d.innerHTML=unescape("%u200B"),a.nextSibling?a.parentNode.insertBefore(d,a.nextSibling):a.parentNode.appendChild(d),b.setStartBefore(d.firstChild),b.setEndBefore(d.firstChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)}else 0!=DEXTTOP.DEXT5.browser.ie||null!=a.previousSibling||null!=a.nextSibling||""!=a.innerHTML&&a.innerHTML!=unescape("%u200B")&&"<br>"!=a.innerHTML||(DEXTTOP.DEXT5.util.cancelEvent(d),moveLiNode(a,0));else if(8==c){if(0==b.startOffset){a=
!1;for(e=3==e.nodeType?e.parentNode:e;;){if("LI"==e.tagName){a=!0;break}if("BODY"==e.tagName)break;if(e.parentNode.firstChild!=e)break;e=e.parentNode}if(a){("<br>"==e.innerHTML||"<br />"==e.innerHTML)&&e.firstChild&&e.removeChild(e.firstChild);a=e;var e=null,g=a.previousSibling;if(g){var e=g.getElementsByTagName("OL"),h=e.length,g=g.getElementsByTagName("UL");c=g.length;0<h||0<c?(f=null,0<h&&0==c?f=e[h-1]:0<c&&0==h&&(f=g[c-1]),e=f.lastChild):e=a.previousSibling}else"LI"==a.parentNode.parentNode.tagName&&
a.parentNode.previousSibling&&(e=a.parentNode.parentNode);if(e){DEXTTOP.DEXT5.util.cancelEvent(d);for(d=null;a.hasChildNodes();)null==d&&(d=a.firstChild),a.parentNode.parentNode==e?e.insertBefore(a.firstChild,a.parentNode):e.appendChild(a.firstChild);h=a.parentNode;h.removeChild(a);0==h.getElementsByTagName("li").length&&h.parentNode.removeChild(h);d?(b.setStartBefore(d),b.setEndBefore(d)):(d=e.lastChild)?(b.setStartAfter(d),b.setEndAfter(d)):(d=_iframeDoc.createTextNode("%u200B"),e.appendChild(d),
b.setStartBefore(d),b.setEndBefore(d),e.removeChild(d));rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);setChildOlUlListStyle(e)}}}}else if(46==c&&(c=!1,3==e.nodeType?e.nodeValue.length==b.endOffset?c=!0:e.nodeValue==unescape("%u200B")&&e.nodeValue.length==b.endOffset+1&&(c=!0):1==e.nodeType&&(b=getFirstRange().range,f=b.endContainer,3==f.nodeType?g=f.nodeValue.length:1==f.nodeType&&(g=f.childNodes.length,f.childNodes[b.endOffset]&&(1==f.childNodes[b.endOffset].nodeType&&
"BR"==f.childNodes[b.endOffset].tagName?--g:3==f.childNodes[b.endOffset].nodeType&&f.childNodes[b.endOffset].nodeValue==unescape("%u200B")&&--g)),g==b.endOffset&&(null==f.nextSibling||"OL"==f.nextSibling.tagName||"UL"==f.nextSibling.tagName?(e=f,c=!0):"LI"==f.tagName&&(e=f,c=!0))),c)){for(g=c=!1;;){if(e.parentNode&&"LI"==e.parentNode.tagName){e.parentNode.lastChild==e?c=!0:!e.nextSibling||"OL"!=e.nextSibling.tagName&&"UL"!=e.nextSibling.tagName||(g=c=!0);break}if(null==e.parentNode||"BODY"==e.parentNode.tagName)break;
e=e.parentNode}c&&(h=null,g?h=e.nextSibling:a.nextSibling?h=a.nextSibling:a.parentNode.parentNode.nextSibling?h=a.parentNode.parentNode.nextSibling:DEXTTOP.DEXT5.util.cancelEvent(d));if(h){DEXTTOP.DEXT5.util.cancelEvent(d);e=null;e=g?h.getElementsByTagName("li")[0]:h;for(d=null;e.hasChildNodes();)null==d&&(d=e.firstChild),g?h.parentNode.insertBefore(e.firstChild,h):a.appendChild(e.firstChild);h=e.parentNode;h.removeChild(e);g&&0==h.hasChildNodes()&&h.parentNode.removeChild(h);setChildOlUlListStyle(a);
d&&(b.setStartBefore(d),b.setEndBefore(d),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))}}}else!DEXTTOP.DEXT5.browser.ie||13!=c&&8!=c&&46!=c||(f=e=b.startContainer,3==f.nodeType&&(f=f.parentNode),a=GetParentbyTagName(f,"li"),b=b.endContainer,3==b.nodeType&&(b=b.parentNode),b=GetParentbyTagName(b,"li"),(a||b)&&a!=b&&(isMulitSelectionInLi=!0,DEXTTOP.DEXT5.util.cancelEvent(d),alert(dext5_lang.msg.canNotDeleteLi)));else if("keyup"==a&&0==b.toString().length)if(f=
e=b.startContainer,3==f.nodeType&&(f=f.parentNode),a=GetParentbyTagName(f,"li"),G_LastNodeForLi&&a&&G_LastNodeForLi!=a)if(d=a.innerHTML,d=d.replace(/<[oul].*/gim,""),d=d.replace(/[\r\n]/gim,""),""==d&&(d=_iframeDoc.createTextNode(unescape("%u200B")),a.firstChild?a.insertBefore(d,a.firstChild):a.appendChild(d),d=unescape("%u200B")),-1<d.indexOf(unescape("%u200B")))d==unescape("%u200B")?(b.setStartBefore(a.firstChild),b.setEndBefore(a.firstChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)):
3==e.nodeType?(d=e.nodeValue.indexOf(unescape("%u200B")),0==d&&1==e.nodeValue.length?((d=e.previousSibling)?3==d.nodeType&&(b.setStart(d,d.nodeValue.length),b.setEnd(d,d.nodeValue.length)):(b.setStartBefore(e),b.setEndBefore(e)),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)):-1<d&&b.startOffset-1==d&&(b.setStart(e,b.startOffset-1),b.setEnd(e,b.startOffset-1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))):
1==e.nodeType&&(e=e.childNodes[b.startOffset-1],b.setStart(e,e.nodeValue.length-1),b.setEnd(e,e.nodeValue.length-1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b));else{if(e=null,0>d.indexOf(unescape("%u200B"))){a=a.childNodes;h=a.length;for(d=0;d<h;d++)if(a[d].tagName&&("OL"==a[d].tagName||"UL"==a[d].tagName)){e=a[d];break}e&&(d=_iframeDoc.createTextNode(unescape("%u200B")),e.parentNode.insertBefore(d,e),b.setStartBefore(d),b.setEndBefore(d),rangy.getSelection(_iframeWin).removeAllRanges(),
rangy.getSelection(_iframeWin).addRange(b))}}else if(a)if(39==c){if(3==e.nodeType&&(d=e.nodeValue.indexOf(unescape("%u200B")),-1<d&&b.startOffset>d)){e=null;h=a.childNodes;g=h.length;for(d=0;d<g;d++)if(h[d].tagName&&("OL"==h[d].tagName||"UL"==h[d].tagName)){e=h[d];break}h=null;e?h=e.getElementsByTagName("li")[0]:a.nextSibling&&(h=a.nextSibling);h&&(h.firstChild?(e=h.firstChild,b.setStartBefore(e),b.setEndBefore(e)):(e=_iframeDoc.createTextNode(unescape("%u200B")),h.appendChild(e),b.setStartBefore(e),
b.setEndBefore(e),h.removeChild(e)),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))}}else 37==c&&(3==e.nodeType?(d=e.nodeValue.indexOf(unescape("%u200B")),0==d&&1==e.nodeValue.length?((d=e.previousSibling)?3==d.nodeType&&(b.setStart(d,d.nodeValue.length-1),b.setEnd(d,d.nodeValue.length-1)):a!=G_LastNodeForLi&&(b.setStartBefore(e),b.setEndBefore(e)),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)):-1<d&&b.startOffset-
1==d&&(d=b.startOffset-2,0>d&&(d=0),b.setStart(e,d),b.setEnd(e,d),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))):1==e.nodeType&&0<=b.startOffset-1&&(e=e.childNodes[b.startOffset-1],b.setStart(e,e.nodeValue.length),b.setEnd(e,e.nodeValue.length),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b)));else if(G_LastNodeForLi&&null==a&&13==c&&(d=null,DEXTTOP.DEXT5.browser.gecko)){if(d=GetParentbyTagName(f,"div"))if(a=
GetParentbyTagName(f,"ol"),e=GetParentbyTagName(f,"ul"),""!=d.innerHTML&&"<br>"!=d.innerHTML||null!=a||null!=e)d=null;d&&(a=_iframeDoc.createElement("p"),a.innerHTML="<br>",d.parentNode.insertBefore(a,d),d.parentNode.removeChild(d),b.setStartBefore(a.firstChild),b.setEndBefore(a.firstChild),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b))}}
function adjustOlUlTag(a){var b=[];b.push(a.getElementsByTagName("ol"));b.push(a.getElementsByTagName("ul"));a=b.length;for(var c=0;c<a;c++){var d=b[c];for(j=d.length-1;0<=j;j--){var e=d[j],f=e.parentNode;if(f&&("OL"==f.tagName||"UL"==f.tagName)){for(var g=e.previousSibling;null!=g&&"LI"!=g.tagName;)g=g.previousSibling;if(g){if(""==g.innerHTML||"<br>"==g.innerHTML)g.innerHTML=unescape("%u200B")}else g=_iframeDoc.createElement("li"),g.innerHTML=unescape("%u200B"),f.insertBefore(g,e);g.appendChild(e)}}}}
var G_RULER_OFFSET_X,G_RULER_COORD_X,G_RULER_DRAG=!1,G_CURR_DRAGGIN_RULER,G_RULER_MOVE_AREA={realX1:0,x1:0,realX2:0,x2:0};
function rulerStartDrag(a){dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design);restoreSelection();setFocusToBody();var b=getDialogWindow();getDialogDocument();G_CURR_DRAGGIN_RULER=a.target?a.target:a.srcElement;var c=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width);document.getElementById(G_CURR_DRAGGIN_RULER.id.replace("_point_","_pointline_")).style.display="";if(0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_0")||0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_1")){var d=
document.getElementById("dext_ruler_point_2_"+DEXTTOP.G_CURREDITOR.ID),d=DEXTTOP.DEXT5.util.parseIntOr0(d.style.marginLeft),e=document.getElementById("dext_ruler_area_0"),f=DEXTTOP.DEXT5.util.parseIntOr0(e.style.left),e=DEXTTOP.DEXT5.util.parseIntOr0(e.style.width);G_RULER_MOVE_AREA.x1=f+e-c/2;G_RULER_MOVE_AREA.x2=d-30}else 0==G_CURR_DRAGGIN_RULER.id.indexOf("dext_ruler_point_2")&&(f=document.getElementById("dext_ruler_point_0_"+DEXTTOP.G_CURREDITOR.ID),d=document.getElementById("dext_ruler_point_1_"+
DEXTTOP.G_CURREDITOR.ID),f=DEXTTOP.DEXT5.util.parseIntOr0(f.style.marginLeft),d=DEXTTOP.DEXT5.util.parseIntOr0(d.style.marginLeft),G_RULER_MOVE_AREA.x1=(f>d?f:d)+30,e=document.getElementById("dext_ruler_area_1"),f=DEXTTOP.DEXT5.util.parseIntOr0(e.style.left)-c/2,G_RULER_MOVE_AREA.x2=f);a||(a=b.event);G_RULER_OFFSET_X=a.clientX;G_CURR_DRAGGIN_RULER.style.marginLeft||(G_CURR_DRAGGIN_RULER.style.marginLeft="0px");G_RULER_COORD_X=parseInt(G_CURR_DRAGGIN_RULER.style.marginLeft);G_RULER_DRAG=!0;b=document.getElementById("ue_ruler_back_div");
b.style.display="";c=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+DEXTTOP.G_CURREDITOR.ID);b.style.width=c.style.width;b.style.height=c.style.height;DEXTTOP.DEXT5.util.addEvent(document,"mousemove",rulerDrag,!0);DEXTTOP.DEXT5.util.addEvent(document,"mouseup",rulerStopDrag,!0);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTDOC,"mousemove",rulerDrag,!0);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTDOC,"mouseup",rulerStopDrag,!0);DEXTTOP.DEXT5.util.cancelEvent(a)}
function rulerDrag(a){if(G_RULER_DRAG){var b=getDialogWindow();getDialogDocument();a||(a=b.event);getWindowClientSize(b);currentScrollPos=getWindowScrollPos(b);b=G_RULER_COORD_X+a.clientX-G_RULER_OFFSET_X;try{if(!(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion)&&a.currentTarget==DEXTTOP.DEXTDOC)var c=getClientRect(DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+DEXTTOP.G_CURREDITOR.ID)),b=b-c.left}catch(d){}b<=G_RULER_MOVE_AREA.x1?b=G_RULER_MOVE_AREA.x1:b>=G_RULER_MOVE_AREA.x2&&(b=
G_RULER_MOVE_AREA.x2);var c=!1,e=DEXTTOP.DEXT5.util.parseIntOr0(DEXTTOP.G_CURREDITOR._config.ruler.moveGap);1<e?b==G_RULER_MOVE_AREA.x1?c=!0:b==G_RULER_MOVE_AREA.x2?c=!0:0==(b+DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width)/2)%e&&(c=!0):c=!0;c&&(G_CURR_DRAGGIN_RULER.style.marginLeft=b+"px");c=G_CURR_DRAGGIN_RULER.id;b=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width);c=c.replace("_point_","_pointline_");c=document.getElementById(c);b=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.marginLeft)+
b/2;c.style.left=b+"px";DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a)}}
function rulerStopDrag(a){getDialogDocument();G_RULER_DRAG=!1;document.getElementById("ue_ruler_back_div").style.display="none";var b=document.getElementById("dext_ruler_pointline_0_"+DEXTTOP.G_CURREDITOR.ID),c=document.getElementById("dext_ruler_pointline_1_"+DEXTTOP.G_CURREDITOR.ID);a=document.getElementById("dext_ruler_pointline_2_"+DEXTTOP.G_CURREDITOR.ID);b=DEXTTOP.DEXT5.util.parseIntOr0(b.style.left);c=DEXTTOP.DEXT5.util.parseIntOr0(c.style.left);a=DEXTTOP.DEXT5.util.parseIntOr0(a.style.left);
DEXTTOP.G_CURREDITOR._setting.ruler_position=b+","+c+","+a;a=G_CURR_DRAGGIN_RULER.id;b=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.width);c=a.replace("_point_","_pointline_");c=document.getElementById(c);b=DEXTTOP.DEXT5.util.parseIntOr0(G_CURR_DRAGGIN_RULER.style.marginLeft)+b/2;c.style.left=b+"px";0==a.indexOf("dext_ruler_point_0")||0==a.indexOf("dext_ruler_point_1")?"1"==DEXTTOP.G_CURREDITOR._config.ruler.useInoutdent&&setNodeStyleForRulerMode(1):0==a.indexOf("dext_ruler_point_2")&&
"1"==DEXTTOP.G_CURREDITOR._config.ruler.useInoutdent&&setNodeStyleForRulerMode(2);document.getElementById(G_CURR_DRAGGIN_RULER.id.replace("_point_","_pointline_")).style.display="none";DEXTTOP.DEXT5.util.removeEvent(document,"mousemove",rulerDrag,!0);DEXTTOP.DEXT5.util.removeEvent(document,"mouseup",rulerStopDrag,!0);DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTDOC,"mousemove",rulerDrag,!0);DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTDOC,"mouseup",rulerStopDrag,!0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function setNodeStyleForRulerMode(a){var b=document.getElementById("dext_ruler_area_0"),c=DEXTTOP.DEXT5.util.parseIntOr0(b.style.left)+DEXTTOP.DEXT5.util.parseIntOr0(b.style.width),b=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("dext_ruler_pointline_0_"+DEXTTOP.G_CURREDITOR.ID).style.left)-c,c=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("dext_ruler_pointline_1_"+DEXTTOP.G_CURREDITOR.ID).style.left)-c-b,d=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("dext_ruler_pointline_2_"+DEXTTOP.G_CURREDITOR.ID).style.left),
e=document.getElementById("dext_ruler_area_1"),d=DEXTTOP.DEXT5.util.parseIntOr0(e.style.left)-d,e=getFirstRange().range,f=!1;e.startContainer&&"BODY"==e.startContainer.tagName&&e.endContainer&&"BODY"==e.endContainer.tagName&&(f=!0);for(var e=f?DEXTTOP.G_CURREDITOR._BODY.childNodes:getNodesInRange(e),f=e.length,g=0;g<f;g++){var h=e[g];if("P"==h.tagName||"LI"==h.tagName)1==a?(h.style.marginLeft=b+"px",h.style.textIndent=c+"px"):h.style.marginRight=d+"px"}}
function setRulerMode2Position(a,b){var c=b._DOC.documentElement.scrollLeft||b._BODY.scrollLeft||0,d=DEXTTOP.DEXT5.util.parseIntOr0(a.style.textIndent),e=DEXTTOP.DEXT5.util.parseIntOr0(a.style.marginLeft),f=DEXTTOP.DEXT5.util.parseIntOr0(a.style.marginRight),g=getClientRect(a),h=DEXTTOP.DEXT5.util.parseIntOr0(g.left),n=DEXTTOP.DEXT5.util.parseIntOr0(g.right),m=document.getElementById("dext_ruler_point_0_"+b.ID),p=document.getElementById("dext_ruler_point_1_"+b.ID),t=document.getElementById("dext_ruler_point_2_"+
b.ID),q=DEXTTOP.DEXT5.util.parseIntOr0(m.style.width),g=document.getElementById("dext_ruler_pointline_0_"+b.ID),u=document.getElementById("dext_ruler_pointline_1_"+b.ID),v=document.getElementById("dext_ruler_pointline_2_"+b.ID);"1"==b._config.ruler.useInoutdent&&(m.style.marginLeft=h-q/2+"px",g.style.left=h+"px",p.style.marginLeft=h+d-q/2+"px",u.style.left=h+d+"px",t.style.marginLeft=n-q/2+"px",v.style.left=n+"px");var m=document.getElementById("dext_ruler_area_0"),p=document.getElementById("dext_ruler_area_1"),
w=q=d=t=0,t=0,d=n+f,q=h-e;0>q&&(q=0);w=getCurrEditorWidth()-d;0>w&&(w=0);m.style.width=q+"px";p.style.width=w+"px";m.style.left=t+"px";p.style.left=d+"px";G_RULER_MOVE_AREA.x1=t+q;G_RULER_MOVE_AREA.x2=d;e=0==t+q?h+c:t+q+c;G_RULER_MOVE_AREA.realX1=e;G_RULER_MOVE_AREA.realX2=d+c;"1"==b._config.ruler.useInoutdent&&(b._setting.ruler_position=DEXTTOP.DEXT5.util.parseIntOr0(g.style.left)+c+","+(DEXTTOP.DEXT5.util.parseIntOr0(u.style.left)+c)+","+(DEXTTOP.DEXT5.util.parseIntOr0(v.style.left)+c))}
function setRulerPositionForNode(a){a=a?a:DEXTTOP.G_CURREDITOR;if(1==a.isInitFocusHandler&&0==a._config.initFocus&&DEXTTOP.DEXT5.browser.ie)a.isInitFocusHandler=!1;else if("2"==a._config.ruler.mode&&"none"!=document.getElementById("dext_tab_tool3_"+a.ID).style.display){var b=getFirstRange().range;if(b){b=b.startContainer;3==b.nodeType&&(b=b.parentNode);var c=GetParentbyTagName(b,"p");null==c&&(c=GetParentbyTagName(b,"li"));null!=c||"BODY"!=b.tagName&&9!=b.nodeType||(c=a._DOC.getElementsByTagName("p")[0]);
c&&setRulerMode2Position(c,a)}}}function getCurrEditorWidth(){var a=null,a=getClientRect(document.getElementById("editorContentArea"));return a=a.right-a.left}
function setAutoUrlHyperLink(a,b){if("0"!=DEXTTOP.G_CURREDITOR._config.autoUrlDetect){var c=null;try{var d="which"in a?a.which:a.keyCode,e="",f=null,g=b.range;if(32==d&&g.startOffset==g.endOffset&&"3"==g.endContainer.nodeType)f=g.startContainer,e=g.endContainer.nodeValue,e=e.substring(0,g.endOffset-1);else if(13==d&&!a.shiftKey){var h=GetParentbyTagName(g.startContainer,"p");h&&h.previousSibling&&h.previousSibling.lastChild&&(f=h.previousSibling.lastChild,"1"==f.nodeType?e=f.textContent:"3"==f.nodeType&&
(e=f.nodeValue))}g=!1;d=0;-1<e.toLowerCase().indexOf("http:")?(e=e.substring(e.toLowerCase().lastIndexOf("http:")),g=!0,d=0):-1<e.toLowerCase().indexOf("https:")?(e=e.substring(e.toLowerCase().lastIndexOf("http:")),g=!0,d=0):-1<e.toLowerCase().indexOf("www.")&&(e=e.substring(e.toLowerCase().lastIndexOf("www.")),g=!0,d=1);if(g&&(e=e.replace(/\u00A0/g,""),g=null,0==d?g=e.match(/^(https?|ftp):\/\/(-\.)?([^\s\/?\.#]+\.?)+(\/[^\s]*)?[^\s\.,]$/i):1==d&&(g=e.match(/(www\.)?([^\s\/?\.#]+\.?)+(\/[^\s]*)?[^\s\.,]$/i)),
g)){var c=saveSelection(DEXTTOP.G_CURREDITOR.ID,!0),n=rangy.createRange(_iframeDoc);n.selectNodeContents(f);n.findText(e,{caseSensitive:!1,wholeWordsOnly:!1,direction:"forward"})&&(n.select(),e={type:"hyperlink",url:e,target:"_blank",attr_info_arr:[]},command_InsertHyperLink(DEXTTOP.G_CURREDITOR.ID,document.getElementById("dext5_design_"+DEXTTOP.G_CURREDITOR.ID),e));restoreSelection(c,!0)}}catch(m){null!=c&&restoreSelection(c,!0)}}}
function setContentChangeKeyEvent(a,b){if("function"==typeof DEXTTOP.dext_editor_contentsize_change_event&&38!=b&&40!=b&&37!=b&&39!=b&&36!=b&&35!=b&&33!=b&&34!=b)try{0<G_KEY_IMG_COUNT&&G_KEY_IMG_COUNT!=_iframeDoc.getElementsByTagName("img").length&&(G_KEY_IMG_COUNT=-1,contentChangeEventWrapper())}catch(c){}}
function contentChangeEventWrapper(a,b){if("function"==typeof DEXTTOP.dext_editor_contentsize_change_event){var c=[],d=0,e=_iframeDoc.getElementsByTagName("img");if(G_IMG_TOTAL_COUNT==e.length){var f=!0;try{for(var g=0,h=e.length;g<h;g++)if("undefined"==typeof G_IMG_CURRENT_LIST[e[g].src]){f=!1;G_IMG_CURRENT_LIST[e[g].src]=0;break}else if(G_IMG_CURRENT_ARRAYLIST.length==h&&G_IMG_CURRENT_ARRAYLIST[g]!=e[g].src){f=!1;break}}catch(n){f=!1}if(f)return}if(null!=a&&"object"==typeof a){if("img"!=a.nodeName.toLowerCase())return;
d=0;DEXTTOP.DEXT5.util.checkUrlForContentSizeCheckEvent(a.src)&&c.push(a)}else if(null==a||"undefined"==typeof a){if(null==e||e&&0==e.length){if(-1==G_IMG_TOTAL_SIZE||0!=G_IMG_TOTAL_SIZE){G_IMG_TOTAL_COUNT=G_IMG_TOTAL_SIZE=0;G_IMG_CURRENT_LIST={};G_IMG_CURRENT_ARRAYLIST=[];try{DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:0})}catch(m){}}return}g=0;for(h=e.length;g<h;g++)DEXTTOP.DEXT5.util.checkUrlForContentSizeCheckEvent(e[g].src)&&c.push(e[g]);d=1}if(0==c.length){G_IMG_CURRENT_LIST=
{};G_IMG_TOTAL_SIZE=0;try{DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:0})}catch(p){}}else{for(var t=[],q=[],g=0,h=c.length;g<h;g++)"undefined"==typeof G_IMG_TOTAL_LIST[c[g].src]?t.push(c[g].src):q.push(c[g].src);var u=0;G_IMG_TOTAL_COUNT=e.length;-1==G_IMG_TOTAL_SIZE&&(G_IMG_TOTAL_SIZE=0);if(0==t.length){G_IMG_CURRENT_LIST={};G_IMG_CURRENT_ARRAYLIST=[];g=0;for(h=e.length;g<h;g++)"undefined"!=typeof G_IMG_TOTAL_LIST[e[g].src]&&(u+=G_IMG_TOTAL_LIST[e[g].src],G_IMG_CURRENT_LIST[e[g].src]=
G_IMG_TOTAL_LIST[e[g].src],G_IMG_CURRENT_ARRAYLIST.push(e[g].src));if(G_IMG_TOTAL_SIZE!=u){G_IMG_TOTAL_SIZE=u;try{DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:u})}catch(v){}}}else DEXTTOP.DEXT5.GetFileSizeEx(t,function(a){if(0==d)u=G_IMG_TOTAL_SIZE+parseInt(a),G_IMG_TOTAL_LIST[t]=parseInt(a),G_IMG_CURRENT_LIST[t]=parseInt(a);else if(1==d){G_IMG_CURRENT_LIST={};G_IMG_CURRENT_ARRAYLIST=[];for(var b=0,c=q.length;b<c;b++)"undefined"!=G_IMG_TOTAL_LIST[q[b]]&&(u+=G_IMG_TOTAL_LIST[q[b]],
G_IMG_CURRENT_LIST[q[b]]=G_IMG_TOTAL_LIST[q[b]],G_IMG_CURRENT_ARRAYLIST.push(q[b]));b=0;c=t.length;for(a=(a+"").split(",");b<c;b++)""==a[b]&&(a[b]=0),u+=parseInt(a[b]),G_IMG_TOTAL_LIST[t[b]]=parseInt(a[b]),G_IMG_CURRENT_LIST[t[b]]=parseInt(a[b]),G_IMG_CURRENT_ARRAYLIST.push(t[b])}if(G_IMG_TOTAL_SIZE!=u){G_IMG_TOTAL_SIZE=u;try{DEXTTOP.dext_editor_contentsize_change_event(DEXTTOP.G_CURREDITOR.ID,{image:u})}catch(e){}}},DEXTTOP.G_CURREDITOR.ID)}}}
function getWidthForAutoBodyFit(a,b){var c;c="table"==b?a._defTableWidth:a._defaultWidth;if("1"==a._config.autoBodyFit){var d=DEXTTOP.DEXT5.util.parseIntOr0(a._BODY.style.width);0<d&&(c=d-10)}return c}
function changeTextForAutoUrl(a,b){var c={changedData:"",matchArr:null};if("1"==b._config.autoUrlDetect)try{a=a.replace(/&nbsp;/gi,unescape("%u200B")+"dext5_nbsp;"+unescape("%u200B"));var d=null,d=a.match(/(www.|http(s)?:\/\/)([a-z0-9\w]+\.*)+[a-z0-9]{2,4}([\/a-z0-9-%#?&=\w])+(\.[a-z0-9]{2,4}(\?[\/a-z0-9-%#?&=\w]+)*)*/gi),e=unescape("%u200B")+"dext5_nbsp;"+unescape("%u200B");a=a.replace(new RegExp(e,"gi"),"&nbsp;");if(d){for(var f=d.length,e=0;e<f;e++)a=a.replace(d[e],unescape("%u200B")+"dext5_link"+
e+unescape("%u200B"));c.changedData=a;c.matchArr=d}}catch(g){c={changedData:"",matchArr:null}}return c}function rollBackTextForAutoUrl(a){for(var b=a.matchArr.length,c=0;c<b;c++)a.changedData=a.changedData.replace(unescape("%u200B")+"dext5_link"+c+unescape("%u200B"),'<a href="'+(0>a.matchArr[c].toLowerCase().indexOf("://")?"http://"+a.matchArr[c]:a.matchArr[c])+'">'+a.matchArr[c]+"</a>");return a.changedData}
function getFirstChildNodeForCaret(a){if(a.firstChild)for(a=a.firstChild;;)if(3==a.nodeType||-1<",img,input,iframe,object,video,".indexOf(","+a.tagName.toLowerCase()+",")){a=a.parentNode;break}else if("BR"==a.tagName){a=a.parentNode;break}else if(null!=a.firstChild)a=a.firstChild;else break;return a}
function getLastChildNodeForCaret(a){"TABLE"==a.tagName&&(a=a.getElementsByTagName("td"),a=a[a.length-1]);for(;null!=a.lastChild;)a=a.lastChild;if(3==a.nodeType||a.tagName&&-1<",br,img,input,iframe,object,video,".indexOf(","+a.tagName.toLowerCase()+","))a=a.parentNode;return a};function command_bold(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"strong"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"bold",c)}function command_italic(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"i"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"italic",c)}
function command_formatting(a,b,c){dext_src_init(b);c.toLowerCase();restoreSelection();setFocusToBody();a=getFirstRange();""==c?DoExecuteCommandFormatting(a,"p",!1):DoExecuteCommandFormatting(a,c,!0)}function command_underline(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"u"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"underline",c)}
function command_strikeThrough(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"strike"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"strikeThrough",c)}function command_superscript(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"sup"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"superscript",c)}
function command_subscript(a,b){dext_src_init(b._EDITOR.design);var c={document:_iframeDoc,styleWithCss:!1,tagName:"sub"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"subscript",c)}function command_selectAll(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();_iframeDoc.execCommand("selectAll",!1,null);b._iconEnable("selectArea")}
function command_align(a,b,c,d,e){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var f=getFirstRange();a=f.range;try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(a.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(a.endOffset),3==a.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(a.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(a.startContainer),3==a.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(a.endContainer.parentNode):
(DEXTTOP.G_CURREDITOR.beforeOffset.push(a.endContainer),1==a.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(a.endContainer.innerText||a.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(a.toString().length)}catch(g){DEXTTOP.G_CURREDITOR.beforeOffset=null}var h=null;if(e&&"table"==e.tagName.toLowerCase())h=e;else if(e&&"img"==e.tagName.toLowerCase()){if(b=GetParentbyTagName(e,"figure")){if("justify"==c||"center"==c)c="";"cssFloat"in b.style?b.style.cssFloat=c:b.style.styleFloat=
c;rangy.getSelection(_iframeWin).removeAllRanges();(c=b.getElementsByTagName("figcaption"))&&c[0]&&doSetCaretPosition(c[0],0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;e&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=e,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!1,null));setMenuIconRealable(getMyElementNode(e));return}}else h=getSelectionTable(b);if(h){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
if("0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign||"0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO)"justify"==c||"left"==c&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?h.removeAttribute("align"):h.setAttribute("align",c);try{var n=_iframeDoc.body.createControlRange();n.add(h);n.select()}catch(m){}setMenuIconRealable(h);DEXTTOP.G_CURREDITOR._iconEnable("focusTable",h);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;e&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=
e,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,!1,null))}else{if(void 0==a)"left"==c?c="justifyLeft":"right"==c?c="justifyRight":"center"==c?c="justifyCenter":"justify"==c&&(c="justifyFull"),DoExecuteCommand2(f.sel,a,c,d);else{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();e="p li dt dd h1 h2 h3 h4 h5 h6 pre address div".split(" ");
n=e.length;b=GetTableSelectionCells();if(0==b.length){if(null!=a.startContainer.previousSibling&&"HEAD"==a.startContainer.previousSibling.tagName&&null==a.endContainer.nextSibling){for(var p=0;p<n;p++)for(f=_iframeDoc.body.getElementsByTagName(e[p]),h=f.length,d=0;d<h;d++)""!=f[d].style.layoutGridMode&&(f[d].style.layoutGridMode="none"),f[d].style.textAlign=c;n=_iframeDoc.body.getElementsByTagName("table");f=n.length;for(p=0;p<f;p++){if("0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign||
"0"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO)"justify"==c||"left"==c&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?n[p].removeAttribute("align"):n[p].setAttribute("align",c);var h=n[p].rows,t=h.length;for(d=0;d<t;d++){b=h[d].cells;a=b.length;for(var q=0;q<a;q++)setBlockTag(b[q].childNodes,e,"align",c)}}setBlockTag(_iframeDoc.body.childNodes,e,"align",c);q=_iframeDoc.body.getElementsByTagName("div");f=q.length;for(d=0;d<f;d++)setBlockTag(q[d].childNodes,e,"align",c)}else{b=!1;a&&(p=
GetTDTHCell(a.startContainer),d=GetTDTHCell(a.endContainer),f=a.commonAncestorContainer,null!=p&&null!=d&&null!=f&&p==d==f&&(q=GetParentbyTagName(p,"table"),b=!0));b?f=getElementsFromSelection(p.nodeName.toString().toLowerCase()):0==a.toString().length?(d=a.startContainer,f=[d]):f=a.getNodes();h=f.length;if(2>=h)for(p=0;p<h;p++)d=f[p],3==d.nodeType&&f.push(d.parentNode);if(!f||1==f.length&&-1<"body,td,th".indexOf(f[0].nodeName.toLowerCase()))f=getNodesInRange(a);var h=f.length,t=a.startOffset,u=a.endOffset;
0==a.toString().length&&0==a.getNodes().length&&a.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(var v=0;v<h;v++)if(1==f[v].nodeType&&(p=f[v].tagName.toLowerCase(),"0"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_DeleteTableAlign&&"0"!=DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO||0==a.toString().length||0==a.getNodes().length||"table"!=p||b&&q==f[v]||("justify"==c||"left"==c&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?f[v].removeAttribute("align"):f[v].setAttribute("align",c)),
-1<e.indexOf(p))){for(p=0;p<n;p++){var w=f[v].getElementsByTagName(e[p]),y=w.length;for(d=0;d<y;d++)""!=w[d].style.layoutGridMode&&(w[d].style.layoutGridMode="none"),w[d].style.textAlign=c}""!=f[v].style.layoutGridMode&&(f[v].style.layoutGridMode="none");f[v].style.textAlign=c}var x;0==a.toString().length&&1==a.getNodes().length&&(x=a.getNodes()[0],f.push(a.getNodes()[0]));n=3==f[0].nodeType;setBlockTag(f,e,"align",c);if(n){if(0==a.toString().length)try{a.setEnd(f[0],u)}catch(z){}a.setStart(f[0],
t);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a)}}(c=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(c,1),c.parentNode.removeChild(c)):x&&(c=getFirstRange().range,getFirstRange().sel.removeAllRanges(),c.selectNode(x),getFirstRange().sel.addRange(c));f=getFirstRange();a=f.range;setMenuIconRealable(getMyElementNode(a.startContainer))}else{7==DEXTTOP.DEXT5.browser.ieVersion&&null!=ActiveCurrTable&&0==d&&(x=!1,"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&
(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="1",x=!0),setAdjustTableWidthHeight(ActiveCurrTable),x&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0"));a=b.length;for(p=0;p<a;p++){for(d=0;d<n;d++)for(f=b[p].getElementsByTagName(e[d]),h=f.length,q=0;q<h;q++)""!=f[q].style.layoutGridMode&&(f[q].style.layoutGridMode="none"),f[q].style.textAlign=c;setBlockTag(b[p].childNodes,e,"align",c);q=b[p].getElementsByTagName("div");f=q.length;for(d=0;d<f;d++)setBlockTag(q[d].childNodes,e,"align",c);x=b[p].getElementsByTagName("table");
q=x.length;for(d=0;d<q;d++)"justify"==c?x[d].removeAttribute("align"):x[d].setAttribute("align",c)}doSetCaretPosition(DrageEndCell.childNodes[0],1);c=getFirstRange().range;x=getMyChildElementNode(c.startContainer);c.selectNode(x);setMenuIconRealable(x);_iframeDoc_MouseUpMenu(null,DrageEndCell)}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0}DEXTTOP.G_CURREDITOR.beforeOffset=null}}function command_justifyLeft(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyLeft",c)}function command_justifyCenter(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyCenter",c)}
function command_justifyRight(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyRight",c)}function command_justifyFull(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyFull",c)}
function command_indent(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange().range,d=c.startContainer,d=3==d.nodeType?d.parentNode:d;if(GetParentbyTagName(d,"li"))setTabkeyAction();else{d=parseIntOr0(b._config.inoutdentDefaultSize);0==d&&(d=40);if(c&&"1"!=b._config.allowInoutdentText){var e=GetTDTHCell(c.startContainer);if(e&&0<c.toString().length)return;if(e=GetParentbyTagName(e,"table")){var f=parseIntOr0(e.style.marginLeft);e.style.marginLeft=f+d+"px";
return}}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var e="p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" "),g,h;g=0==c.toString().length?[c.startContainer]:c.getNodes();if(1==g.length){if(f=g[0],!(f.tagName&&-1<e.indexOf(f.tagName.toLowerCase())))for(;f=f.parentNode,!f.tagName||"body"!=f.tagName.toLowerCase();)if(f.tagName&&-1<e.indexOf(f.tagName.toLowerCase())){g=[f];break}}else{var f=g[0],n=g[g.length-1],m=f;for(h=n;!m.tagName||"body"!=m.tagName.toLowerCase();){if(m.tagName&&
-1<e.indexOf(m.tagName.toLowerCase())){f=m;break}m=m.parentNode}for(;!h.tagName||"body"!=h.tagName.toLowerCase();){if(h.tagName&&-1<e.indexOf(h.tagName.toLowerCase())){n=h;break}h=h.parentNode}f==n&&(g=[f])}null!=c.startContainer.previousSibling&&"HEAD"==c.startContainer.previousSibling.tagName&&null==c.endContainer.nextSibling&&(g=c.getNodes());0<c.toString().length&&1<g.length&&1==g[0].nodeType&&"P"==g[0].tagName&&(f=g[0].innerText||g[0].textContent,3==c.startContainer.nodeType&&null==c.startContainer.nextSibling&&
(f=c.startContainer.nodeValue),n=!1,f.length==c.startOffset&&(n=!0),!n&&DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&2<=g.length&&0<c.startOffset&&3!=g[1].nodeType&&1==c.startContainer.nodeType&&(n=!0),n&&(c.setStartAfter(g[0]),g=c.getNodes()));h=g.length;for(var n=c.startOffset,m=c.endOffset,p=0;p<h;p++)if(null!=g[p].parentNode&&1==g[p].nodeType&&g[p].tagName&&"body"!=g[p].tagName.toLowerCase())if("table"==g[p].tagName.toLowerCase())"1"!=b._config.allowInoutdentText&&(f=parseIntOr0(g[p].style.marginLeft),
g[p].style.marginLeft=f+d+"px");else if(g[p].tagName&&-1<e.indexOf(g[p].tagName.toLowerCase())){var t=parseIntOr0(g[p].style.paddingLeft),f=parseIntOr0(g[p].style.marginLeft);0<t?(0<f&&(t+=f),g[p].style.paddingLeft="",g[p].style.marginLeft=t+d+"px"):g[p].style.marginLeft=f+d+"px"}f=g[0]&&g[0].nodeType?3==g[0].nodeType:!1;setBlockTag(g,e,"indent",d);f&&(0==c.toString().length&&c.setEnd(g[0],m),c.setStart(g[0],n),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(c))}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_outdent(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange().range,d=c.startContainer,d=3==d.nodeType?d.parentNode:d;if(GetParentbyTagName(d,"li"))setShiftTabkeyAction();else{d=parseIntOr0(b._config.inoutdentDefaultSize);0==d&&(d=40);if(c&&"1"!=b._config.allowInoutdentText){var e=GetTDTHCell(c.startContainer);if(e&&0<c.toString().length)return;if(e=GetParentbyTagName(e,"table")){var f=parseIntOr0(e.style.marginLeft);e.style.marginLeft=(0>
f-d?0:f-d)+"px"}}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var g="p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" "),e=0==c.toString().length?[c.startContainer]:c.getNodes();if(1==e.length){var h=e[0];if(!(h.tagName&&-1<g.indexOf(h.tagName.toLowerCase())))for(;h=h.parentNode,!h.tagName||"body"!=h.tagName.toLowerCase();)if(h.tagName&&-1<g.indexOf(h.tagName.toLowerCase())){e=[h];break}}else{for(var h=e[0],n=e[e.length-1],m=h,f=n;!m.tagName||"body"!=m.tagName.toLowerCase();){if(m.tagName&&
-1<g.indexOf(m.tagName.toLowerCase())){h=m;break}m=m.parentNode}for(;!f.tagName||"body"!=f.tagName.toLowerCase();){if(f.tagName&&-1<g.indexOf(f.tagName.toLowerCase())){n=f;break}f=f.parentNode}h==n&&(e=[h])}null!=c.startContainer.previousSibling&&"HEAD"==c.startContainer.previousSibling.tagName&&null==c.endContainer.nextSibling&&(e=c.getNodes());g=e.length;h=c.startOffset;n=c.endOffset;for(m=0;m<g;m++)if(null!=e[m].parentNode&&1==e[m].nodeType&&e[m].tagName&&"body"!=e[m].tagName.toLowerCase())if("table"==
e[m].tagName.toLowerCase())"1"!=b._config.allowInoutdentText&&(f=parseIntOr0(e[m].style.marginLeft),f=0>f-d?0:f-d,e[m].style.marginLeft=f+"px");else{var p=parseIntOr0(e[m].style.paddingLeft),f=parseIntOr0(e[m].style.marginLeft);0<p?(0<f&&(p+=f),f=0>p-d?0:p-d,e[m].style.paddingLeft=""):f=0>f-d?0:f-d;e[m].style.marginLeft=f+"px"}3==e[0].nodeType&&(0==c.toString().length&&c.setEnd(e[0],n),c.setStart(e[0],h),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(c))}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_insertOrderedList(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange(),d=c.range,e=getFirstRange().range,f=null;e&&e.startContainer&&(f=getMyElementNode(e.startContainer));var g=GetParentbyTagName(f,"ol"),f=GetParentbyTagName(f,"ul");g||f?f?(f.style.listStyleType="",DoExecuteCommand2(c.sel,d,"insertOrderedList")):g&&(g.style.listStyleType="",DoExecuteCommand2(c.sel,d,"insertOrderedList")):DoExecuteCommand2(c.sel,d,"insertOrderedList");c=getFirstRange().range;
0==!!c&&(c=e);if(f=getMyElementNode(c.startContainer))if(e=GetParentbyTagName(f,"ol"))if(""==e.style.listStyleType&&(e.style.listStyleType="decimal"),""!=b._config.orderListDefaultClass&&e.setAttribute("class",b._config.orderListDefaultClass),e.parentNode&&e.parentNode.tagName&&-1<",ul,ol,".indexOf(","+e.parentNode.tagName.toLowerCase()+",")){for(d=e.previousSibling;null!=d&&1!=d.nodeType;)d=d.previousSibling;d&&"li"==d.tagName.toLowerCase()&&d.appendChild(e)}e=getNodesInRange(c);d=e.length;for(f=
0;f<d;f++)"ol"==e[f].nodeName.toLowerCase()&&(c=e[f].parentNode,"p"==c.nodeName.toLowerCase()&&(""==e[f].style.fontSize&&""!=c.style.fontSize&&(e[f].style.fontSize=c.style.fontSize),""==e[f].style.fontFamily&&""!=c.style.fontFamily&&(e[f].style.fontFamily=c.style.fontFamily),c.parentNode.replaceChild(e[f],c),c=getFirstRange(),c.sel.removeAllRanges(),c.range.selectNodeContents(e[f]),c.sel.addRange(c.range)));removeDivInLiTag();setRulerPositionForNode()}
function command_listDecimal(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","decimal")}function command_listDecimalLeadingZero(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","decimal-leading-zero")}function command_listLowerAlpha(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","lower-alpha")}function command_listLowerGreek(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","lower-greek")}
function command_listLowerRoman(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","lower-roman")}function command_listUpperAlpha(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","upper-alpha")}function command_listUpperRoman(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"N","upper-roman")}
function command_insertUnOrderedList(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange(),d=c.range,e=getFirstRange().range,f=null;e&&e.startContainer&&(f=getMyElementNode(e.startContainer));var g=GetParentbyTagName(f,"ol"),f=GetParentbyTagName(f,"ul");g||f?g?(g.style.listStyleType="",DoExecuteCommand2(c.sel,d,"insertUnOrderedList")):f&&(f.style.listStyleType="",DoExecuteCommand2(c.sel,d,"insertUnOrderedList")):DoExecuteCommand2(c.sel,d,"insertUnOrderedList");
c=getFirstRange().range;0==!!c&&(c=e);if(f=getMyElementNode(c.startContainer))if(e=GetParentbyTagName(f,"ul"))if(""==e.style.listStyleType&&(e.style.listStyleType="disc"),""!=b._config.unOrderListDefaultClass&&e.setAttribute("class",b._config.unOrderListDefaultClass),e.parentNode&&e.parentNode.tagName&&-1<",ul,ol,".indexOf(","+e.parentNode.tagName.toLowerCase()+",")){for(d=e.previousSibling;null!=d&&1!=d.nodeType;)d=d.previousSibling;d&&"li"==d.tagName.toLowerCase()&&d.appendChild(e)}e=getNodesInRange(c);
d=e.length;for(f=0;f<d;f++)"ul"==e[f].nodeName.toLowerCase()&&(c=e[f].parentNode,"p"==c.nodeName.toLowerCase()&&(""==e[f].style.fontSize&&""!=c.style.fontSize&&(e[f].style.fontSize=c.style.fontSize),""==e[f].style.fontFamily&&""!=c.style.fontFamily&&(e[f].style.fontFamily=c.style.fontFamily),c.parentNode.replaceChild(e[f],c),c=getFirstRange(),c.sel.removeAllRanges(),c.range.selectNodeContents(e[f]),c.sel.addRange(c.range)));removeDivInLiTag();setRulerPositionForNode()}
function command_listDisc(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"B","disc")}function command_listCircle(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"B","circle")}function command_listSquare(a,b){dext_src_init(b._EDITOR.design);command_listNumberBullets(a,b,"B","square")}function command_removeFormat(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange();DoExecuteCommand2(c.sel,c.range,"removeFormat")}
function command_removeCss(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange().range;try{var d=getElementsFromSelection(),e=d.length;if(0==c.toString().length){var f=GetTableSelectionCells(),g=f.length;if(0==g)return!1;1!=isApplyFormat&&ClearDraggingTableCellSelected();for(var d=[],c=null,h=0,n=0;n<g;n++){d.push(f[n]);for(var c=f[n].getElementsByTagName("*"),h=c.length,m=0;m<h;m++)d.push(c[m])}e=d.length}else{f="";g=!1;for(n=0;n<e;n++)f=d[n].nodeName,"TABLE"==
f&&(g=!0);g&&ClearDraggingTableAllTable()}(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var f=null,p,n=0;n<e;n++)if(f=d[n],p=f.tagName.toLowerCase(),"table"==p||"td"==p||"th"==p){if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying){var t=
f.style.width,q=f.style.height,u=f.style.border,v=f.style.borderBottom,w=f.style.borderTop,y=f.style.borderLeft,x=f.style.borderRight,z=f.style.borderWidth,A=f.style.borderStyle,B=f.style.borderColor,g="";"table"==p&&(g=f.style.fontSize);removeAttribute(f,"align");removeAttribute(f,"style");removeAttribute(f,"className");removeAttribute(f,"bgcolor");""!=g&&(f.style.fontSize=g);""!=t&&(f.style.width=t);""!=q&&(f.style.height=q);""!=u&&(f.style.border=u);""!=z&&(f.style.borderWidth=z);""!=A&&(f.style.borderStyle=
A);""!=B&&(f.style.borderColor=B);""!=v&&(f.style.borderBottom=v);""!=w&&(f.style.borderTop=w);""!=y&&(f.style.borderLeft=y);""!=x&&(f.style.borderRight=x);"table"==p&&(f.style.borderCollapse="collapse",null!=f.getAttribute("cellpadding")&&"0"!=f.getAttribute("cellpadding")||f.setAttribute("cellPadding","1"))}}else{var g="style align background cellOrgBgColor border borderColor color face size height width hspace vspace valign class".split(" "),G=g.length;if(-1<",a,p,span,div,address,b,dd,dl,dt,font,i,li,label,ol,ul,strike,strong,sub,sup,u,".indexOf(","+
p+","))for(c=0;c<G;c++)removeAttribute(f,g[c])}var D=DEXT5_EDITOR.HTMLParser.makeMap("span,font");DEXTTOP.G_CURREDITOR._formatPainterList&&"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&(D=DEXT5_EDITOR.HTMLParser.makeMap("span,font,b,strong,i,em,u,strike,s,sub,sup"));for(n=e-1;0<=n;n--)if(f=d[n],p=f.tagName.toLowerCase(),D[p]&&"BODY"!=f.parentNode.tagName)if(DEXTTOP.DEXT5.browser.ie)f.removeNode();else{for(;f.firstChild;)f.parentNode.insertBefore(f.firstChild,f);f.parentNode.removeChild(f)}if(null==
DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(I){}}
function command_removeCss2(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange().range;if(0==a.toString().length)try{var d=getElementsFromSelection(),e=d.length;if(0==a.toString().length){var f=GetTableSelectionCells(),g=f.length;if(0==g)return!1;d=[];c=null;for(var h=a=0;h<g;h++){d.push(f[h]);c=f[h].getElementsByTagName("*");a=c.length;for(var n=0;n<a;n++)d.push(c[n])}e=d.length}for(var f=null,m,h=0;h<e;h++)if(f=d[h],m=f.tagName.toLowerCase(),"table"!=m&&"td"!=
m&&"th"!=m&&"tr"!=m&&"tbody"!=m&&"body"!=m&&"img"!=m){for(var p=f.attributes.length,g=[],n=0;n<p;n++)g.push(f.attributes[n].nodeName);for(c=0;c<p;c++)removeAttribute(f,g[c])}var t=DEXT5_EDITOR.HTMLParser.makeMap("span,font");DEXTTOP.G_CURREDITOR._formatPainterList&&"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&(t=DEXT5_EDITOR.HTMLParser.makeMap("span,font,b,strong,i,em,u,strike,s,sub,sup"));for(h=0;h<e;h++)f=d[h],m=f.tagName.toLowerCase(),t[m]&&"BODY"!=f.parentNode.tagName&&f.removeNode()}catch(q){}else removeCssInSelection(c)}
function command_copy(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();DEXTTOP.DEXT5.browser.ie?_iframeDoc.execCommand("copy",!1,null):alert(dext5_lang.msg.copy)}
function command_cut(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(DEXTTOP.DEXT5.browser.ie){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();_iframeDoc.execCommand("cut",!1,null);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper()}catch(c){}}else alert(dext5_lang.msg.cut)}
function command_pastehtml(a,b,c,d){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion){0<b.UndoManager.charCount&&b.UndoManager.putUndo();if(G_dext5plugIn){try{if(void 0==d&&"1"==b._config.limitPasteHtmlLength.value){var e=b._config.limitPasteHtmlLength.length,f=G_dext5plugIn.getOriginalHtml("body");if(f.length>e&&!checkCanPasteToIamge()){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();return}if("0"==
b._config.pasteToImage&&f.length>e){checkCanPasteToIamge()?alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1):alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();return}}}catch(g){}a=G_dext5plugIn.getPasteHtml();a=a.replace(/layout-flow:.*?;/gi,"");"1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64_remove&&(a=a.replace(/<img[^>]*src=["\']([^>]*:\\)([^>"\']+)["\']?[^>]*>/gi,""));if(100==G_dext5plugIn.getHTMLFormatFromType){var h="",n=changeTextForAutoUrl(a,DEXTTOP.G_CURREDITOR);""!=n.changedData&&
(h=a,a=n.changedData);a=a.replace(/&not/g,"&amp;not");a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a);if(""!=n.changedData){n.changedData=a;try{a=rollBackTextForAutoUrl(n)}catch(m){a=h.replace(/&not/g,"&amp;not"),a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a)}}}else{h="";try{h=G_dext5plugIn.getDext5PluginVersion()}catch(p){}""!=h&&"5,0,0,9"<=h&&6!=G_dext5plugIn.getHTMLFormatFromType&&(a=a.replace(/\r\n/g,"\n"))}h=!1;if(DEXTTOP.G_CURREDITOR.setTextPaste&&"1"!=DEXTTOP.G_CURREDITOR.setTextPasteMode)n=
document.createElement("div"),n.innerHTML=a,a=n.innerHTML,a=DEXTTOP.DEXT5.convertHtmlToText(a);else{if(G_dext5plugIn.getHTMLFormatFromType&&G_dext5plugIn.getPasteHtmlEx&&6==G_dext5plugIn.getHTMLFormatFromType&&(h=!0,DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&(n=a.match(RegExp("<img[^>]*src=[\"']?([^>\"']+)[\"']?[^>]*>","gi")))))for(var t=n.length,q=0;q<t;q++)if(-1<n[q].indexOf("file://")){h=!1;break}6==G_dext5plugIn.getHTMLFormatFromType&&DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&
(n=G_dext5plugIn.getPasteHtmlEx(),n=checkCopyInCellFormInertnNet(n),""!=n&&(a=n,h=!1))}if(void 0!=c){d&&"0"==b._config.pasteToImage&&d.hide();c=G_dext5plugIn.ShowImageSaveDlgFromClipboard(c);try{if("HTML"==c&&"1"==b._config.limitPasteHtmlLength.value&&(e=b._config.limitPasteHtmlLength.length,f=G_dext5plugIn.getOriginalHtml("body"),f.length>e)){checkCanPasteToIamge()?alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1):alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();return}}catch(u){}if(""==
c){setFocusToBody();return}""!=c&&"HTML"!=c&&(a=c,h=!1)}"1"==b._config.ie_BugFixed_Hyfont&&(a=DEXTTOP.DEXT5.util.replaceHyFont(a,b));e=!0;h&&(setPasteBin(),b.isStopScroll=!0,(e=document.execCommand("paste",!1,null))?(e=!1,fn_PasteIE(),setTimeout(function(){b.isStopScroll=!1},1)):e=!0);e&&(e=!1,6==G_dext5plugIn.getHTMLFormatFromType&&(e=!0),f=document.createElement("div"),f.innerHTML=a,replaceSpanToDivContainAbsolute(f)&&(a=f.innerHTML),"1"==b._config.useHtmlCorrection?"1"==b._config.useHtmlProcessByWorker?
(showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:DEXTTOP.G_CURREDITOR._config,callFn:"htmlTagRevision",callFnParam:[a,!0,e],callBackFn:fn_command_pasteHtml_htmlTagRevision_After})):(a=htmlTagRevision(a,!0,e),fn_command_pasteHtml_htmlTagRevision_After(a,b)):fn_command_pasteHtml_htmlTagRevision_After(a,b))}else setPasteBin(),b.isStopScroll=!0,document.execCommand("paste",
!1,null),fn_PasteIE(),setTimeout(function(){b.isStopScroll=!1},1);b.UndoManager.putUndo();b.UndoManager.charCount=0}else _iframeDoc.queryCommandState("paste")?(0<b.UndoManager.charCount&&b.UndoManager.putUndo(),_iframeDoc.execCommand("paste",!1,null),b.UndoManager.putUndo(),b.UndoManager.charCount=0):b._dextCommands(b.ID,"paste_dialog")}
function fn_command_pasteHtml_htmlTagRevision_After(a,b){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();"undefined"==typeof b&&(b=DEXTTOP.G_CURREDITOR);a=removeTagStyle(a);a=repairPasteTextInCell(a);0<a.length?(0<b.UndoManager.charCount&&(b.UndoManager.putUndo(),b._iconEnable("")),"1"==b._config.useHtmlProcessByWorker?(a=DEXTTOP.DEXT5.util.officeCleanByDom(a,!0),showProcessingBackground(),fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,
gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:b._config,callFn:"DEXTTOP.DEXT5.util.officeClean",callFnParam:[a,!0],callBackFn:fn_command_pasteHtml_officeClean_After})):(a=DEXTTOP.DEXT5.util.officeClean(a,!0),fn_command_pasteHtml_officeClean_After(a,b))):"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}
function fn_command_pasteHtml_officeClean_After(a,b){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();"undefined"==typeof b&&(b=DEXTTOP.G_CURREDITOR);a=OfficePasteClean(a);a=DEXTTOP.DEXT5.util.emptyTagRemove(a);a=IEPasteRemoveEmptyNodes(a);a=DEXTTOP.DEXT5.util.htmlRevision(a);a=xssReplaceScript(null,a);a=getImageAutoFitForPasteHtml(a);"1"==b._config.tableAutoAdjustInPaste&&/<table/i.test(a)&&(a=command_AdjustTableAndCellWidth(b.ID,b,{type:"paste",htmlData:a}));if("function"==
typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event){var c=a;try{c=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(a)}catch(d){c=a}if(c)a=c;else if(0==c||""==c){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}pasteWordCount(a)?(-1<a.indexOf("dext5customdata")&&(a=checkExistCustomData(a)),setTimeout(function(){pasteHtmlAtCaretHuge(a)},0),checkPasteImage(a),0>a.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=
!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1)),"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground(),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){}},500)):"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground()}
function command_pastetext(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=document.getElementById("dext_span_"+a+"text_paste");b.setTextPaste?(b.setTextPaste=!1,c.style.backgroundImage=""):(b.setTextPaste=!0,c&&(_className=DEXTTOP.DEXT5.util.getClass(c),_className+=" uebutton_span_enter",DEXTTOP.DEXT5.util.setClass(c,_className),-1<c.className.indexOf("uebutton_type")?c.style.backgroundImage="url("+b._config.webPath.image+"skin/"+b._config.style.skinName+"/form_skinback_release.gif)":
c.style.backgroundImage="url("+b._config.webPath.image+"skin/"+b._config.style.skinName+"/skinback_release.gif)"))}
function command_pagebreak(a,b){try{dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);getFirstRange();var c=_iframeDoc.createElement("div");c.style.pageBreakAfter="always";c.contentEditable=!1;c.style.display="block";c.className="DEXT_fiVe_Page_Break";c.id="dext_page_break";var d=_iframeDoc.createElement("span");
d.style.display="none";d.innerHTML=dext5_lang.icon.pagebreak;c.appendChild(d);d="";DEXTTOP.DEXT5.browser.ie&&(d="<p>",11<=DEXTTOP.DEXT5.browser.ieVersion?d+="<br>":7>=DEXTTOP.DEXT5.browser.ieVersion&&(d+="&nbsp;"),d+="</p>");pasteHtmlAtCaretHuge(c.outerHTML+d,!1,!0);c=_iframeDoc.getElementById("dext_page_break");c.removeAttribute("id");var e=GetParentbyTagName(c,"span");e&&(e.parentNode.insertBefore(c,e),""==e.innerHTML&&e.parentNode.removeChild(e));e=null;try{c.nextSibling?e=c.nextSibling:(e=_iframeDoc.createElement("p"),
e.innerHTML=!DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.ie&&11<=DEXTTOP.DEXT5.browser.ieVersion?"<br>":"&nbsp;",c.parentNode.appendChild(e)),e&&doSetCaretPosition(e,0)}catch(f){}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(g){}}
function command_print(a,b){dext_src_init(b._EDITOR.design);isViewMode(b)||b.setChangeMode("preview");setTimeout(function(){var a,d="preview";isViewMode(b)&&(d="design");a=b._EDITOR[d].contentDocument?b._EDITOR[d].contentDocument:b._EDITOR[d].contentWindow.document;changeSpanPageBreakProperty(a);if(DEXTTOP.DEXT5.browser.ie)if(d=a.getElementById("dext5printpreview"))try{d.doPrintPreview(b._config.printHeader,b._config.printFooter,"")}catch(e){a.execCommand("print",!1,null)}else a.execCommand("print",
!1,null);else"none"==b._EDITOR[d].style.display&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)&&(bChnageDisplay=!0,b._EDITOR[d].style.display=""),b._EDITOR[d].contentWindow.print();isViewMode(b)?restoreSpanPageBreakProperty(a):b.setChangeMode("design")},350)}
function command_saveAs(a,b,c){dext_src_init(b._EDITOR.design);var d=DEXTTOP.DEXT5.getHtmlValueExWithDocType(),d=d.replace("&amp;","&");if(G_dext5plugIn){var e=b._config.saveHtmlName,e=e.replace(/[\\/:*?"<>|]/gi,""),f=e.lastIndexOf(".");0<=f&&(e=e.substr(0,f));c?(e=G_dext5plugIn.doSaveHTML(d,e,"utf-8",""),""!=e&&(b.strOldSaveFileName=e)):(c="",c=""==b.strOldSaveFileName?e:b.strOldSaveFileName,b.strOldSaveFileName=G_dext5plugIn.doSaveHTML(d,c,"utf-8",""))}else{var g=b._config.saveHtmlName,g=g.replace(/[\\/:*?"<>|]/gi,
""),f=g.lastIndexOf(".");0>g.substr(f+1).indexOf("htm")&&(g=0<=f?g.substr(0,f):g+".html");e=function(){var a=DEXTTOP.DEXTDOC.createElement("form");a.id="dext5_saveFrm";a.name="dext5_saveFrm";a.method="post";var c=DEXTTOP.DEXTDOC.createElement("input");c.id="htmlstring";c.name="htmlstring";c.type="hidden";c.value=encodeURIComponent(d);var e=DEXTTOP.DEXTDOC.createElement("input");e.id="tosavepathurl";e.name="tosavepathurl";e.type="hidden";var f=DEXTTOP.DEXTDOC.createElement("input");f.id="savafoldernamerule";
f.name="savafoldernamerule";f.type="hidden";var t=DEXTTOP.DEXTDOC.createElement("input");t.id="saveHtmlName";t.name="saveHtmlName";t.type="hidden";if("0"!=b._config.security.encryptParam){e.value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(b._config.toSavePathURL);f.value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(b._config.saveFolderNameRule);t.value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(g);var q=DEXTTOP.DEXTDOC.createElement("input");q.id="pe";q.name="pe";q.value=b._config.security.encryptParam;q.type=
"hidden";a.appendChild(q)}else e.value=b._config.toSavePathURL,f.value=b._config.saveFolderNameRule,t.value=encodeURIComponent(g);a.action=""!=b._config.post_url_save_for_notes?b._config.post_url_save_for_notes:b._config.post_url;a.appendChild(c);a.appendChild(e);a.appendChild(f);a.appendChild(t);DEXTTOP.DEXTDOC.body.appendChild(a);null==DEXTTOP.DEXTDOC.getElementById("dext_saveframe")&&(c=DEXTTOP.DEXTDOC.createElement("iframe"),c.style.display="none",c.id="dext_saveframe",c.name="dext_saveframe",
DEXTTOP.DEXTDOC.body.appendChild(c));a.target="dext_saveframe";a.submit();DEXTTOP.DEXTDOC.body.removeChild(a)};c=function(b){if(b){var c=document.createElement("iframe");c.style.display="none";c.id="saveframe";document.body.appendChild(c);var d=c.contentWindow.document;c.onload=function(){setTimeout(function(){d.execCommand("SaveAs",!0,g);c.parentNode.removeChild(c);c=null},10)};d.open("text/html","replace");d.write(DEXTTOP.DEXT5.getHtmlValueExWithDocType(a));d.close()}else{b=document.createElement("a");
b.setAttribute("href","data:text/html;charset=utf-8,"+encodeURIComponent(DEXTTOP.DEXT5.getHtmlValueExWithDocType(a)));b.setAttribute("download",g);if(document.createEvent){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0);b.dispatchEvent(e)}else b.click();b=null}};DEXTTOP.DEXT5.browser.mobile?e():DEXTTOP.DEXT5.browser.safari?e():DEXTTOP.DEXT5.browser.ie?c(!0):c(!1)}}
function command_undo(a,b){dext_src_init(b._EDITOR.design);0<b.UndoManager.charCount&&(b.UndoManager.putUndo(),b.UndoManager.charCount=0);b.UndoManager.execUndo()}function command_redo(a,b){dext_src_init(b._EDITOR.design);b.UndoManager.execRedo();b.UndoManager.charCount=0}function command_fontsize(a,b,c){dext_src_init(b);a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontsize:c};restoreSelection();setFocusToBody();b=getFirstRange();DoExecuteCommand3(b.sel,b.range,"fontSize",a,c)}
function command_fontfamily(a,b,c){dext_src_init(b);a=changeFontFamily(c);b={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontfamily:a};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"fontFamily",b,a)}
function command_docBGColor(a,b,c){dext_src_init(b);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();_iframeDoc.body.style.background=c;DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_fontColor(a,b,c){dext_src_init(b);a=document.getElementById("dext_em_"+DEXTTOP.G_CURREDITOR.ID+"color_show");c?a.style.backgroundColor=c:c=a.style.backgroundColor;""==c&&(c="#000000");a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontcolor:c};restoreSelection();setFocusToBody();b=getFirstRange();DoExecuteCommand3(b.sel,b.range,"fontcolor",a,c)}
function command_fontBgColor(a,b,c){dext_src_init(b);a=document.getElementById("dext_em_"+DEXTTOP.G_CURREDITOR.ID+"bg_color_show");c?a.style.backgroundColor=c:c=a.style.backgroundColor;""==c&&(c="#ffffff");a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontcolor:c};restoreSelection();setFocusToBody();b=getFirstRange();DoExecuteCommand3(b.sel,b.range,"fontbgcolor",a,c)}
function command_lineHeight(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();a=getFirstRange();var d=a.range;try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endOffset),3==d.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer),3==d.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer.parentNode):
(DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer),1==d.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(d.endContainer.innerText||d.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.toString().length)}catch(e){DEXTTOP.G_CURREDITOR.beforeOffset=null}"2"==DEXTTOP.G_CURREDITOR._config.lineHeightMode&&-1<c.toString().indexOf("%")&&(c=parseInt(c,10)/100);if(void 0==d)DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&11>=DEXTTOP.DEXT5.browser.ieVersion&&c==DEXTTOP.G_CURREDITOR._setting.line_height&&
(c=parseInt(c,10)/100+.01),DoExecuteCommand3(a.sel,d,"lineheight",{document:_iframeDoc,styleWithCss:!0,lineheight:c},c);else{0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a="p span li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" ");var f=a.length,g,h,n=GetTableSelectionCells();if(0==n.length){if(null!=d.startContainer.previousSibling&&"HEAD"==d.startContainer.previousSibling.tagName&&null==d.endContainer.nextSibling){for(b=0;b<f;b++){g=_iframeDoc.body.getElementsByTagName(a[b]);
h=g.length;for(var m=0;m<h;m++)"span"==g[m].tagName.toLowerCase()?""!=g[m].style.lineHeight&&(g[m].style.lineHeight=c):g[m].style.lineHeight=c}f=_iframeDoc.body.getElementsByTagName("table");g=f.length;for(b=0;b<g;b++){h=f[b].rows;for(var p=h.length,m=0;m<p;m++)for(var n=h[m].cells,d=n.length,t=0;t<d;t++)setBlockTag(n[t].childNodes,a,"lineHeight",c)}setBlockTag(_iframeDoc.body.childNodes,a,"lineHeight",c);g=_iframeDoc.body.getElementsByTagName("div");h=g.length;for(m=0;m<h;m++)setBlockTag(g[m].childNodes,
a,"lineHeight",c)}else{g=getNodesInRange(d);h=g.length;0==d.toString().length&&0==d.getNodes().length&&d.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(n=0;n<h;n++)if(1==g[n].nodeType&&(t=g[n].tagName.toLowerCase(),-1<a.indexOf(t))){if("div"!=t)for(b=0;b<f;b++)for(var p=g[n].getElementsByTagName(a[b]),q=p.length,m=0;m<q;m++)"span"==p[m].tagName.toLowerCase()?""!=p[m].style.lineHeight&&(p[m].style.lineHeight=c):p[m].style.lineHeight=c;"span"==t?""!=g[n].style.lineHeight&&(g[n].style.lineHeight=
c):g[n].style.lineHeight=c}var u;0==d.toString().length&&1==d.getNodes().length&&(u=d.getNodes()[0],g.push(d.getNodes()[0]));setBlockTag(g,a,"lineHeight",c)}(c=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(c,1),c.parentNode.removeChild(c)):u&&(c=getFirstRange().range,getFirstRange().sel.removeAllRanges(),c.selectNode(u),getFirstRange().sel.addRange(c))}else for(d=n.length,b=0;b<d;b++){for(m=0;m<f;m++)for(g=n[b].getElementsByTagName(a[m]),h=g.length,t=0;t<h;t++)"span"==g[t].tagName.toLowerCase()?
""!=g[t].style.lineHeight&&(g[t].style.lineHeight=c):g[t].style.lineHeight=c;setBlockTag(n[b].childNodes,a,"lineHeight",c);g=n[b].getElementsByTagName("div");h=g.length;for(m=0;m<h;m++)setBlockTag(g[m].childNodes,a,"lineHeight",c)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}DEXTTOP.G_CURREDITOR.beforeOffset=null}
function command_InsertTablebyRowCol(a,b,c,d){dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();b=getFirstRange();a=b.range;try{0==a.toString().length&&setRestoreCaretPos(!1)}catch(e){}b=getCellDefValue();a=_iframeDoc.createElement("table");a.style.wordBreak="break-all";var f=0,g=getFirstRange().range,h=getMyElementNode(g.startContainer),n,g=getWidthForAutoBodyFit(DEXTTOP.G_CURREDITOR,"table");try{var m=GetParentbyTagName(h,"td");if(m){var p=getClientRect(m);
n=p.right-p.left}n&&50<n?(n-=10,f=Math.round(n/d),a.style.width=n+"px"):(f=Math.round(g/d),a.style.width=g+"px")}catch(t){f=Math.round(g/d),a.style.width=g+"px"}"1"==DEXTTOP.G_CURREDITOR._config.tableUseHeight&&(a.style.height=20*c+"px");""!=DEXTTOP.G_CURREDITOR._config.tableDefaultWidth&&(f=Math.round(DEXTTOP.G_CURREDITOR._config.tableDefaultWidth/d),a.style.width=DEXTTOP.G_CURREDITOR._config.tableDefaultWidth+"px");""!=DEXTTOP.G_CURREDITOR._config.tableDefaultHeight&&(a.style.height=DEXTTOP.G_CURREDITOR._config.tableDefaultHeight+
"px");""!=DEXTTOP.G_CURREDITOR._config.tableInitInoutdent&&(a.style.marginLeft=DEXTTOP.G_CURREDITOR._config.tableInitInoutdent+"px");n="";""!=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight?(n=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight+"px",a.style.height=parseInt(n,10)*c+"px"):n="20px";""!=DEXTTOP.G_CURREDITOR._config.tableDefaultClass?(a.className=DEXTTOP.G_CURREDITOR._config.tableDefaultClass,n="",a.style.height=""):a.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size;a.style.borderCollapse=
"collapse";"1"==DEXTTOP.G_CURREDITOR._config.useTableBorderAttribute&&a.setAttribute("border","1");m="";m=DEXTTOP.DEXT5.browser.gecko?"1px solid ":"1px none ";a.style.border=m+DEXTTOP.G_CURREDITOR._config.defaultBorderColor;a.setAttribute("cellSpacing","0");a.setAttribute("cellPadding","0");m=_iframeDoc.createElement("tbody");for(p=0;p<c;p++){g=_iframeDoc.createElement("tr");for(h=0;h<d;h++){var q=_iframeDoc.createElement("td");q.innerHTML=b;q.style.border="1px solid "+DEXTTOP.G_CURREDITOR._config.defaultBorderColor;
g.appendChild(q);q.style.width=f-1+"px";q.style.height=n}m.appendChild(g)}a.appendChild(m);g=getFirstRange().range;h=getMyElementNode(g.startContainer);"p"!=h.tagName.toLowerCase()||"<br>"!=h.innerHTML&&"<br/>"!=h.innerHTML&&"<br />"!=h.innerHTML&&""!=h.innerHTML&&"&nbsp;"!=h.innerHTML||g.selectNode(h);c=a.outerHTML;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,c),g=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(g)}else pasteHtmlAtCaretHuge(c);
b=getFirstRange();b.range.startContainer&&(a=GetParentbyTagName(b.range.startContainer,"table"));try{g.selectNode(a);var u=a.parentNode;"body"!=u.tagName.toLowerCase()&&g.setEndAfter(u);g.collapse(!1);DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion||(b=getFirstRange(),b.sel.addRange(g));DEXTTOP.DEXT5.browser.gecko&&doSetCaretPosition(u,1);repairBodyFirstLastTag(!1);var v=a.rows[0].cells[0];v&&(createTableCellDefValue(v),0==checkCellBRValue()&&0==(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion)&&
(v.innerHTML="<p></p>"),0!=DEXTTOP.DEXT5.browser.ie?doSetCaretPosition(v.childNodes[0],0):setTimeout(function(){doSetCaretPosition(v.childNodes[0],0)},10),DEXTTOP.G_SELECTED_ELEMENT=v.childNodes[0])}catch(w){}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");ActiveCurrTable=a;setRulerPositionForNode()}
function command_InsertDetailTable(a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y,x,z,A,B,G,D,I,K,E,N,H,J,M,L,F,C,W,V){dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var P=F=b=a=0,S=getFirstRange().range,fa=getMyElementNode(S.startContainer),ba,S=getWidthForAutoBodyFit(DEXTTOP.G_CURREDITOR,"table");if("3"!=c&&"4"!=c){a=d;b=e;if(""==f)try{var U=GetParentbyTagName(fa,"td");if(U){var ea=getClientRect(U);ba=ea.right-ea.left}F=ba&&50<ba?ba-10:S}catch(ga){F=S}else F=
"1"==DEXTTOP.G_CURREDITOR._config.autoBodyFit?f>S?S:f:f;""!=g&&(P=g)}else if("3"==c){a=D;b=I;if(""==K)try{if(U=GetParentbyTagName(fa,"td"))ea=getClientRect(U),ba=ea.right-ea.left;F=ba&&50<ba?ba-10:DEXTTOP.G_CURREDITOR._defTableWidth}catch(aa){F=DEXTTOP.G_CURREDITOR._defTableWidth}else F=K;""!=E&&(P=E)}d=getFirstRange();d=d.range;try{0==d.toString().length&&setRestoreCaretPos(!1)}catch(X){}if("4"!=c){W=Math.floor(F/b*100)/100;d=Math.floor(P/a*100)/100;0==d&&(d=""!=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight?
parseInt(DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight,10):20);e=getCellDefValue();C=_iframeDoc.createElement("table");C.style.wordBreak="break-all";null!=L&&""!=L&&(C.id=L);null!=M&&""!=M?(C.className=M,d=""):null==M&&""!=DEXTTOP.G_CURREDITOR._config.tableDefaultClass?(C.className=DEXTTOP.G_CURREDITOR._config.tableDefaultClass,d=""):C.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size;C.style.width=F+"px";if("3"!=c){""!=g&&(C.style.height=P+"px");"Y"==h?C.style.borderCollapse="separate":
"N"==h&&(C.style.borderCollapse="collapse");""==n||"left"==n&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO||(C.align=n);"N"==h?C.style.border=DEXTTOP.DEXT5.browser.gecko?"1px #000000":"1px none #000000":"Y"==h&&(""!=m.outsideTop&&(C.style.borderTop=m.outsideTop,showBorderForNoneClass(C,"dext_table_border_t")),""!=m.outsideLeft&&(C.style.borderLeft=m.outsideLeft,showBorderForNoneClass(C,"dext_table_border_l")),""!=m.outsideRight&&(C.style.borderRight=m.outsideRight,showBorderForNoneClass(C,
"dext_table_border_r")),""!=m.outsideBottom&&(C.style.borderBottom=m.outsideBottom,showBorderForNoneClass(C,"dext_table_border_b")));"1"==DEXTTOP.G_CURREDITOR._config.useTableBorderAttribute&&C.setAttribute("border","1");""!=p&&C.setAttribute("cellSpacing",p);""!=t&&C.setAttribute("cellPadding",t);""!=u&&C.setAttribute("summary",u);if(""!=v){"[FAIL]"==v.substring(0,6)?(C.setAttribute("alt",v.substring(6,v.length)),v=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"):insertImageSrc(DEXTTOP.G_CURREDITOR,
v);C.style.backgroundImage="url("+v+")";""!=w&&(C.style.backgroundAttachment=w);""!=y&&(C.style.backgroundRepeat=y);if(""!=x||""!=z)C.style.backgroundPosition=parseInt(x,10)+"px "+parseInt(z,10)+"px";if(V&&1<V.length)for(n=V.length,g=1;g<n;g++)p=V[g].split("^"),2==p.length&&C.setAttribute(p[0],p[1])}""!=A&&(C.style.backgroundColor=A)}else""!=E&&"1"==DEXTTOP.G_CURREDITOR._config.tableUseHeight&&(C.style.height=P+"px"),"1"==H?(m.outsideTop="3px solid rgb(0, 216, 255)",m.outsideLeft="0px rgb(0, 0, 0)",
m.outsideRight="0px rgb(0, 0, 0)",m.outsideBottom="3px solid rgb(0, 216, 255)",m.insideRow="1px solid rgb(0, 0, 0)",m.insideCol="1px solid rgb(0, 0, 0)",C.style.borderCollapse="collapse",C.style.fontSize="10pt",C.setAttribute("cellSpacing","0"),C.setAttribute("cellPadding","3")):"2"==H?(C.style.borderWidth="1px",C.style.borderStyle="solid",C.style.borderColor="#000000",C.style.fontSize="10pt",C.style.borderCollapse="collapse",C.setAttribute("border","1"),C.setAttribute("cellSpacing","0")):"3"==H?
(C.style.borderWidth="1px",C.style.borderStyle="dashed",C.style.borderColor="#000000",C.style.fontSize="10pt",C.style.borderCollapse="collapse",C.setAttribute("border","1"),C.setAttribute("cellSpacing","0")):"4"==H?(C.style.borderWidth="1px",C.style.borderStyle="solid",C.style.borderColor="#000000",C.style.fontSize="10pt",C.style.borderCollapse="collapse",C.setAttribute("border","1"),C.setAttribute("cellSpacing","0")):"5"==H?(C.style.borderWidth="1px",C.style.borderStyle="solid",C.style.borderColor=
"#000000",C.style.fontSize="10pt",C.style.borderCollapse="collapse",C.setAttribute("border","1"),C.setAttribute("cellSpacing","0")):"6"==H?(C.style.borderWidth="1px",C.style.borderStyle="solid",C.style.borderColor="#000000",C.style.fontSize="10pt",C.style.borderCollapse="collapse",C.setAttribute("border","1"),C.setAttribute("cellSpacing","0")):"7"==H?(C.style.borderWidth="medium",C.style.borderStyle="solid",C.style.borderColor="#000000",C.style.fontSize="10pt",C.setAttribute("rules","none"),C.setAttribute("cellSpacing",
"0")):"8"==H?(C.style.borderWidth="1px",C.style.borderStyle="solid",C.style.borderColor="#000000",C.style.fontSize="10pt",C.style.borderCollapse="collapse",C.setAttribute("border","1"),C.setAttribute("cellSpacing","0")):"9"==H?(C.style.borderWidth="1px",C.style.borderStyle="solid",C.style.borderColor="#000000",C.style.fontSize="10pt",C.style.borderCollapse="collapse",C.setAttribute("border","1"),C.setAttribute("cellSpacing","0")):"10"==H?(C.style.borderWidth="1px",C.style.borderStyle="solid",C.style.borderColor=
"#000000",C.style.fontSize="10pt",C.style.borderCollapse="collapse",C.setAttribute("border","1")):"11"==H?(C.style.borderStyle="hidden",C.style.borderColor="#ffffff",C.style.fontSize="10pt",C.setAttribute("border","1"),C.setAttribute("rules","none"),C.setAttribute("frame","void"),C.setAttribute("cellSpacing","0")):"12"==H&&(C.style.borderWidth="1px",C.style.borderStyle="solid",C.style.borderColor="#000000",C.style.fontSize="10pt",C.style.borderCollapse="collapse",C.setAttribute("border","1"),C.setAttribute("rules",
"rows"),C.setAttribute("cellSpacing","0"));0<J&&(C.style.marginLeft=J+"px");A=_iframeDoc.createElement("tbody");for(J=0;J<a;J++){V=_iframeDoc.createElement("tr");for(g=0;g<b;g++){if("3"!=c)"2"==G?0==g?(n=_iframeDoc.createElement("th"),"Y"==B&&(n.scope="row")):n=_iframeDoc.createElement("td"):"3"==G?0==J?(n=_iframeDoc.createElement("th"),"Y"==B&&(n.scope="col")):n=_iframeDoc.createElement("td"):"4"==G?0==g||0==J?(n=_iframeDoc.createElement("th"),"Y"!=B||0==g&&0==J||(0==g&&(n.scope="row"),0==J&&(n.scope=
"col"))):n=_iframeDoc.createElement("td"):n=_iframeDoc.createElement("td"),n.innerHTML=e;else{if("5"==H&&0!=g&&0==J)continue;"1"==H||"2"==H||"5"==H||"10"==H||"11"==H||"12"==H?0==J?(n=_iframeDoc.createElement("th"),"Y"==N&&(n.scope="col")):n=_iframeDoc.createElement("td"):"6"==H?0==J||0==g?(n=_iframeDoc.createElement("th"),"Y"!=N||0==g&&0==J||(0==g&&(n.scope="row"),0==J&&(n.scope="col"))):n=_iframeDoc.createElement("td"):"8"==H?0==g?(n=_iframeDoc.createElement("th"),"Y"==N&&(n.scope="row")):n=_iframeDoc.createElement("td"):
n=_iframeDoc.createElement("td");"1"==H?0==J?(p=_iframeDoc.createElement("p"),p.innerHTML="T"+(g+1),n.appendChild(p)):n.innerHTML=e:n.innerHTML=e}V.appendChild(n);"3"==c&&"1"!=H?"4"==H?(n.style.borderWidth="1px",n.style.borderStyle="dashed",n.style.borderColor="#000000"):"5"==H?0==g&&0==J&&n.setAttribute("colSpan",b):"6"==H?0==J?0!=g&&(n.style.backgroundColor="#e5e5e5"):0==g&&(n.style.backgroundColor="#e9f5f7"):"8"==H&&0==g&&(n.style.backgroundColor="#e9f5f7"):("3"==c&&"1"==H&&0==J&&(n.style.textAlign=
"center"),n.style.border="1px solid #000000","N"==h&&(0==J&&""!=m.outsideTop&&(n.style.borderTop=m.outsideTop,showBorderForNoneClass(n,"dext_table_border_t")),0==g&&""!=m.outsideLeft&&(n.style.borderLeft=m.outsideLeft,showBorderForNoneClass(n,"dext_table_border_l")),g==b-1&&""!=m.outsideRight&&(n.style.borderRight=m.outsideRight,showBorderForNoneClass(n,"dext_table_border_r")),J==a-1&&""!=m.outsideBottom&&(n.style.borderBottom=m.outsideBottom,showBorderForNoneClass(n,"dext_table_border_b"))));""!=
W&&(n.style.width=W-1+"px");""!=d&&(n.style.height=d+"px")}A.appendChild(V);"3"==c&&("2"==H?0==J&&(V.style.backgroundColor="#e5e5e5"):"5"==H?0==J&&(V.style.backgroundColor="#e5e5e5"):"9"==H?V.style.backgroundColor=0==J%2?"#e5e5e5":"#e9f5f7":"10"==H?0==J?V.style.backgroundColor="#e5e5e5":J==parseInt(a,10)-1&&(V.style.backgroundColor="#e9f5f7"):"11"==H?0==J&&(V.style.backgroundColor="#e5e5e5"):"12"==H&&0==J&&(V.style.backgroundColor="#e5e5e5"))}""!=q&&(h=_iframeDoc.createElement("caption"),h.innerHTML=
q,C.appendChild(h));C.appendChild(A);("3"!=c||"3"==c&&"1"==H)&&setBorderTableAndAllCell(C,m);m=C}else m="TableTemplateList",0==DEXTTOP.DEXT5.util.xml.count(W,m)&&(m="TableTempleteList"),m=DEXTTOP.DEXT5.util.xml.getNodeIdx(W,m,parseInt(C,10)-1),m=DEXTTOP.DEXT5.util.xml.getNode(m,"SetSource").textContent||DEXTTOP.DEXT5.util.xml.getNode(m,"SetSource").text,m=DEXTTOP.DEXT5.util.replaceAll(m,"\r\n",""),m=DEXTTOP.DEXT5.util.replaceAll(m,"\r",""),m=DEXTTOP.DEXT5.util.replaceAll(m,"\n",""),m=DEXTTOP.DEXT5.util.replaceAll(m,
"\t",""),m=m.replace(/^\s+/,"").replace(/\s+$/,""),q=_iframeDoc.createElement("div"),q.innerHTML=m,m=q.childNodes[0],delete q;S=getFirstRange().range;fa=getMyElementNode(S.startContainer);"p"!=fa.tagName.toLowerCase()||"<br>"!=fa.innerHTML&&"<br/>"!=fa.innerHTML&&"<br />"!=fa.innerHTML&&""!=fa.innerHTML&&"&nbsp;"!=fa.innerHTML||S.selectNode(fa);S.deleteContents();q=m.outerHTML;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,q),S=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),
rangy.getSelection(_iframeWin).addRange(S)}else pasteHtmlAtCaretHuge(q);d=getFirstRange();d.range.startContainer&&(m=GetParentbyTagName(d.range.startContainer,"table"));try{S.selectNode(m);var ka=m.parentNode;"body"!=ka.tagName.toLowerCase()&&S.setEndAfter(ka);S.collapse(!1);DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion||(d=getFirstRange(),d.sel.addRange(S));DEXTTOP.DEXT5.browser.gecko&&doSetCaretPosition(ka,1);repairBodyFirstLastTag(!1);var O=m.rows[0].cells[0];O&&("4"!=c&&createTableCellDefValue(O),
0==checkCellBRValue()&&""==O.innerHTML&&(O.innerHTML="<p></p>"),doSetCaretPosition(O.childNodes[0],0))}catch(Q){}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");ActiveCurrTable=m;setRulerPositionForNode()}
function command_InsertTableProperty(a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y,x,z,A,B,G,D,I,K){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var E=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");null==D||""==D?removeAttribute(E,"id"):""!=D&&(E.id=D);E.style.wordBreak="break-all";""==G?(removeAttribute(E,"class"),E.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size):null!=G&&(E.className=G,E.style.fontSize=
"");""!=c&&(E.style.width=c+"px");""!=d&&"1"==DEXTTOP.G_CURREDITOR._config.tableUseHeight&&(E.style.height=d+"px");"N"==e?E.style.borderCollapse="collapse":"Y"==e&&(E.style.borderCollapse="separate");E.align=""==f||"left"==f&&"2"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO?"":f;E.style.marginLeft=0<B?B+"px":"";"N"==e?E.style.border=DEXTTOP.DEXT5.browser.gecko?"1px #000000":"1px none #000000":"Y"==e&&(""!=g.outsideTop&&(E.style.borderTop=g.outsideTop,showBorderForNoneClass(E,"dext_table_border_t")),
""!=g.outsideLeft&&(E.style.borderLeft=g.outsideLeft,showBorderForNoneClass(E,"dext_table_border_l")),""!=g.outsideRight&&(E.style.borderRight=g.outsideRight,showBorderForNoneClass(E,"dext_table_border_r")),""!=g.outsideBottom&&(E.style.borderBottom=g.outsideBottom,showBorderForNoneClass(E,"dext_table_border_b")));""!=h&&E.setAttribute("cellSpacing",h);""!=n&&E.setAttribute("cellPadding",n);b=!1;c=0;d=E.childNodes.length;for(a=0;a<d;a++)if(E.childNodes[a].nodeName.match(/caption/i)){b=!0;c=a;break}""==
m?b&&E.removeChild(E.childNodes[c]):b?E.childNodes[c].innerHTML=m:(a=_iframeDoc.createElement("caption"),a.innerHTML=m,E.appendChild(a));""!=p&&E.setAttribute("summary",p);if("Y"==t)E.style.backgroundImage="",E.style.backgroundAttachment="",E.style.backgroundRepeat="",E.style.backgroundPosition="",E.style.backgroundColor="",E.removeAttribute("background");else if("N"==t){if(""!=q){"[FAIL]"==q.substring(0,6)&&(E.setAttribute("alt",q.substring(6,q.length)),q=DEXTTOP.G_CURREDITOR._config.webPath.image+
"dialog/image_xbox.jpg");0==q.indexOf("url")?E.style.backgroundImage=q:E.style.backgroundImage="url("+q+")";E.removeAttribute("background");E.style.backgroundAttachment=""==u?"":u;E.style.backgroundRepeat=""==v?"":v;if(""!=w||""!=y)E.style.backgroundPosition=parseInt(w,10)+"px "+parseInt(y,10)+"px";if(K&&1<K.length)for(m=K.length,a=1;a<m;a++)p=K[a].split("^"),2==p.length&&E.setAttribute(p[0],p[1])}if(""!=x)for(E.style.backgroundColor=x,K=E.rows,m=E.rows.length,a=0;a<m;a++)for(p=K[a].cells,t=K[a].cells.length,
x=0;x<t;x++)""!=p[x].style.backgroundColor&&(p[x].style.backgroundColor="")}x=GetTableSelectionCellsPosition(E,!0);K=x.arrOutSideLeft.length;m=x.arrOutSideRight.length;p=x.arrOutSideTop.length;t=x.arrOutSideBottom.length;q=x.arrSelected.length;u=[];v=[];w=[];y=[];b="";if(""==g.outsideLeft)for(a=0;a<K;a++)b=x.arrOutSideLeft[a].style.borderLeftWidth+" "+x.arrOutSideLeft[a].style.borderLeftStyle+" "+x.arrOutSideLeft[a].style.borderLeftColor,u.push(b);if(""==g.outsideRight)for(a=0;a<m;a++)b=x.arrOutSideRight[a].style.borderRightWidth+
" "+x.arrOutSideRight[a].style.borderRightStyle+" "+x.arrOutSideRight[a].style.borderRightColor,v.push(b);if(""==g.outsideTop)for(a=0;a<p;a++)b=x.arrOutSideTop[a].style.borderTopWidth+" "+x.arrOutSideTop[a].style.borderTopStyle+" "+x.arrOutSideTop[a].style.borderTopColor,w.push(b);if(""==g.outsideBottom)for(a=0;a<t;a++)b=x.arrOutSideBottom[a].style.borderBottomWidth+" "+x.arrOutSideBottom[a].style.borderBottomStyle+" "+x.arrOutSideBottom[a].style.borderBottomColor,y.push(b);if(""!=g.insideRow)for(a=
0;a<q;a++)command_ApplyCellProperty("inRow",x.arrSelected[a],g);if(""!=g.insideCol)for(a=0;a<q;a++)command_ApplyCellProperty("inCol",x.arrSelected[a],g);if(""==g.outsideLeft)for(a=0;a<K;a++)g.outsideLeft=u[a],command_ApplyCellProperty("left",x.arrOutSideLeft[a],g);else for(a=0;a<K;a++)command_ApplyCellProperty("left",x.arrOutSideLeft[a],g);if(""==g.outsideRight)for(a=0;a<m;a++)g.outsideRight=v[a],command_ApplyCellProperty("right",x.arrOutSideRight[a],g);else for(a=0;a<m;a++)command_ApplyCellProperty("right",
x.arrOutSideRight[a],g);if(""==g.outsideTop)for(a=0;a<p;a++)g.outsideTop=w[a],command_ApplyCellProperty("top",x.arrOutSideTop[a],g);else for(a=0;a<p;a++)command_ApplyCellProperty("top",x.arrOutSideTop[a],g);if(""==g.outsideBottom)for(a=0;a<t;a++)g.outsideBottom=y[a],command_ApplyCellProperty("bottom",x.arrOutSideBottom[a],g);else for(a=0;a<t;a++)command_ApplyCellProperty("bottom",x.arrOutSideBottom[a],g);g=E.rows.length;for(a=K=0;a<g;a++)for(K=E.rows[a].cells.length,x=0;x<K;x++){"2"==A?0==x?(m=_iframeDoc.createElement("th"),
setCopyAllObjectAtributes(E.rows[a].cells[x],m,!0),"Y"==z&&(m.scope="row")):(m=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(E.rows[a].cells[x],m,!0)):"3"==A?0==a?(m=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(E.rows[a].cells[x],m,!0),"Y"==z&&(m.scope="col")):(m=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(E.rows[a].cells[x],m,!0)):"4"==A?0==a||0==x?(m=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(E.rows[a].cells[x],m,!0),"Y"==z&&(0!=a||0!=x?(0==a&&(m.scope=
"col"),0==x&&(m.scope="row")):m.scope="")):(m=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(E.rows[a].cells[x],m,!0)):(m=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(E.rows[a].cells[x],m,!0));"N"==z&&(m.scope="");""!=E.rows[a].cells[x].id&&(m.id=E.rows[a].cells[x].id);"1"!=E.rows[a].cells[x].colSpan&&(m.colSpan=E.rows[a].cells[x].colSpan);"1"!=E.rows[a].cells[x].rowSpan&&(m.rowSpan=E.rows[a].cells[x].rowSpan);""!=E.rows[a].cells[x].style.width&&(m.style.width=E.rows[a].cells[x].style.width);
""!=E.rows[a].cells[x].style.height&&(m.style.height=E.rows[a].cells[x].style.height);""!=E.rows[a].cells[x].style.textAlign&&(m.style.textAlign=E.rows[a].cells[x].style.textAlign);""!=E.rows[a].cells[x].style.verticalAlign&&(removeAttribute(E.rows[a].cells[x],"valign"),m.style.verticalAlign=E.rows[a].cells[x].style.verticalAlign);"nowrap"==E.rows[a].cells[x].style.whiteSpace&&(m.style.whiteSpace="nowrap");""!=E.rows[a].cells[x].style.backgroundImage&&(m.style.backgroundImage=E.rows[a].cells[x].style.backgroundImage);
""!=E.rows[a].cells[x].style.backgroundAttachment&&(m.style.backgroundAttachment=E.rows[a].cells[x].style.backgroundAttachment);""!=E.rows[a].cells[x].style.backgroundRepeat&&(m.style.backgroundRepeat=E.rows[a].cells[x].style.backgroundRepeat);""!=E.rows[a].cells[x].style.backgroundPosition&&(m.style.backgroundPosition=E.rows[a].cells[x].style.backgroundPosition);""!=E.rows[a].cells[x].style.backgroundColor&&(m.style.backgroundColor=E.rows[a].cells[x].style.backgroundColor);p=[];t=[];try{if(DEXTTOP.DEXT5.browser.ie&&
8>DEXTTOP.DEXT5.browser.ieVersion){p=E.rows[a].cells[x].getElementsByTagName("a");for(var N=p.length,H=0;H<N;H++)p[H].outerHTML.match(RegExp("(hrefs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),t.push(RegExp.$2)}}catch(J){p=[],t=[]}m.innerHTML=E.rows[a].cells[x].innerHTML;try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion&&(N=p.length,0<N))for(var M=m.getElementsByTagName("a"),L=M.length,H=0;H<L;H++)M[H].href&&0>M[H].href.toLowerCase().indexOf("javascript")&&0>M[H].href.indexOf("'")&&0>M[H].href.indexOf('"')&&
""!=t[H]&&M[H].href!=t[H]&&(M[H].href=t[H],M[H].setAttribute("href",t[H]))}catch(F){m.innerHTML=E.rows[a].cells[x].innerHTML}E.rows[a].cells[x].parentNode.replaceChild(m,E.rows[a].cells[x])}setAdjustTableWidthHeight(E);ClearDraggingTableCellSelected();0<E.rows[0].cells[0].childNodes.length?setTimeout(function(){doSetCaretPosition(E.rows[0].cells[0].childNodes[0],0)},0):setTimeout(function(){doSetCaretPosition(E.rows[0].cells[0],0)},0);DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertCellProperty(a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y,x,z,A){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");var B="";"collapse"==a.style.borderCollapse?B="N":"separate"==a.style.borderCollapse&&(B="Y");b=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);b=GetTableSelectionCellsPosition(b,!1);ClearDraggingTableCellSelected();var G=b.arrOutSideLeft.length,
D=b.arrOutSideRight.length,I=b.arrOutSideTop.length,K=b.arrOutSideBottom.length,E=b.arrSelected.length,N=[],H=[],J=[],M=[],L="";if(""==h.outsideLeft)for(var F=0;F<G;F++)L=b.arrOutSideLeft[F].style.borderLeftWidth+" "+b.arrOutSideLeft[F].style.borderLeftStyle+" "+b.arrOutSideLeft[F].style.borderLeftColor,N.push(L);if(""==h.outsideRight)for(F=0;F<D;F++)L=b.arrOutSideRight[F].style.borderRightWidth+" "+b.arrOutSideRight[F].style.borderRightStyle+" "+b.arrOutSideRight[F].style.borderRightColor,H.push(L);
if(""==h.outsideTop)for(F=0;F<I;F++)L=b.arrOutSideTop[F].style.borderTopWidth+" "+b.arrOutSideTop[F].style.borderTopStyle+" "+b.arrOutSideTop[F].style.borderTopColor,J.push(L);if(""==h.outsideBottom)for(F=0;F<K;F++)L=b.arrOutSideBottom[F].style.borderBottomWidth+" "+b.arrOutSideBottom[F].style.borderBottomStyle+" "+b.arrOutSideBottom[F].style.borderBottomColor,M.push(L);if(""!=h.insideRow)for(F=0;F<E;F++)command_ApplyCellProperty("inRow",b.arrSelected[F],h,c,d,f,g,n,m,p,t,q,u,v,w,y,x);else for(F=
0;F<E;F++)command_ApplyCellProperty("inRow",b.arrSelected[F],null,c,d,f,g,n,m,p,t,q,u,v,w,y,x);if(""!=h.insideCol)for(F=0;F<E;F++)command_ApplyCellProperty("inCol",b.arrSelected[F],h,c,d,f,g,n,m,p,t,q,u,v,w,y,x);else for(F=0;F<E;F++)command_ApplyCellProperty("inCol",b.arrSelected[F],null,c,d,f,g,n,m,p,t,q,u,v,w,y,x);if(""==h.outsideLeft)for(F=0;F<G;F++)h.outsideLeft=N[F],command_ApplyCellProperty("left",b.arrOutSideLeft[F],h,c,d,f,g,n,m,p,t,q,u,v,w,y,x);else for(F=0;F<G;F++)"N"==B&&(N=getCellNearLeftTop(b.arrOutSideLeft[F]),
command_ApplyEdgeReduce(N.arrLeft,h,"left")),command_ApplyCellProperty("left",b.arrOutSideLeft[F],h,c,d,f,g,n,m,p,t,q,u,v,w,y,x);if(""==h.outsideRight)for(F=0;F<D;F++)h.outsideRight=H[F],command_ApplyCellProperty("right",b.arrOutSideRight[F],h,c,d,f,g,n,m,p,t,q,u,v,w,y,x);else for(F=0;F<D;F++)"N"==B&&(N=getCellNearLeftTop(b.arrOutSideRight[F]),command_ApplyEdgeReduce(N.arrRight,h,"right")),command_ApplyCellProperty("right",b.arrOutSideRight[F],h,c,d,f,g,n,m,p,t,q,u,v,w,y,x);if(""==h.outsideTop)for(F=
0;F<I;F++)h.outsideTop=J[F],command_ApplyCellProperty("top",b.arrOutSideTop[F],h,c,d,f,g,n,m,p,t,q,u,v,w,y,x);else for(F=0;F<I;F++)"N"==B&&(N=getCellNearLeftTop(b.arrOutSideTop[F]),command_ApplyEdgeReduce(N.arrTop,h,"top")),command_ApplyCellProperty("top",b.arrOutSideTop[F],h,c,d,f,g,n,m,p,t,q,u,v,w,y,x);if(""==h.outsideBottom)for(F=0;F<K;F++)h.outsideBottom=M[F],command_ApplyCellProperty("bottom",b.arrOutSideBottom[F],h,c,d,f,g,n,m,p,t,q,u,v,w,y,x);else for(F=0;F<K;F++)"N"==B&&(N=getCellNearLeftTop(b.arrOutSideBottom[F]),
command_ApplyEdgeReduce(N.arrBottom,h,"bottom")),command_ApplyCellProperty("bottom",b.arrOutSideBottom[F],h,c,d,f,g,n,m,p,t,q,u,v,w,y,x);if(null!=e)if(0<E)for(F=0;F<E;F++)command_ApplyTitleCell(b.arrSelected[F],e);else command_ApplyTitleCell(DEXTTOP.G_SELECTED_ELEMENT,e);if(""!=z||""!=A){c=[];0<b.arrSelected.length?c=b.arrSelected:c.push(DEXTTOP.G_SELECTED_ELEMENT);f=c.length;d=[];for(F=0;F<f;F++){var C=c[F];""!=z&&(z=DEXTTOP.DEXT5.util.parseIntOr0(z),e=getClientRect(C),h=DEXTTOP.DEXT5.util.parseIntOr0(e.right-
e.left),d.push(h));""!=A&&(C.style.height=A+"px")}if(""!=z){for(F=0;F<f;F++)C=c[F],A=1,1<C.colSpan&&1<b.arrSelected.length&&(A=C.colSpan),C.style.width=z*A+"px";A=[0];for(F=1;F<f;F++){g=A.length;h=!1;C=c[F];e=getClientRect(C);for(n=0;n<g;n++)if(m=getClientRect(c[A[n]]),e.left>=m.left&&e.right<=m.right){h=!0;break}0==h&&A.push(F)}f=!1;g=A.length;for(F=0;F<g;F++)if(C=c[A[F]],e=getClientRect(C),e=DEXTTOP.DEXT5.util.parseIntOr0(e.right-e.left),h=d[A[F]],e!=h){f=!0;break}if(f){d=c[0].parentNode.cells;
f=d.length;for(F=g=0;F<f;F++)c[0]==d[F]?(A=1,1<C.colSpan&&1<b.arrSelected.length&&(A=C.colSpan),e=z*A):""!=d[F].style.width&&d[F].style.width.indexOf("px")?e=DEXTTOP.DEXT5.util.parseIntOr0(d[F].style.width):(e=getClientRect(d[F]),e=e.right-e.left),g+=e;a.style.width=g+1+"px";setRulerPositionForNode()}}}0<DEXTTOP.G_SELECTED_ELEMENT.childNodes.length?doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT.childNodes[0],0):doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,0);DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_ApplyTitleCell(a,b){var c=a.tagName.toLowerCase(),d="",e;"Y"==b?(d="th",e=_iframeDoc.createElement("th")):"N"==b?(d="td",e=_iframeDoc.createElement("td")):(e=_iframeDoc.createElement(a.tagName.toLowerCase()),d=a.tagName.toLowerCase());c!=d&&(setCopyAllObjectAtributes(a,e,!0),e.innerHTML=a.innerHTML,e.style.width=a.style.width,e.style.height=a.style.height,1<a.colSpan&&(e.colSpan=a.colSpan),1<a.rowSpan&&(e.rowSpan=a.rowSpan));c!=d&&a.parentNode.replaceChild(e,a)}
function command_ApplyCellProperty(a,b,c,d,e,f,g,h,n,m,p,t,q,u,v,w,y){""==v?removeAttribute(b,"class"):null!=v&&(b.className=v);""==w?removeAttribute(b,"id"):null!=w&&(b.id=w);""==d?b.style.textAlign="":null!=d&&(b.style.textAlign=d);""==e?b.style.verticalAlign="":null!=e&&(removeAttribute(b,"valign"),b.style.verticalAlign=e);null!=f&&(""==f?b.removeAttribute("scope"):b.scope=f);null!=g&&("Y"==g?b.style.whiteSpace="nowrap":"N"==g&&"nowrap"==b.style.whiteSpace&&(b.style.whiteSpace=""));c&&((d=RegExp("^\\s\\s*$",
"g"),"top"==a)?c.outsideTop.match(d)?""!=b.style.borderTop&&(b.style.borderTop="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_t")):(b.style.borderTop=c.outsideTop,showBorderForNoneClass(b,"dext_table_border_t")):"bottom"==a?c.outsideBottom.match(d)?""!=b.style.borderBottom&&(b.style.borderBottom="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_b")):(b.style.borderBottom=c.outsideBottom,showBorderForNoneClass(b,"dext_table_border_b")):"left"==a?c.outsideLeft.match(d)?
""!=b.style.borderLeft&&(b.style.borderLeft="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_l")):(b.style.borderLeft=c.outsideLeft,showBorderForNoneClass(b,"dext_table_border_l")):"right"==a?c.outsideRight.match(d)?""!=b.style.borderRight&&(b.style.borderRight="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_r")):(b.style.borderRight=c.outsideRight,showBorderForNoneClass(b,"dext_table_border_r")):"inRow"==a?c.insideRow.match(d)?(""!=b.style.borderTop&&(b.style.borderTop=
"1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_t")),""!=b.style.borderBottom&&(b.style.borderBottom="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_b"))):(b.style.borderTop=c.insideRow,b.style.borderBottom=c.insideRow,showBorderForNoneClass(b,"dext_table_border_t"),showBorderForNoneClass(b,"dext_table_border_b")):"inCol"==a&&(c.insideCol.match(d)?(""!=b.style.borderLeft&&(b.style.borderLeft="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_l")),
""!=b.style.borderRight&&(b.style.borderRight="1px solid rgb(0, 0, 0)",showBorderForNoneClass(b,"dext_table_border_r"))):(b.style.borderLeft=c.insideCol,b.style.borderRight=c.insideCol,showBorderForNoneClass(b,"dext_table_border_l"),showBorderForNoneClass(b,"dext_table_border_r"))));if("Y"==h)b.style.backgroundImage="",b.style.backgroundAttachment="",b.style.backgroundRepeat="",b.style.backgroundPosition="",b.style.backgroundColor="",b.removeAttribute("cellOrgBgColor"),b.removeAttribute("background");
else if("N"==h){""!=n&&("[FAIL]"==n.substring(0,6)&&(b.setAttribute("alt",n.substring(6,n.length)),n=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),0==n.indexOf("url")?b.style.backgroundImage=n:b.style.backgroundImage="url("+n+")",b.removeAttribute("background"));if(y&&1<y.length)for(a=y.length,c=1;c<a;c++)h=y[c].split("^"),2==h.length&&b.setAttribute(h[0],h[1]);""==m?b.style.backgroundAttachment="":null!=m&&(b.style.backgroundAttachment=m);""==p?b.style.backgroundRepeat="":null!=
p&&(b.style.backgroundRepeat=p);m=b.style.backgroundPosition;p=["0px","0px"];""!=m&&(p=m.split(" "));if(""!=t&&""!=q)b.style.backgroundPosition=parseInt(t,10)+"px "+parseInt(q,10)+"px";else if(""!=t||""!=q)""!=t&&""==q?b.style.backgroundPosition=parseInt(t,10)+"px "+p[1]:""==t&&""!=q&&(b.style.backgroundPosition=p[0]+" "+parseInt(q,10)+"px");""!=u&&(b.style.backgroundColor=u)}}
function command_ApplyEdgeReduce(a,b,c){if(a){var d=a.length;if("top"==c)for(var e=0;e<d;e++)a[e].style.borderBottom=b.outsideTop;if("left"==c)for(e=0;e<d;e++)a[e].style.borderRight=b.outsideLeft;if("right"==c)for(e=0;e<d;e++)a[e].style.borderLeft=b.outsideRight;if("bottom"==c)for(e=0;e<d;e++)a[e].style.borderTop=b.outsideBottom}}
function command_InsertRowColumn(a,b,c,d,e){dext_src_init(b);restoreSelection();setFocusToBody();"R"==c&&"U"==d?command_insertRowUp(a,_dext_editor,e):"R"==c&&"D"==d?command_insertRowDown(a,_dext_editor,e):"C"==c&&"R"==d?command_insertCellRight(a,_dext_editor,e):"C"==c&&"L"==d&&command_insertCellLeft(a,_dext_editor,e)}
function command_RowProperty(a,b,c,d,e,f){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);setTableRowSelect(a);a=getCellNearLeftTop(a);b=a.arrSelected.length;for(var g=0;g<b;g++)""!=d&&(a.arrSelected[g].style.height=d+"px"),a.arrSelected[g].style.textAlign=""==e?"":e,a.arrSelected[g].style.verticalAlign=""==f?"":f,""!=c&&a.arrSelected[g].setAttribute("cellOrgBgColor",
c);ActiveCurrTable.setAttribute("DEXT5CellSelected","DEXT5CellSelected");ClearDraggingTableCellSelected();a&&0<a.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_ColumnProperty(a,b,c,d,e,f,g){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);setTableColumnSelect(a);a=getCellNearLeftTop(a);b=a.arrSelected.length;for(g=0;g<b;g++)""!=d&&(a.arrSelected[g].style.width=d+"px"),a.arrSelected[g].style.textAlign=""==e?"":e,a.arrSelected[g].style.verticalAlign=""==f?"":f,""!=c&&a.arrSelected[g].setAttribute("cellOrgBgColor",
c);ActiveCurrTable.setAttribute("DEXT5CellSelected","DEXT5CellSelected");ClearDraggingTableCellSelected();a&&a.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_InsertCellBorder(a,b,c,d,e,f){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");var g="";"collapse"==a.style.borderCollapse?g="N":"separate"==a.style.borderCollapse&&(g="Y");a=!1;b=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);b=getCellNearLeftTop(b);for(var h=b.arrSelected.length,n=0;n<h;n++)a=b.arrSelected[n],""!=c&&(a.style.borderTop=c),
""!=d&&(a.style.borderLeft=d),""!=e&&(a.style.borderRight=e),""!=f&&(a.style.borderBottom=f),a=!0;if("N"==g){if(""!=c)for(g=b.arrTop.length,n=0;n<g;n++)b.arrTop[n].style.borderBottom=c,a=!0;if(""!=d)for(c=b.arrLeft.length,n=0;n<c;n++)b.arrLeft[n].style.borderRight=d,a=!0;if(""!=e)for(d=b.arrRight.length,n=0;n<d;n++)b.arrRight[n].style.borderLeft=e,a=!0;if(""!=f)for(e=b.arrBottom.length,n=0;n<e;n++)b.arrBottom[n].style.borderTop=f,a=!0}a&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0)}
function command_cellBGColor(a,b,c){dext_src_init(b);a=document.getElementById("dext_em_"+DEXTTOP.G_CURREDITOR.ID+"cell_bg_color_show");c?a.style.backgroundColor=c:c=a.style.backgroundColor;restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d;try{if(DEXTTOP.G_SELECTED_ELEMENT)d=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);else{var e=getFirstRange().range;a=null;e&&e.startContainer&&(a=getMyElementNode(e.startContainer));d=GetTDTHCell(a)}var f=
getCellNearLeftTop(d),g=f.arrSelected.length;for(d=0;d<g;d++){var h=f.arrSelected[d];h.style.backgroundColor=c;h.removeAttribute("dext_select")}f&&0<f.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}catch(n){}}
function command_InsertDogBGImg(a,b,c,d,e,f,g,h){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if("Y"==c)_iframeDoc.body.style.backgroundImage="",_iframeDoc.body.style.backgroundAttachment="",_iframeDoc.body.style.backgroundRepeat="",_iframeDoc.body.style.backgroundColor="",_iframeDoc.body.removeAttribute("background"),DEXTTOP.G_CURREDITOR._PageProp.bodyimage="",DEXTTOP.G_CURREDITOR._PageProp.bodycolor=
"",DEXTTOP.G_CURREDITOR._PageProp.bodyattachment="",DEXTTOP.G_CURREDITOR._PageProp.bodyrepeat="",showRuler(DEXTTOP.G_CURREDITOR);else if("N"==c&&("1"!=DEXTTOP.G_CURREDITOR._config.horizontalLine.use&&("[FAIL]"==d.substring(0,6)&&(_iframeDoc.body.setAttribute("alt",d.substring(6,d.length)),d=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),_iframeDoc.body.style.backgroundImage="url("+d+")",_iframeDoc.body.removeAttribute("background"),_iframeDoc.body.style.backgroundAttachment=e,
_iframeDoc.body.style.backgroundRepeat=f,""!=g&&(_iframeDoc.body.style.backgroundColor=g)),DEXTTOP.G_CURREDITOR._PageProp.bodyimage="url("+d+")",""!=g&&(DEXTTOP.G_CURREDITOR._PageProp.bodycolor=g),DEXTTOP.G_CURREDITOR._PageProp.bodyattachment=e,DEXTTOP.G_CURREDITOR._PageProp.bodyrepeat=f,h&&1<h.length))for(a=h.length,b=1;b<a;b++)c=h[b].split("^"),2==c.length&&_iframeDoc.body.setAttribute(c[0],c[1]);DEXTTOP.G_CURREDITOR._PageProp.bshowgrid&&1==DEXTTOP.G_CURREDITOR._PageProp.bshowgrid?changeBodyImageProperty(!1):
"1"!=DEXTTOP.G_CURREDITOR._config.horizontalLine.use&&changeBodyImageProperty(!0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertImage(a,b,c,d,e,f,g,h){dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();c=getFirstRange().range;try{0==c.toString().length&&setRestoreCaretPos(!1)}catch(n){}c=_iframeDoc.createElement("img");if("CCODE_001"==DEXTTOP.G_CURREDITOR._config.custom_code)d=h.srcURL,e=d.split("|"),"emoticon"==G_LAST_CMD||h.input_url_checked?"[FAIL]"==d.substring(0,6)?(c.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),
c.setAttribute("alt",d.substring(6,d.length).replace(/"/g,"'"))):c.setAttribute("src",d):("[FAIL]"==e[2].substring(0,6)?(c.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),c.setAttribute("alt",e[2].substring(6,e[2].length).replace(/"/g,"'"))):c.setAttribute("src",e[2]),c.setAttribute("filemimeinfo",d),0==h.input_url_checked&&"[FAIL]"!=e[2].substring(0,6)&&insertImageSrc(DEXTTOP.G_CURREDITOR,e[2])),c.setAttribute("title",h.title),"emoticon"==G_LAST_CMD||h.input_url_checked?
"[FAIL]"!=d.substring(0,6)&&c.setAttribute("alt",h.alt):"[FAIL]"!=e[2].substring(0,6)&&c.setAttribute("alt",h.alt),"undefined"!=typeof h.id&&""!=h.id&&c.setAttribute("id",h.id),"undefined"!=typeof h.className&&""!=h.className&&c.setAttribute("class",h.className),"0"!=DEXTTOP.G_CURREDITOR._config.allowImgSize&&(""!=h.width&&(c.style.width=h.width+"px"),""!=h.height&&(c.style.height=h.height+"px")),""!=h.margin_top.toString()&&(c.style.marginTop=h.margin_top+"px"),""!=h.margin_right.toString()&&(c.style.marginRight=
h.margin_right+"px"),""!=h.margin_bottom.toString()&&(c.style.marginBottom=h.margin_bottom+"px"),""!=h.margin_left.toString()&&(c.style.marginLeft=h.margin_left+"px"),""!=h.align&&c.setAttribute("align",h.align),""==h.border?c.setAttribute("border","0"):c.setAttribute("border",h.border),""==h.border?c.style.border="0px solid":c.style.border=h.border+"px solid";else if("0"!=DEXTTOP.G_CURREDITOR._config.allowImgSize&&(""!=h.width&&(c.style.width=h.width+"px"),""!=h.height&&(c.style.height=h.height+
"px")),"[FAIL]"==h.srcURL.substring(0,6)?(c.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),c.setAttribute("alt",h.srcURL.substring(6,h.srcURL.length).replace(/"/g,"'"))):c.setAttribute("src",h.srcURL),0==h.input_url_checked&&"[FAIL]"!=h.srcURL.substring(0,6)&&insertImageSrc(DEXTTOP.G_CURREDITOR,h.srcURL),c.setAttribute("title",h.title),"[FAIL]"!=h.srcURL.substring(0,6)&&c.setAttribute("alt",h.alt),"undefined"!=typeof h.id&&""!=h.id&&c.setAttribute("id",h.id),
"undefined"!=typeof h.className&&""!=h.className&&c.setAttribute("class",h.className),""!=h.margin_top.toString()&&(c.style.marginTop=h.margin_top+"px"),""!=h.margin_right.toString()&&(c.style.marginRight=h.margin_right+"px"),""!=h.margin_bottom.toString()&&(c.style.marginBottom=h.margin_bottom+"px"),""!=h.margin_left.toString()&&(c.style.marginLeft=h.margin_left+"px"),""!=h.align&&c.setAttribute("align",h.align),""==h.border?c.setAttribute("border","0"):c.setAttribute("border",h.border),""==h.border?
c.style.border="0px solid":c.style.border=h.border+"px solid",c=setImageBorder(c,{borderStyle:h.borderStyle,borderWidth:h.borderThickness,borderColor:h.borderColor,borderKind:h.borderKind}),(d=h.img_attr_info_arr)&&1<d.length)for(f=d.length,e=1;e<f;e++)g=d[e].split("^"),2==g.length&&c.setAttribute(g[0],g[1]);d=getFirstRange().range;d.collapse(!0);if(h.figure){e=_iframeDoc.createElement("figure");f=_iframeDoc.createElement("figcaption");e.setAttribute("contenteditable","false");e.setAttribute("style",
DEXTTOP.G_CURREDITOR._config.figure.figurestyle);f.setAttribute("style",DEXTTOP.G_CURREDITOR._config.figure.figcaptionstyle);f.setAttribute("contenteditable","true");f.setAttribute("dext_default_caption","true");e.appendChild(c);e.appendChild(f);e=e.outerHTML;if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,e),d=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(d)}else pasteHtmlAtCaretHuge(e);
f=_iframeDoc.getElementsByTagName("figcaption");g=f.length;for(e=0;e<g;e++)if("true"==f[e].getAttribute("dext_default_caption")){f[e].removeAttribute("dext_default_caption");g=_iframeDoc.createElement("p");g.innerHTML=DEXTTOP.G_CURREDITOR._config.figure.defaultcaption;f[e].appendChild(g);break}}else d.insertNode(c);try{if(void 0==c.nextSibling||null==c.nextSibling){var m=d.getDocument().createTextNode(" ");c.parentNode.appendChild(m)}}catch(p){}d.selectNode(c);d.collapse(!1);m=!1;DEXTTOP.DEXT5.browser.safari&&
h.continueInsert&&(m=!0,e=_iframeDoc.createElement("br"),d.insertNode(e),d.selectNode(e),d.collapse(!1));h.imageSpacing&&(e=_iframeDoc.createElement("br"),d.insertNode(e),d.selectNode(e),d.collapse(!1),0==m&&(e=_iframeDoc.createElement("br"),d.insertNode(e),d.selectNode(e),d.collapse(!1)));rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(d);""!=h.linkurl&&(c.parentNode.removeChild(c),command_InsertHyperLink(a,b,{type:"hyperlink",text:c.outerHTML,url:h.linkurl,
target:h.linktarget,title:h.linktitle}));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper(c)}catch(t){}}
function command_InsertMedia(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();0<a.range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);range.pasteHtml(c);a.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertReplacedImg(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=makeImageElementForObject(c);b=getFirstRange().range;b.deleteContents();b.insertNode(a);b.selectNode(b.endContainer);b.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);rangy.getSelection(_iframeWin).collapseToEnd();
"0"==DEXTTOP.G_CURREDITOR._config.useReplaceImage&&(DEXTTOP.G_CURREDITOR._dextCustomDataMode=!1,ReplaceImageToRealObject(!1,!0));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertLinkMedia(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();b=a.range;0<b.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);b.pasteHtml(c);a.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_ModifyReplacedImg(a,b,c,d){dext_src_init(b);restoreSelection();setFocusToBody();a=d.getAttribute("dext5customdata");if(null!=a&&void 0!=a)if(a=getDextCustomData(a),"iframe"==c.type||"iframe"==c.type2)a.type=c.type,a.type2=c.type2,a.src=c.src?c.src:"",a.id=c.id?c.id:"",a.name=c.name?c.name:"",a.title=c.title?c.title:"",a.className=c.className?c.className:"",a.width=c.width?c.width:"",a.height=c.height?c.height:"",a.align=c.align?c.align:"",a.scrolling=c.scrolling?c.scrolling:"",a.frameBorder=
c.frameBorder?c.frameBorder:"",a.attributes=c.attributes?c.attributes:"",a.caption=c.caption?c.caption:"",-1<c.width.indexOf("px")||-1<c.width.indexOf("%")||-1<c.width.indexOf("pt")?d.style.width=c.width:""!=c.width&&(d.style.width=c.width+"px"),-1<c.height.indexOf("px")||-1<c.height.indexOf("%")||-1<c.height.indexOf("pt")?d.style.height=c.height:d.style.height=c.height+"px",d.align=c.align;else if("flash"==c.type||"flash"==c.type2){a.type=c.type;a.type2=c.type2;a.src=c.src;a.width=c.width;a.height=
c.height;a.hspace=c.hspace;a.vspace=c.vspace;a.scale=c.scale;a.allowScriptAccess=c.allowScriptAccess;a.quality=c.quality;a.align="";a.menu=c.menu;a.play=c.play;a.loop=c.loop;a.allowFullScreen=c.allowFullScreen;a.flashvars=c.flashvars;a.caption=c.caption;-1<c.width.indexOf("px")||-1<c.width.indexOf("%")||-1<c.width.indexOf("pt")?d.style.width=c.width:d.style.width=c.width+"px";-1<c.height.indexOf("px")||-1<c.height.indexOf("%")||-1<c.height.indexOf("pt")?d.style.height=c.height:d.style.height=c.height+
"px";d.align="";b="absbottom absmiddle absmiddle bottom left middle right texttop top".split(" ");for(var e=b.length,f=0;f<e;f++)if(c.align==b[f]){d.align=c.align;a.align=c.align;break}}}
function command_InsertHR(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var c=getFirstRange().range;if(c){for(var d=_iframeDoc.createElement("hr"),e=!1,f=c.startContainer;f;){if("p"===f.nodeName.toLowerCase()){e=!0;break}f=f.firstChild}e&&(c.setStartBefore(f),c.collapse(!0));c.insertNode(d);c.selectNode(d);
c.collapse(!1)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_insertHorizontalLine(a,b,c,d,e){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=getFirstRange().range;b=_iframeDoc.createElement("hr");if(a){d?(b.style.cssText=d.style.cssText,100>e&&DEXTTOP.DEXT5.util.dextSetAttribute(b,"width",e,"%")):c&&(100>c.width&&DEXTTOP.DEXT5.util.dextSetAttribute(b,"width",
c.width,"%"),""==c.height?b.style.height="1px":b.style.height=c.height+"px",""!=c.align&&(b.align=c.align),b.style.backgroundColor=""!=c.color?c.color:"#000000",b.style.color=c.color,b.style.border="0px");d=!1;for(c=a.startContainer;c;){if("p"===c.nodeName.toLowerCase()){d=!0;break}c=c.parentNode}e=b.outerHTML;e+='<p id="dext_target"></p>';d&&!c.nextSibling&&(d=a.cloneRange(),d.selectNodeContents(c),d.setEnd(a.endContainer,a.endOffset),c.innerText.length==d.toString().length&&(e+="<p><br></p>"));
if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera){if(_iframeDoc.execCommand("inserthtml",!1,e),a=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(a)}else pasteHtmlAtCaretHuge(e);if(c=_iframeDoc.getElementById("dext_target"))if(d=c.nextSibling,a.selectNode(c),a.deleteContents(),d)try{if(("P"==d.tagName||"TABLE"==d.tagName||"DIV"==d.tagName)&&d.firstChild)for(var f=d.firstChild;;)if(3==f.nodeType||-1<",img,input,iframe,object,video,".indexOf(","+
f.tagName.toLowerCase()+",")){d=f.parentNode;break}else if("BR"==f.tagName){d=f.parentNode;break}else if(null!=f.firstChild)f=f.firstChild;else{d=f;break}doSetCaretPosition(d,0)}catch(g){}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertIframe(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=_iframeDoc.createElement("iframe");""!=c.id&&(a.id=c.id);""!=c.name&&(a.name=c.name);""!=c.title&&(a.title=c.title);a.style.width=""!=c.width?c.width+"px":"400px";a.style.height=""!=c.height?c.height+"px":"400px";a.align=c.align;a.scrolling=
c.scroll;a.frameBorder=1==c.border?1:0;a.src=c.url;c=getFirstRange().range;c.deleteContents();c.insertNode(a);c.selectNode(c.endContainer);c.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertHyperLink(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;if("hyperlink"==c.type||"image"==c.type)if(0==a.toString().length){""==c.text&&(c.text=c.url);b=_iframeDoc.createElement("a");b.innerHTML=c.text;b.setAttribute("href",c.url);b.target="undefined"!=typeof c.target&&""!=c.target?c.target:"_blank";"undefined"!=typeof c.title&&""!=c.title?b.title=c.title:
"0"!=DEXTTOP.G_CURREDITOR._config.accessibility&&-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("a_title")&&(b.title=c.url);"undefined"!=typeof c.id&&""!=c.id&&(b.id=c.id);"undefined"!=typeof c.className&&""!=c.className&&(b.className=c.className);"undefined"!=typeof c.type2&&"insert_file"==c.type2&&(b.setAttribute("DEXT5InsertFile",""),"1"==DEXTTOP.G_CURREDITOR._config.attachFileImage&&attachFileImage(b,c));if("undefined"!=typeof c.attr_info_arr&&1<c.attr_info_arr.length)for(var d=
c.attr_info_arr.length,e=1;e<d;e++){var f=c.attr_info_arr[e].split("^");2==f.length&&b.setAttribute(f[0],f[1])}a.deleteContents();a.insertNode(b);a.selectNode(b);c=c.text.replace(/"/g,"'").match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi"));e="";c&&0<c.length&&(e=c[0].replace("src=",""),e=e.replace(/\'/g,""),e=e.replace(/&amp;/g,"&"),b.getElementsByTagName("img")[0].src=e)}else for(_iframeDoc.execCommand("CreateLink",!1,c.url),b=getFirstRange().range,0==!!b&&(b=a),b=getNodesInRange(b),d=b.length,
e=0;e<d;e++)"a"==b[e].nodeName.toLowerCase()&&(b[e].target="undefined"!=typeof c.target&&""!=c.target?c.target:"_blank","undefined"!=typeof c.title&&""!=c.title?b[e].title=c.title:"0"!=DEXTTOP.G_CURREDITOR._config.accessibility&&-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("a_title")&&(b[e].title=c.url),"undefined"!=typeof c.id&&""!=c.id&&(b[e].id=c.id),"undefined"!=typeof c.className&&""!=c.className&&(b[e].className=c.className),"undefined"!=typeof c.type2&&"insert_file"==
c.type2&&(b[e].setAttribute("DEXT5InsertFile",""),"1"==DEXTTOP.G_CURREDITOR._config.attachFileImage&&attachFileImage(b[e],c)));else"bookmark"==c.type&&(0==a.toString().length?(""==c.text&&(c.text=c.bookname),b=_iframeDoc.createElement("a"),b.innerHTML=c.text,b.href=c.bookname,a.deleteContents(),a.insertNode(b),a.selectNode(b)):(_iframeDoc.execCommand("CreateLink",!1,c.bookname),getNodesInRange(a)));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();try{rangy.getSelection(_iframeWin).addRange(a)}catch(g){alert("DEXT5 Hyperlink error : "+
g)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertBookmark(a,b,c,d){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=_iframeDoc.createElement("a");""==c&&(c=DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?unescape("%u200B"):unescape("%uFEFF"));a.innerHTML=c;a.setAttribute("id",d);a.setAttribute("name",d);a.className=
"dext5_bookmark";c=getFirstRange().range;c.deleteContents();d=c.getDocument().createTextNode("\u00a0");c.insertNode(d);c.insertNode(a);c.selectNode(a.nextSibling);c.collapse(!1);DEXTTOP.DEXT5.browser.ie&&d.parentNode.removeChild(d);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertSymbol(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;a.deleteContents();0<a.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a.pasteHtml(c+'<span id="dext_symbol">dext_symbol</span>');c=_iframeDoc.getElementById("dext_symbol");doSetCaretPosition(c,1);c.parentNode.removeChild(c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0}function command_TableSelect(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(a=getFirstRange().range)a=GetTDTHCell(a.startContainer),GetParentbyTagName(a,"table").setAttribute("DEXT5CellSelected","DEXT5CellSelected"),"select_cell"==c?setTableCellSelect(a):"select_row"==c?setTableRowSelect(a):"select_column"==c?setTableColumnSelect(a):"select_all"==c&&setTableAllSelect(a)}
function command_TableWidthHeightRemove(a,b,c){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();"width_remove"==c?setTableWidthRemove():"height_remove"==c?setTableHeightRemove():"width_height_remove"==c&&setTableWidthHeightRemove();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_TableSameWidthheight(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();"same_width"==c?setTableWidthSame():"same_height"==c?setTableHeightSame():"same_widthheight"==c&&(setTableWidthSame(),setTableHeightSame());a=GetTableSelectionCells();1<a.length?DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell"):1==a.length&&DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell");
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_TableRowClone(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange().range;c&&(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),c=GetTDTHCell(c.startContainer),setTableRowClone(c),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_VerticalAlignExcute(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(a=getFirstRange().range){var d=GetTDTHCell(a.startContainer);a=GetTableSelectionCells(d);b=a.length;0==b&&(a[0]=d,b=a.length);for(d=0;d<b;d++){var e=a[d];removeAttribute(e,"valign");e.style.verticalAlign=c}a=GetTableSelectionCells();b=a.length;0==b?DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"):
1==b?DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell"):1<b&&DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}
function command_editorSetting(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();var d=DEXTTOP.DEXT5.util.getEditorByName(a);d._setting.grid_color=c.grid_color;d._setting.grid_color_nm=c.grid_color_nm;d._setting.grid_spans=c.grid_spans;d._setting.grid_form=c.grid_form;d._setting.page_title=c.page_title;d._setting.encoding=c.encoding;d._setting.doctype=c.doctype;d._setting.xhtml=c.xhtml;d._setting.lang=c.lang;d._PageProp.encoding=c.encoding;d._PageProp.doctype=c.doctype;d._PageProp.xmlnsname=
c.xhtml;d._PageProp.lang=c.lang;d._setting.auto_save=c.auto_save;setAutoSave(d);d._config.autoList.use=c.auto_list;try{DEXTTOP.DEXTWIN.localStorage["dext_"+a+"_auto_list"]=c.auto_list}catch(e){}1==d._config.ruler.use&&(d._setting.ruler=c.ruler,"2"!=d._config.ruler.mode&&(d._setting.ruler_position=c.ruler_px),"0"==c.ruler?(d._config.ruler.view="0",hideRuler(d),"1"==d._config.usePersonalSetting&&"1"==d._config.ruler.mode&&(_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("width"):
_iframeDoc.body.style.removeAttribute("width"))):"1"==d._config.ruler.view?setTimeout(function(){set_ruler_point_position(d);set_ruler_pointline_position(d)},100):(d._config.ruler.view="1",setTimeout(function(){showRuler(d)},100)),setUserSetting(d,"ruler"));if(1==d._config.usePersonalSetting){d._setting.personal_font_family=c.personal_font_family;d._setting.personal_font_size=c.personal_font_size;d._setting.personal_line_height=c.personal_line_height;setUserSetting(d,"personalSetting");a=c.personal_font_family;
b=c.personal_font_size;var f=c.personal_line_height;""==a&&(a=d._config.defaultFontFamily);""==b&&(b=d._config.defaultFontSize);""==f&&(f=d._config.defaultLineHeight);var g=createEditorDefaultStyleInnerHTML(d._config,a,b,f),h=_iframeDoc.createElement("style");h.type="text/css";h.styleSheet?(h.styleSheet.cssText=g,""==h.innerHTML&&(h.innerHTML=g)):h.appendChild(_iframeDoc.createTextNode(g));(g=getDefaultStyleTag(_iframeDoc,d))?(g.parentNode.insertBefore(h,g),g.parentNode.removeChild(g)):(g=_iframeDoc.getElementsByTagName("head")[0])&&
g.appendChild(h);d._setting.font_family=a;d._dextFontFamily._fontFamily[d.ID]&&(d._dextFontFamily._fontFamily[d.ID][0]=a);d._dextFontFamily._iframe_doc&&(d._dextFontFamily._iframe_doc.getElementById("ff_"+d.ID+"_0").getElementsByTagName("span")[0].style.fontFamily=a);d._setting.font_size=b;d._dextFontSize._fontSize[d.ID]&&(d._dextFontSize._fontSize[d.ID][0]=b);d._dextFontSize._iframe_doc&&(d._dextFontSize._iframe_doc.getElementById("fs_"+d.ID+"_0").style.fontSize=b);d._setting.line_height=f;d._dextLineHeight._lineHeight[d.ID]&&
(d._dextLineHeight._lineHeight[d.ID][0]=f)}setDoctypeProperty(d._docType[c.doctype],c.encoding,c.lang,c.xhtml);a=d._config.webPath.image+"grid/bggrid_"+c.grid_spans+"_"+c.grid_color_nm.replace(" ","").toLowerCase()+"_"+c.grid_form+".png";_iframeDoc.title=c.page_title;d._PageProp.bshowgrid&&1==d._PageProp.bshowgrid&&(d._PageProp.gridimage="url("+DEXTTOP.DEXT5.util.url.full_url(a)+")",d._PageProp.gridattachment="scroll",d._PageProp.gridrepeat="repeat",changeBodyImageProperty(!1))}
function command_InsertInputText(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("input");b.type=c.insertType;b.setAttribute("value",c.insertValue);b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;""!=c.insertAlign&&(b.style.textAlign=c.insertAlign);""!=c.insertWidth&&(b.style.width=c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=
c.insertHeight+"px");c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");c.insertReadonly?b.readOnly=!0:b.removeAttribute("readonly");""!=c.insertSize&&(b.size=c.insertSize);""!=c.insertMaxlength&&(b.maxLength=c.insertMaxlength);var d=c.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=c.insertEventNameArr[g],f+=c.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(b,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&
8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,b=b.replace(">",' name="'+c.insertName+'" />'),a.pasteHtml(b));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputRadioOrCheckbox(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("input");b.type=c.insertType;b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;""!=c.insertWidth&&(b.style.width=c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=c.insertHeight+"px");c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");
c.insertChecked?(b.checked=!0,b.setAttribute("checked","checked")):(b.checked=!1,b.removeAttribute("chekced"));b.setAttribute("value",c.insertValue);var d=c.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=c.insertEventNameArr[g],f+=c.insertEventFunctionArr[g];g={type:"event"};g.eventName=e;g.eventFunction=f;setDextCustomData(b,g)}a.deleteContents();if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie){b.setAttribute("name",
c.insertName);if("radio"==c.insertType&&c.insertChecked)for(e=_iframeDoc.getElementsByName(c.insertName),f=e.length,g=0;g<f;g++)e[g].checked=!1,e[g].removeAttribute("checked");a.insertNode(b);a.selectNode(b);c.insertChecked&&(b.checked=!0,b.setAttribute("checked","checked"))}else{if("radio"==c.insertType&&c.insertChecked)for(e=_iframeDoc.getElementsByName(c.insertName),f=e.length,g=0;g<f;g++)e[g].checked=!1,e[g].removeAttribute("checked");b=b.outerHTML;b=b.replace(">",' name="'+c.insertName+'" />');
a.pasteHtml(b)}a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputButton(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("input");b.type=c.insertType;b.setAttribute("value",c.insertValue);b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;""!=c.insertAlign&&(b.style.textAlign=c.insertAlign);""!=c.insertWidth&&(b.style.width=c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=
c.insertHeight+"px");c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");var d=c.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=c.insertEventNameArr[g],f+=c.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(b,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,
b=b.replace(">",' name="'+c.insertName+'" />'),a.pasteHtml(b));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputSelect(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("select");b.setAttribute("value",c.insertValue);b.multiple=c.insertMultiselect;b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;b.size=c.insertSize;""!=c.insertWidth&&(b.style.width=c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=c.insertHeight+
"px");c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");for(var d=c.insertOptionsArr.length,e=0;e<d;e++){var f=_iframeDoc.createElement("option");f.innerHTML=c.insertOptionsArr[e];f.setAttribute("value",c.insertOptionsValueArr[e]);f.selected=c.insertOptionsSelected[e];b.appendChild(f)}var g=c.insertEventNameArr.length;if(0<g){f=d="";for(e=0;e<g;e++)0!=e&&(d+="\x0B",f+="\x0B"),d+=c.insertEventNameArr[e],f+=c.insertEventFunctionArr[e];e={type:"event"};e.eventName=d;e.eventFunction=f;setDextCustomData(b,
e)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,b=b.replace(">",' name="'+c.insertName+'" >'),a.pasteHtml(b));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputTextarea(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("textarea");b.value=c.insertValue;b.innerHTML=c.insertValue;b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;""!=c.insertRows&&(b.rows=c.insertRows);""!=c.insertCols&&(b.cols=c.insertCols);""!=c.insertWrap&&(b.wrap=c.insertWrap);""!=c.insertWidth&&(b.style.width=
c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=c.insertHeight+"px");""!=c.insertAlign&&(b.style.textAlign=c.insertAlign);c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");c.insertReadonly?b.readOnly=!0:b.removeAttribute("readonly");var d=c.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=c.insertEventNameArr[g],f+=c.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(b,d)}a.deleteContents();
DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,b=b.replace(">",' name="'+c.insertName+'" >'),a.pasteHtml(b));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputHidden(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("input");b.type="hidden";b.setAttribute("value",c.insertValue);b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),
a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,b=b.replace(">",' name="'+c.insertName+'" />'),a.pasteHtml(b));DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0;ReplaceRealObjectToImage(!1);a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputImage(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;b=_iframeDoc.createElement("input");b.type=c.insertType;b.setAttribute("value",c.insertValue);b.id=c.insertId;b.className=c.insertClass;b.title=c.insertTitle;b.src=c.insertSrc;c.insertAlign&&(b.align=c.insertAlign);""!=c.insertWidth&&(b.style.width=c.insertWidth+"px");""!=c.insertHeight&&(b.style.height=
c.insertHeight+"px");c.insertDisabled?b.disabled=!0:b.removeAttribute("disabled");var d=c.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=c.insertEventNameArr[g],f+=c.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(b,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(b.setAttribute("name",c.insertName),a.insertNode(b),a.selectNode(b)):(b=b.outerHTML,
b=b.replace(">",' name="'+c.insertName+'" />'),a.pasteHtml(b));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function isDEXTContainerMode(){var a=!1;try{a=-1<DEXTTOP.DEXTWIN.location.href.indexOf("editor_container.html")}catch(b){}return a}
function command_fullScreen(a,b){if(1==isDEXTContainerMode())return!1;var c=document.getElementById("ue_editor_holder_"+a);if(""==DEXTTOP.G_CURREDITOR.FrameStatus){var d=DEXTTOP.DEXTDOC.getElementById("div_resizebar_"+DEXTTOP.G_CURREDITOR.ID);d&&(d.style.display="none");originScrollSize=getWindowScrollPos(DEXTTOP.DEXTWIN);orginEditorSize=getClientSize(c);var d=document.getElementById("dext_topstatusbar_"+a),e=document.getElementById("dext_menu_"+a),f=document.getElementById("dext_toolbar_"+a),g=document.getElementById("dext_statusbar_"+
a),h,n,m,p;d&&(h=getClientRect(d));e&&(n=getClientRect(e));f&&(m=getClientRect(f));g&&(p=getClientRect(g));d=0;n&&(d+=n.bottom-n.top);m&&(d+=m.bottom-m.top);d=h?d+(h.bottom-h.top):d+1;d=p?d+(p.bottom-p.top):d+1;b.baseMenuToolbarHeight=d;h=window.frameElement;originfull.margin1=DEXTTOP.DEXTDOC.documentElement.style.margin;originfull.padding1=DEXTTOP.DEXTDOC.documentElement.style.padding;originfull.border1=DEXTTOP.DEXTDOC.documentElement.style.border;originfull.height1=DEXTTOP.DEXTDOC.documentElement.style.height;
originfull.overflow1=DEXTTOP.DEXTDOC.documentElement.style.overflow;originfull.margin2=DEXTTOP.DEXTDOC.body.style.margin;originfull.padding2=DEXTTOP.DEXTDOC.body.style.padding;originfull.border2=DEXTTOP.DEXTDOC.body.style.border;originfull.height2=DEXTTOP.DEXTDOC.body.style.height;originfull.overflow2=DEXTTOP.DEXTDOC.body.style.overflow;DEXTTOP.DEXTDOC.documentElement.style.overflow="hidden";DEXTTOP.DEXTDOC.documentElement.style.padding="0";DEXTTOP.DEXTDOC.documentElement.style.margin="0";DEXTTOP.DEXTDOC.documentElement.style.border=
"0";DEXTTOP.DEXTDOC.documentElement.style.height="100%";DEXTTOP.DEXTDOC.body.style.overflow="hidden";DEXTTOP.DEXTDOC.body.style.padding="0";DEXTTOP.DEXTDOC.body.style.margin="0";DEXTTOP.DEXTDOC.body.style.border="0";DEXTTOP.DEXTDOC.body.style.height="100%";originfull.overflow3=h.style.overflow;originfull.position3=h.style.position;originfull.zIndex=h.style.zIndex;getClientRect(h);h.style.overflow="hidden";h.style.position="absolute";h.style.width="100%";h.style.height="100%";h.style.zIndex=b._config.zIndex;
n=getWindowClientSize(DEXTTOP.DEXTWIN);h.style.width=n[0]+"px";h.style.height=n[1]+"px";c.style.height=n[1]-b.baseMenuToolbarHeight+"px";h.style.left="0px";h.style.top="0px";c=getClientRect(h);relativePos=isRelativePosition(h);0<c.left||0<c.top?relativePos=!0:(h.style.left="0px",h.style.top="0px");setBackupHiddenStyle(h,DEXTTOP.DEXTWIN);DEXTTOP.G_CURREDITOR.FrameStatus="full_size";setEditorHeight(b,!1);resizeDextWin();DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",resizeDextWin)}else{if(d=DEXTTOP.DEXTDOC.getElementById("div_resizebar_"+
DEXTTOP.G_CURREDITOR.ID))d.style.display="";DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTWIN,"resize",resizeDextWin);h=window.frameElement;DEXTTOP.DEXTDOC.documentElement.style.margin=originfull.margin1;DEXTTOP.DEXTDOC.documentElement.style.padding=originfull.padding1;DEXTTOP.DEXTDOC.documentElement.style.border=originfull.border1;DEXTTOP.DEXTDOC.documentElement.style.height=originfull.height1;DEXTTOP.DEXTDOC.documentElement.style.overflow=originfull.overflow1;DEXTTOP.DEXTDOC.body.style.margin=originfull.margin2;
DEXTTOP.DEXTDOC.body.style.padding=originfull.padding2;DEXTTOP.DEXTDOC.body.style.border=originfull.border2;DEXTTOP.DEXTDOC.body.style.height=originfull.height2;DEXTTOP.DEXTDOC.body.style.overflow=originfull.overflow2;h.style.overflow=originfull.overflow3;h.style.position=originfull.position3;h.style.left="0px";h.style.top="0px";h.style.width="100%";h.style.height="100%";h.width="100%";h.height="100%";h.style.zIndex=originfull.zIndex;setRestorreHiddenStyle();setEditorHeight(b,!0);c.style.height=b._defaultHeight+
"px";DEXTTOP.DEXTWIN.scroll(originScrollSize[0],originScrollSize[1]);DEXTTOP.G_CURREDITOR.FrameStatus=""}c=[];"full_size"==DEXTTOP.G_CURREDITOR.FrameStatus?c.push("full_screen"):removeArrayItemByValue(c,"full_screen");DEXTTOP.G_CURREDITOR._iconSelected(c);setRulerPositionForNode();setTimeout(function(){try{DEXTTOP.DEXTWIN.dext_full_screen_event(a,DEXTTOP.G_CURREDITOR.FrameStatus)}catch(b){}},100)}
function command_grid(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid)changeBodyImageProperty(!0),b._PageProp.bshowgrid=!1;else{var c=b._config.webPath.image+"grid/bggrid_"+b._setting.grid_spans+"_"+b._setting.grid_color_nm.replace(" ","").toLowerCase()+"_"+b._setting.grid_form+".png";b._PageProp.gridimage="url("+DEXTTOP.DEXT5.util.url.full_url(c)+")";b._PageProp.gridattachment="scroll";b._PageProp.gridrepeat="repeat";b._PageProp.bshowgrid=
!0;changeBodyImageProperty(!1)}}
function command_InsertPasteDialogHtml(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();a=DEXTTOP.DEXT5.util.officeClean(c,!1);a=DEXTTOP.DEXT5.util.htmlRevision(a);a=xssReplaceScript(null,a);"1"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjustInPaste&&/<table/i.test(a)&&(a=command_AdjustTableAndCellWidth(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,{type:"paste",htmlData:a}));if("function"==typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event){b=a;try{b=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(a)}catch(d){b=a}if(b)a=
b;else if(0==b||""==b)return}pasteWordCount(a)&&(-1<a.indexOf("dext5customdata")&&(a=checkExistCustomData(a)),_iframeDoc.execCommand("inserthtml",!1,a),0>a.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),xssReplaceScript(_iframeDoc)))}
function command_tableIndentOutdent(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetParentbyTagName(parent.G_SELECTED_ELEMENT,"table",!0);try{if(null==a&&0<GetTableSelectionCells().length){var d=GetTableSelectionCells();a=GetParentbyTagName(d[0],"table",!0)}}catch(e){}b=parseIntOr0(b._config.tableDefaultInoutdent);d=parseIntOr0(a.style.marginLeft,10);"indent"==c?d=989>=d?d+b:999:
"outdent"==c&&(d=d>=b?d-b:0);a.style.marginLeft=d+"px";doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_loadAutoSave(a,b,c){b=function(){c&&""!=c&&DEXTTOP.DEXT5.setHtmlValueExWithDocType(c,a)};0==DEXTTOP.DEXT5.isEmpty(a)?1==confirm(dext5_lang.loadAutoSave.loadMsg)&&b():b()}
function command_useRuler(a){a=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+a);getIframeDocument(a);"1"==DEXTTOP.G_CURREDITOR._config.ruler.view?(DEXTTOP.G_CURREDITOR._config.ruler.view="0",hideRuler(DEXTTOP.G_CURREDITOR)):(DEXTTOP.G_CURREDITOR._config.ruler.view="1",showRuler(DEXTTOP.G_CURREDITOR),moveRulerPosition(null))}
function command_Direction(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange().range;var d=getFirstRange().sel,e=elems=null,f=[];if(a&&a.startContainer){if(1==a.startContainer.nodeType){var e=getMyElementNode(a.startContainer),g=rangy.dom.getBody(_iframeDoc).childNodes,h=g.length;for(b=0;b<h;b++)f.push(g[b])}else e=getMyElementNode(a.startContainer),f=getNodesInRange(a);elems=getDirectionNode(a,d,e,f);d=elems.length;for(b=0;b<d;b++)elems[b].dir=c.toLowerCase();
setMenuIconRealable(getMyElementNode(a.startContainer))}}
function command_tableCopy(a,b,c){if(1==c||1==getCopyCellData())if(dext_src_init(b._EDITOR.design),restoreSelection(),setFocusToBody(),DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.safari)doSetCaretPosition(DrageEndCell.childNodes[0],1);else{_iframeDoc.getElementById("dext_temp_copy_div")&&_iframeDoc.getElementById("dext_temp_copy_div").parentNode.removeChild(_iframeDoc.getElementById("dext_temp_copy_div"));var d=0,e=0;if(DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion)try{d=Math.max(_iframeDoc.documentElement.scrollLeft,
_iframeDoc.body.scrollLeft),e=Math.max(_iframeDoc.documentElement.scrollTop,_iframeDoc.body.scrollTop)}catch(f){}var g=_iframeDoc.createElement("div");g.style.position="absolute";g.style.left="-5000px";g.style.top=e+"px";g.id="dext_temp_copy_div";g.style.width="1px";g.style.height="1px";g.innerHTML=DEXTTOP.G_COPIEDTABLE.outerHTML;_iframeDoc.body.appendChild(g);setTimeout(function(){try{var a=saveSelection(b.ID,!0),c=getFirstRange(),f=c.range,p=c.sel;f.setStartBefore(g.firstChild);f.setEndAfter(g.firstChild);
p.removeAllRanges();p.addRange(f);_iframeDoc.execCommand("copy");if(a){restoreSelection(a,!0);try{DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&_iframeWin.scroll(d,e)}catch(t){}}g.parentNode.removeChild(g)}catch(q){_iframeDoc.getElementById("dext_temp_copy_div")&&_iframeDoc.getElementById("dext_temp_copy_div").parentNode.removeChild(_iframeDoc.getElementById("dext_temp_copy_div"))}},0)}}
function command_tablePaste(a,b,c){try{dext_src_init(b._EDITOR.design);if(c){DEXTTOP.G_COPIEDTABLE=c;DEXTTOP.G_COPIEDCELLDATA=[];var d=c.rows.length;for(a=0;a<d;a++){var e=c.rows[a],f=e.cells.length;for(b=0;b<f;b++){var g=e.cells[b];void 0==DEXTTOP.G_COPIEDCELLDATA[a]&&(DEXTTOP.G_COPIEDCELLDATA[a]=[]);var h="",h=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&""==g.innerHTML?"&nbsp;":g.innerHTML;DEXTTOP.G_COPIEDCELLDATA[a].push(h)}}}var n,m=getFirstRange().range;null!=DEXTTOP.G_SELECTED_ELEMENT?
"html"==DEXTTOP.G_SELECTED_ELEMENT.tagName.toLowerCase()?n=_iframeDoc.body.lastChild:m&&m.startContainer&&(n=getMyElementNode(m.startContainer)):m&&m.startContainer&&(n=getMyElementNode(m.startContainer));null!=n&&doSetCaretPosition(n,0);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();1==setPasteCellData()&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}catch(p){}}
function command_intablePaste(a,b){try{dext_src_init(b._EDITOR.design);var c,d=getFirstRange().range;null!=DEXTTOP.G_SELECTED_ELEMENT?"html"==DEXTTOP.G_SELECTED_ELEMENT.tagName.toLowerCase()?c=_iframeDoc.body.lastChild:d&&d.startContainer&&(c=getMyElementNode(d.startContainer)):d&&d.startContainer&&(c=getMyElementNode(d.startContainer));null!=c&&doSetCaretPosition(c,0);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DrageStartCell=null;1==setPasteCellData()&&
(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}catch(e){}}
function command_listNumberBullets(a,b,c,d){restoreSelection();setFocusToBody();a=getFirstRange();var e=a.range,f=getFirstRange().range,g=null;f&&f.startContainer&&(g=getMyElementNode(f.startContainer));f=GetParentbyTagName(g,"ol");g=GetParentbyTagName(g,"ul");"N"==c&&g||"N"==c&&!f&&!g?DoExecuteCommand2(a.sel,e,"insertOrderedList",!1,!0):("B"==c&&f||"B"==c&&!f&&!g)&&DoExecuteCommand2(a.sel,e,"insertUnOrderedList",!1,!0);f=getFirstRange().range;g=null;f&&f.startContainer&&(g=getMyElementNode(f.startContainer));
g&&(a=null,"N"==c?a=GetParentbyTagName(g,"ol"):"B"==c&&(a=GetParentbyTagName(g,"ul")),a&&(a.style.listStyleType=d,"N"==c&&""!=b._config.orderListDefaultClass?a.setAttribute("class",b._config.orderListDefaultClass):"B"==c&&""!=b._config.unOrderListDefaultClass&&a.setAttribute("class",b._config.unOrderListDefaultClass)));a=getFirstRange().range;0==!!a&&(a=f);b=getNodesInRange(a);c=b.length;for(d=0;d<c;d++)if(a=b[d].nodeName.toLowerCase(),"ol"==a||"ul"==a)a=b[d].parentNode,"p"==a.nodeName.toLowerCase()&&
(a.parentNode.replaceChild(b[d],a),a=getFirstRange(),a.sel.removeAllRanges(),a.range.selectNodeContents(b[d]),a.sel.addRange(a.range));removeDivInLiTag();if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)try{DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(h){}setRulerPositionForNode()}
function command_setClassStyle(a,b){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange(),d=c.range;0<a.UndoManager.charCount&&a.UndoManager.putUndo();try{if(0==d.toString().length){var e=GetTableSelectionCells();if(0!=e.length){var f=e.length,g="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,h=DEXTTOP.DEXT5.browser.quirks;if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==g||1==h))for(var n=0;n<f;n++){var m=e[n];"<p></p>"==m.innerHTML.toLowerCase()?
m.innerHTML="<p>&nbsp;</p>":"<span></span>"==m.innerHTML.toLowerCase()?m.innerHTML="<span>&nbsp;</span>":""==m.innerHTML.toLowerCase()&&(m.innerHTML="&nbsp;")}for(n=0;n<f;n++){c.sel.removeAllRanges();d.selectNode(e[n]);c.sel.addRange(d);var p=rangy.createCssClassApplier(b);p.applyToSelection(_iframeWin);rangy.getSelection(_iframeWin).removeAllRanges()}c.sel.removeAllRanges();doSetCaretPosition(DrageEndCell.childNodes[0],1);!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=g&&1!=h||
(DEXTTOP.G_CURREDITOR._LastRange=null)}}else p=rangy.createCssClassApplier(b),p.applyToSelection(_iframeWin);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(t){}}
function command_removeClassStyle(a,b){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();var c=getFirstRange(),d=c.range;0<a.UndoManager.charCount&&a.UndoManager.putUndo();try{if(0==d.toString().length){var e=GetTableSelectionCells();if(0!=e.length){for(var f=e.length,g=0;g<f;g++){c.sel.removeAllRanges();d.selectNode(e[g]);c.sel.addRange(d);var h=rangy.createCssClassApplier(b);h.undoToSelection(_iframeWin);rangy.getSelection(_iframeWin).removeAllRanges()}c.sel.removeAllRanges();
doSetCaretPosition(DrageEndCell.childNodes[0],1);!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=iframeQuirks&&1!=browserQuirks||(DEXTTOP.G_CURREDITOR._LastRange=null)}}else h=rangy.createCssClassApplier(b),h.undoToSelection(_iframeWin);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(n){}}
function command_custom(a,b,c,d){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();try{DEXTTOP.DEXTWIN.dext_editor_custom_action(c,a,d)}catch(e){}}
function command_formatPainter(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();try{var c=getFirstRange().range;if(0==c.toString().length)if(0<GetTableSelectionCells().length)null!=b._formatPainterList&&(b._formatPainterList=null,b._iconEnable(""));else{b._formatPainterList=[];var d=b._config.applyFormatExceptStyle,e=c.endContainer,c=e;3==e.nodeType&&(c=e.parentNode);if(1==c.nodeType&&"BODY"!=c.tagName){var f=DEXTTOP.DEXT5.util.getStyle(c,"all"),g=getElementInParentStyleProperty(c,
"lineHeight");""!=g&&0<d.length&&-1<d.indexOf("lineHeight")&&(g="");b._formatPainterList.lineHeight=g;var h=getElementInParentStyleProperty(c,"fontFamily");""==h&&(h=f.fontFamily);b._formatPainterList.fontFamily=h;var n=getElementInParentStyleProperty(c,"fontSize");""==n&&(n=f.fontSize);b._formatPainterList.fontSize=n;var m=getElementInParentStyleProperty(c,"color");""==m&&(m=f.color);b._formatPainterList.color=m;var p=getElementInParentStyleProperty(c,"backgroundColor");b._formatPainterList.backgroundColor=
p;b._formatPainterList.textAlign=f.textAlign;var t=getElementInParentStyleProperty(c,"paddingLeft");b._formatPainterList.paddingLeft=t;var q=f.fontWeight;""!=q&&("700"<=q||"bold"==q)&&(b._formatPainterList.b=!0);b._formatPainterList.i=""!=getElementInParentTag(c,["em","i"])?!0:!1;var u=GetParentbyTagName(c,"u");if(u){b._formatPainterList.u=!0;var v=getElementInParentStyleProperty(u,"color");""!=v&&(b._formatPainterList.u_has_color=!0)}if(u=GetParentbyTagName(c,"s")||GetParentbyTagName(c,"strike"))b._formatPainterList.s=
!0,v=getElementInParentStyleProperty(u,"color"),""!=v&&(b._formatPainterList.s_has_color=!0);b._formatPainterList.sup=""!=getElementInParentTag(c,["sup"])?!0:!1;b._formatPainterList.sub=""!=getElementInParentTag(c,["sub"])?!0:!1;if(""!=getElementInParentTag(c,["ol"])){var u=GetParentbyTagName(c,"ol"),w=u.style.listStyleType;b._formatPainterList.ol=w}""!=getElementInParentTag(c,["ul"])&&(u=GetParentbyTagName(c,"ul"),w=u.style.listStyleType,b._formatPainterList.ul=w)}else b._formatPainterList=null}}catch(y){b._formatPainterList=
null}}
function command_applyFormat(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(null!=b._formatPainterList)try{var c,d;DEXTTOP.DEXT5.browser.ie&&(c=0<_iframeDoc.body.scrollLeft?_iframeDoc.body.scrollLeft:_iframeDoc.documentElement.scrollLeft,d=0<_iframeDoc.body.scrollTop?_iframeDoc.body.scrollTop:_iframeDoc.documentElement.scrollTop);var e="";if("undefined"!=typeof _iframeWin.getSelection){var f=_iframeWin.getSelection();if(f.rangeCount){for(var g=_iframeDoc.createElement("div"),h=
0,n=f.rangeCount;h<n;++h)g.appendChild(f.getRangeAt(h).cloneContents());e=g.innerHTML}}else"undefined"!=typeof _iframeDoc.selection&&"Control"!=_iframeDoc.selection.type&&(e=_iframeDoc.selection.createRange().htmlText);if(/<table|<td|<tr|<th/i.test(e))alert(dext5_lang.msg.apply_format_alert1);else{var m=b._formatPainterList;m.nowApplying="1";var p=getFirstRange(),t=p.range;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();command_removeCss2(a,b,e);try{setSelectionWithDextmark();
var p=getFirstRange(),t=p.range,q=t.startContainer;3==q.nodeType&&(q=q.parentNode);var u=GetTDTHCell(q);if(q)if(u){if("700"<=u.style.fontWeight||"bold"<=u.style.fontWeight)setSelectionWithDextmark(),command_bold(a,b),setSelectionWithDextmark(),command_bold(a,b);"italic"==u.style.fontStyle&&(setSelectionWithDextmark(),command_italic(a,b),setSelectionWithDextmark(),command_italic(a,b))}else{var v=DEXTTOP.DEXT5.util.getStyle(q,"all");if(""==getElementInParentTag(q,["b","strong"])){var w=v.fontWeight;
""!=w&&("700"<=w||"bold"==w)&&(setSelectionWithDextmark(),command_bold(a,b),setSelectionWithDextmark(),command_bold(a,b))}if(""==getElementInParentTag(q,["em","i"])){var y=v.fontStyle;""!=y&&"italic"==y&&(setSelectionWithDextmark(),command_italic(a,b),setSelectionWithDextmark(),command_italic(a,b))}}}catch(x){}setSelectionWithDextmark();command_removeFormat(a,b);if(void 0!=m.ol)switch(setSelectionWithDextmark(),m.ol.toLowerCase()){case "decimal-leading-zero":command_listDecimalLeadingZero(a,b);break;
case "lower-alpha":command_listLowerAlpha(a,b);break;case "lower-greek":command_listLowerGreek(a,b);break;case "lower-roman":command_listLowerRoman(a,b);break;case "upper-alpha":command_listUpperAlpha(a,b);break;case "upper-roman":command_listUpperRoman(a,b);break;default:command_listDecimal(a,b)}if(void 0!=m.ul)switch(setSelectionWithDextmark(),m.ul.toLowerCase()){case "circle":command_listCircle(a,b);break;case "square":command_listSquare(a,b);break;default:command_listDisc(a,b)}1==m.b&&(setSelectionWithDextmark(),
command_bold(a,b));1==m.i&&(setSelectionWithDextmark(),command_italic(a,b));1==m.u&&1!=m.u_has_color&&(setSelectionWithDextmark(),command_underline(a,b));1==m.s&&1!=m.s_has_color&&(setSelectionWithDextmark(),command_strikeThrough(a,b));""!=m.color&&(setSelectionWithDextmark(),command_fontColor(a,b._EDITOR.design,m.color));1==m.u&&1==m.u_has_color&&(setSelectionWithDextmark(),command_underline(a,b));1==m.s&&1==m.s_has_color&&(setSelectionWithDextmark(),command_strikeThrough(a,b));""!=m.fontFamily&&
(setSelectionWithDextmark(),command_fontfamily(a,b._EDITOR.design,m.fontFamily));""!=m.fontSize&&0>m.fontSize.indexOf("em")&&(setSelectionWithDextmark(),command_fontsize(a,b._EDITOR.design,m.fontSize));""!=m.lineHeight&&(setSelectionWithDextmark(),command_lineHeight(a,b._EDITOR.design,m.lineHeight));var z=m.textAlign;""!=z&&-1<z.toLowerCase().indexOf("right")?(setSelectionWithDextmark(null,!0),command_align(a,b,"right")):-1<z.toLowerCase().indexOf("left")?(setSelectionWithDextmark(null,!0),command_align(a,
b,"left")):-1<z.toLowerCase().indexOf("center")?(setSelectionWithDextmark(null,!0),command_align(a,b,"center")):-1<z.toLowerCase().indexOf("full")&&(setSelectionWithDextmark(null,!0),command_align(a,b,"justify"));""!=m.paddingLeft&&(setSelectionWithDextmark(),command_setIndentOutdent(a,b,m.paddingLeft));""!=m.backgroundColor&&(setSelectionWithDextmark(),command_fontBgColor(a,b._EDITOR.design,m.backgroundColor));1==m.sup&&(setSelectionWithDextmark(),command_superscript(a,b));1==m.sub&&(setSelectionWithDextmark(),
command_subscript(a,b));m.nowApplying="0";void 0==c&&void 0==d||_iframeWin.scroll(c,d);removeDextmark(!0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}catch(A){m.nowApplying="0",removeDextmark()}}
function command_setIndentOutdent(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();b=getFirstRange().range;if(!(b&&GetTDTHCell(b.startContainer)&&0<b.toString().length)){a=getNodesInRange(b);null!=b.startContainer.previousSibling&&"HEAD"==b.startContainer.previousSibling.tagName&&null==b.endContainer.nextSibling&&(a=_iframeDoc.body.childNodes);b=a.length;for(var d=0;d<b;d++)null!=a[d].parentNode&&"body"==a[d].parentNode.nodeName.toLowerCase()&&"table"!=a[d].tagName.toLowerCase()&&
(0<parseIntOr0(a[d].style.paddingLeft)&&(a[d].style.paddingLeft=""),a[d].style.marginLeft=c)}}
function command_margin(a,b,c,d){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var e=getFirstRange().range;a=GetTableSelectionCells();b=a.length;if(0==b)for(a=getNodesInRange(e),null!=e.startContainer.previousSibling&&"HEAD"==e.startContainer.previousSibling.tagName&&null==e.endContainer.nextSibling&&(a=_iframeDoc.body.childNodes),b=a.length,e=0;e<b;e++)null==a[e].parentNode||"body"!=a[e].parentNode.nodeName.toLowerCase()&&"td"!=a[e].parentNode.nodeName.toLowerCase()&&"td"!=
a[e].parentNode.nodeName.toLowerCase()||!a[e].tagName||"table"==a[e].tagName.toLowerCase()||("margin"==c?a[e].style.margin=d:("marginTop"==c&&(a[e].style.marginTop=d),"marginBottom"==c&&(a[e].style.marginBottom=d),"marginLeft"==c&&(a[e].style.marginLeft=d),"marginRight"==c&&(a[e].style.marginRight=d)));else for(e=0;e<b;e++)for(var f=a[e].childNodes,g=f.length,h=0;h<g;h++)1!=f[h].nodeType||"P"!=f[h].tagName&&"SPAN"!=f[h].tagName||("margin"==c?f[h].style.margin=d:("marginTop"==c&&(f[h].style.marginTop=
d),"marginBottom"==c&&(f[h].style.marginBottom=d),"marginLeft"==c&&(f[h].style.marginLeft=d),"marginRight"==c&&(f[h].style.marginRight=d)))}
function command_textIndent(a,b,c,d){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var e=getFirstRange().range;a=GetTableSelectionCells();b=a.length;if(0==b)for(a=getNodesInRange(e),null!=e.startContainer.previousSibling&&"HEAD"==e.startContainer.previousSibling.tagName&&null==e.endContainer.nextSibling&&(a=_iframeDoc.body.childNodes),b=a.length,e=0;e<b;e++)null==a[e].parentNode||"body"!=a[e].parentNode.nodeName.toLowerCase()&&"td"!=a[e].parentNode.nodeName.toLowerCase()&&"td"!=
a[e].parentNode.nodeName.toLowerCase()||"table"==a[e].tagName.toLowerCase()||"textIndent"!=c||(a[e].style.textIndent=d);else for(e=0;e<b;e++)for(var f=a[e].childNodes,g=f.length,h=0;h<g;h++)1!=f[h].nodeType||"P"!=f[h].tagName&&"SPAN"!=f[h].tagName||"textIndent"!=c||(f[h].style.textIndent=d)}
function command_imageAlign(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();getFirstRange();a=DEXTTOP.G_SELECTED_IMAGE_ELEMENT;""==c?a.removeAttribute("align"):a.setAttribute("align",c)}
function command_letterSpacing(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var d=getFirstRange().range;try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endOffset),3==d.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer),3==d.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer.parentNode):
(DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer),1==d.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(d.endContainer.innerText||d.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.toString().length)}catch(e){DEXTTOP.G_CURREDITOR.beforeOffset=null}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a="p span li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" ");var f=a.length,g,h,n=GetTableSelectionCells();if(0==n.length){if(null!=
d.startContainer.previousSibling&&"HEAD"==d.startContainer.previousSibling.tagName&&null==d.endContainer.nextSibling){for(b=0;b<f;b++){g=_iframeDoc.body.getElementsByTagName(a[b]);h=g.length;for(var m=0;m<h;m++)"span"==g[m].tagName.toLowerCase()?""!=g[m].style.letterSpacing&&(g[m].style.letterSpacing=c):g[m].style.letterSpacing=c}f=_iframeDoc.body.getElementsByTagName("table");g=f.length;for(b=0;b<g;b++){h=f[b].rows;for(var p=h.length,m=0;m<p;m++)for(var n=h[m].cells,d=n.length,t=0;t<d;t++)setBlockTag(n[t].childNodes,
a,"letterSpacing",c)}setBlockTag(_iframeDoc.body.childNodes,a,"letterSpacing",c);g=_iframeDoc.body.getElementsByTagName("div");h=g.length;for(m=0;m<h;m++)setBlockTag(g[m].childNodes,a,"letterSpacing",c)}else{g=getNodesInRange(d);h=g.length;0==d.toString().length&&0==d.getNodes().length&&d.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(n=0;n<h;n++)if(1==g[n].nodeType&&(t=g[n].tagName.toLowerCase(),-1<a.indexOf(t))){if("div"!=t)for(b=0;b<f;b++)for(var p=g[n].getElementsByTagName(a[b]),q=p.length,
m=0;m<q;m++)"span"==p[m].tagName.toLowerCase()?""!=p[m].style.letterSpacing&&(p[m].style.letterSpacing=c):p[m].style.letterSpacing=c;"span"==t?""!=g[n].style.letterSpacing&&(g[n].style.letterSpacing=c):g[n].style.letterSpacing=c}var u;0==d.toString().length&&1==d.getNodes().length&&(u=d.getNodes()[0],g.push(d.getNodes()[0]));setBlockTag(g,a,"letterSpacing",c)}(c=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(c,1),c.parentNode.removeChild(c)):u&&(c=getFirstRange().range,getFirstRange().sel.removeAllRanges(),
c.selectNode(u),getFirstRange().sel.addRange(c))}else for(d=n.length,b=0;b<d;b++){for(m=0;m<f;m++)for(g=n[b].getElementsByTagName(a[m]),h=g.length,t=0;t<h;t++)"span"==g[t].tagName.toLowerCase()?""!=g[t].style.letterSpacing&&(g[t].style.letterSpacing=c):g[t].style.letterSpacing=c;setBlockTag(n[b].childNodes,a,"letterSpacing",c);g=n[b].getElementsByTagName("div");h=g.length;for(m=0;m<h;m++)setBlockTag(g[m].childNodes,a,"letterSpacing",c)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0;DEXTTOP.G_CURREDITOR.beforeOffset=null}function command_InsertOpenFile(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();a=c.data;"html"!=c.fileExt&&"htm"!=c.fileExt&&"txt"==c.fileExt&&(a=htmlSpecialChars(c.data),a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a));DEXTTOP.DEXT5.setHtmlContents(a)}
function command_InsertBlockquote(a,b,c){a="";switch(c.tagvalue){case "1":a="margin:0 0 30px 20px;padding:0 8px;border-left:2px solid #999999";break;case "2":a="margin:0 0 30px 13px;padding:0 8px 0 16px;background:url("+DEXTTOP.G_CURREDITOR._config.webPath.image+"icon/img_blockquote02.gif)  0 3px no-repeat;";break;case "3":a="BORDER-TOP: #7a7d83 1px dashed; BORDER-RIGHT: #7a7d83 1px dashed; BORDER-BOTTOM: #7a7d83 1px dashed; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px dashed; PADDING-RIGHT: 10px;";
break;case "4":a="BORDER-TOP: #007ace 1px dashed; BORDER-RIGHT: #007ace 1px dashed; BORDER-BOTTOM: #007ace 1px dashed; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #007ace 1px dashed; PADDING-RIGHT: 10px;";break;case "5":a="BORDER-TOP: #7a7d83 1px dashed; BORDER-RIGHT: #7a7d83 1px dashed; background:#ebebeb; BORDER-BOTTOM: #7a7d83 1px dashed; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px dashed; PADDING-RIGHT: 10px";
break;case "6":a="BORDER-TOP: #7a7d83 1px solid; BORDER-RIGHT: #7a7d83 1px solid; BORDER-BOTTOM: #7a7d83 1px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px solid; PADDING-RIGHT: 10px;";break;case "7":a="BORDER-TOP: #007ace 1px solid; BORDER-RIGHT: #007ace 1px solid; BORDER-BOTTOM: #007ace 1px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #007ace 1px solid; PADDING-RIGHT: 10px;";
break;case "8":a="BORDER-TOP: #7a7d83 1px solid; BORDER-RIGHT: #7a7d83 1px solid; background:#ebebeb; BORDER-BOTTOM: #7a7d83 1px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #7a7d83 1px solid; PADDING-RIGHT: 10px";break;case "9":a="BORDER-TOP: #999 2px solid; BORDER-RIGHT: #999 2px solid; BORDER-BOTTOM: #999 2px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #999 2px solid; PADDING-RIGHT: 10px";
break;case "10":a="BORDER-TOP: #007ace 2px solid; BORDER-RIGHT: #007ace 2px solid; background:#ebebeb; BORDER-BOTTOM: #007ace 2px solid; ZOOM: 1; PADDING-BOTTOM: 10px; PADDING-TOP: 10px; PADDING-LEFT: 10px; MARGIN: 0px 0px 30px; BORDER-LEFT: #007ace 2px solid; PADDING-RIGHT: 10px"}dext_src_init(b);restoreSelection();setFocusToBody();b=getFirstRange();c=b.range;try{var d=GetParentbyTagName(c.startContainer,"blockquote"),e=GetParentbyTagName(c.endContainer,"blockquote"),f=d,g=!1;if(null!=d||null!=e)if(d==
e)g=!0;else if(d!=e){var h=c.commonAncestorContainer;if(h&&h.tagName&&"blockquote"==h.tagName.toLowerCase())f=h;else{if(d)c.setStartBefore(d.firstChild);else{for(d=c.startContainer;!d.tagName;)d=d.parentNode;c.setStartBefore(d)}e||(e=c.endContainer);for(;e.parentNode!=h;)e=e.parentNode;for(;d.parentNode!=h;)d=d.parentNode;f=_iframeDoc.createElement("blockquote");h.insertBefore(f,d);c.setStartAfter(f);c.setEndAfter(e);c.surroundContents(f);c.setStartBefore(f.firstChild);c.setEndAfter(f.lastChild);
b.sel.removeAllRanges();b.sel.addRange(c)}g=!0}if(g)f.style.cssText=a;else{c&&0==c.toString().length&&c.startContainer==c.endContainer&&c.startContainer.tagName&&"p"==c.startContainer.tagName.toLowerCase()&&"<br>"==c.startContainer.innerHTML&&(c.startContainer.innerHTML=unescape("%u200B"));DoExecuteCommand2(b.sel,c,"indent");var n=getFirstRange().range;0==!!n&&(n=range);for(var m=getNodesInRange(n),p=m.length,e=0;e<p;e++)if("blockquote"==m[e].nodeName.toLowerCase()){m[e].style.cssText=a;break}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(t){}}function command_CancelBlockquote(a,b){dext_src_init(b);restoreSelection();setFocusToBody();var c=getFirstRange().range;if(c=GetParentbyTagName(c.startContainer,"blockquote")){for(;0<c.childNodes.length;)c.parentNode.insertBefore(c.childNodes[0],c);null!=c.previousSibling&&doSetCaretPosition(c.previousSibling,1);c.parentNode.removeChild(c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}
function command_inputSameWidthHeight(a,b,c){"1"==b._config.formMode&&(dext_src_init(b._EDITOR.design),restoreSelection(),setFocusToBody(),"width"==c?d5ApplySameWidth():"height"==c?d5ApplySameHeight():"widthheight"==c&&d5ApplySameWidthHeight(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_setAccessibility(a,b,c,d,e){dext_src_init(b);a=!1;if(c.idSamMode)c.id!=c.sameOrgId&&(d.setAttribute("id",c.id),a=!0);else if(b=null,a=d.getAttribute("dext5customdata"),null!=a&&void 0!=a&&(b=getDextCustomData(a)),c.skip)d.setAttribute("dext5webaccskip","dext5webaccskip"),a=!0;else{d.removeAttribute("dext5webaccskip");a=!1;var f=d.tagName.toLowerCase();if(-1<"frame,framset,a".indexOf(f)||b&&("iframe"==b.type||"iframe"==b.type2))b?b.title=c.title:d.title=c.title,""!=c.title&&(a=!0);
else if("table"==f){if(-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("table_caption")||""==DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems)if(d.caption)if(""==c.title){b=0;for(var f=d.childNodes.length,g=0;g<f;g++)if(d.childNodes[g].nodeName.match(/caption/i)){b=g;break}d.removeChild(d.childNodes[b])}else d.caption.innerHTML=c.title,a=!0;else""!=c.title&&(a=_iframeDoc.createElement("caption"),a.innerHTML=c.title,d.insertBefore(a,d.firstChild),a=!0);else a=!0;a=a&&
""!=c.alt?!0:!1;if(-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("table_summary")||""==DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems)d.summary=c.alt}else""!=c.alt&&(a=!0),d.alt=c.alt}c=_iframeDoc.createElement("img");c.alt="web_accessibility_ok";c.src="../images/editor/dialog/check01.png";c.name="chkImg";d=e.getElementsByTagName("img");b=e.getElementsByTagName("div");a?0<b.length&&("chkImg"!=d[0].name&&e.insertBefore(c,b[0]),b[0].style.display="none"):("chkImg"==
d[0].name&&e.removeChild(d[0]),0<b.length&&(b[0].style.display=""))}
function command_calculationFormula(a,b,c){a=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);if(null!=a){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d;switch(c){case "horizontal_sum":case "horizontal_avg":d=getLeftHorizontalCells(a);break;case "vertical_sum":case "vertical_avg":d=getTopVerticalCells(a)}for(var e=d.length,f=b=0,g=!1,h=0;h<e;h++){var n=d[h].innerHTML,n=n.replace(/\r/g,""),n=n.replace(/[\n|\t]/g,""),n=n.replace(/[\v|\f]/g,""),n=n.replace(/<p><br><\/p>/gi,
"\n"),n=n.replace(/<P>&nbsp;<\/P>/gi,"\n"),n=n.replace(/<br(\s)*\/?>/gi,"\n"),n=n.replace(/<br(\s[^\/]*)?>/gi,"\n"),n=n.replace(/<\/p(\s[^\/]*)?>/gi,"\n"),n=n.replace(/<\/li(\s[^\/]*)?>/gi,"\n"),n=n.replace(/<\/tr(\s[^\/]*)?>/gi,"\n");nIdx=n.lastIndexOf("\n");-1<nIdx&&"\n"==n.substring(nIdx)&&(n=n.substring(0,nIdx));n=removeStripTags(n,null);n=unhtmlSpecialChars(n);-1<n.indexOf(",")&&(g||(g=!0),n=n.replace(/,/gi,""));isNaN(Number(n))||""==n||(b=command_NumCal(b,n,"+"),f++)}if("horizontal_avg"==c||
"vertical_avg"==c)b=command_NumCal(b,f,"/");b||(b=0);b=b.toString();g&&(b=-1<b.indexOf(".")?fnCommaExec(b.substring(0,b.indexOf(".")))+b.substring(b.indexOf("."),b.length):fnCommaExec(b));c=_iframeDoc.createElement("p");c.innerHTML=b;a.innerHTML="";a.appendChild(c);doSetCaretPosition(c,1);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}
function command_NumCal(a,b,c){if(isNaN(Number(a))||isNaN(Number(b)))return!1;var d,e,f;e=/\./;e.test(a)?(a=a.toString(),d=a.split("."),d=d[1].length):d=0;e.test(b)?(b=b.toString(),e=b.split("."),e=e[1].length):e=0;d=d>e?d:e;e="1";for(var g=1;g<=d;g++)e+="0";switch(c){case "+":f=Math.round(Number(a)*e+Number(b)*e)/e;break;case "/":f=Number(a)/Number(b)}return f}
function command_tableSelection(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(a=getFirstRange().range){if(!c){c=GetTDTHCell(a.startContainer);if(null==c||void 0==c)return;c=GetParentbyTagName(c,"table");if(null==c)return}if(getApplyDragResize(b))DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=c,clearInterval(DEXTTOP.G_CURREDITOR.dext_dragresize.dextResizeIconInterval),DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,
!1,null);else{b=_iframeDoc.body.createControlRange();try{ClearDraggingTableCellSelected(),b.add(c),b.select(),DEXTTOP.G_SELECTED_ELEMENT=c,setMenuIconRealable(c),_iframeDoc_MouseUpMenu(null,c)}catch(d){}}}}
function command_showBlocks(a,b){document.getElementById("ue_editor_holder_"+a);if(""==DEXTTOP.G_CURREDITOR.ShowBlocks){var c=DEXTTOP.G_CURREDITOR._config.webPath.css;DEXTTOP.DEXT5.isRelease||(c=DEXTTOP.G_CURREDITOR._config.webPath.css_dev);DEXTTOP.DEXT5.addUserCssUrl(c+"editor_showblocks.css?ver="+DEXTTOP.DEXT5.ReleaseVer);DEXTTOP.G_CURREDITOR.ShowBlocks="show_blocks"}else{for(var c=b._DOC.getElementsByTagName("link"),d=null,e=c.length-1;0<=e;e--)-1<c[e].href.indexOf("editor_showblocks.css")&&(d=
c[e],d.parentNode.removeChild(d));DEXTTOP.G_CURREDITOR.ShowBlocks=""}c=[];"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks?c.push("show_blocks"):removeArrayItemByValue(c,"show_blocks");DEXTTOP.G_CURREDITOR._iconSelected(c)}
function command_tableLock(a,b){var c=getFirstRange().range.startContainer;3==c.nodeType&&(c=c.parentNode);var d=getSelectionTable(b);if(d)if(checkLockAttr(d,!0))removeLockAttr(d),removeClassName(d,"DEXT_five_table_lock");else{var e=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,f=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultTableLockMode,g=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultShowLockIconUserMode;setClassName(d,"DEXT_five_table_lock");d.setAttribute(e,"");d.setAttribute("lock_mode",
f);d.setAttribute("show_icon",g)}else{e=GetTableSelectionCells();f=e.length;g=GetTDTHCell(c);if(0<f)d=GetParentbyTagName(e[0],"table");else{if(null==g||"TD"!=g.tagName&&"TH"!=g.tagName)return;d=GetParentbyTagName(g,"table")}d&&(checkLockAttr(d,!0)?(removeLockAttr(d),removeClassName(d,"DEXT_five_table_lock")):(e=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,f=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultTableLockMode,g=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultShowLockIconUserMode,
setClassName(d,"DEXT_five_table_lock"),d.setAttribute(e,""),d.setAttribute("lock_mode",f),d.setAttribute("show_icon",g)))}c&&1==c.nodeType&&setMenuIconRealable(c)}
function command_cellLock(a,b){var c=GetTableSelectionCells(),d=c.length,e=getFirstRange().range.startContainer;3==e.nodeType&&(e=e.parentNode);currElem=GetTDTHCell(e);if(0<d){var f=!1;checkLockAttr(c[0],!0)&&(f=!0);for(var g=0;g<d;g++)f?(removeLockAttr(c[g]),removeClassName(c[g],"DEXT_five_cell_lock")):(c[g].setAttribute("dext_lock",""),setClassName(c[g],"DEXT_five_cell_lock"))}else{if(null==currElem||"TD"!=currElem.tagName&&"TH"!=currElem.tagName)return;checkLockAttr(currElem,!0)?(removeLockAttr(currElem),
removeClassName(currElem,"DEXT_five_cell_lock")):(currElem.setAttribute("dext_lock",""),setClassName(currElem,"DEXT_five_cell_lock"))}e&&1==e.nodeType&&setMenuIconRealable(e)}
function command_help(){var a="ko";"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(a="en");var a=DEXTTOP.G_CURREDITOR._config.webPath.help+"index_"+a+".html",b=1200,c=screen.availHeight,d=40;DEXTTOP.DEXT5.browser.ie?d=40:DEXTTOP.DEXT5.browser.chrome?d=70:DEXTTOP.DEXT5.browser.gecko?d=40:DEXTTOP.DEXT5.browser.opera?d=80:DEXTTOP.DEXT5.browser.safari&&(d=100);var e=screen.availHeight;e<=c&&(c=e-d);try{b>parseInt(screen.width,10)&&(b=parseInt(screen.width,10)-50)}catch(f){}d=0;try{d=screen.width/2-b/2}catch(g){}var h=
DEXTTOP.DEXTWIN.open(a,"DEXT5Help","width="+b+","+("height="+c)+","+("left="+d+"px")+",top=0px,resizable=yes");setTimeout(function(){h.focus()},100)}
function command_wordTransform(a,b){if(G_dext5plugIn){setImageSizeForProperty();var c=_iframeDoc.getElementsByTagName("head")[0].getElementsByTagName("style")[0],d=c.innerHTML,e=d.replace("margin:0px 10px 10px 10px;","").replace("MARGIN: 0px 10px 10px","").replace("margin:10px;","").replace("MARGIN: 10px","");if(c.styleSheet){c.styleSheet.cssText=e;try{c.innerHTML=e}catch(f){}}else c.innerHTML=e;e=DEXTTOP.DEXT5.getHtmlValueEx(a);if(c.styleSheet){c.styleSheet.cssText=d;try{c.innerHTML=d}catch(g){}}else c.innerHTML=
d;c=G_dext5plugIn.getHTMLValueFromApplication(e,0);""!=c&&DEXTTOP.DEXT5.setBodyValue(c,a)}}function command_InsertMiniPhotoEditor(a,b,c){if("1"==DEXTTOP.G_CURREDITOR._config.useMiniImageEditor){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var d=DEXTTOP.DEXTWIN;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(d=DEXTTOP.G_CURREDITOR.dialogWindow);d.KMINIPHOTO&&1==d.KMINIPHOTO.miniPhotoCreation?show_MiniPhotoEditor(a,b,c):create_MiniPhotoEditor(a,b,c)}}
function create_MiniPhotoEditor(a,b,c){try{if("1"==DEXTTOP.G_CURREDITOR._config.useMiniImageEditor){var d=DEXTTOP.DEXTWIN;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(d=DEXTTOP.G_CURREDITOR.dialogWindow);if(null==d.document.getElementById("k_mini_photo")){miniPhotoCallback=function(){d.KMINIPHOTO.isRelease=DEXTTOP.DEXT5.isRelease;new d.KMINIPhoto({Id:"kminiphoto",Lang:DEXTTOP.G_CURREDITOR._config.lang,PhotoHolder:"k_mini_photo",ZIndex:DEXTTOP.G_CURREDITOR._config.zIndex+5E3,AutoDestroy:DEXTTOP.G_CURREDITOR._config.autoDestroy.use,
Width:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.width,Height:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.height,BackgroundColor:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.backgroundColor,BackgroundOpacity:DEXTTOP.G_CURREDITOR._config.miniPhotoEditor.backgroundOpacity,CreationCompleteEvent:function(){d.KMINIPHOTO.miniPhotoCreation=!0}})};var e=d.document.createElement("div");e.id="k_mini_photo";e.style.display="none";d.document.body.appendChild(e);var f=d.document.getElementsByTagName("head")[0],
g=d.document.createElement("script");g.type="text/javascript";var h=!1;g.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState||h||(h=!0,miniPhotoCallback())};g.onload=function(){h||(h=!0,miniPhotoCallback())};g.src=DEXTTOP.DEXT5.isRelease?DEXTTOP.DEXT5.rootPath+"imageEdit/js/kminiphoto.js":DEXTTOP.DEXT5.rootPath+"imageEdit/js_dev/kminiphoto.js";f.appendChild(g)}}}catch(n){}d=DEXTTOP.DEXTWIN;null!=DEXTTOP.G_CURREDITOR.dialogWindow&&(d=DEXTTOP.G_CURREDITOR.dialogWindow);
if(d.KMINIPHOTO&&1==d.KMINIPHOTO.miniPhotoCreation)show_MiniPhotoEditor(a,b,c);else var m=setInterval(function(){d.KMINIPHOTO&&d.KMINIPHOTO.miniPhotoCreation&&(clearInterval(m),show_MiniPhotoEditor(a,b,c))},1E3)}
function show_MiniPhotoEditor(a,b,c){a=function(a){var c;a?(0==a.toLowerCase().indexOf("file://")&&G_dext5plugIn&&(a=G_dext5plugIn.getBase64ImageFromLocalImage(a)),b.miniPhotoLastMode="modify",c={url:a,width:DEXTTOP.G_SELECTED_IMAGE_ELEMENT.clientWidth,height:DEXTTOP.G_SELECTED_IMAGE_ELEMENT.clientHeight,dialogWindow:b.dialogWindow?b.dialogWindow:null,completeEvent:kMiniPhotoComplete}):(b.miniPhotoLastMode="new",c={url:null,width:"",height:"",dialogWindow:b.dialogWindow?b.dialogWindow:null,completeEvent:kMiniPhotoComplete});
var f=getDialogWindow();setTimeout(function(){DEXTTOP.DEXT5.isClickedMiniPhoto=!1;f.KMINIPHOTO.ShowPhotoPopup(c)},20)};c?DEXTTOP.G_SELECTED_IMAGE_ELEMENT&&"IMG"==DEXTTOP.G_SELECTED_IMAGE_ELEMENT.tagName&&(c=DEXTTOP.G_SELECTED_IMAGE_ELEMENT.src,a(c)):(c=getFirstRange().range,c.startOffset==c.endOffset&&0==c.toString().length?a(null):DEXTTOP.G_SELECTED_IMAGE_ELEMENT&&"IMG"==DEXTTOP.G_SELECTED_IMAGE_ELEMENT.tagName&&(c=DEXTTOP.G_SELECTED_IMAGE_ELEMENT.src,a(c)))}
function command_InsertImagePhotoEdit(a,b){var c=DEXTTOP.G_CURREDITOR._config.photoEditorId;null!=DEXTTOP.DEXT5.config.DialogWindow?""!=c?DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(c):DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup():""!=c?(DEXTTOP.DEXT5PHOTO.ShowPopup(c),DEXTTOP.DEXT5PHOTO.Reset(c),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!0,c)):(DEXTTOP.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXT5PHOTO.Reset(),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!0))}
function kMiniPhotoComplete(a,b){dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design);restoreSelection();setFocusToBody();var c=b.src;if(G_dext5plugIn){if("base64"!=DEXTTOP.G_CURREDITOR._config.uploadMethod){var d="jpg";try{if("data:"==c.substring(0,5)){var e=c.split(",");2==e.length&&(d=getExtFromImageDataSrc(e[0]))}}catch(f){}c=G_dext5plugIn.getLocalImageFromBase64Image(c,d)}"new"==DEXTTOP.G_CURREDITOR.miniPhotoLastMode?(d=_iframeDoc.createElement("img"),d.src=c,d.alt="",c=getFirstRange().range,c.deleteContents(),
c.collapse(!0),c.pasteHtml(d.outerHTML),c.collapse(!1)):(DEXTTOP.G_SELECTED_IMAGE_ELEMENT.src=c,DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.width=b.width,DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.height=b.height)}else e=c.split(","),2==e.length&&(d=getExtFromImageDataSrc(e[0])),"new"==DEXTTOP.G_CURREDITOR.miniPhotoLastMode?postBase64ImageToServer(e[1],d,null,!0):(postBase64ImageToServer(e[1],d,DEXTTOP.G_SELECTED_IMAGE_ELEMENT,!0),DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.width=b.width,DEXTTOP.G_SELECTED_IMAGE_ELEMENT.style.height=
b.height);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{contentChangeEventWrapper()}catch(g){}}
function command_photoEditProperty(a,b){if(null!=DEXTTOP.G_SELECTED_ELEMENT){var c=DEXTTOP.G_CURREDITOR._config.photoEditorId;null!=DEXTTOP.DEXT5.config.DialogWindow?""!=c?(DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(c),DEXTTOP.DEXTWIN.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src,c),DEXTTOP.DEXTWIN.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1,c)):(DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXTWIN.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src),DEXTTOP.DEXTWIN.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,
!1)):""!=c?(DEXTTOP.DEXT5PHOTO.ShowPopup(c),DEXTTOP.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src,c),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1,c)):(DEXTTOP.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1))}}
function command_showTableBorder(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=_iframeDoc.body.getElementsByTagName("table"),d=c.length,e=[];if(1==DEXTTOP.G_CURREDITOR.ShowTableBorder){for(var f=0;f<d;f++)removeClassName(c[f],"DEXT_tableborder");removeArrayItemByValue(e,"table_border");DEXTTOP.G_CURREDITOR.ShowTableBorder=!1}else{for(f=0;f<d;f++)checkExistClassName(c[f].className,"DEXT_tableborder")||setClassName(c[f],"DEXT_tableborder");e.push("table_border");DEXTTOP.G_CURREDITOR.ShowTableBorder=
!0}DEXTTOP.G_CURREDITOR._iconSelected(e)}function command_pasteToImage(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();b.bTextorHtmlData="image"==c.type?!1:!0;command_pasteHtml5(b,c)}
function command_pasteHtml5(a,b){var c=a.clipData,d=a.pasteEvt;if(DEXTTOP.G_CURREDITOR.setTextPaste)for(var e="span font strong i em u strike s sub sup".split(" "),f=e.length,c=c.replace(/<b>/gi,""),c=c.replace(/<b ([^>?+])*>/gi,""),c=c.replace(/<\/b>/gi,""),g=0;g<f;g++)var h=new RegExp("</"+e[g]+">","gi"),c=c.replace(new RegExp("<"+e[g]+" *([^>?+])*>","gi"),""),c=c.replace(h,"");c=dummyTagClassClear(c);if(a.bTextorHtmlData)0<c.length&&("1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker?(showProcessingBackground(),
fn_processHtmlWorker({editorBrowser:{ie:DEXTTOP.DEXT5.browser.ie,ieVersion:DEXTTOP.DEXT5.browser.ieVersion,gecko:DEXTTOP.DEXT5.browser.gecko},editorConfig:a._config,callFn:"SetCorrectOfficeHtml",callFnParam:[c],callBackFn:command_pasteHtml5_After}),DEXTTOP.DEXT5.util.cancelEvent(d)):(c=SetCorrectOfficeHtml(c),command_pasteHtml5_After(c,a)));else if("0"==a._config.paste_image_base64_remove&&setPasteImageFromClipboard(d,b),0==DEXTTOP.DEXT5.browser.gecko)a.UndoManager.putUndo(),a.UndoManager.charCount=
0,DEXTTOP.DEXT5.util.cancelEvent(d),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){}},500);else return!0}
function command_pasteHtml5_After(a,b,c){"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&destoryWebWorkerVar();"undefined"==typeof b&&(b=DEXTTOP.G_CURREDITOR);"undefined"!=typeof c&&(G_wordProcessorType=c);a=SetCorrectOfficeHtmlForDOM(a);"1"==b._config.useHtmlCorrection&&(a=htmlTagRevision(a,!0));a=removeTagStyle(a);a=repairPasteTextInCell(a);0<b.UndoManager.charCount&&(b.UndoManager.putUndo(),b._iconEnable(""));a=DEXTTOP.DEXT5.util.officeClean(a,!1);a=OfficePasteClean(a);a=DEXTTOP.DEXT5.util.emptyTagRemove(a);
a=DEXTTOP.DEXT5.util.htmlRevision(a);a=xssReplaceScript(null,a);a=b._FRAMEWIN.DEXT5_EDITOR.HTMLParser.RemoveOfficeTag2(a);"1"==b._config.ie_BugFixed_Hyfont&&(a=DEXTTOP.DEXT5.util.replaceHyFont(a,b));c=!1;if("base64"==b._config.uploadMethod&&a&&""!=a&&"-1"!=b._config.maxImageBase64fileCount){var d=getBase64ImageCountEx(a);0<d&&getBase64ImageCount()+d>parseInt(b._config.maxImageBase64fileCount,10)&&(c=dext5_lang.msg.max_base64file_count,c=c.replace("{0}",b._config.maxImageBase64fileCount),alert(c),
c=!0)}if(!c){"1"==b._config.tableAutoAdjustInPaste&&/<table/i.test(a)&&(a=command_AdjustTableAndCellWidth(b.ID,b,{type:"paste",htmlData:a}));if("function"==typeof DEXTTOP.DEXTWIN.dext_editor_beforepaste_event){c=a;try{c=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(a)}catch(e){c=a}if(c)a=c;else if(0==c||""==c){DEXTTOP.DEXT5.util.cancelEvent(b.pasteEvt);"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}}if(!pasteWordCount(a)){DEXTTOP.DEXT5.util.cancelEvent(b.pasteEvt);
"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();return}-1<a.indexOf("dext5customdata")&&(a=checkExistCustomData(a));d=GetTableSelectionCells();c=document.createElement("div");c.innerHTML=a;c=c.childNodes;if(1==c.length&&c[0].tagName&&"table"==c[0].tagName.toLowerCase()&&0<d.length)command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,c[0]);else{d=!1;if("1"==DEXTTOP.G_CURREDITOR._config.useTablePasteDialog){var f=getFirstRange().range,g=null;f.startContainer==
f.endContainer&&(g=f.startContainer,3==g.nodeType&&(g=g.parentNode),g=GetTDTHCell(g));g&&1==c.length&&c[0].tagName&&"table"==c[0].tagName.toLowerCase()&&(d=!0)}d?(DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode=c[0],DEXTTOP.G_CURREDITOR.pasteTableParam.tableHtml=a,DEXTTOP.G_CURREDITOR.pasteTableParam.currCellNode=g,DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode=GetParentbyTagName(g,"table"),null!=dragPopup&&0!=(dragPopup&&"none"!=dragPopup.style.display)||DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.paste_table)):_iframeDoc.execCommand("inserthtml",!1,a)}if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)for(g=getElementsByClass("raon_placeholder",_iframeDoc.body,"span"),c=g.length,d=0;d<c;d++)g[d].getAttribute("contentEditable")||g[d].setAttribute("contentEditable","true");checkPasteImage(a);if(g=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(g);0>a.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),
b._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1),xssReplaceScript(_iframeDoc),ClearDraggingTableAllTable())}"1"==DEXTTOP.G_CURREDITOR._config.useHtmlProcessByWorker&&hideProcessingBackground();if(0==DEXTTOP.DEXT5.browser.gecko){b.UndoManager.putUndo();b.UndoManager.charCount=0;DEXTTOP.DEXT5.util.cancelEvent(b.pasteEvt);try{contentChangeEventWrapper()}catch(h){}}else return!0}
function command_insertLayer(a,b){try{dext_src_init(b._EDITOR.design);getApplyDragResize(b)&&DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear();restoreSelection();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);getFirstRange();var c=_iframeDoc.createElement("div");c.style.display="block";c.className="DEXT_fiVe_Layer";c.style.width="150px";c.style.height="100px";c.style.border=
"#000000 1px solid";c.style.position="absolute";var d=getWindowScrollPos(_iframeWin);c.style.left=d[0]+30+"px";c.style.top=d[1]+30+"px";_iframeDoc.body.appendChild(c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(e){}}
function command_elementZindex(a,b,c){try{if(DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem){var d=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem;d.style.position="absolute";var e=_iframeDoc.body.getElementsByTagName("*"),f=e.length;a=[];for(b=0;b<f;b++)1==e[b].nodeType&&-1<",img,iframe,table,embed,div,".indexOf(","+e[b].tagName.toLowerCase()+",")&&a.push(e[b]);var g=a.length;for(b=g-1;0<=b;b--)for(var h=1;h<=b;h++)if(a[h-1].style.zIndex>a[h].style.zIndex){var n=
a[h-1];a[h-1]=a[h];a[h]=n}switch(c){case 1:d!=a[a.length-1]&&(d.style.zIndex=a[a.length-1].style.zIndex+1);break;case 2:if(d!=a[0])for(b=0;b<g;b++)d==a[b]?d.style.zIndex=0:a[b].style.zIndex+=1;break;case 3:if(d!=a[a.length-1])for(b=0;b<g;b++)if(d==a[b]){a[b]=a[b+1];a[b+1]=d;for(h=0;h<g;h++)a[h].style.zIndex=h;break}break;case 4:if(d!=a[0])for(b=0;b<g;b++)if(d==a[b]){a[b]=a[b-1];a[b-1]=d;for(h=0;h<g;h++)a[h].style.zIndex=h;break}}}}catch(m){}}
function command_elementPosition(a,b){try{getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResizeDiv&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem.style.position="absolute"==DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem.style.position?"":"absolute",DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear())}catch(c){}}
function command_insert_datetime(a,b,c){try{dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=getFirstRange().range,e;if(c)e=c;else if("undefined"!=typeof DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG||"undefined"!=typeof DEXTTOP.DEXTWIN.G_CURREDITOR._FRAMEWIN.DEXT_LANG_CONFIG.dateTime){e=DEXTTOP.G_CURREDITOR.lastDateType;var f=DEXTTOP.G_CURREDITOR._config.lang,f=f.replace("-",
""),g=new Date,h=c=b=a="",n="",m="",p="",t="",q="",u="",v="";a=g.getFullYear();b=a.toString().substring(2,4);c=DEXTTOP.DEXT5.util.leadingZeros(g.getMonth()+1,2);h=DEXTTOP.DEXT5.util.leadingZeros(g.getDate(),2);n=g.getDay();void 0!=DEXT_LANG_CONFIG.dateTime["date_"+f].Month[g.getMonth()]&&(m=DEXT_LANG_CONFIG.dateTime["date_"+f].Month[g.getMonth()]);void 0!=DEXT_LANG_CONFIG.dateTime["date_"+f].Day[n]&&(p=DEXT_LANG_CONFIG.dateTime["date_"+f].Day[n]);t=DEXTTOP.DEXT5.util.leadingZeros(g.getHours(),2);
q=DEXTTOP.DEXT5.util.leadingZeros(g.getMinutes(),2);u=DEXTTOP.DEXT5.util.leadingZeros(g.getSeconds(),2);v=12<=g.getHours()?"PM":"AM";e=e.replace("YYYY",a);e=e.replace("YY",b);e=e.replace("MM",c);e=e.replace("DD",h);e=e.replace("Month",m);e=e.replace("Day",p);e=e.replace("hh",t);e=e.replace("mm",q);e=e.replace("ss",u);e=e.replace("AMPM",v)}else e="";d.deleteContents();0<d.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);d.pasteHtml(e+'<span id="dext_datevalue">dext_datevalue</span>');
var w=_iframeDoc.getElementById("dext_datevalue");doSetCaretPosition(w,1);w.parentNode.removeChild(w);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(y){}}
function command_InsertConversion(a,b,c){try{dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=getFirstRange().range;d.deleteContents();var e=d.getDocument().createTextNode(c.text);d.insertNode(e);d.selectNode(e);d.select();if(e.parentNode&&e.parentNode.tagName&&"BODY"==e.parentNode.tagName){var f=_iframeDoc.createElement("p");_iframeDoc.body.insertBefore(f,e);f.appendChild(e)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(g){}}function command_InsertVideo(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();b=a.range;0<b.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);b.pasteHtml(c);a.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertCalculator(a,b,c){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();b=a.range;0<b.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);b.pasteHtml(c);a.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_zoom(a,b,c){try{var d=DEXTTOP.G_CURREDITOR.getEditorMode();b=null;"design"==d?b=_iframeDoc.body:"preview"==d&&(b=DEXTTOP.G_CURREDITOR._EDITOR.preview.contentDocument.body);d=0;"p"==c?d=10:"m"==c&&(d=-10);var e=document.getElementById("ue_"+a+"zoom_text").value,e=parseIntOr0(e)+d;0==e?(c=/\((.*)\)/i,b&&b.style.transform.match(c),e=""==RegExp.$1?100:100*parseFloat(RegExp.$1)):10>e&&(e=10);document.getElementById("ue_"+a+"zoom_text").value=e.toString()+"%";e/=100;DEXTTOP.DEXT5.browser.ie&&
10>DEXTTOP.DEXT5.browser.ieVersion?b.style.zoom=100*e+"%":(b.style.transform="scale("+e+")",b.style.transformOrigin="0% 0% 0px")}catch(f){}}
function command_InsertPlaceholder(a,b,c){try{dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=getFirstRange(),e=d.range;0<e.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var f=document.createElement("span");f.className="raon_placeholder";f.setAttribute("placeholder",c.notice);f.setAttribute("contenteditable","true");e.pasteHtml(f.outerHTML);d.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(g){}}
function command_InsertChart(a,b,c){var d=function(a){var b=a.split(",");4==b.length?(b[3]="0.7)",a=b.join()):(a=a.replace(/b/,"ba"),a=a.replace(/\)/,",0.7)"));return a},e=c.element,f=c.chart,g=c.preview;null==e||f||g||(c=DEXTTOP.DEXT5.util.makeDecryptReponseMessage(e.getAttribute("raon_chart")),f=JSON.parse(c.replace(/&quot;/g,'"')).data,f.width=e.clientWidth,f.height=e.clientHeight);c="line";a={};var h={responsive:!1},n=!0,m=!1,p,t,q,u,v,w,y;yStack=xStack=!1;a.labels=[];for(var x=1;x<f.data.length;x++)a.labels.push(f.data[x][0]);
x=f.type.split("-");c=x[0];x=x[1];switch(c){case "line":c="line";p=!1;t=f.color.column;if(2==x||4==x)w=0;if(3==x||4==x)y=0;break;case "bar":c=3==x||4==x?"horizontalBar":"bar";q=f.color.column;if(2==x||4==x)yStack=xStack=!0;break;case "area":c="line";q=f.color.column;p=!0;if(2==x||4==x)w=0;if(3==x||4==x)yStack=!0;break;case "circle":n=!1;1==x?c="pie":2==x&&(c="doughnut");q=f.color.column;break;case "radar":5==x?(c="polarArea",n=!1,q=f.color.column,h.layout={padding:{top:5,bottom:5}}):(c="radar",1==
x?u=q=t=f.color.column:2==x?(q=t=f.color.column,w=0):3==x?(t=f.color.column,p=!1,q=f.color.column,w=0):4==x&&(t=["rgba(0,0,0,0)"],p=!1,v=u=q=f.color.column));break;case "scatter":c=1==x?"scatter":"bubble",m=!0,q=f.color.column}a.datasets=[];var z=0;if(n)for(x=1;x<f.data[0].length;x++){var A={};if(m)if(A.label=f.data[0][x],q&&(A.backgroundColor=q[z]),A.data=[],"scatter"==c)for(var B=1;B<f.data.length;B++)A.data.push({x:f.data[B][0],y:f.data[B][x]});else{if("bubble"==c){for(B=1;B<f.data.length;B++)A.data.push({x:f.data[B][0],
y:f.data[B][x],r:f.data[B][x+1]});x++}}else{A.label=f.data[0][x];A.data=[];for(B=1;B<f.data.length;B++)A.data.push(f.data[B][x]);A.fill=p;A.pointRadius=w;A.lineTension=y;t&&(A.borderColor=t[z]?t[z]:t);q&&(A.backgroundColor=q[z]?d(q[z]):q);u&&(A.pointBorderColor=u[z]);v&&(A.pointBackgroundColor=d(v[z]))}a.datasets.push(A);z++}else{a.labels=f.data[0];A={data:f.data[1],fill:p,pointRadius:w};t&&(A.borderColor=t);if(q)for(A.backgroundColor=[];z<f.data[0].length;)A.backgroundColor.push(d(q[z++]));a.datasets.push(A)}p=
parseFloat(f.axes.max);t=parseFloat(f.axes.min);q=parseFloat(f.axes.step);if(n&&"radar"!=c)h.scales={xAxes:[{stacked:xStack,gridLines:{display:f.grid},scaleLabel:{display:0<f.axes.x.text.length,labelString:f.axes.x.text,fontFamily:f.axes.x.fontFamily,fontSize:f.axes.x.fontSize,fontStyle:f.axes.x.fontStyle,fontColor:f.axes.x.fontColor},ticks:{}}],yAxes:[{stacked:yStack,gridLines:{display:f.grid},scaleLabel:{display:0<f.axes.y.text.length,labelString:f.axes.y.text,fontFamily:f.axes.y.fontFamily,fontSize:f.axes.y.fontSize,
fontStyle:f.axes.y.fontStyle,fontColor:f.axes.y.fontColor},ticks:{}}]},"horizontalBar"==c?(""!=f.axes.max&&(h.scales.xAxes[0].ticks.max=p),""!=f.axes.min&&(h.scales.xAxes[0].ticks.min=t),""!=f.axes.step&&(h.scales.xAxes[0].ticks.stepSize=q)):"scatter"==c||"bubble"==c?(""!=f.axes.max&&(h.scales.xAxes[0].ticks.max=p,h.scales.yAxes[0].ticks.max=p),""!=f.axes.min&&(h.scales.xAxes[0].ticks.min=t,h.scales.yAxes[0].ticks.min=t),""!=f.axes.step&&(h.scales.xAxes[0].ticks.stepSize=q,h.scales.yAxes[0].ticks.stepSize=
q)):(""!=f.axes.max&&(h.scales.yAxes[0].ticks.max=p),""!=f.axes.min&&(h.scales.yAxes[0].ticks.min=t),""!=f.axes.step&&(h.scales.yAxes[0].ticks.stepSize=q));else if("radar"==c||"polarArea"==c)h.scale={ticks:{}},""!=f.axes.max&&(h.scale.ticks.max=p),""!=f.axes.min&&(h.scale.ticks.min=t),""!=f.axes.step&&(h.scale.ticks.stepSize=q);h.title={display:0<f.title.text.length,position:f.title.position,text:f.title.text,fontFamily:f.title.fontFamily,fontSize:f.title.fontSize,fontStyle:f.title.fontStyle,fontColor:f.title.fontColor};
h.legend={display:f.legend.display,position:f.legend.position,labels:{fontFamily:f.legend.fontFamily,fontSize:parseFloat(f.legend.fontSize),fontStyle:f.legend.fontStyle,fontColor:f.legend.fontColor}};canvas=document.createElement("canvas");f.width=0<parseIntOr0(f.width)?f.width:400;f.height=0<parseIntOr0(f.height)?f.height:200;canvas.width=f.width;canvas.height=f.height;h.animation={duration:0,onComplete:function(a,c){var d=document.createElement("canvas");d.width=f.width;d.height=f.height;d.getContext("2d").fillStyle=
f.color.background;d.getContext("2d").fillRect(this.chartArea.left,this.chartArea.top,this.chartArea.right-this.chartArea.left,this.chartArea.bottom-this.chartArea.top);d.getContext("2d").drawImage(this.canvas,0,0,d.width,d.height);var h=d.toDataURL();if(g)e.width=582<d.width?582:d.width,e.height=320<d.height?320:d.height,e.src=h;else{dext_src_init(b);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();d=getFirstRange().range;try{0==selObjectText.toString().length&&setRestoreCaretPos(!1)}catch(m){}d.collapse(!0);
e||(e=_iframeDoc.createElement("img"),d.insertNode(e));e.src=h;h=DEXTTOP.DEXT5.util.makeEncryptParam(JSON.stringify({data:f}));e.setAttribute("raon_chart",h);e.style.width=f.width+"px";e.style.height=f.height+"px";d.selectNode(e);d.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(d);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}"function"==typeof DEXTTOP.dext_editor_contentsize_change_event&&(h=e.src,"data:"==
h.substring(0,5)&&(h=h.split(","),2==h.length&&(d=DEXTTOP.G_CURREDITOR._FRAMEWIN.getExtFromImageDataSrc(h[0]),DEXTTOP.G_CURREDITOR._FRAMEWIN.postBase64ImageToServer(h[1],d,e,!1),window.setTimeout(function(){try{contentChangeEventWrapper()}catch(a){}},500))))}};new Chart(canvas,{type:c,data:a,options:h})}
function command_removeBackgroundColor(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();var c=function(a,b){try{b||makeRangeSelectionMarkInDesign();var c=_iframeDoc.getElementsByTagName("dextmark"),d,e,f=c[0].parentNode;if(f){for(;;){if("P"==f.tagName||"DIV"==f.tagName||"BODY"==f.tagName||"TD"==f.tagName){d=f;break}f=f.parentNode}e=GetParentbyTagName(d,"table")}var g,h,y=c[1].parentNode;if(y){for(;;){if("P"==y.tagName||"DIV"==y.tagName||"BODY"==y.tagName||"TD"==y.tagName){g=
y;break}y=y.parentNode}h=GetParentbyTagName(g,"table")}var x=dext5_lang.msg.error_remove_background_color,f=!1;if(e&&h)e!=h&&(f=!0);else if(e||h)f=!0;if(f)alert(x);else{h=function(a,b,c,d){b=b.childNodes;for(var e=b.length,f="",g=0;g<e;g++){var h="";1==b[g].nodeType?(h=b[g].outerHTML,h=CleanZeroChar(h)):3==b[g].nodeType&&(h=b[g].data);f+=h}c?(a.innerHTML=f,d?a.appendChild(d):a.innerHTML=f+'<dextmark class="dextmark"></dextmark>'):d?(a.innerHTML+=f,a.firstChild?a.insertBefore(d,a.firstChild):a.appendChild(d)):
a.innerHTML+='<dextmark class="dextmark"></dextmark>'+f};x=function(a,b){null==a.firstChild&&("xp"==DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?a.innerHTML=unescape("%uFEFF"):a.innerHTML=DEXTTOP.DEXT5.browser.ie?unescape("%u200B"):"<br>");b.setStartBefore(a.firstChild);b.setEndAfter(a.lastChild);return b.extractContents()};e=function(a,b,c){c.setStartAfter(a);c.setEndBefore(b);return c.extractContents()};"BODY"==d.tagName?a.setStartBefore(c[0]):a.setStartBefore(d.firstChild);a.setEndBefore(c[0]);
var z=a.extractContents();a.setStartAfter(c[1]);"BODY"==g.tagName?a.setEndAfter(c[1]):a.setEndAfter(g.lastChild);var A=a.extractContents();if(d==g){removeDextMarkInFrame();var B=x(d,a);h(d,z,!0);h(g,A,!1);for(var G=removeBackgroundColorInNodes(B,"backgroundColor",",table,td,p,");G.firstChild;)c[1].parentNode.insertBefore(G.firstChild,c[1])}else{B=null;"BODY"!=d.tagName&&(_iframeDoc.body.firstChild?_iframeDoc.body.insertBefore(c[0],_iframeDoc.body.firstChild):_iframeDoc.body.appendChild(c[0]),B=x(d,
a));f=null;"BODY"!=g.tagName&&(_iframeDoc.body.appendChild(c[1]),f=x(g,a));if("BODY"!=d.tagName)for(h(d,z,!0,c[0]),G=removeBackgroundColorInNodes(B,"backgroundColor",",table,td,p,");G.firstChild;)d.appendChild(G.firstChild);if("BODY"!=g.tagName){h(g,A,!1,c[1]);for(var G=removeBackgroundColorInNodes(f,"backgroundColor",",table,td,p,"),D=g.getElementsByTagName("dextmark");G.firstChild;)D[0].parentNode.insertBefore(G.firstChild,D[0])}z=null;c=_iframeDoc.getElementsByTagName("dextmark");"BODY"==d.tagName&&
(d=c[0]);"BODY"==g.tagName&&(g=c[1]);z=e(d,g,a);for(G=removeBackgroundColorInNodes(z,"backgroundColor",",table,td,p,");G.firstChild;)g.parentNode.insertBefore(G.firstChild,g)}b||(c=_iframeDoc.getElementsByTagName("dextmark"),a.setStartAfter(c[0]),a.setEndBefore(c[1]),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(a))}removeDextMarkInFrame()}catch(I){removeDextMarkInFrame()}};0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
var d=getFirstRange().range,e=GetTableSelectionCells(),f=e.length;if(0<f)for(var g=0;g<f;g++){var h=_iframeDoc.createElement("dextmark");e[g].insertBefore(h,e[g].firstChild);h=_iframeDoc.createElement("dextmark");e[g].appendChild(h);d.setStartBefore(e[g].firstChild);d.setEndAfter(e[g].lastChild);c(d,!0)}else c(d);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_ParagraphAttribute(a,b,c){try{dext_src_init(b);restoreSelection();setFocusToBody();var d=getFirstRange().range;try{DEXTTOP.G_CURREDITOR.beforeOffset=[],DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startOffset),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endOffset),3==d.startContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer.parentNode):DEXTTOP.G_CURREDITOR.beforeOffset.push(d.startContainer),3==d.endContainer.nodeType?DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer.parentNode):
(DEXTTOP.G_CURREDITOR.beforeOffset.push(d.endContainer),1==d.endOffset&&(DEXTTOP.G_CURREDITOR.beforeOffset[1]=(d.endContainer.innerText||d.endContainer.textContent).length)),DEXTTOP.G_CURREDITOR.beforeOffset.push(d.toString().length)}catch(e){DEXTTOP.G_CURREDITOR.beforeOffset=null}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a="p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" ");var f=a.length,g,h,n=GetTableSelectionCells();if(0==n.length){if(null!=d.startContainer.previousSibling&&
"HEAD"==d.startContainer.previousSibling.tagName&&null==d.endContainer.nextSibling){for(var m=0;m<f;m++){g=_iframeDoc.body.getElementsByTagName(a[m]);h=g.length;for(var p=0;p<h;p++)""!=c.marginLeft.toString()&&(g[p].style.marginLeft=c.marginLeft+"px"),""!=c.marginRight.toString()&&(g[p].style.marginRight=c.marginRight+"px"),""!=c.marginTop.toString()&&(g[p].style.marginTop=c.marginTop+"px"),""!=c.marginBottom.toString()&&(g[p].style.marginBottom=c.marginBottom+"px"),""!=c.letterSpacing.toString()&&
(g[p].style.letterSpacing=c.letterSpacing+"px"),""!=c.wordSpacing.toString()&&(g[p].style.wordSpacing=c.wordSpacing+"px"),""!=c.textIndent.toString()&&(g[p].style.textIndent=c.textIndent+"px"),""!=c.fontSize.toString()&&(g[p].style.fontSize=c.fontSize+"pt"),""!=c.fontFamily.toString()&&("default"==c.fontFamily?g[p].style.fontFamily="":g[p].style.fontFamily=c.fontFamily)}for(var t=_iframeDoc.body.getElementsByTagName("table"),q=t.length,m=0;m<q;m++)for(var u=t[m].rows,v=u.length,p=0;p<v;p++)for(var n=
u[p].cells,w=n.length,y=0;y<w;y++)setBlockTag(n[y].childNodes,a,"paragraphAttribute",c);setBlockTag(_iframeDoc.body.childNodes,a,"paragraphAttribute",c);for(var x=_iframeDoc.body.getElementsByTagName("div"),z=x.length,p=0;p<z;p++)setBlockTag(x[p].childNodes,a,"paragraphAttribute",c)}else{g=getNodesInRange(d);h=g.length;0==d.toString().length&&0==d.getNodes().length&&d.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(f=0;f<h;f++)if(1==g[f].nodeType){var A=g[f].tagName.toLowerCase();-1<a.indexOf(A)&&
(""!=c.marginLeft.toString()&&(g[f].style.marginLeft=c.marginLeft+"px"),""!=c.marginRight.toString()&&(g[f].style.marginRight=c.marginRight+"px"),""!=c.marginTop.toString()&&(g[f].style.marginTop=c.marginTop+"px"),""!=c.marginBottom.toString()&&(g[f].style.marginBottom=c.marginBottom+"px"),""!=c.letterSpacing.toString()&&(g[f].style.letterSpacing=c.letterSpacing+"px"),""!=c.wordSpacing.toString()&&(g[f].style.wordSpacing=c.wordSpacing+"px"),""!=c.textIndent.toString()&&(g[f].style.textIndent=c.textIndent+
"px"),""!=c.fontSize.toString()&&(g[f].style.fontSize=c.fontSize+"pt"),""!=c.fontFamily.toString()&&("default"==c.fontFamily?g[f].style.fontFamily="":g[f].style.fontFamily=c.fontFamily))}var B;0==d.toString().length&&1==d.getNodes().length&&(B=d.getNodes()[0],g.push(d.getNodes()[0]));setBlockTag(g,a,"paragraphAttribute",c)}var G=_iframeDoc.getElementById("_dextPosition");if(G)doSetCaretPosition(G,1),G.parentNode.removeChild(G);else if(B){var D=getFirstRange().range;getFirstRange().sel.removeAllRanges();
D.selectNode(B);getFirstRange().sel.addRange(D)}}else for(w=n.length,m=0;m<w;m++){for(p=0;p<f;p++)for(g=n[m].getElementsByTagName(a[p]),h=g.length,y=0;y<h;y++)""!=c.marginLeft.toString()&&(g[p].style.marginLeft=c.marginLeft+"px"),""!=c.marginRight.toString()&&(g[p].style.marginRight=c.marginRight+"px"),""!=c.marginTop.toString()&&(g[p].style.marginTop=c.marginTop+"px"),""!=c.marginBottom.toString()&&(g[p].style.marginBottom=c.marginBottom+"px"),""!=c.letterSpacing.toString()&&(g[p].style.letterSpacing=
c.letterSpacing+"px"),""!=c.wordSpacing.toString()&&(g[p].style.wordSpacing=c.wordSpacing+"px"),""!=c.textIndent.toString()&&(g[p].style.textIndent=c.textIndent+"px"),""!=c.fontSize.toString()&&(g[p].style.fontSize=c.fontSize+"pt"),""!=c.fontFamily.toString()&&("default"==c.fontFamily?g[p].style.fontFamily="":g[p].style.fontFamily=c.fontFamily);setBlockTag(n[m].childNodes,a,"paragraphAttribute",c);x=n[m].getElementsByTagName("div");z=x.length;for(p=0;p<z;p++)setBlockTag(x[p].childNodes,a,"paragraphAttribute",
c)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR.beforeOffset=null}catch(I){}}function command_BeforeSetCompleteSpellCheck(){"spellcheck"in DEXTTOP.G_CURREDITOR._BODY&&"1"==DEXTTOP.G_CURREDITOR._config.browserSpellCheck&&0==DEXTTOP.G_CURREDITOR._BODY.spellcheck&&DEXTTOP.G_CURREDITOR._BODY.removeAttribute("spellcheck")}
function command_AdjustTableAndCellWidth(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();a=function(a){for(var b=a.length,c=0;c<b;c++){var d=a[c];if(""!=d.style.width){var n=0;if(d&&1!=d.raonAdjusted){for(var m=[],p=[],t=d.rows,q=t.length,u=0,v=0,w=0;w<q;w++){var y=t[w].cells.length;y>v&&(v=y,u=w)}w=t[u].cells.length;for(v=0;v<w;v++){var x=t[u].cells[v],z={rect:null,width:null};m.push(z);z.rect=getClientRect(x);z.width=x.offsetWidth;n+=z.width}for(w=0;w<q;w++){for(var A=
t[w].cells,y=A.length,u=[],v=0;v<y;v++){for(var x=A[v],x=getClientRect(x),z=m.length,B=!1,G=!1,D=0;D<z;D++){var I=0,K=0;1>Math.abs(x.left-m[D].rect.left)&&1>Math.abs(x.right-m[D].rect.right)?(G=B=!0,I=x.right-x.left):x.left<=m[D].rect.left&&x.right>=m[D].rect.right&&(1>Math.abs(x.left-m[D].rect.left)?B=!0:1>Math.abs(x.right-m[D].rect.right)&&(G=!0),I+=x.right-x.left);if(B&&G){K=parseInt(I,10);break}}u.push(K)}p.push(u)}try{for(w=0;w<q;w++)for(A=t[w].cells,y=A.length,v=0;v<y;v++){var E=p[w][v];A[v].style.width=
0==E?"":E+"px"}}catch(N){}d.style.width=n+2+"px";n=d.getElementsByTagName("colgroup");for(m=n.length-1;0<=m;m--)n[m].parentNode.removeChild(n[m]);d.raonAdjusted=!0}}}};var d=null;b=[];if(c){if("paste"==c.type)return b=c.htmlData,c=document.createElement("div"),c.style.width="2000px",c.style.height="2000px",c.style.position="absolute",c.style.left="-10000px",c.style.top="-10000px",document.body.appendChild(c),c.innerHTML=b,b=c.getElementsByTagName("table"),a(b),a=c.innerHTML,c.parentNode.removeChild(c),
a;"setHtml"==c.type&&(b=_iframeDoc.getElementsByTagName("table"),a(b))}else d=DEXTTOP.G_SELECTED_ELEMENT,c=GetParentbyTagName(d,"table"),b.push(c),a(b),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_PluginAction(a,b,c){}
function command_InsertTableTopBottomParagraph(a,b){restoreSelection();setFocusToBody();var c=getFirstRange().range,d=null;c&&c.startContainer&&(d=getMyElementNode(c.startContainer));if(d){c=GetTDTHCell(d);if(null==c&&"tr"==d.tagName.toLowerCase()){var e=d.cells.length;0<e&&(c=d.cells[e-1])}c&&(d=GetParentbyTagName(c,"table"))&&("insert_table_top_paragraph"==a?insertPtagTableNear(!0,d):insertPtagTableNear(!1,d))}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0;b._iconEnable("default")}
function command_fontSizeIncDec(a,b,c){var d="";"1"==c._config.useFontSizeKeyin?d=document.getElementById("txtara_"+a+"font_size").value:(d=document.getElementById("ue_"+a+"font_size").innerHTML,DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?(d=d.replace("<SPAN>",""),d=d.replace("</SPAN>","")):(d=d.replace("<span>",""),d=d.replace("</span>","")));if(""!=d&&d!=dext5_lang.icon.font_size){var e="",f="",f=1;""!=c._config.fontSizeIncDecGap&&(f=parseInt(c._config.fontSizeIncDecGap));"font_size_dec"==
b&&(f*=-1);c=parseInt(d);if(-1<d.indexOf("pt")||-1<d.indexOf("px")||-1<d.indexOf("em")||0<d.indexOf("%"))0<d.indexOf("pt")?e="pt":0<d.indexOf("px")?e="px":0<d.indexOf("em")?e="em":0<d.indexOf("%")&&(e="%",f*=10);d=c+f;"font_size_dec"==b&&1>d&&(d=c);f=d+e;"1"==DEXTTOP.G_CURREDITOR._config.useFontSizeKeyin?document.getElementById("txtara_"+a+"font_size").value=f:document.getElementById("ue_"+a+"font_size").innerHTML="<span>"+f+"</span>";command_fontsize(a,document.getElementById("dext5_design_"+a),
f)}}
function command_lineHeightIncDec(a,b,c){var d="";"1"==c._config.useLineHeightKeyin?d=document.getElementById("txtara_"+a+"line_height").value:(d=document.getElementById("ue_"+a+"line_height").innerHTML,DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?(d=d.replace("<SPAN>",""),d=d.replace("</SPAN>","")):(d=d.replace("<span>",""),d=d.replace("</span>","")));if(""!=d&&d!=dext5_lang.icon.line_height){var e=d,f=1;""!=c._config.lineHeightIncDecGap&&(f=parseFloat(c._config.lineHeightIncDecGap));"line_height_dec"==
b&&(f*=-1);0<d.indexOf("%")?(f*=10,e=e.substring(0,e.length-1),f=parseInt(parseInt(e)+f),0<parseInt(e,10)&&0<=f&&(e=f),b="%"):(b="",0<d.indexOf("pt")||0<d.indexOf("px")||0<d.indexOf("em")?(f=parseFloat(parseFloat(e)+f).toFixed(2),0<d.indexOf("pt")?b="pt":0<d.indexOf("px")?b="px":0<d.indexOf("em")&&(b="em"),0<=f&&(e=f)):(f*=.1,f=parseFloat(parseFloat(e)+f).toFixed(2),e=0<=f?f:parseFloat(e)));e=parseFloat(e)+b;"1"==DEXTTOP.G_CURREDITOR._config.useLineHeightKeyin?document.getElementById("txtara_"+a+
"line_height").value=e:document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+e+"</span>";command_lineHeight(a,document.getElementById("dext5_design_"+a),e)}}
function command_letterSpacingIncDec(a,b,c){var d=document.getElementById("ue_"+a+"letter_spacing").innerHTML;DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion?(d=d.replace("<SPAN>",""),d=d.replace("</SPAN>","")):(d=d.replace("<span>",""),d=d.replace("</span>",""));if(""!=d&&d!=dext5_lang.icon.letter_spacing){var e=1;void 0!=c._config.letterSpacingIncDecGap&&""!=c._config.letterSpacingIncDecGap&&(e=parseFloat(c._config.letterSpacingIncDecGap));"letter_spacing_dec"==b&&(e*=-1);b=d.substring(d.length,
d.length-2);c=parseFloat(d);if(-1<d.indexOf("pt")||-1<d.indexOf("px")||-1<d.indexOf("em"))b="",0<d.indexOf("pt")?b="pt":0<d.indexOf("px")?b="px":0<d.indexOf("em")&&(b="em"),c=parseFloat(parseFloat(parseFloat(c)+e).toFixed(2))+b;document.getElementById("ue_"+a+"letter_spacing").innerHTML="<span>"+c+"</span>";command_letterSpacing(a,DEXTTOP.G_CURREDITOR,c)}};var ColorCellBackColor="#d0e6fd",ColorCellDefColor="#ffffff",Mouse_IsPlain=0,Mouse_IsTableSelecting=1,Mouse_IsTableDragging=2,Mouse_IsControlSelecting=3,Mouse_IsCellDragging=4,Mouse_IsCellResizing=5,Mouse_Status=Mouse_IsPlain,DrageStartCell=null,DrageEndCell=null,ActiveCurrTable=null,ActiveLastTable=null,mouseStartPos={},mouseEndPos={},elResizeBar,elResizeBarCover,ResizeInfo={},nDraggableCellEdge=4,nPageLeftRightMargin=0,nPageTopBottomMargin=0,MIN_CELL_WIDTH=10,MIN_CELL_HEIGHT=10;
function createTableResizeBar(a){a=document.createElement("div");try{a.innerHTML='<div style="position:absolute; overflow:hidden; z-index: 99; "><div onmousedown="return false" style="background-color:#000000;filter:alpha(opacity=0);opacity:0.0;-moz-opacity:0.0;-khtml-opacity:0.0;cursor: col-resize; left: 0px; top: 0px; width: 100%; height: 100%;font-size:1px;z-index: 999; "></div></div>',elResizeBar=a.firstChild,elResizeBarCover=elResizeBar.firstChild}catch(b){}document.body.appendChild(elResizeBar);
DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover);DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"dblclick",dbclick_ResizeBarCover);nPageLeftRightMargin=parseIntOr0(document.body.marginLeft)+parseIntOr0(document.body.marginRight);nPageTopBottomMargin=parseIntOr0(document.body.marginTop)+parseIntOr0(document.body.marginBottom)}
function dbclick_ResizeBarCover(){if(3==ResizeInfo.nResizeMode||4==ResizeInfo.nResizeMode){var a=getFirstRange().sel;a&&a.docSelection&&"Control"==a.docSelection.type?(a=GetParentbyTagName(ResizeInfo.currCell,"table"),DEXTTOP.G_SELECTED_ELEMENT=a,DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,a)):(a._ranges.length=a.rangeCount=a.nativeSelection.rangeCount,a.rangeCount&&(a=GetParentbyTagName(ResizeInfo.currCell,"table"),
DEXTTOP.G_SELECTED_ELEMENT=a,DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,a)))}}var nStartHeight=0,nStartWidth=0;function coverResizeLayer(){elResizeBarCover.style.position="absolute";var a=getClientSize();elResizeBarCover.style.width=a.width-nPageLeftRightMargin+"px";elResizeBarCover.style.height=a.height-nPageTopBottomMargin+"px";document.body.appendChild(elResizeBarCover)}
function uncoverResizeLayer(){elResizeBar.appendChild(elResizeBarCover);elResizeBarCover.style.position="";elResizeBarCover.style.width="100%";elResizeBarCover.style.height="100%"}
function _mousedown_ResizeBarCover(a){a=getElementPos(a);nStartHeight=a.clientY;DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousemove",mousemove_ResizeBarCover);DEXTTOP.DEXT5.util.addEvent(document,"mouseup",mouseup_ResizeBarCover);coverResizeLayer();parseIntOr0(elResizeBar.style.width)>parseIntOr0(elResizeBar.style.height)?elResizeBar.style.height="1px":elResizeBar.style.width="1px";elResizeBar.style.border="1px dotted black";elResizeBar.style.fontSize="1pt";nStartWidth=a.clientX;nStartHeight=
a.clientY}function mousemove_ResizeBarCover(a){a=getElementPos(a);1==ResizeInfo.nResizeMode?elResizeBar.style.left=a.pageX-parseIntOr0(elResizeBar.style.width)/2+"px":elResizeBar.style.top=a.pageY-parseIntOr0(elResizeBar.style.height)/2+"px"}
function mouseup_ResizeBarCover(a){hideResizeBar();uncoverResizeLayer();elResizeBar.style.border="";DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,"mousemove",mousemove_ResizeBarCover);DEXTTOP.DEXT5.util.removeEvent(document,"mouseup",mouseup_ResizeBarCover);var b=getElementPos(a),c=a=0;2==ResizeInfo.nResizeMode&&(a=b.clientY-nStartHeight);1==ResizeInfo.nResizeMode&&(c=b.clientX-nStartWidth);b=GetParentbyTagName(ResizeInfo.currCell,"table");if(null!=b){for(var d=[],e=0,f=b.rows.length,g=0;g<f;g++)for(var h=
b.rows[g],n=h.cells.length,m=0;m<n;m++){var p=h.cells[m],t=getClientRect(p),q=getElementOffset(_iframeWin.frameElement);1==ResizeInfo.nResizeMode?nStartWidth<=t.right+q.left+2*nDraggableCellEdge&&nStartWidth>t.right+q.left-2*nDraggableCellEdge&&(q={},q.cell=p,q.right=t.right,d[e]=q,e+=1):2==ResizeInfo.nResizeMode&&nStartHeight<=t.bottom+q.top+2*nDraggableCellEdge&&nStartHeight>t.bottom+q.top-2*nDraggableCellEdge&&(q={},q.cell=p,q.right=t.bottom,d[e]=q,e+=1)}setResizeCells(c,a,d)}}
function setResizeCells(a,b,c){var d=GetParentbyTagName(ResizeInfo.currCell,"table");if(null!=d&&!(0>=c.length||0==a&&0==b)){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var e=[],f=0,g=d.rows.length,h=0;h<g;h++)for(var n=d.rows[h],m=n.cells.length,p=0;p<m;p++){var t=n.cells[p],q=getClientRect(t);1==ResizeInfo.nResizeMode&&c[0].right==q.left&&(e[f]=t,f+=1)}var u=0;if(1==ResizeInfo.nResizeMode){0<a&&0<e.length&&(q=getClientRect(e[0]),u=q.right-q.left,
u-a<MIN_CELL_WIDTH&&(a=u-MIN_CELL_WIDTH));0>a&&0<c.length&&(q=getClientRect(c[0].cell),u=q.right-q.left,u+a<MIN_CELL_WIDTH&&(a=MIN_CELL_WIDTH-u));if(0==e.length){h=parseIntOr0(d.style.width);if(""==d.style.width||""!=d.style.width&&-1<d.style.width.indexOf("%"))q=getClientRect(d),h=q.right-q.left;0<h+a&&(d.style.width=h+a+"px")}f=c.length;for(h=0;h<f;h++)getClientRect(c[h].cell),u=getElemAdjustWidthHeight(c[h].cell).width,g=a,u+a<MIN_CELL_WIDTH&&(g=MIN_CELL_WIDTH-u),c[h].newWidth=u+g+"px";for(h=0;h<
f;h++)c[h].cell.style.width=c[h].newWidth;f=e.length;c=[];for(h=0;h<f;h++)getClientRect(e[h]),u=getElemAdjustWidthHeight(e[h]).width,u-a<MIN_CELL_WIDTH&&(a=u-MIN_CELL_WIDTH),c[h]=u-a+"px";for(h=0;h<f;h++)e[h].style.width=c[h]}else{f=c.length;for(h=0;h<f;h++)q=getClientRect(c[h].cell),u=getElemAdjustWidthHeight(c[h].cell).height,u+b<MIN_CELL_HEIGHT&&(b=MIN_CELL_HEIGHT-u),c[h].newHeight=u+b+"px";for(h=0;h<f;h++)c[h].cell.style.height=c[h].newHeight;try{if(0<f){a=[];for(var v=getClientRect(c[0].cell),
g=d.rows.length,h=0;h<g;h++)for(n=d.rows[h],m=n.cells.length,p=0;p<m;p++)if(t=n.cells[p],q=getClientRect(t),q.top<=v.top&&q.bottom>=v.bottom){e=!1;for(u=0;u<f;u++)if(t==c[u].cell){e=!0;break}e||a.push(t)}for(var w=a.length,h=0;h<w;h++)a[h].style.height="";d.removeAttribute("height");d.style.height="";if("1"==DEXTTOP.G_CURREDITOR._config.tableUseHeight){var y=getClientRect(d);d.style.height=y.bottom-y.top+"px"}for(h=0;h<w;h++){var x=getClientRect(a[h]);a[h].style.height=x.bottom-x.top+"px"}}}catch(z){}}setAdjustTableWidthHeight(d);
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&(d=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem,DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear(),DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem=d,clearInterval(DEXTTOP.G_CURREDITOR.dext_dragresize.dextResizeIconInterval),DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,
!1,null));try{setFocusToBody()}catch(A){}}}
function setAdjustTableWidthHeight(a){if("0"!=DEXTTOP.G_CURREDITOR._config.tableAutoAdjust){var b,c,d;b=null;c=a.rows.length;if(0<c){var e=a.rows[0];d=e.cells.length;0<d&&(b=e.cells[0])}if(null!=b){var f,g;g=f=0;var h=[],n=[],m=getClientRect(b);for(b=0;b<c;b++){e=a.rows[b];d=e.cells.length;for(var p=0;p<d;p++){var t=e.cells[p],q=getClientRect(t);if(m.left==q.left){var u=q.bottom-q.top-1;g+=u}u=parseIntOr0(a.cellPadding);u=q.bottom-q.top-2-2*u+"px";h.push(u);m.top==q.top&&(u=q.right-q.left,f+=u);u=
q.right-q.left-1;1<t.colSpan&&(u=1*u/t.colSpan);u+="px";n.push(u)}}0<f&&0<g&&(a.style.width=f+"px",removeAttribute(a.style,"height"));for(b=f=0;b<c;b++)for(e=a.rows[b],d=e.cells.length,p=0;p<d;p++)t=e.cells[p],t.style.width=n[f],t.style.height=h[f],f++}}}function getPosition(a){for(var b=0,c=0;a;)b+=a.offsetLeft-a.scrollLeft+a.clientLeft,c+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return{x:b,y:c}}function hideResizeBar(){elResizeBar.style.display="none"}
function showResizeBar(){elResizeBar.style.display="block";var a=getElementOffset(_iframeWin.frameElement);if(1==ResizeInfo.nResizeMode||3==ResizeInfo.nResizeMode){setResizeBarSize(2*(ResizeInfo.nBorderSize+nDraggableCellEdge),parseIntOr0(_iframeWin.frameElement.offsetHeight));var b=a.left+ResizeInfo.nBorderLeftPos+ResizeInfo.Pos.clientX-ResizeInfo.Pos.offsetX-parseIntOr0(elResizeBar.style.width);if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||
9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks))var c=getWindowScrollPos(_iframeWin),b=9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&0<c[0]?b+2:b+c[0];3==ResizeInfo.nResizeMode&&(b+=2);setElementOffset(elResizeBar,a.top,b)}else setResizeBarSize(parseIntOr0(_iframeWin.frameElement.offsetWidth+"px"),2*(ResizeInfo.nBorderSize+nDraggableCellEdge)),b=a.top+ResizeInfo.Pos.clientY+ResizeInfo.nBorderTopPos-ResizeInfo.Pos.offsetY-parseIntOr0(elResizeBar.style.height),
DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)&&(c=getWindowScrollPos(_iframeWin),b=9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&0<c[1]?b+nDraggableCellEdge:b+c[1]),4==ResizeInfo.nResizeMode&&(b+=2),setElementOffset(elResizeBar,b,a.left);DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover);DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,
"click",setTableSelectEvt);3==ResizeInfo.nResizeMode||4==ResizeInfo.nResizeMode?getApplyDragResize(DEXTTOP.G_CURREDITOR)||(elResizeBarCover.style.cursor="move",DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"click",setTableSelectEvt)):(DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover),elResizeBarCover.style.cursor=1==ResizeInfo.nResizeMode?"col-resize":"row-resize")}
function setTableSelectEvt(){var a=GetParentbyTagName(ResizeInfo.currCell,"table");command_tableSelection(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,a)}function setResizeBarSize(a,b){elResizeBar.style.width=a+"px";elResizeBar.style.height=b+"px"}
function IsMousePointOnBorder(a){ResizeInfo.nResizeMode=0;ResizeInfo.currCell=a.target?a.target:a.srcElement;var b=ResizeInfo.currCell.tagName;if("TD"!=ResizeInfo.currCell.tagName&&"TH"!=ResizeInfo.currCell.tagName&&(ResizeInfo.currCell=GetTDTHCell(ResizeInfo.currCell),null==ResizeInfo.currCell))return!1;var c=GetParentbyTagName(ResizeInfo.currCell,"table");if(null==c)return!1;var d=DEXTTOP.G_CURREDITOR._config.tableNoResizeClass;if(""!=d&&c.className&&""!=c.className){for(var e=c.className.split(" "),
f=e.length,g=!1,h=0;h<f;h++)if(e[h]==d){g=!0;break}if(g)return!1}ResizeInfo.currTable=c;ResizeInfo.nBorderLeftPos=0;ResizeInfo.nBorderTopPos=-1;ResizeInfo.Pos="contextmenu"==a.type?getClientRect(ResizeInfo.currCell):getElementPos(a,!0);ResizeInfo.nBorderSize=parseIntOr0(c.border);DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.opera?(a=ResizeInfo.nBorderSize+nDraggableCellEdge,c=nDraggableCellEdge):(a=nDraggableCellEdge,c=ResizeInfo.nBorderSize+nDraggableCellEdge);d=ResizeInfo.Pos.offsetX;e=ResizeInfo.Pos.offsetY;
DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)&&(f=getWindowScrollPos(_iframeWin),d-=f[0],e-=f[1]);e<=a&&ResizeInfo.currCell.parentNode.previousSibling&&("td"==b.toLowerCase()||"th"==b.toLowerCase())&&(ResizeInfo.nResizeMode=2);ResizeInfo.currCell.offsetHeight-c<=e&&(ResizeInfo.nBorderTopPos=ResizeInfo.currCell.offsetHeight+a-1,ResizeInfo.nResizeMode=2);b=1;9==DEXTTOP.DEXT5.browser.ieVersion&&
DEXTTOP.DEXT5.browser.quirks&&(f=getWindowScrollPos(_iframeWin),b=f[0]);if(ResizeInfo.currCell.offsetWidth-c<=d+b||DEXTTOP.DEXT5.browser.chrome&&0==ResizeInfo.Pos.offsetX)ResizeInfo.nBorderLeftPos=ResizeInfo.currCell.offsetWidth+a-1,ResizeInfo.nResizeMode=1;b=getClientRect(ResizeInfo.currTable);d=!1;e=!0;"1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use&&(f=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode,ResizeInfo.currTable.getAttribute("lock_mode")&&
""!=ResizeInfo.currTable.getAttribute("lock_mode")&&(f=ResizeInfo.currTable.getAttribute("lock_mode")),"1"==f&&(d=!0),checkLockAttr(ResizeInfo.currTable,d)&&(e=!1));e&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion&&(b.left+a>=ResizeInfo.Pos.clientX?ResizeInfo.nResizeMode=3:b.top+c>=ResizeInfo.Pos.clientY&&(ResizeInfo.nResizeMode=4));return 0===ResizeInfo.nResizeMode?!1:!0}function parseIntOr0(a){a=parseInt(a,10);return isNaN(a)?0:a}
function getClientSize(){var a={};"number"===typeof window.innerWidth?(a.width=window.innerWidth,a.height=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)?(a.width=document.body.clientWidth,a.height=document.body.clientHeight):(a.width=0,a.height=0);return a}
function setElementOffset(a,b,c){if("number"==typeof b&&"number"==typeof c){isNaN(parseInt(a.style.top,10))&&(a.style.top="0px");isNaN(parseInt(a.style.left,10))&&(a.style.left="0px");var d=getElementOffset(a);b-=d.top;c-=d.left;a.style.top=parseInt(a.style.top,10)+b+"px";a.style.left=parseInt(a.style.left,10)+c+"px"}}
function getElementPos(a,b){var c=a.target?a.target:a.srcElement,d=(c.ownerDocument||_iframeDoc).body,e=(c.ownerDocument||_iframeDoc).documentElement,e=[d.scrollLeft||e.scrollLeft,d.scrollTop||e.scrollTop],d={clientX:a.clientX,clientY:a.clientY,pageX:"pageX"in a?a.pageX:a.clientX+e[0]-d.clientLeft,pageY:"pageY"in a?a.pageY:a.clientY+e[1]-d.clientTop};b&&(c=getElementOffset(c),d.offsetX=d.pageX-c.left,d.offsetY=d.pageY-c.top);return d}
function getElementOffset(a){var b={left:0,top:0},c=a.ownerDocument||a.document||_iframeDoc,d=c.documentElement,e=c.body,f;"undefined"!=typeof c.defaultView?f=c.defaultView:"undefined"!=typeof c.parentWindow&&(f=c.parentWindow);box=a.getBoundingClientRect();a=d.clientTop||e.clientTop||0;c=f.pageYOffset&&d.scrollTop||e.scrollTop;b.left=box.left+(f.pageXOffset&&d.scrollLeft||e.scrollLeft)-(d.clientLeft||e.clientLeft||0);b.top=box.top+c-a;return b}
function GetParentInTag(a,b){for(var c=a;null!=c&&(!c.tagName||"html"!=c.tagName.toLowerCase());){if(c.tagName.toLowerCase()==b)return c;c=c.parentNode}return null}function GetParentTagPath(a){for(var b="";null!=a&&(!a.tagName||"html"!=a.tagName.toLowerCase());)b=a.tagName.toLowerCase()+"&nbsp;"+b,a=a.parentNode;return b}function getMyElementNode(a){if(1==a.nodeType)return a;for(;null!=a;){if(1==a.nodeType)return a;a=a.parentNode}return null}
function getMyChildElementNode(a){if(3==a.nodeType)return a.parentNode;for(;null!=a.childNodes&&0<a.childNodes.length;){a=a.lastChild;if(3==a.nodeType)return a.parentNode;if("BR"==a.tagName||"IMG"==a.tagName)return a.previousSibling?getMyChildElementNode(a.previousSibling):a.parentNode}return 1==a.nodeType&&a.parentNode&&"BODY"!=a.parentNode.tagName?a.parentNode:null}
function getElementInParentStyleProperty(a,b){for(var c="",d=a;null!=d&&(!d.tagName||"body"!=d.tagName.toLowerCase());){var e="";if("fontSize"==b)if(d.tagName&&"FONT"==d.tagName){if(e=d.size,0==!!e||""==e)e=d.style[b]}else d.style&&(e=d.style[b]);else d.style&&(e=d.style[b]);if(""!=e&&(c=e,void 0!=c&&0<c.length))return c=c.replace(/"/gi,""),c=c.replace(/'/gi,""),"backgroundColor"!=b&&"color"!=b&&(c=c.split(",")[0]),("backgroundColor"==b||-1<b.indexOf("margin")||-1<b.indexOf("padding"))&&-1<",TD,TH,TABLE,TR,".indexOf(","+
d.tagName+",")&&(c=""),c;d=d.parentNode}"fontFamily"==b?c=getElementInParentProperty(a,"face"):"fontSize"==b&&(c=getElementInParentProperty(a,"size"));return void 0==c?"":c}function getElementInParentProperty(a,b){for(var c="",d=a;null!=d&&(!d.tagName||"body"!=d.tagName.toLowerCase());){if(void 0!=d[b]&&(c=d[b],0<c.length))return c=c.replace(/"/gi,""),c=c.replace(/'/gi,""),c=c.split(",")[0];d=d.parentNode}return void 0==c?"":c}
function getElementInParentTag(a,b){for(var c="",d=a,e="";null!=d&&(!(e=d.nodeName.toLowerCase())||"body"!=e);){for(var f=0;f<b.length;f++)if(e==b[f]){switch(e){case "b":case "strong":c="blod";break;case "em":case "i":c="italic";break;case "u":c="underline";break;case "s":case "strike":c="strike_through";break;case "sup":c="superscript";break;case "sub":c="subscript";break;case "ol":c="list_number";break;case "ul":c="list_bullets";break;case "h1":case "h2":case "h3":case "h4":case "h5":c=e}return c}d=
d.parentNode}return c}
function _iframeDoc_MouseDown(a){G_dext5plugIn&&1==G_dext5plugIn.hasContainer&&G_dext5plugIn.DEXT5SetFocus(0);var b=null,b=a?a:_iframeWin.event,b=b.target?b.target:b.srcElement,c=b.tagName?b.tagName.toLowerCase():null;if(!DEXTTOP.G_CURREDITOR.dext_dragresize||!DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem){if(getApplyDragResize(DEXTTOP.G_CURREDITOR)&&DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion&&("div"==c||"img"==c))return DEXTTOP.DEXT5.util.cancelEvent(a),!1;setDEXTWINDOC();
var d=getEditrFromEvent(a);d._RangeBlurBug=!0;d._LastRange=null;if(isRightClick(a))return DEXTTOP.DEXT5.util.cancelEvent(a),!1;if(!isViewMode(d)&&null!=b&&null!=c){if("1"!=d._config.formMode&&"1"==d._config.userTableLock.use){var e=GetTDTHCell(b),f;e&&(f=GetParentbyTagName(b,"table"));var g=d._config.userTableLock.defaultTableLockMode;f&&f.getAttribute("lock_mode")&&""!=f.getAttribute("lock_mode")&&(g=f.getAttribute("lock_mode"));var h=!0;"1"==g&&(h=!1);if(e){if(h&&checkLockAttr(f)){d.lastElemForLock?
setFocusForLock(d.lastElemForLock):(b=findNoLockElem(f))?setFocusForLock(b):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(e,!h)){d.lastElemForLock?setFocusForLock(d.lastElemForLock):setFocusForLock(findNoLockCell(f));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}}if("1"==d._config.formMode){if(a.ctrlKey)return setFormControlSelected(b),DEXTTOP.DEXT5.util.cancelEvent(a),!1;clearAllFormControlSelected()}if("1"==
d._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("mousedown",a,b)}catch(n){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(c&&("textarea"==c||"input"==c||"select"==c))return!1;f=GetTDTHCell(b);null==f&&null!=ActiveCurrTable&&ClearDraggingTableCellSelected();if(f){ActiveCurrTable=GetParentbyTagName(f,"table");try{ActiveLastTable?ActiveLastTable!=ActiveCurrTable&&(ClearDraggingTable(ActiveLastTable),
ActiveLastTable=ActiveCurrTable):ActiveLastTable=ActiveCurrTable}catch(m){ActiveLastTable=ActiveCurrTable}"1"==DEXTTOP.G_CURREDITOR._config.ie11_BugFixed_JASO&&1==b.nodeType&&"TD"==b.nodeName&&(RegExp("<p([^>?+]*)></p>","gi").test(b.innerHTML),f=ReplaceAll(b.innerHTML,RegExp.$1,""),""!=RegExp.$1&&"<p></p>"==f?b.innerHTML="<p "+RegExp.$1+"><br /></p>":"<p></p>"==b.innerHTML&&(b.innerHTML="<p><br /></p>"))}null!=ActiveCurrTable&&b==ActiveCurrTable?Mouse_Status=Mouse_IsTableDragging:(c=b.tagName.toLowerCase(),
"img"==c||"hr"==c?("img"==c&&(DEXTTOP.G_SELECTED_IMAGE_ELEMENT=b),Mouse_Status=Mouse_IsControlSelecting):(c=null,c=GetTDTHCell(b),null==c?(Mouse_Status=Mouse_IsPlain,ClearDraggingTableCellSelected(),DrageStartCell=null,DEXTTOP.G_SELECTED_ELEMENT=b):(f=!1,d=DEXTTOP.G_CURREDITOR._config.tableNoSelectionClass,""!=d&&(f=GetParentbyTagName(b,"table"),f=checkContainClass(f,d)),0==f&&(Mouse_Status=Mouse_IsCellDragging,a.shiftKey?SelectedCellRange(DrageStartCell,c):(ClearDraggingTableCellSelected(),removeCellDefValue(c,
!1),mouseStartPos=getMousePosition(a),DrageStartCell=c,DrageEndCell=null,DEXTTOP.G_SELECTED_ELEMENT=b)))))}}}
function _iframeDoc_MouseUp(a){setDEXTWINDOC();var b=getEditrFromEvent(a);b._RangeBlurBug=!1;if(isRightClick(a))return DEXTTOP.DEXT5.util.cancelEvent(a),!1;if(!isViewMode(b)){var c=null,d=a?a:_iframeWin.event,c=d.target?d.target:d.srcElement;G_dextResize_Elem_Flag||(G_CURSOR_ELEMENT=c);G_dextResize_Elem_Flag=!1;if(b.useFocusDivForIOS&&(b.useFocusDivForIOS=!1,d=document.getElementById("ue_editor_holder_"+b.ID))){var e=getClientRect(d),f=document.createElement("div");f.style.width="100%";f.style.height=
"100%";f.style.position="absolute";f.style.left=e.left+"px";f.style.top=e.top+"px";f.style.zIndex=b._config.zIndex+10;e=document.createElement("textarea");e.style.width="100%";e.style.height="100%";f.appendChild(e);d.appendChild(f);e.focus();e.blur();d.firstChild.contentWindow.document.body.focus();d.removeChild(f)}if("1"!=b._config.formMode&&"1"==b._config.userTableLock.use){var f=GetTDTHCell(c),g;f&&(g=GetParentbyTagName(c,"table"));e=b._config.userTableLock.defaultTableLockMode;g&&g.getAttribute("lock_mode")&&
""!=g.getAttribute("lock_mode")&&(e=g.getAttribute("lock_mode"));d=!0;"1"==e&&(d=!1);if(f){e=!1;if(e=d?!checkLockAttr(f)&&!checkLockAttr(g):!checkLockAttr(f,!d))"TABLE"==c.tagName?checkLockAttr(c,!d)?b.lastElemForLock=findNoLockElem(c):(f=findNoLockCell(c),b.lastElemForLock=f):b.lastElemForLock=c;if(d&&checkLockAttr(g)){b.lastElemForLock?setFocusForLock(b.lastElemForLock):(b=findNoLockElem(g))?setFocusForLock(b):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);
return}}else"BODY"!=c.tagName&&("TABLE"==c.tagName?checkLockAttr(c,!d)?b.lastElemForLock=findNoLockElem(c):(f=findNoLockCell(c),b.lastElemForLock=f):b.lastElemForLock=c),checkLockElemInSelectionRange();d||(d=getFirstRange().range.startContainer,3==d.nodeType&&(d=d.parentNode),(f=GetParentbyTagName(d,"td"))&&checkLockAttr(f,!0)&&(b.lastElemForLock?setFocusForLock(b.lastElemForLock):(g=GetParentbyTagName(f,"td"),setFocusForLock(findNoLockCell(g)))));f=GetTableSelectionCells();e=f.length;if(0<e){for(var h=
!1,d=0;d<e;d++){if(checkLockAttr(f[d],!0)){h=!0;break}else{var n=[];n.push(f[d].getElementsByTagName("table"));n.push(f[d].getElementsByTagName("td"));var m=n.length;for(j=0;j<m;j++){var p=n[j].length;for(k=0;k<p;k++)if(checkLockAttr(n[j][k],!0)){h=!0;break}if(h)break}}if(h)break}h&&(b.lastElemForLock?setFocusForLock(b.lastElemForLock):setFocusForLock(findNoLockCell(g)),ClearDraggingTableCellSelected())}(g=getSelectionTable(b))&&checkLockAttr(g)&&(b.lastElemForLock?setFocusForLock(b.lastElemForLock):
setFocusForLock(findNoLockCell(g)))}g=c.tagName?c.tagName.toLowerCase():null;if("2"==DEXTTOP.G_CURREDITOR._config.olUlTagMode&&(e=GetParentbyTagName(c,"li")))if(d=getFirstRange().range,f=e.innerHTML,f=f.replace(/(<([^>]+)>)/ig,""),""==f)e.innerHTML=unescape("%u200B");else if(0==d.toString().length){f=d.endContainer;if(GetParentbyTagName(3==f.nodeType?f.parentNode:f,"li")!=e){f=e;try{var t=f.innerHTML.toLowerCase(),q=t.indexOf("ol"),u=t.indexOf("ul"),t="";-1<q&&0>u?t="ol":0>q&&-1<u?t="ul":-1<q&&-1<
u&&(t=q<u?"ol":"ul");if(""!=t){var v=f.getElementsByTagName(t)[0],w=_iframeDoc.createTextNode(unescape("%u200B"));f.insertBefore(w,v);d.setStartBefore(w);d.setEndBefore(w);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(d)}}catch(y){}}for(q=null;;){if(f.nextSibling&&("OL"==f.nextSibling.tagName||"UL"==f.nextSibling.tagName)){q=f.nextSibling;break}if(0==!!f.parentNode||"LI"==f.parentNode.tagName||"BODY"==f.parentNode.tagName)break;f=f.parentNode}q&&((w=q.previousSibling)&&
3==w.nodeType&&w.data==unescape("%u200B")?(d.setStartBefore(w),d.setEndBefore(w),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(d)):(w=_iframeDoc.createTextNode(unescape("%u200B")),q.parentNode.insertBefore(w,q)))}if("input"==g&&(w=!1,DEXTTOP.DEXT5.browser.ie&&(c.isContentEditable?w=!0:DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion&&(w=!0)),w&&(DEXTTOP.G_SELECTED_ELEMENT=c,"checkbox"==c.type.toLowerCase()||"radio"==c.type.toLowerCase())))if(1==
c.checked)c.checked=!1,c.removeAttribute("checked");else{if("radio"==c.type.toLowerCase())for(w=_iframeDoc.getElementsByName(c.name),q=w.length,d=0;d<q;d++)w[d].checked=!1,w[d].removeAttribute("checked");c.checked=!0;c.setAttribute("checked","checked")}if(g&&("textarea"==g||"input"==g||"select"==g)&&"1"!=DEXTTOP.G_CURREDITOR._config.formMode)return!1;if("1"==b._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("mouseup",a,c)}catch(x){}if(1==
DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(Mouse_Status==Mouse_IsCellDragging){if(DEXTTOP.DEXT5.browser.ie)try{_iframeDoc.body.releaseCapture()}catch(z){}Mouse_Status=Mouse_IsPlain;try{var A,B=GetTDTHCell(c);B?"true"==B.getAttribute("dext_select")?A=""==ReplaceAll(B.innerHTML," ","")||1==checkCellDefValue(B.innerHTML)?1:2:(ClearDraggingTableCellSelected(),DrageEndCell=null,A=3):DrageEndCell&&(A=""==ReplaceAll(DrageEndCell.innerHTML," ","")||1==checkCellDefValue(DrageEndCell.innerHTML)?
1:2);switch(A){case 1:setTimeout(function(){DEXTTOP.G_CURREDITOR._iconSelected();try{DrageEndCell?DrageEndCell.firstChild&&"P"==DrageEndCell.firstChild.tagName?doSetCaretPosition(DrageEndCell.firstChild,0):doSetCaretPosition(DrageEndCell,0):B&&(B.firstChild&&"P"==B.firstChild.tagName?doSetCaretPosition(B.firstChild,0):doSetCaretPosition(B,0))}catch(a){}},0);break;case 2:setTimeout(function(){try{var a;DrageEndCell?(a=getMyChildElementNode(DrageEndCell.lastChild),doSetCaretPosition(a,1)):B&&(a=getMyChildElementNode(B.lastChild),
doSetCaretPosition(a,1));DEXTTOP.G_CURREDITOR._iconSelected()}catch(b){}},0);break;case 3:break;default:DEXTTOP.G_CURREDITOR._iconSelected();try{DrageEndCell?doSetCaretPosition(DrageEndCell,0):B&&doSetCaretPosition(B,0)}catch(G){}}}catch(D){}}if(a=c.tagName)a=a.toLowerCase(),"img"==a?("Windows"==DEXTTOP.DEXT5.UserAgent.os.name&&DEXTTOP.DEXT5.browser.safari||DEXTTOP.DEXT5.browser.ie&&9>DEXTTOP.DEXT5.browser.ieVersion||getApplyDragResize(DEXTTOP.G_CURREDITOR)||!c.getAttribute("raon_chart")||0!=Mouse_Status||
(a={element:c},command_InsertChart(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a)),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):"html"==a&&setFocusToBody();setRulerPositionForNode();if(DEXTTOP.DEXT5.browser.ie)try{setTimeout(function(){var a,b=getFirstRange().range;b&&b.startContainer==b.endContainer&&1==b.collapsed&&(a=getMyElementNode(b.startContainer));if(0==b.toString().length&&("undefined"==typeof a&&"a"==getMyElementNode(b.startContainer).tagName.toLowerCase()&&
(a=getMyElementNode(b.startContainer)),null==a)){var d=!1;try{var e;b.startContainer&&b.startContainer.tagName&&(e=b.startContainer.tagName.toLowerCase());var f=getElementsFromSelection(e);e?DEXTTOP.DEXT5.browser.ie&&(8>DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)?1==f.length&&"IMG"==f[0].tagName&&(d=!0):2==f.length&&"IMG"==f[1].tagName&&(d=!0):3==f.length&&"IMG"==f[2].tagName&&(d=!0)}catch(g){}!d&&c&&0>",div,img,table,input,textarea,select,hr,".indexOf(","+c.tagName.toLowerCase()+
",")&&(c.tagName&&"P"==c.tagName&&"TD"==c.parentNode.tagName?doSetCaretPosition(c,1):c.tagName&&"SPAN"==c.tagName&&"raon_placeholder"==c.className||(setFocusToBody(),setFocusFirstChildForStyle(DEXTTOP.G_CURREDITOR._BODY),(b=getFirstRange().range)&&b.startContainer==b.endContainer&&1==b.collapsed&&(a=getMyElementNode(b.startContainer))))}if(11<=DEXTTOP.DEXT5.browser.ieVersion){if("undefined"==typeof a&&b.endContainer&&(a=getMyElementNode(b.endContainer)),a&&"P"==a.nodeName&&a.lastChild&&"BR"==a.lastChild.nodeName&&
a.lastChild.previousSibling&&(b=b.getBoundingDocumentRect(),Math.round(b.right)==Math.round(getClientRect(a.lastChild).right))){for(a=a.lastChild.previousSibling;a&&a.lastChild;)a=a.lastChild;a=getMyElementNode(a)}}else if(a)if(a=getFirstRange().sel.focusNode)for(;1!=a.nodeType;)a=a.parentNode;else a=getMyElementNode(b.startContainer);a&&setMenuIconRealable(a)},10)}catch(I){}}}
function CheckNoWhere(a,b,c){var d=b.Y,e=_iframeDoc.body.clientHeight,f=_iframeDoc.body.firstChild,g=_iframeDoc.body.lastChild;b=!1;a="spanTag_NoWhere_"+DEXTTOP.G_CURREDITOR.ID;if(10>=d&&-1<",table,hr,div,ul,ol,dl,form,blockquote,".indexOf(","+f.tagName.toLowerCase()+","))b=!0;else if(d>=e&&-1<",table,hr,div,ul,ol,dl,form,blockquote,".indexOf(","+g.tagName.toLowerCase()+","))b=!0;else if(10<d&&d<e){b=!1;d=" table hr div ul ol dl form blockquote ".split(" ");f=e=null;for(g=0;g<d.length&&(e=GetParentInTag(c,
d[g]),null==e);g++);if(null!=e)if(null==e.previousSibling)b=!0,getElementOffset(e);else{for(g=0;g<d.length&&(f=GetParentInTag(e.previousSibling,d[g]),null==f);g++);null!=e&&null!=f&&(b=!0,getElementOffset(e))}}else if(f.id==a)return;0==b?(c=_iframeDoc.getElementById(a),null!=c&&_iframeDoc.body.removeChild(c)):(c=_iframeDoc.getElementById(a),null==c&&(c=_iframeDoc.createElement("span"),c.setAttribute("id",a),c.innerHTML="",_iframeDoc.body.insertBefore(c,_iframeDoc.body.firstChild)))}
function _iframeDoc_MouseMove(a){var b=getEditrFromEvent(a);if(!isViewMode(b))if(getApplyDragResize(b)&&DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_isDrag)DEXTTOP.G_CURREDITOR.dext_dragresize.dragElem(a,"doc"),DEXTTOP.DEXT5.util.cancelEvent(a);else{var c=null,c=a?a:_iframeWin.event,c=c.target?c.target:c.srcElement,d=c.tagName?c.tagName.toLowerCase():null;if(null!=d&&Mouse_Status!=Mouse_IsCellResizing&&Mouse_Status!=
Mouse_IsTableDragging&&null!=c){if("1"==b._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("mousemove",a,c)}catch(e){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}b=GetTDTHCell(c);mouseEndPos=getMousePosition(a);if(isLeftClick(a)&&Mouse_Status==Mouse_IsCellDragging){if(null!=b&&null!=DrageStartCell&&(DrageStartCell!=b||0!=GetTableSelectionCells().length)&&(GetParentbyTagName(c,"table")==ActiveCurrTable&&
(DrageEndCell=b),SelectedCellRange(DrageStartCell,b),DEXTTOP.DEXT5.browser.ie&&setAutoScroll(mouseEndPos),DEXTTOP.DEXT5.browser.ie))try{_iframeDoc.body.setCapture(!1)}catch(f){}}else"img"!=d&&"hr"!=d&&"div"!=d&&"a"!=d&&(Mouse_Status=Mouse_IsPlain),DEXTTOP.DEXT5.browser.mobile||(null!=b?IsMousePointOnBorder(a)?b.isContentEditable&&showResizeBar():hideResizeBar():hideResizeBar())}}}
function setAutoScroll(a){var b=getElementOffset(_iframeWin.frameElement),c,d;c=_iframeWin.frameElement.offsetHeight;d=_iframeWin.frameElement.offsetWidth;var b=b.left+d,e,f;DEXTTOP.DEXT5.browser.ie?(e=_iframeDoc.documentElement.scrollLeft+_iframeDoc.body.scrollLeft,f=_iframeDoc.documentElement.scrollTop+_iframeDoc.body.scrollTop):(e=_iframeWin.scrollX,f=_iframeWin.scrollY);a.X+20>b&&_iframeWin.scroll(e+30,f);0<e&&a.X-20<b-d&&_iframeWin.scroll(e-30,f);a.Y+20>c&&_iframeWin.scroll(e,f+30);0<f&&a.Y-
20<c-c&&_iframeWin.scroll(e,f-30)}function isLeftClick(a){return a.which?1==a.which:a.button?1==a.button:!1}function isRightClick(a){var b=!1;a=a||window.event;a.which||void 0===a.button||(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);switch(a.which){case 1:b=!1;break;case 2:b=!1;break;case 3:b=!0;break;case 0:0==a.button&&(b=!0)}return b}
function ClearDraggingTableCellSelected(){if(null!=ActiveCurrTable&&ActiveCurrTable.getAttribute("DEXT5CellSelected"))try{ActiveCurrTable.removeAttribute("DEXT5CellSelected");for(var a=ActiveCurrTable,b=a.rows.length,c=0;c<b;c++)for(var d=a.rows[c],e=d.cells.length,f=0;f<e;f++){var g=d.cells[f];"true"==g.getAttribute("dext_select")&&(g.style.backgroundColor=g.getAttribute("cellOrgBgColor"),removeAttribute(g,"cellOrgBgColor"),removeAttribute(g,"dext_select"))}}catch(h){}}
function ClearDraggingTable(a){if(null!=a&&a.getAttribute("DEXT5CellSelected"))try{a.removeAttribute("DEXT5CellSelected");for(var b=a.rows.length,c=0;c<b;c++)for(var d=a.rows[c],e=d.cells.length,f=0;f<e;f++){var g=d.cells[f];"true"==g.getAttribute("dext_select")&&(g.style.backgroundColor=g.getAttribute("cellOrgBgColor"),removeAttribute(g,"cellOrgBgColor"),removeAttribute(g,"dext_select"))}}catch(h){}}
function ClearDraggingTableAllTable(){try{for(var a=_iframeDoc.getElementsByTagName("TABLE"),b=a.length,c=null,d=null,e=0,f=0,g=0,h=0;h<b;h++)if(c=a[h],e=c.rows.length,c.getAttribute("DEXT5CellSelected")){c.removeAttribute("DEXT5CellSelected");for(var n=0;n<e;n++)for(var f=c.rows[n],g=f.cells.length,m=0;m<g;m++)d=f.cells[m],"true"==d.getAttribute("dext_select")&&(d.style.backgroundColor=d.getAttribute("cellOrgBgColor"),removeAttribute(d,"cellOrgBgColor"),removeAttribute(d,"dext_select"))}}catch(p){}}
function colorToHex(a){if(6>a.length)return"#tttttt";if("#"===a.substr(0,1))return a;a=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);if(null==a)return"#tttttt";var b=parseInt(a[2]),c=parseInt(a[3]),b=parseInt(a[4])|c<<8|b<<16;return a[1]+"#"+b.toString(16)}function removeAttribute(a,b){if(null!=a)try{a.removeProperty?a.removeProperty(b):a.removeAttribute(b)}catch(c){}}function getClientRect(a){var b={left:0,top:0,right:0,bottom:0};try{b=a.getBoundingClientRect()}catch(c){}return b}
function getMousePosition(a){var b={};if(a.clientX||a.clientY)b.X=Math.round(a.clientX),b.Y=Math.round(a.clientY);else if(a.pageX||a.pageY)b.X=Math.round(a.pageX),b.Y=Math.round(a.pageY);return b}
function SelectedCellRange(a,b,c){c=GetParentbyTagName(a,"tr");var d=GetParentbyTagName(b,"tr");if(null!=c&&null!=d&&(ActiveCurrTable=GetParentbyTagName(c,"table"),ClearDraggingTableCellSelected(),a!=b)){var d=getClientRect(a),e=getClientRect(b);b=d.left<e.left?d.left:e.left;a=d.top<e.top?d.top:e.top;c=d.right<e.right?e.right:d.right;d=d.bottom<e.bottom?e.bottom:d.bottom;b-=2;a-=2;c+=2;for(var d=d+2,e=!1,f=ActiveCurrTable.rows.length,g=0;g<f;g++)for(var h=ActiveCurrTable.rows[g],n=h.cells.length,
m=0;m<n;m++){var p=h.cells[m],t=getClientRect(p);t.left>=b&&t.right<=c&&t.top>=a&&t.bottom<=d&&(""==p.style.backgroundColor&&""!=p.getAttribute("cellOrgBgColor")&&(p.style.backgroundColor=p.getAttribute("cellOrgBgColor")),p.setAttribute("cellOrgBgColor",p.style.backgroundColor),p.style.backgroundColor=ColorCellBackColor,setCellDefValue(p),p.setAttribute("dext_select","true"),e=!0)}if(e)try{if(ActiveCurrTable.setAttribute("DEXT5CellSelected","DEXT5CellSelected"),"1"==DEXTTOP.G_CURREDITOR._config.cellSelectionMode){var q=
getFirstRange().sel;q&&q.removeAllRanges&&q.removeAllRanges()}}catch(u){}}}function GetTDTHCell(a){if(a&&a.nodeName.match(/t[dh]/i))return a;for(;null!=a&&!a.nodeName.match(/t[dh]/i);)a=a.parentNode;return a}
function CanMerge(){if(null==ActiveCurrTable)return 0;var a=0,b,c,d,e,f,g,h,n;b=c=1E7;for(var m=d=e=0;m<ActiveCurrTable.rows.length;m++)for(var p=ActiveCurrTable.rows[m],t=0;t<p.cells.length;t++){var q=p.cells[t];if("true"==q.getAttribute("dext_select")){h=q.colSpan;var u=q.rowSpan,a=a+h*u;n=getClientRect(q);f=n.left;g=n.top;h=n.right;n=n.bottom}b>f&&(b=parseInt(f,10));c>g&&(c=parseInt(g,10));d<h&&(d=parseInt(h,10));e<n&&(e=parseInt(n,10))}for(m=g=f=0;m<ActiveCurrTable.rows.length;m++)for(p=ActiveCurrTable.rows[m],
t=0;t<p.cells.length;t++)if(q=p.cells[t],n=getClientRect(q),b<=parseInt(n.left,10)&&c<=parseInt(n.top,10)&&d>=parseInt(n.right,10)&&e>=parseInt(n.bottom,10)||b>parseInt(n.left,10)&&c<=parseInt(n.top,10)&&b<parseInt(n.right,10)&&e>=parseInt(n.bottom,10)||d>parseInt(n.left,10)&&c<=parseInt(n.top,10)&&d<parseInt(n.right,10)&&e>=parseInt(n.bottom,10)||b<=parseInt(n.left,10)&&e>parseInt(n.top,10)&&d>=parseInt(n.right,10)&&e<parseInt(n.bottom,10)||b<=parseInt(n.left,10)&&c>parseInt(n.top,10)&&d>=parseInt(n.right,
10)&&c<parseInt(n.bottom,10))h=q.colSpan,u=q.rowSpan,f+=h*u,d==n.right&&(g+=q.rowSpan);b=0;0<g&&(b=a/g);return"number"==typeof b&&0<b.toString().indexOf(".")?!1:f==a&&1<f?f:0}
function command_mergeCell(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(0!=CanMerge()){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var c,d,e,f,g,h,n,m;c=d=1E7;e=f=0;var p="";ActiveCurrTable&&(p=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");for(var t=0;t<ActiveCurrTable.rows.length;t++)for(var q=ActiveCurrTable.rows[t],u=0;u<q.cells.length;u++){var v=q.cells[u];"true"==v.getAttribute("dext_select")&&
(m=getClientRect(v),g=m.left,h=m.top,n=m.right,m=m.bottom);c>g&&(c=g);d>h&&(d=h);e<n&&(e=n);f<m&&(f=m)}n=h="";var w,y;w=y=0;g=null;for(t=0;t<ActiveCurrTable.rows.length;t++)for(q=ActiveCurrTable.rows[t],u=0;u<q.cells.length;u++)v=q.cells[u],m=getClientRect(v),c<=m.left&&d<=m.top&&e>=m.right&&f>=m.bottom&&(d==m.top&&c==m.left?(g=v,n=v.innerHTML):v.style.visibility="hidden",h+=removeCellDefValue(v,!0),1>Math.abs(c-m.left)&&(w+=v.rowSpan),1>Math.abs(d-m.top)&&(y+=v.colSpan));if(g){m=0;c=getClientRect(g);
for(t=ActiveCurrTable.rows.length-1;0<=t;t--)for(q=ActiveCurrTable.rows[t],u=q.cells.length-1;0<=u;u--)v=q.cells[u],d=getClientRect(v),"hidden"==v.style.visibility&&(c.top==d.top&&(m+=parseIntOr0(v.style.width)),c.right==d.left&&c.top!=d.top&&parseIntOr0(v.style.height));0<m&&(g.style.width=parseIntOr0(g.style.width)+m+"px")}t=!1;g&&(t=!0);if(t){ActiveCurrTable.style.borderCollapse="";e=d=0;f=[];var x=0;c=getClientRect(g);for(t=0;t<ActiveCurrTable.rows.length;t++)for(nTemp=0,q=ActiveCurrTable.rows[t],
u=0;u<q.cells.length;u++)v=q.cells[u],m=getClientRect(v),(c.left!=m.left||c.right!=m.right)&&c.left<=m.left&&c.right>=m.right&&(0==nTemp&&f.push(v),x+=1,nTemp+=v.colSpan),c.bottom==m.top&&(e=nTemp),c.top==m.bottom&&(d=nTemp);0<d||0<e?g.colSpan=d<e?e:d:removeAttribute(g,"colSpan");if(f.length==x){for(t=0;t<f.length;t++)removeAttribute(f[t],"colSpan");removeAttribute(g,"colSpan")}}if(g){1<y&&(g.colSpan=y);1<w&&(g.rowSpan=w);for(t=ActiveCurrTable.rows.length-1;0<=t;t--){q=ActiveCurrTable.rows[t];for(u=
q.cells.length-1;0<=u;u--)v=q.cells[u],"hidden"==v.style.visibility&&q.deleteCell(u);0==q.cells.length&&deleteRow(q)}g.innerHTML=0==h.length?""!=n?n:DEXTTOP.DEXT5.browser.ie?"":getCellDefValue():h;try{DEXTTOP.DEXT5.browser.gecko?0==h.length?doSetCaretPosition(g.childNodes[0],0):setGeckoCellCaretPosistion(g,!0):(doSetCaretPosition(g.childNodes[0],0),removeCellDefValue(g,!1))}catch(z){}ClearDraggingTableCellSelected();if(1==ActiveCurrTable.rows.length)for(q=ActiveCurrTable.rows[0],u=0;u<q.cells.length;u++)v=
q.cells[u],removeAttribute(v,"rowSpan"),removeAttribute(v,"colSpan");1==ActiveCurrTable.rows.length&&1==ActiveCurrTable.rows[0].cells.length&&(removeAttribute(ActiveCurrTable.rows[0].cells[0],"width"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"height"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"colSpan"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"rowSpan"));if(g&&1<g.colSpan&&1<ActiveCurrTable.rows.length){n=0;h=[];c=getClientRect(g);for(t=0;t<ActiveCurrTable.rows.length;t++)for(q=
ActiveCurrTable.rows[t],u=0;u<q.cells.length;u++)v=q.cells[u],m=getClientRect(v),c.left==m.left&&c.right==m.right&&parseIntOr0(g.colSpan)==parseIntOr0(v.colSpan)&&(m=parseIntOr0(v.rowSpan),n=1<m?n+m:n+1,h.push(v));if(n==ActiveCurrTable.rows.length)for(q=h.length,t=0;t<q;t++)removeAttribute(h[t],"colSpan")}}ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=p);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}}
function command_deleteTable(a,b){dext_src_init(b._EDITOR.design);if(null==ActiveCurrTable)return 0;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var c=ActiveCurrTable.previousSibling;try{if(c){if(3==c.nodeType||1==c.nodeType&&"BR"==c.tagName)c="text"}else{var d=ActiveCurrTable.parentNode;1==d.nodeType&&"BODY"!=d.tagName&&(c=d)}}catch(e){c=null}ActiveCurrTable.parentNode.removeChild(ActiveCurrTable);ActiveCurrTable=null;if("text"!=c)if(null==c)""==_iframeDoc.body.innerHTML?
(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default"));else if(doSetCaretPosition(c,1),c=GetParentbyTagName(c,"table")){var d=b._config.tableNoActionClass,f=!1;""!=d&&(f=checkContainClass(c,d));ActiveCurrTable=c;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",f)}else DEXTTOP.G_CURREDITOR._iconEnable("default");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_insertRowUp(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();InsertRowUpDown(!0,!1,c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function command_insertRowDown(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();InsertRowUpDown(!1,!1,c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function InsertRowUpDown(a,b,c,d){var e=getFirstRange().range;if(e){var f=null,f=d?d:GetTDTHCell(e.startContainer);if(null!=f&&(ActiveCurrTable=GetParentbyTagName(f,"table"),d=GetParentbyTagName(f,"tr"))){e=0;a?e=d.rowIndex:(e=1<f.rowSpan?d.rowIndex+f.rowSpan:d.rowIndex+1,e>ActiveCurrTable.rows.length&&(e=ActiveCurrTable.rows.length));for(var g=[],h=[],n=getClientRect(f),f=0;f<ActiveCurrTable.rows.length;f++)for(var m=ActiveCurrTable.rows[f],p=0;p<m.cells.length;p++){var t=m.cells[p],q=getClientRect(t);
if(a){if(.1>Math.abs(n.top-q.top)||q.top<n.top&&q.bottom>n.top){var u={};u.left=q.left;u.cell=t;h.push(u)}}else if(.1>Math.abs(n.bottom-q.bottom)||q.bottom>n.bottom&&n.bottom>q.top)u={},u.left=q.left,u.cell=t,h.push(u)}h.sort(function(a,b){return a.left-b.left});for(f=0;f<h.length;f++)g.push(h[f].cell);h=[];for(f=0;f<g.length;f++)m=g[f],p=m.rowSpan,q=getClientRect(m),h[f]=1<p&&1==a&&q.top!=n.top||1<p&&0==a&&q.bottom!=n.bottom?m.rowSpan+1:1;c||(c=1);for(a=0;a<c;a++)for(n=ActiveCurrTable.insertRow(e),
setCopyAllObjectAtributes(d,n,!1),f=0;f<g.length;f++)if(m=g[f],p=m.rowSpan,1<h[f])m.rowSpan=h[f],removeAttribute(m,"height");else if(q=n.insertCell(-1)){"th"==m.tagName.toLowerCase()&&(p=document.createElement("th"),q.parentNode.replaceChild(p,q),q=p);q.innerHTML=getCellDefValue();if(b){p=[];t=[];try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion)for(var p=m.getElementsByTagName("a"),v=p.length,w=0;w<v;w++)p[w].outerHTML.match(RegExp("(hrefs*=s*(?:\"|')(.*?)(?:\"|'))","gi")),t.push(RegExp.$2)}catch(y){p=
[],t=[]}setCopyAllObjectAtributes(m,q,!0);try{if(DEXTTOP.DEXT5.browser.ie&&8>DEXTTOP.DEXT5.browser.ieVersion&&(v=p.length,0<v))for(var x=q.getElementsByTagName("a"),z=x.length,w=0;w<z;w++)x[w].href&&0>x[w].href.toLowerCase().indexOf("javascript")&&0>x[w].href.indexOf("'")&&0>x[w].href.indexOf('"')&&""!=t[w]&&x[w].href!=t[w]&&(x[w].href=t[w],x[w].setAttribute("href",t[w]))}catch(A){q.innerHTML=m.innerHTML}}else setCopyAllObjectAtributes(m,q,!1);1<q.rowSpan&&removeAttribute(q,"rowSpan")}}}}
function command_deleteRow(a,b){dext_src_init(b._EDITOR.design);if(null==ActiveCurrTable)return 0;restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var c=null,d=-1,e=0,f=getFirstRange().range;if(f){f=GetTDTHCell(f.startContainer);c=ActiveCurrTable.previousSibling;try{if(c){if(3==c.nodeType||1==c.nodeType&&"BR"==c.tagName)c="text"}else{var g=ActiveCurrTable.parentNode;1==g.nodeType&&"BODY"!=g.tagName&&(c=g)}}catch(h){c=null}g=
GetParentbyTagName(f,"tr");for(f=0;f<ActiveCurrTable.rows.length;f++)for(var n=ActiveCurrTable.rows[f],m=0;m<n.cells.length;m++)if("true"==n.cells[m].getAttribute("dext_select")){-1==d&&(d=n.rowIndex);e++;break}e=e||1;for(f=0;f<e;f++){-1!=d&&(g=ActiveCurrTable.rows[d]);if(null==g)return;deleteRow(g)}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;ActiveCurrTable?(doSetCaretPosition(ActiveCurrTable.rows[0].cells[0].childNodes[0],0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):
"text"!=c&&(null==c?""==_iframeDoc.body.innerHTML?(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default")):(doSetCaretPosition(c,1),(c=GetParentbyTagName(c,"table"))?(d=b._config.tableNoActionClass,e=!1,""!=d&&(e=checkContainClass(c,d)),ActiveCurrTable=c,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",e)):DEXTTOP.G_CURREDITOR._iconEnable("default")))}
function deleteRow(a){if(null!=a){ActiveCurrTable=GetParentbyTagName(a,"table");var b=a.rowIndex;ActiveCurrTable.previousSibling&&doSetCaretPosition(ActiveCurrTable.previousSibling,0);for(var c=0;c<ActiveCurrTable.rows.length;c++){var d=ActiveCurrTable.rows[c],e=d.rowIndex;if(b==e)break;for(var f=0;f<d.cells.length;f++){var g=d.cells[f],h=g.rowSpan;1<h&&b<e+h&&(2==h?removeAttribute(g,"rowSpan"):g.rowSpan=h-1)}}for(f=0;f<a.cells.length;f++)if(g=a.cells[f],h=g.rowSpan,1<h){c=ActiveCurrTable.rows[a.rowIndex+
1].insertCell(g.cellIndex);if(null==c)return;d=g.colSpan;e=g.style.width;c.innerHTML=g.innerHTML;c.style.border="1px solid #000000";c.style.width=e;2<h&&(c.rowSpan=h-1);1<d&&(c.colSpan=d)}1==ActiveCurrTable.rows.length?(ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),ActiveCurrTable=null):ActiveCurrTable.deleteRow(b)}}
function command_insertCellLeft(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();insertCell(!0,c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function command_insertCellRight(a,b,c){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();insertCell(!1,c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function insertCell(a,b){var c=getFirstRange().range;if(c){var d=GetTDTHCell(c.startContainer);if(null!=d&&(ActiveCurrTable=GetParentbyTagName(d,"table"),GetParentbyTagName(d,"tr"))){for(var c=[],e=[],f=getClientRect(d),d=0;d<ActiveCurrTable.rows.length;d++)for(var g=ActiveCurrTable.rows[d],h=0;h<g.cells.length;h++){var n=g.cells[h],m=getClientRect(n);a?f.left==m.left?(m={},m.x=d,m.y=h,m.width=0<n.style.width.length?n.style.width:"",m.height=0<n.style.width.height?n.style.height:"",m.rowSpan=n.rowSpan,
m.cell=n,c.push(m)):(f.top>=m.bottom||f.bottom<=m.top)&&.1<m.right-f.left&&.1<f.left-m.left&&e.push(n):f.right==m.right?(m={},m.x=d,m.y=h+1,m.rowSpan=n.rowSpan,m.width=0<n.style.width.length?n.style.width:"",m.height=0<n.style.width.height?n.style.height:"",m.cell=n,c.push(m)):(f.top>=m.bottom||f.bottom<=m.top)&&.1<m.right-f.right&&.1<f.right-m.left&&e.push(n)}b||(b=1);for(d=0;d<c.length;d++)for(f=0;f<b;f++){n=c[d];g=ActiveCurrTable.rows[n.x].insertCell(n.y);if(null==g)return;"th"==n.cell.tagName.toLowerCase()&&
(h=document.createElement("th"),g.parentNode.replaceChild(h,g),g=h);g.innerHTML=getCellDefValue();setCopyAllObjectAtributes(n.cell,g,!1);1<n.rowSpan?g.rowSpan=n.rowSpan:removeAttribute(g,"rowSpan");1<n.cell.colSpan&&removeAttribute(g,"colSpan")}for(d=0;d<e.length;d++)for(f=0;f<b;f++)n=e[d],n.colSpan+=1}}}
function command_InsertSplitCell(a,b,c,d){dext_src_init(b);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;var e,f,g;"TD"==DEXTTOP.G_SELECTED_ELEMENT.tagName||"TH"==DEXTTOP.G_SELECTED_ELEMENT.tagName?g=DEXTTOP.G_SELECTED_ELEMENT:a&&(g=GetTDTHCell(a.startContainer));g&&(e=GetTableSelectionCells(g),f=e.length);if(0==f)1<parseInt(c)&&splitCellByRow(c,!0,g),1<parseInt(d)&&splitCellByColumn(d,!0,g);else for(g=
0;g<f;g++)1<parseInt(c)&&splitCellByRow(c,!0,e[g]),1<parseInt(d)&&splitCellByColumn(d,!0,e[g]);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function splitCellByRow(a,b,c){if(b=null==c||void 0==c?getFirstRange().range:c)if(b=null==c||void 0==c?GetTDTHCell(b.startContainer):GetTDTHCell(b),null!=b){ActiveCurrTable=GetParentbyTagName(b,"table");var d=GetParentbyTagName(b,"tr"),e="";ActiveCurrTable&&(e=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");if(d){whereRowIdx=d.rowIndex;if(1<b.rowSpan){--b.rowSpan;var d=b.style.width,f=b.style.height,g=ActiveCurrTable.rows[whereRowIdx+b.rowSpan],h=GetFirstIndexInRowByCurrCell(g,
b);if(g=g.insertCell(h+1))g.innerHTML=getCellDefValue(),g.style.borderTop=b.style.borderTop,g.style.borderRight=b.style.borderRight,g.style.borderBottom=b.style.borderBottom,g.style.borderLeft=b.style.borderLeft,g.className=b.className,"true"==b.getAttribute("dext_select")?(g.setAttribute("cellOrgBgColor",b.getAttribute("cellOrgBgColor")),g.style.backgroundColor=ColorCellBackColor,g.setAttribute("dext_select","true")):""==b.style.backgroundColor||0!=b.style.backgroundColor.indexOf("#")&&0!=b.style.backgroundColor.indexOf("rgb")||
(g.style.backgroundColor=b.style.backgroundColor),0<d.length&&(g.style.width=d),0<f.length&&(g.style.height=f),1<b.colSpan&&(g.colSpan=b.colSpan);--a;1==b.rowSpan&&removeAttribute(b,"rowSpan");1<a&&splitCellByRow(a,!1,c);ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=e);return}c=[];for(var n=0,m=getClientRect(b),d=0;d<ActiveCurrTable.rows.length;d++)for(f=ActiveCurrTable.rows[d],g=0;g<f.cells.length;g++){var h=f.cells[g],p=getClientRect(h);if(m.top==p.top||p.top<m.top&&p.bottom>m.top)c[n]=
h,n+=1}n=[];for(d=0;d<c.length;d++)f=c[d],getClientRect(f),f!=b&&(n[d]=f.rowSpan+(a-1));for(m=1;m<a;m++){g=ActiveCurrTable.insertRow(whereRowIdx+m);d=b.style.width;f=b.style.height;h=GetFirstIndexInRowByCurrCell(g,b);if(g=g.insertCell(h))g.innerHTML=getCellDefValue(),g.style.borderTop=b.style.borderTop,g.style.borderRight=b.style.borderRight,g.style.borderBottom=b.style.borderBottom,g.style.borderLeft=b.style.borderLeft,g.className=b.className,"true"==b.getAttribute("dext_select")?(g.setAttribute("cellOrgBgColor",
b.getAttribute("cellOrgBgColor")),g.style.backgroundColor=ColorCellBackColor,g.setAttribute("dext_select","true")):""==b.style.backgroundColor||0!=b.style.backgroundColor.indexOf("#")&&0!=b.style.backgroundColor.indexOf("rgb")||(g.style.backgroundColor=b.style.backgroundColor),0<d.length&&(g.style.width=d),0<f.length&&(g.style.height=f),1<b.colSpan&&(g.colSpan=b.colSpan);for(d=0;d<c.length;d++)f=c[d],1<=n[d]&&(f.rowSpan=n[d],removeAttribute(f,"height"))}}ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=
e)}}function GetFirstIndexInRowByCurrCell(a,b){for(var c=-1,d=a.cells.length,e=getClientRect(b),d=d-1;0<=d;d--){var f=getClientRect(a.cells[d]);if(e.left>=f.right){c=d;break}}return c}
function splitCellByColumn(a,b,c){if(b=null==c||void 0==c?getFirstRange().range:c)if(b=null==c||void 0==c?GetTDTHCell(b.startContainer):GetTDTHCell(b),null!=b){ActiveCurrTable=GetParentbyTagName(b,"table");var d=GetParentbyTagName(b,"tr"),e="";ActiveCurrTable&&(e=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");if(d){if(1<b.colSpan){--b.colSpan;var f=parseInt(b.style.width),g=isNaN(parseInt(parseInt(b.style.width)/a))?"":parseInt(parseInt(b.style.width,10)/a,10)+"px",
h=b.style.height,n=d.insertCell(b.cellIndex+1);n&&(n.innerHTML=getCellDefValue(),n.style.borderTop=b.style.borderTop,n.style.borderRight=b.style.borderRight,n.style.borderBottom=b.style.borderBottom,n.style.borderLeft=b.style.borderLeft,n.className=b.className,"true"==b.getAttribute("dext_select")?(n.setAttribute("cellOrgBgColor",b.getAttribute("cellOrgBgColor")),n.style.backgroundColor=ColorCellBackColor,n.setAttribute("dext_select","true")):""==b.style.backgroundColor||0!=b.style.backgroundColor.indexOf("#")&&
0!=b.style.backgroundColor.indexOf("rgb")||(n.style.backgroundColor=b.style.backgroundColor),0<g.length&&(n.style.width=g),0<h.length&&(n.style.height=h),1<b.rowSpan&&(n.rowSpan=b.rowSpan));--a;1==b.colSpan&&removeAttribute(b,"colSpan");1<a?(g=f-parseInt(g),0<g&&(b.style.width=g+"px"),splitCellByColumn(a,!1,c)):0<g.length&&(b.style.width=g);ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=e);return}c=[];n=0;h=getClientRect(b);for(g=0;g<ActiveCurrTable.rows.length;g++)for(var m=ActiveCurrTable.rows[g],
f=0;f<m.cells.length;f++){var p=m.cells[f],t=getClientRect(p);if(p!=b){if(h.left>=t.left&&h.right<=t.right){m={};m.x=g;m.y=f;m.width=0<p.style.width.length?p.style.width:"";m.colSpan=p.colSpan;c[n]=m;n+=1;break}}else if(p==b)break}for(g=0;g<c.length;g++){n=c[g];n=ActiveCurrTable.rows[n.x].cells[n.y];if(null==n)return;n.colSpan+=a-1}g=isNaN(parseInt(parseInt(b.style.width)/a))?"":parseInt(parseInt(b.style.width,10)/a,10)+"px";0>=g.length&&(g=isNaN(parseInt(parseInt(b.clientWidth)/a))?"":parseInt(parseInt(b.clientWidth,
10)/a,10)+"px");""==g&&1==ActiveCurrTable.rows.length&&(g=parseInt(parseInt(ActiveCurrTable.style.width,10)/a,10)+"px");h=b.style.height;0<g.length&&(b.style.width=g);0<h.length&&(b.style.height=h);for(c=1;c<a;c++)if(n=d.insertCell(b.cellIndex+c))n.innerHTML=getCellDefValue(),n.style.borderTop=b.style.borderTop,n.style.borderRight=b.style.borderRight,n.style.borderBottom=b.style.borderBottom,n.style.borderLeft=b.style.borderLeft,n.className=b.className,"true"==b.getAttribute("dext_select")?(n.setAttribute("cellOrgBgColor",
b.getAttribute("cellOrgBgColor")),n.style.backgroundColor=ColorCellBackColor,n.setAttribute("dext_select","true")):""==b.style.backgroundColor||0!=b.style.backgroundColor.indexOf("#")&&0!=b.style.backgroundColor.indexOf("rgb")||(n.style.backgroundColor=b.style.backgroundColor),0<g.length&&(n.style.width=g),0<h.length&&(n.style.height=h),1<b.rowSpan&&(n.rowSpan=b.rowSpan)}ActiveCurrTable&&(ActiveCurrTable.style.borderCollapse=e)}}
function command_deleteCell(a,b){dext_src_init(b._EDITOR.design);if(null==ActiveCurrTable)return 0;restoreSelection();setFocusToBody();var c=null;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=getFirstRange().range;if(d){var e="";ActiveCurrTable&&(e=ActiveCurrTable.style.borderCollapse,ActiveCurrTable.style.borderCollapse="");c=ActiveCurrTable.previousSibling;try{if(c){if(3==c.nodeType||1==c.nodeType&&"BR"==c.tagName)c="text"}else{var f=ActiveCurrTable.parentNode;
1==f.nodeType&&"BODY"!=f.tagName&&(c=f)}}catch(g){c=null}var f=0,h=!1;"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="1",h=!0);setAdjustTableWidthHeight(ActiveCurrTable);h&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0");h=GetTableSelectionCells();for(0==h.length&&h.push(GetTDTHCell(d.startContainer));0<h.length;){var d=0,n=h[h.length-1],m=getClientRect(n);if(n){for(var p=[],h=0;h<ActiveCurrTable.rows.length;h++){var t=ActiveCurrTable.rows[h];if(n.parentNode.rowIndex==
h){var q={};q.x=h;q.y=n.cellIndex;q.isDel=!0;p.push(q)}else for(var u=0;u<t.cells.length;u++){var q=t.cells[u],v=getClientRect(q),q={};q.x=h;q.y=u;m.left<=v.left&&m.right>=v.right?(q.isDel=!0,p.push(q)):m.left>=v.left&&m.right<=v.right&&(q.isDel=!1,p.push(q))}}for(h=p.length;0<h;h--){t=p[h-1];u=ActiveCurrTable.rows[t.x].cells[t.y];if(null==u){ActiveCurrTable.style.borderCollapse=e;return}t.isDel?(u=parseIntOr0(u.style.width),d<u&&(d=u),ActiveCurrTable.rows[t.x].deleteCell(t.y)):2<u.colSpan?--u.colSpan:
removeAttribute(u,"colSpan")}for(h=ActiveCurrTable.rows.length-1;0<=h;h--)if(0==ActiveCurrTable.rows[h].cells.length){p=ActiveCurrTable.rows[h].rowIndex;for(u=0;u<h;u++){t=ActiveCurrTable.rows[u];n=t.rowIndex;if(p==n)break;for(m=0;m<t.cells.length;m++)q=t.cells[m],v=q.rowSpan,1<v&&p<n+v&&(2==v?removeAttribute(q,"rowSpan"):q.rowSpan=v-1)}ActiveCurrTable.deleteRow(h)}0==ActiveCurrTable.rows.length&&(ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),ActiveCurrTable=null)}f+=d;h=GetTableSelectionCells()}ActiveCurrTable&&
(d=parseIntOr0(ActiveCurrTable.style.width),0<d&&(ActiveCurrTable.style.width=d-f+"px"),ActiveCurrTable.style.borderCollapse=e)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;ActiveCurrTable?(doSetCaretPosition(ActiveCurrTable.rows[0].cells[0].childNodes[0],0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):"text"!=c&&(null==c?""==_iframeDoc.body.innerHTML?(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default")):
(doSetCaretPosition(c,1),(c=GetParentbyTagName(c,"table"))?(e=b._config.tableNoActionClass,f=!1,""!=e&&(f=checkContainClass(c,e)),ActiveCurrTable=c,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",f)):DEXTTOP.G_CURREDITOR._iconEnable("default")))}
function GetTableSelectionCells(a){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(a,"table"));if(null==ActiveCurrTable)return[];a=[];for(var b=0,c=0;c<ActiveCurrTable.rows.length;c++)for(var d=ActiveCurrTable.rows[c],e=0;e<d.cells.length;e++){var f=d.cells[e];"true"==f.getAttribute("dext_select")&&(a[b]=f,b+=1)}return a}
function GetTableSelectionCellsPosition(a,b){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(a,"table"));if(null==ActiveCurrTable)return[];for(var c={arrOutSideLeft:[],arrOutSideRight:[],arrOutSideTop:[],arrOutSideBottom:[],arrSelected:[],rowCnt:0,colCnt:0},d,e=[],f=[],g=ActiveCurrTable.rows.length,h=0;h<g;h++){for(var n=ActiveCurrTable.rows[h],f=[],m=0,p=n.cells.length,t=0;t<p;t++){var q=n.cells[t];b?(f.push(q),c.arrSelected.push(q),d=h,m+=1):"true"==q.getAttribute("dext_select")&&(f.push(q),
c.arrSelected.push(q),d=h,m+=1)}0<f.length&&e.push(f);m>c.colCnt&&(c.colCnt=m)}if(0==e.length&&(null==a||void 0==a))return c;if(0==e.length)return c.arrOutSideLeft.push(a),c.arrOutSideRight.push(a),c.arrOutSideTop.push(a),c.arrOutSideBottom.push(a),c.rowCnt=1,c.colCnt=1,c;c.arrOutSideTop=e[0].slice();f=e.length;c.rowCnt=f;if(0<f)for(c.arrOutSideBottom=e[f-1].slice(),h=p=m=n=g=0;h<f;h++){var q=e[h],t=q.length,u=0,v=t;if(0==g||q[0].parentNode.rowIndex==n+g)c.arrOutSideLeft.push(q[0]),u=1,1<q[0].rowSpan&&
(g=parseIntOr0(q[0].rowSpan),n=q[0].parentNode.rowIndex,1<g&&g+n-1>=d&&c.arrOutSideBottom.push(q[0]));if(0==m||q[t-1].parentNode.rowIndex==p+m)c.arrOutSideRight.push(q[t-1]),--v,1<q[t-1].rowSpan&&(m=parseIntOr0(q[t-1].rowSpan),p=q[t-1].parentNode.rowIndex),1<m&&m+p-1>=d&&c.arrOutSideBottom.push(q[t-1]);q[0].parentNode.rowIndex==n+g&&(g=n=0);q[t-1].parentNode.rowIndex==p+m&&(m=p=0);if(h<f-1)for(t=u;t<v;t++){var u=q[t].rowSpan,w=q[t].parentNode.rowIndex;1<u&&w+u-1>=d&&c.arrOutSideBottom.push(q[t])}}return c}
function CellSelectedCopy(a){var b={all:!0,selected:!1,cellValue:[],Table:null},c=l=0,d,e="",f=0;if(null==a||void 0==a)return!1;for(var g=a.rows.length,h=!1,n=0;n<g;n++){for(var m=a.rows[n],p=m.cells.length,e=e+"<tr>",t=0;t<p;t++){var q=m.cells[t];if("true"==q.getAttribute("dext_select")){b.selected=!0;void 0==b.cellValue[c]&&(b.cellValue[c]=[]);d=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&""==q.innerHTML?"&nbsp;":q.innerHTML;b.cellValue[c].push(d);e+=q.outerHTML;try{var u=isNaN(parseInt(q.style.width,
10))?u=parseInt(q.width,10):parseInt(q.style.width,10);if(isNaN(u))var v=getClientRect(q),u=v.right-v.left;isNaN(u)&&(u=0)}catch(w){u=0}0==h&&(f+=parseInt(u,10)+1)}else b.all=!1}0!=f&&(h=!0);e+="</tr>";void 0!=b.cellValue[c]&&(c+=1)}if(0==b.all)for(table_tag=DEXTTOP.DEXT5.util.replaceAll(a.outerHTML,a.innerHTML,e),table_tag=DEXTTOP.DEXT5.util.replaceAll(table_tag,"<tr></tr>",""),n=document.createElement("div"),n.innerHTML=table_tag,a=n.getElementsByTagName("table")[0],a.style.width=f+"px",a.style.height=
"",a.height="",f=a.getElementsByTagName("td"),c=f.length,n=0;n<c;n++)""!=f[n].getAttribute("cellOrgBgColor")&&"undefined"!=typeof f[n].getAttribute("cellOrgBgColor")?(f[n].style.backgroundColor=f[n].getAttribute("cellOrgBgColor"),removeAttribute(f[n],"cellOrgBgColor"),removeAttribute(f[n],"dext_select")):f[n].style.backgroundColor="";b.Table=a;return b}
function getTableBorderCells(a){var b={arrLeft:[],arrTop:[],arrRight:[],arrBottom:[]};if(null==a||void 0==a)return b;var c=a.tagName.toLowerCase(),d=a;"table"!=c&&(d=GetParentbyTagName(a,"table"));if(null==d)return b;a=d.rows.length;for(var e=getClientRect(d.rows[0].cells[0]),c=0;c<a;c++)for(var f=d.rows[c],g=f.cells.length,h=0;h<g;h++){var n=f.cells[h],m=getClientRect(n);e.left==m.left&&b.arrLeft.push(n);e.top==m.top&&b.arrTop.push(n)}for(var c=b.arrTop[b.arrTop.length-1],e=getClientRect(b.arrLeft[b.arrLeft.length-
1]),p=getClientRect(c),c=0;c<a;c++)for(f=d.rows[c],g=f.cells.length,h=0;h<g;h++)n=f.cells[h],m=getClientRect(n),e.bottom==m.bottom&&b.arrBottom.push(n),p.right==m.right&&b.arrRight.push(n);return b}
function getCellNearLeftTop(a,b){var c={arrLeft:[],arrRight:[],arrTop:[],arrBottom:[],arrSelected:[]},d=[];void 0==b&&(d=GetTableSelectionCells(a));if(0==d.length&&(null==a||void 0==a))return c;0==d.length&&d.push(a);c.arrSelected=d;var e=GetParentbyTagName(d[0],"table");getClientRect(e.rows[0].cells[0]);for(var f=0;f<d.length;f++)for(var g=getClientRect(d[f]),h=e.rows.length,n=0;n<h;n++)for(var m=e.rows[n],p=m.cells.length,t=0;t<p;t++){var q=m.cells[t],u=getClientRect(q);g.left==u.right&&(g.top<=
u.top&&g.bottom>=u.bottom||g.top>=u.top&&g.bottom<=u.bottom&&1<q.rowSpan)&&c.arrLeft.push(q);g.right==u.left&&(g.top<=u.top&&g.bottom>=u.bottom||g.top>=u.top&&g.bottom<=u.bottom&&1<q.rowSpan)&&c.arrRight.push(q);g.top==u.bottom&&(g.left<=u.left&&g.right>=u.right||g.left>=u.left&&g.right<=u.right&&1<q.colSpan)&&c.arrTop.push(q);g.bottom==u.top&&(g.left<=u.left&&g.right>=u.right||g.left>=u.left&&g.right<=u.right&&1<q.colSpan)&&c.arrBottom.push(q)}return c}
function setTableRowSelect(a){if(null!=a&&void 0!=a){var b=GetParentbyTagName(a,"table"),c=GetParentbyTagName(a,"tr");if(null!=b&&null!=c){for(var b=null,d=0;d<c.cells.length;d++)b=c.cells[d],b.setAttribute("cellOrgBgColor",b.style.backgroundColor),b.style.backgroundColor=ColorCellBackColor,b.setAttribute("dext_select","true"),setCellDefValue(b);DrageEndCell=b;c=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-1]);doSetCaretPosition(c,0);setMenuIconRealable(DrageEndCell);
_iframeDoc_MouseUpMenu(null,a)}}}
function setTableColumnSelect(a){if(null!=a&&void 0!=a){var b=GetParentbyTagName(a,"table");if(null!=b){for(var c=b.rows.length,d=null,e=getClientRect(a),f=0;f<c;f++)for(var g=b.rows[f],h=g.cells.length,n=0;n<h;n++){cell=g.cells[n];var m=getClientRect(cell);e.left==m.left&&(cell.setAttribute("cellOrgBgColor",cell.style.backgroundColor),cell.style.backgroundColor=ColorCellBackColor,cell.setAttribute("dext_select","true"),setCellDefValue(cell),d=cell)}DrageEndCell=d;b=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-
1]);doSetCaretPosition(b,0);setMenuIconRealable(DrageEndCell);_iframeDoc_MouseUpMenu(null,a)}}}function setTableCellSelect(a){if(null!=a&&void 0!=a){var b=a.tagName.toLowerCase();if("td"!=b||"th"!=b)a=GetTDTHCell(a);null!=a&&(a.setAttribute("cellOrgBgColor",a.style.backgroundColor),a.style.backgroundColor=ColorCellBackColor,a.setAttribute("dext_select","true"),setCellDefValue(a),DrageEndCell=a,_iframeDoc_MouseUpMenu(null,a))}}
function setTableAllSelect(a){if(null!=a&&void 0!=a){var b=GetParentbyTagName(a,"table");if(null!=b){for(var c=b.rows.length,d=null,e=0;e<c;e++)for(var f=b.rows[e],g=f.cells.length,h=0;h<g;h++)d=f.cells[h],d.setAttribute("cellOrgBgColor",d.style.backgroundColor),d.style.backgroundColor=ColorCellBackColor,d.setAttribute("dext_select","true"),setCellDefValue(d);DrageEndCell=d;b=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-1]);doSetCaretPosition(b,1);setMenuIconRealable(DrageEndCell);
_iframeDoc_MouseUpMenu(null,a)}}}function setTableWidthRemove(){for(var a=GetTableSelectionCells(),b=0;b<a.length;b++){var c=a[b];removeAttribute(c,"width");removeAttribute(c.style,"width")}}function setTableHeightRemove(){for(var a=GetTableSelectionCells(),b=a.length,c=0;c<b;c++){var d=a[c];removeAttribute(d,"height");removeAttribute(d.style,"height")}}
function setTableWidthHeightRemove(){for(var a=GetTableSelectionCells(),b=a.length,c=0;c<b;c++){var d=a[c];removeAttribute(d,"width");removeAttribute(d.style,"width");removeAttribute(d,"height");removeAttribute(d.style,"height")}}
function setTableWidthSame(){var a=GetTableSelectionCells();if(0!=a.length){var b=GetParentbyTagName(a[0],"table");if(null!=b){for(var c=0,d=0,e=a.length,f=0,g=0;g<e;g++){var h=a[g],n=0;""!=h.style.width&&-1<h.style.width.indexOf("%")?(n=getClientRect(h),n=n.right-n.left):n=parseIntOr0(h.style.width);0==n&&(n=parseIntOr0(h.width));0==n&&(n=getClientRect(h),n=n.right-n.left);var m=parseIntOr0(h.colSpan);1<m&&(n/=m);h=parseIntOr0(h.rowSpan);if(1<h)for(d+=h,f+=1,m=0;m<h;m++)c+=n;else c+=n}e=b.rows.length;
h=a.length;1<d&&(h+=d-f);c/=h;d=[];for(g=0;g<a.length;g++)for(n=getClientRect(a[g]),m=0;m<e;m++)for(var f=b.rows[m],p=f.cells.length,t=0;t<p;t++){var h=f.cells[t],q=getClientRect(h);n.left==q.left&&n.right==q.right&&d.push(h)}a=d.length;for(b=0;b<a;b++)h=d[b],m=parseIntOr0(h.colSpan),h.style.width=1<m?c*m+"px":c+"px",removeAttribute(h,"width")}}}
function setTableHeightSame(){var a=GetTableSelectionCells(),b=a.length;if(0!=b){for(var c=[],d,e=0;e<b;e++)d?d==getClientRect(a[e]).left&&c.push(a[e]):(d=getClientRect(a[e]).left,c.push(a[e]));var a=c,e=b=a.length,f=GetParentbyTagName(a[0],"table");if(null!=f){for(var g=0,h=c=0;h<b;h++){var n=a[h],g=g+getCellSize(n).height;if(1<n.rowSpan)var m=parseInt(n.rowSpan,10),e=e+(m-1)}m=f.rows.length;d=0;d=parseInt(g/e,10);g=[];for(h=0;h<b;h++)for(var p=getClientRect(a[h]),e=0;e<m;e++)for(var t=f.rows[e],
q=t.cells.length,u=0;u<q;u++){var n=t.cells[u],v=getClientRect(n);1<parseIntOr0(a[h].rowSpan)?p.top<=v.top&&p.bottom>=v.bottom&&g.push(n):1<parseIntOr0(n.rowSpan)||p.top==v.top&&p.bottom==v.bottom&&g.push(n)}a=g.length;for(e=0;e<a;e++)m=(m=parseIntOr0(g[e].rowSpan))?m:1,g[e].style.height=d*m+"px",removeAttribute(n,"height");b=!1;for(e=0;e<a;e++)f=getCellSize(g[e]).height,m=(m=parseIntOr0(g[e].rowSpan))?m:1,f/=m,d<f&&(c=f,b=!0);if(b)for(e=0;e<a;e++)m=(m=parseIntOr0(g[e].rowSpan))?m:1,g[e].style.height=
c*m+"px",removeAttribute(n,"height")}}}function setTableRowClone(a){null!=a&&void 0!=a&&(GetTDTHCell(a),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),InsertRowUpDown(!1,!0),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_convertTableToText(a,b){dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(null==ActiveCurrTable)return 0;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var c="",d=ActiveCurrTable,e=d.rows.length,f=0;f<e;f++)for(var g=d.rows[f],h=g.cells.length,n=0;n<h;n++)var m=g.cells[n],p="",p="innerText"in m?m.innerText:"textContent"in m?m.textContent:"",c=c+p;d=ActiveCurrTable.parentNode;d.removeChild(ActiveCurrTable);ActiveCurrTable=
null;c=c.replace("&nbsp;","");e=_iframeDoc.createElement("p");e.innerHTML=c;d.appendChild(e);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function _iframeDoc_MouseUpMenu(a,b){setDEXTWINDOC();var c=getEditrFromEvent(a);if(!isViewMode(c)){var d=null;try{var e=a?a:_iframeWin.event,d=void 0!=b||null!=b?b:e.target?e.target:e.srcElement;DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem&&(d=DEXTTOP.G_CURREDITOR.dext_dragresize.G_dextResize_elem);if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var f=GetTDTHCell(d),g;f&&(g=GetParentbyTagName(d,"table"));
var h=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;g&&g.getAttribute("lock_mode")&&""!=g.getAttribute("lock_mode")&&(h=g.getAttribute("lock_mode"));c=!0;"1"==h&&(c=!1);if(f){if(c&&checkLockAttr(g)){if(currEditor.lastElemForLock)setFocusForLock(currEditor.lastElemForLock);else{var n=findNoLockElem(g);n?setFocusForLock(n):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(f,!c)){currEditor.lastElemForLock?
setFocusForLock(currEditor.lastElemForLock):setFocusForLock(findNoLockCell(g));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}}var m=d.tagName.toLowerCase();if(m&&("textarea"==m||"input"==m||"select"==m)&&"1"!=DEXTTOP.G_CURREDITOR._config.formMode)return!1;if(m&&"img"==m){var p=d.getAttribute("dext5customdata");if(null!=p&&void 0!=p&&"hidden"==getDextCustomData(p).type)return!1}var t=function(){var a=getFirstRange(),b=a.range;if(b){var c=GetTableSelectionCells(),e=!1,f=
DEXTTOP.G_CURREDITOR._config.tableNoActionClass;if(0<c.length)""!=f&&(e=GetParentbyTagName(c[0],"table"),e=checkContainClass(e,f)),1==c.length?DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell",e):DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell",e);else{c=GetTDTHCell(b.startContainer);try{d.toString()||(d=null)}catch(g){d=null}var h=GetParentbyTagName(d,"div");if(h&&"DEXT_fiVe_Page_Break"==h.className&&b.startContainer==b.endContainer)a.sel.removeAllRanges(),b.selectNode(h),a.sel.addRange(b),
DEXTTOP.G_CURREDITOR._iconEnable("focusPageBreak");else if("table"==m)""!=f&&(e=checkContainClass(d,f)),DEXTTOP.G_CURREDITOR._iconEnable("focusTable",e);else if(b&&0<b.toString().length){var n;"body"==m&&1==b.startContainer.nodeType&&(n=getSelectionTable(DEXTTOP.G_CURREDITOR));n?(""!=f&&(e=checkContainClass(n,f)),DEXTTOP.G_CURREDITOR._iconEnable("focusTable",e)):c?DEXTTOP.G_CURREDITOR._iconEnable("cellSelectText"):DEXTTOP.G_CURREDITOR._iconEnable("selectArea")}else if(n=getSelectionTable(DEXTTOP.G_CURREDITOR))""!=
f&&(e=checkContainClass(n,f)),DEXTTOP.G_CURREDITOR._iconEnable("focusTable",e);else if(a=GetTDTHCell(d),"img"==m)DEXTTOP.G_SELECTED_ELEMENT=d,GetParentbyTagName(d,"figure")?DEXTTOP.G_CURREDITOR._iconEnable("focusFigure"):d.getAttribute("raon_chart")?DEXTTOP.G_CURREDITOR._iconEnable("focusChart"):DEXTTOP.G_CURREDITOR._iconEnable("focusImage");else if(a){if("1"!=DEXTTOP.G_CURREDITOR._config.formMode||"input"!=m&&"textarea"!=m&&"select"!=m)""!=f&&(e=GetParentbyTagName(a,"table"),e=checkContainClass(e,
f)),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",e),DEXTTOP.G_SELECTED_ELEMENT=a}else"a"!=m&&"table"!=m&&("embed"==m?DEXTTOP.G_CURREDITOR._iconEnable("focusEmbed"):"span"==m&&d&&"raon_placeholder"==d.className?DEXTTOP.G_CURREDITOR._iconEnable("placeholder"):DEXTTOP.G_CURREDITOR._iconEnable("default"))}}};0==DEXTTOP.G_CURREDITOR._config.editorBodyEditable?(f=d,DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&(f=getFirstRange().range.startContainer,3==f.nodeType&&(f=f.parentNode)),0==
f.isContentEditable?DEXTTOP.G_CURREDITOR._iconEnable("editableFalse"):setTimeout(function(a){t(a)},10)):setTimeout(function(a){t(a)},10)}catch(q){}}}function _iframeBody_Select(a){_iframeDoc_MouseUpMenu(a)}function setGeckoCellCaretPosistion(a,b){if(0<a.childNodes.length){var c=a.childNodes[a.childNodes.length-1];c.childNodes?b?doSetCaretPosition(c.childNodes[0],1):doSetCaretPosition(c.childNodes[0],0):doSetCaretPosition(c,0)}else doSetCaretPosition(a,0)}
function setTableShortcut(a){var b="which"in a?a.which:a.keyCode,c=!1,d=getEditrFromEvent(a);if(null==d)return c;try{if(a.ctrlKey){a=null;var e=getFirstRange().range;e&&0==e.toString().length&&e.startContainer&&(a=getMyElementNode(e.startContainer));if(a){if(a=GetTDTHCell(a))switch(ActiveCurrTable=GetParentbyTagName(a,"table"),b){case 116:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_cell");c=!0;break;case 117:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_row");
c=!0;break;case 118:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_column");c=!0;break;case 119:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_all");c=!0;break;case 120:d._dextCommands(d.ID,"merge_cell");c=!0;break;case 121:d._dextCommands(d.ID,"table_same_width");c=!0;break;case 122:d._dextCommands(d.ID,"table_same_height"),c=!0}c&&_iframeDoc_MouseUpMenu(null,a)}}}catch(f){}return c}
function getElemAdjustWidthHeight(a){var b={width:0,height:0};if(a.style.width&&""!=a.style.width)if(-1<a.style.width.indexOf("%")||-1<a.style.width.indexOf("in")){var c=getClientRect(a);b.width=c.right-c.left}else b.width=parseInt(a.style.width);else a.width&&""!=a.width?b.width=parseInt(a.width):(c=getClientRect(a),b.width=c.right-c.left);if(a.style.height&&""!=a.style.height)if(c=getClientRect(a),-1<a.style.height.indexOf("%")||-1<a.style.width.indexOf("in"))b.height=c.bottom-c.top;else{b.height=
parseInt(a.style.height);try{20<c.bottom-c.top-b.height&&(b.height=c.bottom-c.top)}catch(d){}}else a.height&&""!=a.height?b.height=parseInt(a.height):(c=getClientRect(a),b.height=c.bottom-c.top);return b}
function setCopyAllObjectAtributes(a,b,c){try{for(var d=a.attributes.length,e=0;e<d;e++){var f=a.attributes[e];f.specified&&"id"!=f.name&&("style"==f.name?b.style.cssText=a.style.cssText:"class"==f.name?b.className=f.value:b.setAttribute(f.name,f.value))}1==c&&(b.innerHTML=a.innerHTML)}catch(g){}}
function setCopyAllObjectAtributesForInput(a,b,c){try{for(var d=a.attributes.length,e=0;e<d;e++){var f=a.attributes[e];f.specified&&"type"!=name&&("style"==f.name?b.style.cssText=a.style.cssText:"type"!=f.name&&("class"==f.name?b.className=f.value:b.setAttribute(f.name,f.value)))}1==c&&(b.innerHTML=a.innerHTML)}catch(g){}}
function getTopVerticalCells(a){var b=GetParentbyTagName(a,"table");if(GetParentbyTagName(a,"tr")){var c=[];a=getClientRect(a);for(var d=0;d<b.rows.length;d++)for(var e=b.rows[d],f=0;f<e.cells.length;f++){var g=e.cells[f],h=getClientRect(g);a.top>h.top&&(a.left==h.left?c.push(g):(a.top>=h.bottom||a.bottom<=h.top)&&.1<h.right-a.left&&.1<a.left-h.left&&c.push(g))}return c}}
function getLeftHorizontalCells(a){var b=GetParentbyTagName(a,"table");if(GetParentbyTagName(a,"tr")){var c=[],d=[];a=getClientRect(a);for(var e=0;e<b.rows.length;e++)for(var f=b.rows[e],g=0;g<f.cells.length;g++){var h=f.cells[g],n=getClientRect(h);if(a.left>n.left&&(a.top==n.top||n.top<a.top&&n.bottom>a.top)){var m={};m.left=n.left;m.cell=h;d.push(m)}}d.sort(function(a,b){return a.left-b.left});for(e=0;e<d.length;e++)c.push(d[e].cell);return c}}
function getHorizontalCells(a,b){var c=[],d=GetParentbyTagName(a,"table"),e=GetParentbyTagName(a,"tr");if(b)for(var f=0;f<d.rows.length;f++)for(var g=d.rows[f],h=0;h<g.cells.length;h++){var n=g.cells[h];e.rowIndex==g.rowIndex?c.push(n):1<n.rowSpan?e.rowIndex>g.rowIndex&&e.rowIndex<g.rowIndex+n.rowSpan?c.push(n):1<a.rowSpan&&(e.rowIndex>g.rowIndex&&e.rowIndex<g.rowIndex+n.rowSpan?c.push(n):e.rowIndex<g.rowIndex&&e.rowIndex+a.rowSpan>g.rowIndex&&c.push(n)):1<a.rowSpan&&e.rowIndex<g.rowIndex&&e.rowIndex+
a.rowSpan>g.rowIndex&&c.push(n)}else c=e.cells;return c}
function getCellSize(a){var b={height:0};if(a){var c=getClientRect(a),c=Math.round(c.bottom-c.top);if(parseIntOr0(a.style.height)>=c)return b.height=parseIntOr0(a.style.height),b;var d=parseIntOr0(a.style.paddingTop)+parseIntOr0(a.style.paddingBottom),e=0,f=GetParentbyTagName(a,"table"),g="collapse"==f.style.borderCollapse,h=getCellNearLeftTop(a,!0),n=function(a,b){var c=a.parentElement,d=b.parentElement;return c.rowIndex==d.rowIndex?0:c.rowIndex>d.rowIndex?1:-1},m=function(a,b){var c=a.parentElement,
d=b.parentElement;if(1<a.rowSpan)return 1<b.rowSpan?c.rowIndex+a.rowSpan==d.rowIndex+b.rowSpan?0:c.rowIndex+a.rowSpan>d.rowIndex+b.rowSpan?1:-1:c.rowIndex+a.rowSpan==d.rowIndex+1?0:c.rowIndex+a.rowSpan>d.rowIndex+1?1:-1;if(1<b.rowSpan)return c.rowIndex+1==d.rowIndex+b.rowSpan?0:c.rowIndex+1>d.rowIndex+b.rowSpan?1:-1;if(c.rowIndex==d.rowIndex)return 0;if(c.rowIndex>d.rowIndex)return 1;if(c.rowIndex>d.rowIndex)return-1},p=0;if(h.arrTop[0]){if(g)for(var t=h.arrTop[0],q=getHorizontalCells(t,!0),u=0;u<
q.length;u++)if(0===m(t,q[u]))var v=parseIntOr0(q[u].style.borderBottomWidth),p=p>v?p:v;q=getHorizontalCells(a);u=0}else{g&&(p=parseIntOr0(f.style.borderTopWidth));var q=getHorizontalCells(a),u=0}for(;u<q.length;u++)t=parseIntOr0(q[u].style.borderTopWidth),p=p>t?p:t;t=0;if(h.arrBottom[0]){q=getHorizontalCells(a,!0);for(u=0;u<q.length;u++)0===m(a,q[u])&&(v=parseIntOr0(q[u].style.borderBottomWidth),t=t>v?t:v);if(g)for(h=getHorizontalCells(h.arrBottom[0]),u=0;u<h.length;u++)q=parseIntOr0(h[u].style.borderTopWidth),
t=t>q?t:q}else for(g&&(t=parseIntOr0(f.style.borderBottomWidth)),q=getHorizontalCells(a,!0),u=0;u<q.length;u++)0===m(a,q[u])&&(v=parseIntOr0(q[u].style.borderBottomWidth),t=t>v?t:v);q=h=0;if(1<parseIntOr0(a.rowSpan)){for(var v={},w={},y=getHorizontalCells(a,!0),u=0;u<y.length;u++){var x=y[u].parentElement.rowIndex;if(-1===n(a,y[u])){var z=parseIntOr0(y[u].style.borderTopWidth),A=parseIntOr0(y[u].style.paddingTop),B="posTop"+x;v[B]?(v[B]=v[B]>z?v[B]:z,w[B]=w[B]>A?w[B]:A):(v[B]=z,w[B]=A)}1===m(a,y[u])&&
(z=parseIntOr0(y[u].style.borderBottomWidth),A=parseIntOr0(y[u].style.paddingBottom),B="pos"+(g?"Top"+(x+1):"Bottom"+x),v[B]?(v[B]=v[B]>z?v[B]:z,w[B]=w[B]>A?w[B]:A):(v[B]=z,w[B]=A))}for(B in v)h+=v[B],q+=w[B];g||(q+=parseIntOr0(f.style.borderSpacing))}g&&(p=Math.ceil(p/2),t=Math.floor(t/2));e=e+p+t;e+=h;b.height=c-e-(d+q)}return b}
function command_AddTableLeftAndRight(a,b,c){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();var d=-1;a=-1;for(var e=b.currTableNode.rows.length,f=0;f<e;f++){for(var g=b.currTableNode.rows[f].cells.length,h=0;h<g;h++)if(b.currTableNode.rows[f].cells[h]==b.currCellNode){d=f;a=h;break}if(-1<d)break}if(-1<d&&-1<a){"right"==c&&(a+=1);c=0;d=[];for(f=0;f<b.tableNode.rows.length;f++)d.push(b.tableNode.rows[f].cells);for(f=d.length-1;0<=f;f--)for(g=d[f].length,h=g-1;0<=h;h--)0==f&&(c+=
DEXTTOP.DEXT5.util.parseIntOr0(d[f][0].style.width)),g=b.currTableNode.rows[f],g.insertBefore(d[f][h],g.cells[a]);a=b.currTableNode.style.width;-1<a.indexOf("px")&&(a=DEXTTOP.DEXT5.util.parseIntOr0(a),b.currTableNode.style.width=a+c+"px");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}
function command_AddTableUpAndDown(a,b,c){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();a=-1;for(var d=b.currTableNode.rows.length,e=0;e<d;e++){for(var f=b.currTableNode.rows[e].cells.length,g=0;g<f;g++)if(b.currTableNode.rows[e].cells[g]==b.currCellNode){a=e;break}if(-1<a)break}if(-1<a){"down"==c&&(a+=1);d=b.tableNode.getElementsByTagName("tr");if("down"==c&&0==!!b.currTableNode.rows[a])for(;0<d.length;)b.currTableNode.rows[a-1].parentNode.appendChild(d[0]);else for(;0<d.length;)b.currTableNode.rows[a].parentNode.insertBefore(d[d.length-
1],b.currTableNode.rows[a]);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}};function setTopMenu(a,b,c,d,e){DEXTTOP.G_CURREDITOR=b;DEXT5_TOPMENU.show(a,b.ID,c,d,e)}function hideTopMenu(){DEXT5_TOPMENU.hide()}function hideTopMenuAndFocus(){DEXT5_TOPMENU.hide_focus()}
var DEXT5_TOPMENU={_topmenu_id:"",_topmenu_iframe:null,_topmenu_zIndex:0,_topmenu_bg_zIndex:0,_topmenu_document:null,_topmenu_main:null,_topmenu_sub:null,_topmenu_bg:null,_topmenu_bg_id:"",_width:"",_height:"0",_item_sub_list:{entity:["insert_link_media","iframe_create","flash_create","media_create","video"],align:["align_left","align_center","align_right","align_full"],insert_row:["insert_row_up","insert_row_down"],insert_column:["insert_column_left","insert_column_right"],table_select:["table_select_cell",
"table_select_row","table_select_column","table_select_all"],cell_size:["table_same_width","table_same_height","table_same_widthheight"],align_vertical:["valign_up","valign_center","valign_baseline","valign_bottom"],table_tool:["table_adjust","convert_table_to_text"],list_number:"list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman".split(" "),list_bullets:["list_disc","list_circle","list_square"]},_non_image_item:" design source preview text entity align insert_row insert_column table_select cell_size align_vertical table_tool list_number list_bullets".split(" "),
_disabeld_menu:[],_create:function(a){if(a&&""!=a){var b=DEXTTOP.DEXT5.util._setDEXT5editor(a);b&&(DEXTTOP.G_CURREDITOR=b)}(a=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_iframe"+a))&&a.parentNode.removeChild(a);this._topmenu_id="dext_topmenu_iframe"+DEXTTOP.G_CURREDITOR._config.editor_id;this._topmenu_bg_id="dext_topmenu_background"+DEXTTOP.G_CURREDITOR._config.editor_id;this._topmenu_zIndex=G_MAIN_ZINDEX+2E3;this._topmenu_bg_zIndex=G_MAIN_ZINDEX+1E3;if(a=DEXTTOP.DEXTDOC.getElementById(this._topmenu_id))_topmenu_document=
a.contentWindow.document,this._topmenu_iframe=a,this._topmenu_document=_topmenu_document,this._topmenu_main=_topmenu_document.getElementById("div_topmenu_main"),this._topmenu_sub=_topmenu_document.getElementById("div_topmenu_sub");else{try{a=DEXTTOP.DEXTDOC.createElement("<iframe>")}catch(c){a=DEXTTOP.DEXTDOC.createElement("iframe")}DEXTTOP.DEXTDOC.body.appendChild(a);a.id=this._topmenu_id;a.title="DEXT5Editor Topmenu "+DEXTTOP.G_CURREDITOR._config.editor_id;a.style.margin="0px";a.style.padding="0px";
a.style.zIndex=this._topmenu_zIndex;a.style.position="absolute";a.scrolling="no";a.style.overflow="auto";a.style.overflowX="hidden";a.style.display="none";a.allowTransparency="true";a.frameBorder="0";b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";a.src=b;var b="",b=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,
d="editor_context.css";"3.5.1125677.1800.01"<DEXTTOP.DEXT5.ReleaseVer&&"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(d="editor_context_"+DEXTTOP.G_CURREDITOR._config.lang+".css");var e=DEXTTOP.G_CURREDITOR._config.lang;-1<e.indexOf("-")&&(e=e.split("-")[0]);e=""+('<html lang="'+e+'" xml:lang="'+e+'"><head>')+("<title>DEXT5Editor Topmenu "+DEXTTOP.G_CURREDITOR._config.editor_id+"</title>");isCustomDomain(document)&&(e+='<script>document.domain = "'+document.domain+'";\x3c/script></head>');e+='<link rel="stylesheet" type="text/css" href="'+
b+d+"?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';e+='<link rel="stylesheet" type="text/css" href="'+b+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';e+='</head><body scroll="no" style="overflow-x:hidden; overflow-y:hidden; margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';e+='<div onselectstart="return false;" style="width:100%; height:100%" id="topmenu_iframe_bg">';e+='<div class="DEXT_fiVe_ED_popup">';
e+='<div class="DEXT_fiVe_EDP">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';e+='<dl id="div_topmenu_main"></dl>';e+="</div>";e+="</div>";e+='<div class="DEXT_fiVe_EDP_s" id="topmenu_sub" style="display:none; position:relative;">';e+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';e+='<dl id="div_topmenu_sub"></dl>';e+="</div>";e+="</div>";e+="</div>";e+="</div>";e+="</body></html>";_topmenu_document=a.contentWindow.document;
_topmenu_document.open("text/html","replace");_topmenu_document.write(e);_topmenu_document.close();this._topmenu_iframe=a;this._topmenu_document=_topmenu_document;this._topmenu_main=_topmenu_document.getElementById("div_topmenu_main");this._topmenu_sub=_topmenu_document.getElementById("div_topmenu_sub");var f=this;a=function(){return function(a){f._topmenu_bg.style.display=""}}();DEXTTOP.DEXT5.util.addEvent(this._topmenu_main,"mousemove",a);DEXTTOP.DEXT5.util.addEvent(_topmenu_document,"dragover",
function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1});DEXTTOP.DEXT5.util.addEvent(_topmenu_document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1})}this._topmenu_main.innerHTML="";this._topmenu_sub.innerHTML=""},_setMenu:function(a){var b=[];switch(a){case "m_file":b="new file_open  template layout  save save_as load_auto_save  print pagebreak".split(" ");this._height="230px";-1<DEXTTOP.G_CURREDITOR.remove_item.indexOf("save_as")&&(this._height="200px");this._width="200px";break;
case "m_edit":b="undo redo  copy cut paste  select_all  find replace".split(" ");this._height="230px";this._width="200px";break;case "m_view":b="grid ruler full_screen  design source preview text".split(" ");if(DEXTTOP.DEXT5.browser.LocalStorageSupported){var c=DEXTTOP.DEXT5.util.loadJsonFromLocalStorage("dext_"+DEXTTOP.G_CURREDITOR.ID+"_ruler");"1"==DEXTTOP.G_CURREDITOR._config.usePersonalSetting&&0==(!c||c&&"1"==c.use)&&(c=b.indexOf("ruler"),-1<c&&b.splice(c,c))}this._height="190px";this._width=
"200px";break;case "m_insert":b="doc_bg_image image_create entity  insert_file hyperlink_create bookmark  horizontal_line symbol emoticon".split(" ");this._height="250px";this._width="400px";break;case "m_form":b="bold italic underline strike_through superscript subscript  remove_format remove_css  list_number list_bullets  indent outdent  align".split(" ");this._height="420px";this._width="400px";break;case "m_table":b="table_selection  detail_table_insert table_delete  insert_row_column insert_row insert_column  delete_row delete_column  insert_table_top_paragraph insert_table_bottom_paragraph  merge_cell split_cell table_row_clone  table_select cell_size align_vertical  row_property column_property table_tool table_property cell_property".split(" ");
this._height="513px";this._width="400px";break;case "m_tool":b=["tool_replace","","setting"];this._height="60px";this._width="200px";break;case "m_help":b=["shortcut","","help","","about"];this._height="80px";this._width="200px";break;default:this._height=this._width="1px"}"m_file"==a&&("2"==DEXTTOP.G_CURREDITOR._setting.auto_save.toString().split(",")[0]||void 0==getAutoSaveHtml_userID(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config.setAutoSave.unique_key)||""==getAutoSaveHtml_userID(DEXTTOP.G_CURREDITOR.ID,
DEXTTOP.G_CURREDITOR._config.setAutoSave.unique_key)?this._disabeld_menu.push("load_auto_save"):-1<this._disabeld_menu.indexOf("load_auto_save")&&(this._disabeld_menu=this._disabeld_menu.slice(this._disabeld_menu.indexOf("load_auto_save"),1)));for(a=0;a<b.length;a++)0==a&&(c=this._topmenu_document.createElement("dt"),c.innerHTML="top_main_menu",this._topmenu_main.appendChild(c)),this._addItem(b[a]);this._disableItem(this._disabeld_menu)},_disableItem:function(a){for(var b=0;b<a.length;b++){var c=
this._topmenu_document.getElementById("topmenu_"+a[b]);c&&(c.className="item_disabled")}},_addItem:function(a){for(r=0;r<DEXTTOP.G_CURREDITOR.remove_item.length;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==a)return;var b=this._topmenu_document.createElement("dd"),c=this,d=this._getImageIconUrl(a),e=this._getText(a),f=this._item_sub_list[a];if(""==e)b.className="b_border";else{var g=this._topmenu_document.createElement("div"),h=this._topmenu_document.createElement("div"),n=this._topmenu_document.createElement("div"),
m=this._topmenu_document.createElement("span");0<d.length&&(m.className=a,g.appendChild(m));"textContent"in h?h.textContent=e:h.innerText=e;g.className="s_left";h.className="s_right";var p=this._topmenu_document.createElement("a");p.href="javascript:void(0);";p.title=e;p.style.textDecoration="none";p.style.color="#545454";p.style.cursor="pointer";p.appendChild(g);p.appendChild(h);b.appendChild(p);if(f)n.className="arrow",p.appendChild(n),e=function(a){return function(b){if("item_disabled"!=a.className){c._topmenu_sub.innerHTML=
"";for(var d=0;d<f.length;d++){if(0==d){var e=c._topmenu_document.createElement("dt");e.innerHTML="top_sub_menu";c._topmenu_sub.appendChild(e)}c._addSubItem(f[d])}d=b.target?b.target:b.srcElement;e=getClientRect(d);0==e.top&&(e=getClientRect(d));c._topmenu_document.getElementById("topmenu_sub").style.display="";c._topmenu_document.getElementById("topmenu_sub").style.top=e.top-0+"px";a.className="on_mouseover";DEXTTOP.DEXT5.util.stopEvent(b)}}}(b),d=function(a){return function(b){"on_mouseover"==a.className&&
(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),DEXTTOP.DEXT5.util.addEvent(b,"mouseover",e),DEXTTOP.DEXT5.util.addEvent(b,"mouseout",d),e=function(a,b){return function(d){if("item_disabled"!=a.className){c._topmenu_sub.innerHTML="";for(var e=0;e<f.length;e++)c._addSubItem(f[e],b);var e=d.target?d.target:d.srcElement,g=getClientRect(e);0==g.top&&(g=getClientRect(e));c._topmenu_document.getElementById("topmenu_sub").style.display="";c._topmenu_document.getElementById("topmenu_sub").style.top=
g.top-0+"px";a.className="on_mouseover";DEXTTOP.DEXT5.util.stopEvent(d);d=function(a){return function(a){if(39==("which"in a?a.which:a.keyCode)){var b=c._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A").length,d=c._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A")[0],b=c._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A")[b-1];d.focus();setFocusFirstAndLast(_topmenu_document,d,b);DEXTTOP.DEXT5.util.stopEvent(a)}}}(b);DEXTTOP.DEXT5.util.addEvent(b,
"keyup",d)}}}(b,p),DEXTTOP.DEXT5.util.addEvent(p,"focus",e),DEXTTOP.DEXT5.util.addEvent(p,"blur",d);else{var e=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(p,"focus",t);DEXTTOP.DEXT5.util.removeEvent(p,"blur",q);c._topmenu_document.getElementById("topmenu_sub").style.display="none";"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),d=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(p,"focus",t);DEXTTOP.DEXT5.util.addEvent(p,"blur",
q);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),t=function(a){return function(b){c._topmenu_document.getElementById("topmenu_sub").style.display="none";"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),q=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),c=this,g=function(b){return function(d){"on_mouseover"==b.className&&(_dext_editor._dextCommands(_dext_editor.ID,
a,c),c.hide_focus(),DEXTTOP.DEXT5.util.stopEvent(d))}}(b);DEXTTOP.DEXT5.util.addEvent(b,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(b,"mouseout",d);DEXTTOP.DEXT5.util.addEvent(b,"click",g);DEXTTOP.DEXT5.util.addEvent(p,"focus",t);DEXTTOP.DEXT5.util.addEvent(p,"blur",q)}}0<a.length&&(b.id="topmenu_"+a);b.unselectable="on";this._topmenu_main.appendChild(b)},_addSubItem:function(a,b){for(r=0;r<DEXTTOP.G_CURREDITOR.remove_item.length;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==a)return;var c=this._topmenu_document.createElement("dd"),
d=this,e=this._getImageIconUrl(a),f=this._getText(a);if(""==f)c.className="b_border";else{var g=this._topmenu_document.createElement("div"),h=this._topmenu_document.createElement("div"),n=this._topmenu_document.createElement("span"),m=this._topmenu_document.createElement("a");m.href="javascript:void(0);";m.title=f;m.style.textDecoration="none";m.style.color="#545454";m.style.cursor="pointer";m.appendChild(g);m.appendChild(h);0<e.length&&(n.className=a,g.appendChild(n));"textContent"in h?h.textContent=
f:h.innerText=f;g.className="s_left";h.className="s_right";c.appendChild(m);var e=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(m,"focus",p);DEXTTOP.DEXT5.util.removeEvent(m,"blur",t);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),f=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(m,"focus",p);DEXTTOP.DEXT5.util.removeEvent(m,"blur",t);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),p=
function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),t=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),d=this,g=function(b){return function(c){"on_mouseover"==b.className&&(_dext_editor._dextCommands(_dext_editor.ID,a),d.hide_focus())}}(c);DEXTTOP.DEXT5.util.addEvent(c,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(c,"mouseout",f);DEXTTOP.DEXT5.util.addEvent(c,"click",
g);DEXTTOP.DEXT5.util.addEvent(m,"focus",p);DEXTTOP.DEXT5.util.addEvent(m,"blur",t);e=function(a){return function(a){37==("which"in a?a.which:a.keyCode)&&(b.focus(),DEXTTOP.DEXT5.util.stopEvent(a))}}(m);DEXTTOP.DEXT5.util.addEvent(m,"keyup",e);0<a.length&&(c.id="topmenu_"+a);c.unselectable="on";this._topmenu_sub.appendChild(c)}},_getImageIconUrl:function(a){for(var b=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif",c=0;c<this._non_image_item.length;c++)if(a==
this._non_image_item[c]){b="";break}return b},_getText:function(a){var b="";""!=a&&(b=dext5_lang.topmenu[a]);return b},show:function(a,b,c,d,e){null==this._topmenu_iframe&&this._create();this._topmenu_main.innerHTML="";this._topmenu_sub.innerHTML="";this._setMenu(c);this._topmenu_iframe.style.width=this._width;this._topmenu_iframe.style.height=this._height;a=a?a:window.event;Math.round(a.clientX);Math.round(a.clientY);c={};c=getWindowScrollPos(DEXTTOP.DEXTWIN);d=getClientRect(_iframeWin.parent.frameElement);
getClientRect(_iframeWin.frameElement);a=getClientRect(a.target?a.target:a.srcElement);this._topmenu_iframe.style.left=a.left+c[0]+d.left+"px";this._topmenu_iframe.style.top=a.top+c[1]+d.top+19+"px";this._makeBackground(b,e);this._topmenu_iframe.style.display="";var f=this._topmenu_iframe.contentWindow;b=getIframeDocument(this._topmenu_iframe);0==DEXTTOP.DEXT5.browser.ie&&f.focus();b.body.focus();try{b.getElementsByTagName("A")[0].focus()}catch(g){}b.onkeyup=function(a){var b=0;a=a||f.event;b="which"in
a?a.which:a.keyCode;27==b&&(hideTopMenu(),setTimeout(function(){setFocusToBody()},1))};setFocusFirstAndLast(b,b.getElementsByTagName("A")[0])},hide:function(a,b){_dext_editor._top_menu_click_flag=!1;_dext_editor._top_menu_click_id="";var c=DEXTTOP.DEXT5.util.xml.count(b,"menu");if(0<c)for(var d=0;d<c;d++){var e=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(b,"menu",d),e=DEXTTOP.DEXT5.util.trim(e).toLowerCase();_iframeWin.parent.document.getElementById("ue_"+a+e).childNodes[0].className=""}this._topmenu_document&&
this._topmenu_document.getElementById("topmenu_sub")&&(this._topmenu_document.getElementById("topmenu_sub").style.display="none");this._topmenu_iframe&&(this._topmenu_iframe.style.display="none");this._topmenu_bg&&(this._topmenu_bg.style.display="none")},hide_focus:function(a,b){_dext_editor._top_menu_click_flag=!1;_dext_editor._top_menu_click_id="";var c=DEXTTOP.DEXT5.util.xml.count(b,"menu");if(0<c)for(var d=0;d<c;d++){var e=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(b,"menu",d),e=DEXTTOP.DEXT5.util.trim(e).toLowerCase();
_iframeWin.parent.document.getElementById("ue_"+a+e).childNodes[0].className=""}this._topmenu_document&&this._topmenu_document.getElementById("topmenu_sub")&&(this._topmenu_document.getElementById("topmenu_sub").style.display="none");this._topmenu_iframe&&(this._topmenu_iframe.style.display="none");this._topmenu_bg&&(this._topmenu_bg.style.display="none");dialogCancel()},_makeBackground:function(a,b){var c=this;if(this._topmenu_bg=DEXTTOP.DEXTDOC.getElementById(c._topmenu_bg_id))DEXTTOP.DEXTDOC.body.removeChild(this._topmenu_bg),
this._topmenu_bg=null;if(!this._topmenu_bg){this._topmenu_bg=DEXTTOP.DEXTDOC.createElement("div");this._topmenu_bg.style.display="none";this._topmenu_bg.id=this._topmenu_bg_id;this._topmenu_bg.style.overflow="visible";this._topmenu_bg.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0; -khtml-opacity: 0.0; background-color:#000000; z-index:'+this._topmenu_bg_zIndex+'; position:absolute; left:0px; top:0px;overflow:hidden; "></div>';var d="CSS1Compat"==
DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight;this._topmenu_bg.firstChild.style.width=("CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth)-10+"px";this._topmenu_bg.firstChild.style.height=d-10+"px";DEXTTOP.DEXTDOC.body.appendChild(this._topmenu_bg);d=function(){return function(d){c.hide_focus(a,b)}}();DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"click",d);DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,
"contextmenu",d);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",DEXTTOP.G_CURREDITOR.topmenu_bg_resize);DEXTTOP.DEXT5.util.addEvent(this._topmenu_document.getElementById("topmenu_iframe_bg"),"click",d);DEXTTOP.DEXT5.util.addEvent(this._topmenu_document.getElementById("topmenu_iframe_bg"),"contextmenu",d);this._topmenu_bg.style.display="none";DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"mousemove",function(d){var f=DEXTTOP.DEXT5.util.xml.count(b,"menu");if(0<f)for(var g=0;g<f;g++){var h=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(b,
"menu",g),h=DEXTTOP.DEXT5.util.trim(h).toLowerCase(),h=_iframeWin.parent.document.getElementById("ue_"+a+h).getBoundingClientRect(),n=getClientRect(_iframeWin.parent.frameElement);point_in_rectagnle(d.clientX,d.clientY,n.left+h.left,n.top+h.top,n.left+h.right,n.top+h.bottom)&&(c._topmenu_bg.style.display="none")}})}}};function between(a,b,c){result=!1;a<c&&b>a&&b<c&&(result=!0);a>c&&b>c&&b<a&&(result=!0);if(b==a||b==c)result=!0;return result}
function point_in_rectagnle(a,b,c,d,e,f){result=!1;between(c,a,e)&&between(d,b,f)&&(result=!0);return result};var ImageHTML=function(a,b){this.htmlSource=a;this.range=b},UndoManager=function(){this.arrImageHTML=[];this.limitCount=50;this.currentImage=null;this.index=-1;this.canRedo=this.canUndo=!1;this.charCount=0};
UndoManager.prototype={reset:function(){this.arrImageHTML=[];this.limitCount=50;this.currentImage=null;this.index=-1;this.canRedo=this.canUndo=!1;this.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("");DEXTTOP.G_CURREDITOR.isInitKeydownForSetApi=!0},putUndo:function(){try{var a=getFirstRange().range,b=null;a&&a.startContainer&&(b=getMyElementNode(a.startContainer));a={};b&&(a.id=b.id,a.undoId="_dext",b.id=a.id+a.undoId);var c=_iframeDoc.body.innerHTML,c=dummyTagClassClear(c);if(b)if(""==a.id)try{b.removeAttribute("id")}catch(d){}else b.id=
a.id;var e="BackCompat"==_iframeDoc.compatMode;DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&11>DEXTTOP.DEXT5.browser.ieVersion&&1!=e&&(c=DEXTTOP.DEXT5.util.nbspRemove(c));c=ReplaceAll(c,unescape("%uFEFF"),"");c=ReplaceAll(c,unescape("%u200B"),"");if(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion||e)try{var f=c.match(RegExp("<td *([^>?+])*>","gi"));if(f){for(var g=f.length,b=0;b<g;b++){var h=f[b],n=/cellOrgBgColor=>/.exec(h);if(null!=n)var m=n[0].replace(RegExp("cellOrgBgColor=>",
"g"),">"),h=h.replace(n,m),c=c.replace(f[b],h)}for(b=0;b<g;b++)if(h=f[b],n=/cellOrgBgColor= /.exec(h))m=n[0].replace(RegExp("cellOrgBgColor= ","g"),""),h=h.replace(n,m),c=c.replace(f[b],h)}}catch(p){}if(!this.currentImage||this.currentImage.htmlSource!=c){for(var t=new ImageHTML(c,a),q=this.index+1;q<this.arrImageHTML.length;q++)this.arrImageHTML.pop();this.arrImageHTML.length==this.limitCount&&this.arrImageHTML.shift();this.index=this.arrImageHTML.push(t)-1;this.currentImage=t;this.canUndo=0<this.arrImageHTML.length?
!0:!1;this.index==this.arrImageHTML.length-1&&(this.canRedo=!1);this.charCount=0}}catch(u){}},execUndo:function(){try{if(0==this.canUndo)DEXTTOP.G_CURREDITOR._iconEnable("");else if(--this.index,-1==this.index)this.canRedo=this.canUndo=!1,DEXTTOP.G_CURREDITOR._iconEnable("");else{var a=this.arrImageHTML[this.index].htmlSource;if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion){for(var b="span strong em strike sup sub b i".split(" "),c=b.length,d=0;d<c;d++)var e="(<"+b[d]+"[^>]*>)(?:\\s|  | |)(</"+
b[d]+">)",f=new RegExp(e,"gim"),a=a.replace(f,"$1"+unescape("%u200B")+"</"+b[d]+">");e="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>";f=new RegExp(e,"gim");a=a.replace(f,"$1</span>")}b="";b=DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?unescape("%u200B"):unescape("%uFEFF");f=RegExp("<a ([^>]+)></a>","gi");a=a.replace(f,"<a $1>"+b+"</a>");if(!this.currentImage||this.currentImage.htmlSource!=a){_iframeDoc.body.innerHTML=a;var g=this.arrImageHTML[this.index].range,
h=_iframeDoc.getElementById(g.id+g.undoId);if(h){h.id==g.undoId?removeAttribute(h,"id"):h.id=g.id;var n=getFirstRange();try{(h.nodeType=h.lastChild&&h.lastChild.tagName&&"br"==h.lastChild.tagName.toLowerCase())?doSetCaretPosition(h,0):(rangy.getSelection(_iframeWin).removeAllRanges(),n.range.selectNodeContents(h),n.range.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(n.range)),setMenuIconRealable(h)}catch(m){try{var p=_iframeDoc.body.childNodes,t=p.length;0<t&&(doSetCaretPosition(p[t-
1],0),setMenuIconRealable(p[t-1]))}catch(q){}}}this.currentImage=new ImageHTML(_iframeDoc.body.innerHTML,g);this.canRedo=!0;0==this.index&&(this.canUndo=!1);this.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("");ClearDraggingTableAllTable();try{contentChangeEventWrapper()}catch(u){}}}}catch(v){}},execRedo:function(){try{if(0==this.canRedo)DEXTTOP.G_CURREDITOR._iconEnable("");else{this.index+=1;var a=this.arrImageHTML[this.index].htmlSource;if(DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion)var b=
"(<span[^>]*>)(?:\\s|  | |)(</span>)",c=new RegExp(b,"gim"),a=a.replace(c,"$1"+unescape("%u200B")+"</span>"),b="(<span[^>]*?raon_placeholder.*?>)("+unescape("%u200B")+"?)</span>",c=new RegExp(b,"gim"),a=a.replace(c,"$1</span>");b="";b=DEXTTOP.DEXT5.browser.ie&&"xp"!=DEXTTOP.DEXT5.UserAgent.os.version.toLowerCase()?unescape("%u200B"):unescape("%uFEFF");c=RegExp("<a ([^>]+)></a>","gi");a=a.replace(c,"<a $1>"+b+"</a>");if(!this.currentImage||this.currentImage.htmlSource!=a){_iframeDoc.body.innerHTML=
a;var d=this.arrImageHTML[this.index].range,e=_iframeDoc.getElementById(d.id+d.undoId);if(e){e.id==d.undoId?removeAttribute(e,"id"):e.id=d.id;var f=getFirstRange();try{rangy.getSelection(_iframeWin).removeAllRanges(),f.range.selectNodeContents(e),f.range.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(f.range),setMenuIconRealable(e)}catch(g){try{var h=_iframeDoc.body.childNodes,n=h.length;0<n&&(doSetCaretPosition(h[n-1],1),setMenuIconRealable(h[n-1]))}catch(m){}}}this.currentImage=new ImageHTML(_iframeDoc.body.innerHTML,
d);this.canUndo=!0;this.index==this.arrImageHTML.length-1&&(this.canRedo=!1);this.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("");ClearDraggingTableAllTable();try{contentChangeEventWrapper()}catch(p){}}}}catch(t){}}};resizebar_props={editor:null,editorMinTop:0,editorHegiht:0,mouseTop:0,editorMinFlag:!1,mouseClickFlag:!1,mouseClickObj:null,mouseLeftBtnFlag:!1};function DextResize(a){resizebar_props&&(resizebar_props.editor=a,resizebar_props.editorMinTop=parseInt(a._config.style.defaultMinHeight))}
DextResize.prototype.createStatusResizeBar=function(){if(resizebar_props){if(0==checkIfIncluded("editor_resize_bar.css",DEXTTOP.DEXTDOC)){var a=DEXTTOP.DEXTDOC.createElement("link");a.type="text/css";a.rel="stylesheet";a.href=DEXTTOP.DEXT5.isRelease?resizebar_props.editor._config.webPath.css+"editor_resize_bar.css?ver="+DEXTTOP.DEXT5.ReleaseVer:resizebar_props.editor._config.webPath.css_dev+"editor_resize_bar.css?ver="+DEXTTOP.DEXT5.ReleaseVer;DEXTTOP.DEXTDOC.getElementsByTagName("head")[0].appendChild(a)}a=
DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID);a.className="DEXT_frame_resizebar";var b=DEXTTOP.DEXTDOC.createElement("div");b.setAttribute("id","dext_resizebar_"+resizebar_props.editor.ID);b.className="DEXT_resizebar DEXT_resizebar_"+resizebar_props.editor._config.style.skinName;b.innerHTML='<div class="DEXT_resizebar_btn" id="dext_resizebar_btn_'+resizebar_props.editor.ID+'"><div class="DEXT_resizebar_horizon_line" id="DEXT_resizebar_horizon_line_'+resizebar_props.editor.ID+
'"></div><button type="button" id="DEXT_resizebar_button_'+resizebar_props.editor.ID+'" title="'+dext5_lang.resizebar_button.title+'"></button></div>';a.appendChild(b)}};function dextResizeMouseDownEvt(a){try{DextResize.prototype.mouseDown(a)}catch(b){}}function dextResizeMouseMoveEvt(a){try{DextResize.prototype.mouseMove(a)}catch(b){}}function dextResizeMouseUpEvt(a){try{DextResize.prototype.mouseUp(a)}catch(b){}}function dextResizeBlurEvt(a){try{DextResize.prototype.blur(a)}catch(b){}}
DextResize.prototype.mouseDown=function(a){try{if(resizebar_props)if(DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID)){a=a?a:event;var b=a.target?a.target:a.srcElement,c=this.isLeftClick(a);resizebar_props.mouseLeftBtnFlag=c;resizebar_props.mouseLeftBtnFlag&&(b&&b.id&&b.id=="dext_resizebar_"+resizebar_props.editor.ID?resizebar_props.mouseClickObj=b:b&&b.id&&b.id=="dext_resizebar_btn_"+resizebar_props.editor.ID?resizebar_props.mouseClickObj=b.parentNode:b&&b.id&&(b.id=="DEXT_resizebar_horizon_line_"+
resizebar_props.editor.ID||b.id=="DEXT_resizebar_button_"+resizebar_props.editor.ID)&&(resizebar_props.mouseClickObj=b.parentNode.parentNode));resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&(resizebar_props.editorHegiht=parseInt(DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID).style.height.replace("px","")),resizebar_props.mouseTop=a.clientY,resizebar_props.mouseClickFlag=!0)}else resizebar_props=
null}catch(d){}};
DextResize.prototype.mouseMove=function(a){try{if(resizebar_props&&(a=a?a:event,resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&resizebar_props.mouseClickFlag)){DEXTTOP.DEXTDOC.body.style.cursor="row-resize";if(!DEXTTOP.DEXTDOC.getElementById("dext_disabled")){var b=DEXTTOP.DEXTDOC.createElement("div");b.setAttribute("id","dext_disabled");b.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+(G_MAIN_ZINDEX+
1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var c="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight;b.firstChild.style.width=("CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth)+"px";b.firstChild.style.height=c+"px";DEXTTOP.DEXTDOC.body.appendChild(b)}var b=0,d=a.clientY,b=resizebar_props.editorHegiht+(d-resizebar_props.mouseTop),
b=Math.max(resizebar_props.editorMinTop,b);resizebar_props.editorMinFlag=b==resizebar_props.editorMinTop?!0:!1;resizebar_props.editorMinFlag||(this.setHeight(b),resizebar_props.editorHegiht=b,resizebar_props.mouseTop=d)}}catch(e){}};
DextResize.prototype.mouseUp=function(a){try{if(resizebar_props)if(a=a?a:event,DEXTTOP.DEXTDOC.body.style.cursor="",resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)){var b=0,b=resizebar_props.editorHegiht+(a.clientY-resizebar_props.mouseTop),b=Math.max(resizebar_props.editorMinTop,b);resizebar_props.editorMinFlag=b==resizebar_props.editorMinTop?!0:!1;resizebar_props.editorMinFlag||this.setHeight(b);resizebar_props.editorHegiht=
0;resizebar_props.mouseTop=0;resizebar_props.editorMinFlag=!1;resizebar_props.mouseClickFlag=!1;resizebar_props.mouseClickObj=null;resizebar_props.mouseLeftBtnFlag=!1;if(DEXTTOP.DEXTDOC.getElementById("dext_disabled")){var c=DEXTTOP.DEXTDOC.getElementById("dext_disabled");DEXTTOP.DEXTDOC.body.removeChild(c)}try{DEXTTOP.DEXTWIN.dext_editor_resized_event(DEXTTOP.G_CURREDITOR.Frame)}catch(d){}}else resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&
(resizebar_props.editorHegiht=0,resizebar_props.mouseTop=0,resizebar_props.editorMinFlag=!1,resizebar_props.mouseClickFlag=!1,resizebar_props.mouseClickObj=null,resizebar_props.mouseLeftBtnFlag=!1,DEXTTOP.DEXTDOC.getElementById("dext_disabled")&&(c=DEXTTOP.DEXTDOC.getElementById("dext_disabled"),DEXTTOP.DEXTDOC.body.removeChild(c)))}catch(e){}};
DextResize.prototype.wheel=function(a){try{if(resizebar_props&&(a=a?a:event,resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)))return a.returnValue=!1,a.preventDefault&&a.preventDefault(),!1}catch(b){}};
DextResize.prototype.blur=function(a){try{if(resizebar_props&&resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&DEXTTOP.DEXTDOC.getElementById("dext_disabled")){var b=DEXTTOP.DEXTDOC.getElementById("dext_disabled");DEXTTOP.DEXTDOC.body.removeChild(b)}}catch(c){}};
DextResize.prototype.setHeight=function(a){var b=resizebar_props.editor.ID,c=DEXTTOP.DEXT5.util._setDEXT5editor(b);if(void 0==b||""==b)b=c.ID;var d=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+b),b=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+b).contentWindow.document.getElementById("ue_editor_holder_"+b),e=0,e=c.baseMenuToolbarHeight;isViewMode(c)?c._defaultHeight=parseInt(a,10)-4:c._defaultHeight=parseInt(a,10)-e;-1<a.toString().indexOf("%")||-1<a.toString().indexOf("px")?d.style.height=a:
d.style.height=a+"px";b.style.height=c._defaultHeight+"px";c._config.style.height=a+"px";"1"==resizebar_props.editor._config.ruler.view&&"design"==resizebar_props.editor._currentMode&&c._FRAMEWIN.showRuler(resizebar_props.editor)};DextResize.prototype.isLeftClick=function(a){var b=!1;a=a||window.event;a.which||void 0===a.button||(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);switch(a.which){case 1:b=!0;break;case 2:b=!1;break;case 3:b=!1;break;case 0:0==a.button&&(b=!1)}return b};
DextResize.prototype.apply=function(a){try{resizebar_props&&(DextResizeObj=this,DEXTTOP.DEXT5.util.addEvent(a,"mousedown",dextResizeMouseDownEvt,!0),DEXTTOP.DEXT5.util.addEvent(a,"mousemove",dextResizeMouseMoveEvt,!0),DEXTTOP.DEXT5.util.addEvent(a,"mouseup",dextResizeMouseUpEvt,!0),a.addEventListener&&(domMouseScrollEvent=function(a){DextResizeObj.wheel(a)},a.addEventListener("DOMMouseScroll",domMouseScrollEvent,!1),DEXTTOP.DEXT5.DEXTMULTIPLEEVENT[DEXTTOP.G_CURREDITOR.ID].push({element:a,event:"DOMMouseScroll",
func:domMouseScrollEvent})),DEXTTOP.DEXT5.util.addEvent(a,"blur",dextResizeBlurEvt,!0))}catch(b){}};DextResize.prototype.remove=function(a){try{DEXTTOP.DEXT5.util.removeEvent(a,"mousedown",dextResizeMouseDownEvt,!0),DEXTTOP.DEXT5.util.removeEvent(a,"mousemove",dextResizeMouseMoveEvt,!0),DEXTTOP.DEXT5.util.removeEvent(a,"mouseup",dextResizeMouseUpEvt,!0),DEXTTOP.DEXT5.util.removeEvent(a,"blur",dextResizeBlurEvt,!0)}catch(b){}};(function(){function a(a){var b={};a=a.split(",");for(var c=0;c<a.length;c++)b[a[c]]=!0;return b}var b=a("p,ul,ol,li,a,img,i,b,u,sup,sub,table,caption,col,colgroup,thead,tbody,tfoot,tr,td,th"),c=a("col");DEXT5_EDITOR.HWPFilter=function(b,c){function f(a,b,d,n){b=b.toLowerCase();if(u[b]){for("table"!=B.last()&&"tbody"!=B.last()||"td"!=b||f("","tr","","");B.last()&&v[B.last()];)g("",B.last());"p"!=B.last()||"table"!=b&&"hr"!=b&&"center"!=b||g("","p")}w[b]&&B.last()==b&&g("",b);(n=q[b]||!!n)||B.push(b);
if(c.start){var p=[];a=h.test(a)?m:t;d.replace(a,function(a,b,c,d,e){c=c?c:d?d:e?e:y[b]?b:"";d="";""!=a&&(a=a.substring(a.indexOf(b)+b.length),a=a.substring(a.indexOf("=")+1),a=a.replace(/^\s+/,""),d=a.substring(0,1),"'"!=d&&'"'!=d&&(d=""));p.push({name:b,value:c,escaped:c.replace(/(^|[^\\])"/g,'$1\\"'),quotationmark:d})});c.start&&c.start(b,p,n)}}function g(a,b){if(b)for(b=b.toLowerCase(),d=B.length-1;0<=d&&B[d]!=b;d--);else var d=0;if(0<=d){for(var f=B.length-1;f>=d;f--)c.end&&c.end(B[f]);B.length=
d}}var h=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,n=/^<\/([-A-Za-z0-9_:]+)[^>]*>/,m=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,p=/^<([-A-Za-z0-9_:-]+)((?:\s+[a-zA-Z_0-9:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,t=/([-A-Za-z0-9_:-]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,q=a("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");
a("area,base,basefont,br,col,frame,img,input,isindex,link,meta,param,embed");var u=a("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul,h1,h2,h3,h4,h5,h6"),v=a("colgroup,a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),
w=a("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),y=a("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),x=a(""),z,A,B=[],G=b;B.last=function(){return this[this.length-1]};for(b=b.replace(RegExp("<div( ?([^>?+])*>(\\s+)?(&nbsp;)+(\\s+)?)</ ?div>","gi"),"<p$1</p>");b;){A=!0;if(B.last()&&x[B.last()])b=b.replace(new RegExp("(.*)</"+B.last()+"[^>]*>"),function(a,b){b=b.replace(/\x3c!--(.*?)--\x3e/g,"$1").replace(/<!\[CDATA\[(.*?)]]\x3e/g,"$1");
c.chars&&c.chars(b);return""}),g("",B.last());else{var D=b.indexOf("<");z=b.indexOf(">")+1;var I=b.substring(D,z);if(0==b.indexOf("\x3c!--"))z=b.indexOf("--\x3e"),0<=z&&(c.comment&&c.comment(b.substring(4,z)),b=b.substring(z+3),A=!1);else if(0==b.indexOf("<?xml"))z=b.indexOf("/>"),0<=z&&(b=b.substring(z+2),A=!1);else if(0!=b.indexOf("<")&&"</"+B.last()+">"==I.replace(/ /ig,""))A=b.substring(0,D),z=b.substring(z),b=A+"</"+B.last()+">"+z,A=!0;else if(0==b.indexOf("</")){if(z=b.match(n))b=b.substring(z[0].length),
z[0].replace(n,g),A=!1}else if(0==b.indexOf("<"))if(z=b.match(h))b=b.substring(z[0].length),z[0].replace(h,f),A=!1;else if(z=b.match(p))b=b.substring(z[0].length),z[0].replace(p,f),A=!1;else if("1"==DEXTTOP.G_CURREDITOR._config.removeIncorrectAttribute&&(z=b.indexOf("<"),I=b.indexOf(">"),0==z&&0<I)){var K=b.substring(0,I+1),E=D=z=0;0<K.indexOf('\ub9d1\uc740=""')?(z=K.indexOf('\ub9d1\uc740=""'),D=5,E=K.split('\ub9d1\uc740=""').length):0<K.indexOf("\ub9d1\uc740=''")&&(z=K.indexOf("\ub9d1\uc740=''"),
D=5,E=K.split("\ub9d1\uc740=''").length);if(2==E&&0<z&&(I=b.substring(I+1),E=K.substring(0,z).lastIndexOf(" "),E<z+D))if(z=K.substring(E,z+D),K=K.replace(z,""),b=K+I,z=b.match(h))b=b.substring(z[0].length),z[0].replace(h,f),A=!1;else if(z=b.match(p))b=b.substring(z[0].length),z[0].replace(p,f),A=!1}A&&(z=b.indexOf("<"),A=0>z?b:b.substring(0,z),b=0>z?"":b.substring(z),c.chars&&(B.last()&&v[B.last()]&&"textarea"!=B.last()&&"script"!=B.last()&&(z=!1,D=RegExp("\\S\\n","g"),D.test(A)&&(z=!0),D=RegExp("\\n\\S",
"g"),D.test(A)&&(z=!0),D=RegExp("\\S\\n\\S","g"),D.test(A)&&(z=!0),z?A=A.replace(/\n/g," "):(D=RegExp("\\n\\n","g"),D.test(A)&&""==A.trim()?A=A.replace(/\n\n/g,""):A==unescape("%20%20")&&(z=new RegExp(unescape("%20"),"g"),A=A.replace(z,"&nbsp;")))),c.chars(A)))}if(b==G)throw"Parse Error: "+b;G=b}g()};DEXT5_EDITOR.HWPFilter.DOMProcess=function(b,c){var f=b;try{var g=function(a){var b=!1,c;c=a+"";c=c.replace(/^\s*|\s*$/g,"");c=""==c||isNaN(c)?!1:!0;c?b=!0:-1<a.indexOf("px")&&(a=parseInt(a),b=!0);b&&
(a=.264583*a+"mm");return a},h=function(a){""!=a.align&&-1==",left,center,right,justify,char,".indexOf(","+a.align.toLowerCase()+",")&&(a.align="");""!=a.vAlign&&-1==",top,middle,bottom,baseline,".indexOf(","+a.vAlign.toLowerCase()+",")&&(a.vAlign="")},n=function(a){for(var b=[],c=a.length>>>0;c--;)b[c]=a[c];return b},m=function(a){var b=[],c=0;a=a.attributes;for(var d=a.length;c<d;c++)b.push(a[c].nodeName);return b},p=document.createElement("div");p.style.display="none";p.innerHTML=f;for(var t="p ul ol li table caption col colgroup thead tfoot tbody tr th td a img i b u sub sup ".split(" "),
q=j=k=0,u=t.length,v,w,y,x,z,A,B,G,D,I;q<u;q++)for(v=p.getElementsByTagName(t[q]),j=0,x=v.length;j<x;j++){w=v[j];y=m(w);switch(t[q]){case "p":w.childNodes&&1==w.childNodes.length&&(1==w.nodeType&&"br"==w.tagName.toLowerCase()||"&nbsp;"==w.innerHTML)&&(w.innerHTML="");""!=w.style.textAlign&&(B=",left,center,right,",G=-1==B.indexOf(","+w.style.textAlign.toLowerCase()+",")?"":w.style.textAlign,w.style.textAlign="",w.align=G);""==w.align&&removeAttribute(w,"align");removeAttribute(w,"id");A=a("id,style,align");
break;case "ul":case "ol":if(0==w.getElementsByTagName("li").length){var K=n(w.childNodes),E=document.createElement("li");w.appendChild(E);for(var N=0,H=K.length;N<H;N++)E.appendChild(K[N])}A=a("id");break;case "a":A=a("id,name,href,rel,rev");break;case "img":""!=w.align&&(B=",top,middle,bottom,left,right,",-1==B.indexOf(","+w.align.toLowerCase()+",")&&(w.align=""));(D=DEXTTOP.DEXT5.util.getStyle(w,"width"))&&""!=D&&w.setAttribute("width",D);(I=DEXTTOP.DEXT5.util.getStyle(w,"height"))&&""!=I&&w.setAttribute("height",
I);""==w.src?w.src="noImage":w.src.indexOf("/")?w.src=w.src.substring(w.src.lastIndexOf("/")+1):w.src.indexOf("\\")&&(w.src=w.src.substring(w.src.lastIndexOf("\\")+1));""==w.alt&&(w.alt=""!=w.title?w.title:"untitled");A=a("id,src,alt,name,longdesc,height,width,align,border,hspace,vspace");break;case "table":""!=w.align&&(B=",left,center,right,adjust,",-1==B.indexOf(","+w.align.toLowerCase()+",")&&(w.align=""));""==w.border&&w.setAttribute("border",w.style.borderWidth.replace("px",""));(D=DEXTTOP.DEXT5.util.getStyle(w,
"width"))&&""!=D&&w.setAttribute("width",D);(I=DEXTTOP.DEXT5.util.getStyle(w,"height"))&&""!=I&&w.setAttribute("height",I);A=a("id,summary,width,height,border,cellspacing,cellpadding,align");break;case "caption":""!=w.align&&(B=",top,bottom,left,right,",-1==B.indexOf(","+w.align.toLowerCase()+",")&&(w.align=""));A=a("id,align");break;case "colgroup":case "col":h(w);A=a("id,span,width,align,char,charoff,valign");break;case "thead":case "tfoot":case "tbody":case "tr":h(w);A=a("id,align,char,charoff,valign");
break;case "th":case "td":h(w);(D=DEXTTOP.DEXT5.util.getStyle(w,"width"))&&""!=D&&w.setAttribute("width",D);(I=DEXTTOP.DEXT5.util.getStyle(w,"height"))&&""!=I&&w.setAttribute("height",I);A=a("id,abbr,axis,headers,rowspan,colspan,align,char,charoff,nowrap,width,height");break;case "i":case "b":case "u":case "sub":case "sup":case "li":A=a("id");break;default:A=a("id")}k=0;for(z=y.length;k<z;k++)A[y[k].toLowerCase()]||removeAttribute(w,y[k])}f=DEXTTOP.DEXT5.util.html2xhtml(p.innerHTML);try{var J=!1,
M=!1,f=f.replace(/ width=['\"](\d+)['\"]/ig,function(a,b){J=!0;return' width="'+g(b)+'"'}),f=f.replace(/ height=['\"](\d+)['\"]/ig,function(a,b){M=!0;return' height="'+g(b)+'"'});0==J&&(f=f.replace(/ width=(\d+)/ig,function(a,b){return' width="'+g(b)+'"'}));0==M&&(f=f.replace(/ height=(\d+)/ig,function(a,b){return' height="'+g(b)+'"'}))}catch(L){f=b}}catch(F){f=b}return f};DEXT5_EDITOR.HWPFilter.HTMLtoXML=function(a,e){var f="",g=a,h=a.toLowerCase().indexOf("<body"),n=a.toLowerCase().lastIndexOf("</body>");
-1<h&&-1<n&&(a=a.substring(h+1,n),h=a.indexOf(">"),a=a.substring(h+1));if("undefined"!=typeof e)try{var m=_iframeDoc.getElementById(e);if(m)a=m.innerHTML;else{var p=_iframeDoc.createElement("div");p.style.display="none";p.innerHTML=a;_iframeDoc.body.appendChild(p);if(m=_iframeDoc.getElementById(e))a=m.innerHTML;p.innerHTML="";_iframeDoc.body.removeChild(p);try{delete null}catch(t){}}g=a}catch(q){a=g}try{a=a.replace(/<italic/gi,"<i"),a=a.replace(/<\/italic>/gi,"</i>"),a=a.replace(/<underline/gi,"<u"),
a=a.replace(/<\/underline>/gi,"</u>"),a=a.replace(/<strong/gi,"<b"),g=a=a.replace(/<\/strong>/gi,"</b>"),DEXT5_EDITOR.HWPFilter(a,{start:function(a,c,d){if(b[a]){f+="<"+a;for(a=0;a<c.length;a++)f="href"==c[a].name||"src"==c[a].name?f+(" "+c[a].name+"="+c[a].quotationmark+c[a].value+c[a].quotationmark):""!=c[a].quotationmark?f+(" "+c[a].name+"="+c[a].quotationmark+c[a].value+c[a].quotationmark):f+(" "+c[a].name+'="'+c[a].escaped+'"');f+=(d?"/":"")+">"}},end:function(a){b[a]&&!c[a]&&(f+="</"+a+">")},
chars:function(a){f+=a},comment:function(a){f+=""}}),g=a}catch(u){f=g}return f=DEXT5_EDITOR.HWPFilter.DOMProcess(f,e)}})();var g_d5selectedCName="DEXT_selected_basic",g_d5selectedFocusCName="DEXT_selected_nofocus";
function setFormControlSelected(a){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var b=["INPUT","TEXTAREA","SELECT","BUTTON"],c=b.length,d=!1;if(a&&1==a.nodeType)for(var e=0;e<c;e++)if(a.tagName==b[e]){d=!0;break}if(0==d)clearAllFormControlSelected();else{rangy.getSelection(_iframeWin).removeAllRanges();for(var f=[],g=_iframeDoc.body,e=0;e<c;e++)for(var h=g.getElementsByTagName(b[e]),n=h.length,m=0;m<n;m++)h[m].className!=g_d5selectedCName&&h[m].className!=g_d5selectedFocusCName||a==h[m]||f.push(h[m]);
if(d)if(a.className==g_d5selectedCName)d5RemoveSelectedClassName(a,g_d5selectedCName);else if(a.className==g_d5selectedFocusCName)d5RemoveSelectedClassName(a,g_d5selectedFocusCName),0<f.length&&(f[0].className=g_d5selectedFocusCName);else for(d5AddSelectedClassName(a,g_d5selectedFocusCName),a=f.length,e=0;e<a;e++)d5RemoveSelectedClassName(f[e],g_d5selectedFocusCName),d5AddSelectedClassName(f[e],g_d5selectedCName)}}}
function getFormControlSelectedItem(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){for(var a={count:0,arrNodes:[]},b=["INPUT","TEXTAREA","SELECT","BUTTON"],c=b.length,d=_iframeDoc.body,e=0;e<c;e++)for(var f=d.getElementsByTagName(b[e]),g=f.length,h=0;h<g;h++)if(f[h].className==g_d5selectedCName||f[h].className==g_d5selectedFocusCName)a.count+=1,a.arrNodes.push(f[h]);return a}}
function clearAllFormControlSelected(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode)for(var a=["INPUT","TEXTAREA","SELECT","BUTTON"],b=a.length,c=_iframeDoc.body,d=0;d<b;d++)for(var e=c.getElementsByTagName(a[d]),f=e.length,g=0;g<f;g++)if(e[g].className==g_d5selectedCName||e[g].className==g_d5selectedFocusCName)d5RemoveSelectedClassName(e[g],g_d5selectedCName),d5RemoveSelectedClassName(e[g],g_d5selectedFocusCName)}
function d5AddSelectedClassName(a,b){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var c=a.className,d="";if(0<c.length){for(var c=c.split(" "),e=c.length,f=0;f<e;f++)b!=c[f]&&(d+=c[f]+" ");d+=b}else d=b;a.className=d}}function d5RemoveSelectedClassName(a,b){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var c=a.className,d="";if(0<c.length)for(var c=c.split(" "),e=c.length,f=0;f<e;f++)c[f]!=b&&(d=f<e-1?d+(c[f]+" "):d+c[f]);else d="";a.className=d}}
function d5ApplyAlignLeft(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var b=null,c=0;c<a.count;c++)if(a.arrNodes[c].className==g_d5selectedFocusCName){b=a.arrNodes[c];break}if(b)for(c=0;c<a.count;c++)a.arrNodes[c]!=b&&(a.arrNodes[c].style.left=getClientRect(b).left+"px")}}}
function d5ApplySameWidth(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var b=null,c=0;c<a.count;c++)if(a.arrNodes[c].className==g_d5selectedFocusCName){b=a.arrNodes[c];break}if(b)for(b=""==b.style.width?getClientRect(b).right-getClientRect(b).left+"px":b.style.width,c=0;c<a.count;c++)a.arrNodes[c].style.width=b}}}
function d5ApplySameHeight(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var b=null,c=0;c<a.count;c++)if(a.arrNodes[c].className==g_d5selectedFocusCName){b=a.arrNodes[c];break}if(b)for(b=""==b.style.height?getClientRect(b).bottom-getClientRect(b).top+"px":b.style.height,c=0;c<a.count;c++)a.arrNodes[c].style.height=b}}}
function d5ApplySameWidthHeight(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var b=null,c=0;c<a.count;c++)if(a.arrNodes[c].className==g_d5selectedFocusCName){b=a.arrNodes[c];break}if(b)for(var d=""==b.style.width?getClientRect(b).right-getClientRect(b).left+"px":b.style.width,b=""==b.style.height?getClientRect(b).bottom-getClientRect(b).top+"px":b.style.height,c=0;c<a.count;c++)a.arrNodes[c].style.width=d,a.arrNodes[c].style.height=b}}}
;"object"!=typeof JSON&&(JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function b(a){return e.lastIndex=0,e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var e,h,u,v,w,y=f,x=d[a];switch(x&&"object"==typeof x&&"function"==typeof x.toJSON&&(x=x.toJSON(a)),"function"==typeof n&&(x=n.call(d,a,x)),typeof x){case "string":return b(x);case "number":return isFinite(x)?x+"":"null";case "boolean":case "null":return x+"";
case "object":if(!x)return"null";if(f+=g,w=[],"[object Array]"===Object.prototype.toString.apply(x)){v=x.length;for(e=0;v>e;e+=1)w[e]=c(e,x)||"null";return u=0===w.length?"[]":f?"[\n"+f+w.join(",\n"+f)+"\n"+y+"]":"["+w.join(",")+"]",f=y,u}if(n&&"object"==typeof n)for(v=n.length,e=0;v>e;e+=1)"string"==typeof n[e]&&(h=n[e],u=c(h,x),u&&w.push(b(h)+(f?": ":":")+u));else for(h in x)Object.prototype.hasOwnProperty.call(x,h)&&(u=c(h,x),u&&w.push(b(h)+(f?": ":":")+u));return u=0===w.length?"{}":f?"{\n"+f+
w.join(",\n"+f)+"\n"+y+"}":"{"+w.join(",")+"}",f=y,u}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var d,e,f,g,h,n;"function"!=typeof JSON.stringify&&(e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,d){var e;if(f="",g="","number"==typeof d)for(e=0;d>e;e+=1)g+=" ";else"string"==typeof d&&(g=d);if(n=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});"function"!=typeof JSON.parse&&(d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(a,b){function c(a,
d){var e,f,g=a[d];if(g&&"object"==typeof g)for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&(f=c(g,e),void 0!==f?g[e]=f:delete g[e]);return b.call(a,d,g)}var e;if(a+="",d.lastIndex=0,d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),
"function"==typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");})})();"undefined"==typeof JSON&&(this.JSON={});
(function(){var a={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b=function(b){return a[b]||"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)};JSON.validate=function(a){a=a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");return/^[\],:{}\s]*$/.test(a)};JSON.encode=JSON.stringify?function(a){return JSON.stringify(a)}:function(a){a&&a.toJSON&&(a=a.toJSON());
switch(typeOf(a)){case "string":return'"'+a.replace(/[\x00-\x1f\\"]/g,b)+'"';case "array":return"["+a.map(JSON.encode).clean()+"]";case "object":case "hash":var d=[];Object.each(a,function(a,b){var c=JSON.encode(a);c&&d.push(JSON.encode(b)+":"+c)});return"{"+d+"}";case "number":case "boolean":return""+a;case "null":return"null"}return null};JSON.secure=!0;JSON.decode=function(a,b){if(!a||"string"!=typeof a)return null;null==b&&(b=JSON.secure);if(b){if(JSON.parse)return JSON.parse(a);if(!JSON.validate(a))throw Error("JSON could not decode the input; security is enabled and the value is not secure.");
}return eval("("+a+")")}})();

var rangy; rangy = rangy || function () { function h(c, d) { var e = typeof c[d]; return e == b || e == a && !!c[d] || e == "unknown" } function i(b, c) { return typeof b[c] == a && !!b[c] } function j(a, b) { return typeof a[b] != c } function k(a) { return function (b, c) { var d = c.length; while (d--) if (!a(b, c[d])) return !1; return !0 } } function o(a) { return a && l(a, g) && n(a, f) } function p(a) { return i(a, "body") ? a.body : a.getElementsByTagName("body")[0] } function s(a) { i(window, "console") && h(window.console, "log") && window.console.log(a) } function t(a, b) { b ? window.alert(a) : s(a) } function u(a) { r.initialized = !0, r.supported = !1, t("Rangy is not supported on this page in your browser. Reason: " + a, r.config.alertOnFail) } function v(a) { t("Rangy warning: " + a, r.config.alertOnWarn) } function y(a) { return a.message || a.description || String(a) } function z() { if (r.initialized) return; var a, b = !1, c = !1; h(document, "createRange") && (a = document.createRange(), l(a, e) && n(a, d) && (b = !0), a.detach()); var f = p(document); if (!f || f.nodeName.toLowerCase() != "body") { u("No body element found"); return } f && h(f, "createTextRange") && (a = f.createTextRange(), o(a) && (c = !0)); if (!b && !c) { u("Neither Range nor TextRange are available"); return } r.initialized = !0, r.features = { implementsDomRange: b, implementsTextRange: c }; var g, i; for (var j in q) (g = q[j]) instanceof C && g.init(); for (var k = 0, m = x.length; k < m; ++k) try { x[k](r) } catch (t) { i = "Rangy init listener threw an exception. Continuing. Detail: " + y(t), s(i) } } function B(a) { a = a || window, z(); for (var b = 0, c = A.length; b < c; ++b) A[b](a) } function C(a, b) { this.name = a, this.initialized = !1, this.supported = !1, this.init = b } var a = "object", b = "function", c = "undefined", d = ["startContainer", "startOffset", "endContainer", "endOffset", "collapsed", "commonAncestorContainer"], e = ["setStart", "setStartBefore", "setStartAfter", "setEnd", "setEndBefore", "setEndAfter", "collapse", "selectNode", "selectNodeContents", "compareBoundaryPoints", "deleteContents", "extractContents", "cloneContents", "insertNode", "surroundContents", "cloneRange", "toString", "detach"], f = ["boundingHeight", "boundingLeft", "boundingTop", "boundingWidth", "htmlText", "text"], g = ["collapse", "compareEndPoints", "duplicate", "moveToElementText", "parentElement", "select", "setEndPoint", "getBoundingClientRect"], l = k(h), m = k(i), n = k(j), q = {}, r = { version: "1.3alpha.772", initialized: !1, supported: !0, util: { isHostMethod: h, isHostObject: i, isHostProperty: j, areHostMethods: l, areHostObjects: m, areHostProperties: n, isTextRange: o, getBody: p }, features: {}, modules: q, config: { alertOnFail: !0, alertOnWarn: !1, preferTextRange: !1 } }; r.fail = u, r.warn = v, {}.hasOwnProperty ? r.util.extend = function (a, b, c) { var d, e; for (var f in b) b.hasOwnProperty(f) && (d = a[f], e = b[f], c && d !== null && typeof d == "object" && e !== null && typeof e == "object" && r.util.extend(d, e, !0), a[f] = e); return a } : u("hasOwnProperty not supported"), function () { var a = document.createElement("div"); a.appendChild(document.createElement("span")); var b = [].slice, c; try { b.call(a.childNodes, 0)[0].nodeType == 1 && (c = function (a) { return b.call(a, 0) }) } catch (d) { } c || (c = function (a) { var b = []; for (var c = 0, d = a.length; c < d; ++c) b[c] = a[c]; return b }), r.util.toArray = c }(); var w; h(document, "addEventListener") ? w = function (a, b, c) { a.addEventListener(b, c, !1) } : h(document, "attachEvent") ? w = function (a, b, c) { a.attachEvent("on" + b, c) } : u("Document does not have required addEventListener or attachEvent method"), r.util.addListener = w; var x = []; r.init = z, r.addInitListener = function (a) { r.initialized ? a(r) : x.push(a) }; var A = []; r.addCreateMissingNativeApiListener = function (a) { A.push(a) }, r.createMissingNativeApi = B, C.prototype = { fail: function (a) { throw this.initialized = !0, this.supported = !1, new Error("Module '" + this.name + "' failed to load: " + a) }, warn: function (a) { r.warn("Module " + this.name + ": " + a) }, deprecationNotice: function (a, b) { r.warn("DEPRECATED: " + a + " in module " + this.name + "is deprecated. Please use " + b + " instead") }, createError: function (a) { return new Error("Error in Rangy " + this.name + " module: " + a) } }, r.createModule = function (a, b) { var c = new C(a, function () { if (!c.initialized) { c.initialized = !0; try { b(r, c), c.supported = !0 } catch (d) { var e = "Module '" + a + "' failed to load: " + y(d); s(e) } } }); q[a] = c }, r.requireModules = function (a) { for (var b = 0, c = a.length, d, e; b < c; ++b) { e = a[b], d = q[e]; if (!d || !(d instanceof C)) throw new Error("required module '" + e + "' not found"); d.init(); if (!d.supported) throw new Error("required module '" + e + "' not supported") } }; var D = !1, E = function (a) { D || (D = !0, r.initialized || z()) }; if (typeof window == c) { u("No window found"); return } if (typeof document == c) { u("No document found"); return } return h(document, "addEventListener") && document.addEventListener("DOMContentLoaded", E, !1), w(window, "load", E), r }(), rangy.createModule("DomUtil", function (a, b) { function h(a) { var b; return typeof a.namespaceURI == c || (b = a.namespaceURI) === null || b == "http://www.w3.org/1999/xhtml" } function i(a) { var b = a.parentNode; return b.nodeType == 1 ? b : null } function j(a) { var b = 0; while (a = a.previousSibling)++b; return b } function k(a) { switch (a.nodeType) { case 7: case 10: return 0; case 3: case 8: return a.length; default: return a.childNodes.length } } function l(a, b) { var c = [], d; for (d = a; d; d = d.parentNode) c.push(d); for (d = b; d; d = d.parentNode) if (g(c, d)) return d; return null } function m(a, b, c) { var d = c ? b : b.parentNode; while (d) { if (d === a) return !0; d = d.parentNode } return !1 } function n(a, b) { return m(a, b, !0) } function o(a, b, c) { var d, e = c ? a : a.parentNode; while (e) { d = e.parentNode; if (d === b) return e; e = d } return null } function p(a) { var b = a.nodeType; return b == 3 || b == 4 || b == 8 } function q(a) { if (!a) return !1; var b = a.nodeType; return b == 3 || b == 8 } function r(a, b) { var c = b.nextSibling, d = b.parentNode; return c ? d.insertBefore(a, c) : d.appendChild(a), a } function s(a, b, c) { var d = a.cloneNode(!1); d.deleteData(0, b), a.deleteData(b, a.length - b), r(d, a); if (c) for (var e = 0, f; f = c[e++];) f.node == a && f.offset > b ? (f.node = d, f.offset -= b) : f.node == a.parentNode && f.offset > j(a) && ++f.offset; return d } function t(a) { if (a.nodeType == 9) return a; if (typeof a.ownerDocument != c) return a.ownerDocument; if (typeof a.document != c) return a.document; if (a.parentNode) return t(a.parentNode); throw b.createError("getDocument: no document found for node") } function u(a) { var d = t(a); if (typeof d.defaultView != c) return d.defaultView; if (typeof d.parentWindow != c) return d.parentWindow; throw b.createError("Cannot get a window object for node") } function v(a) { if (typeof a.contentDocument != c) return a.contentDocument; if (typeof a.contentWindow != c) return a.contentWindow.document; throw b.createError("getIframeDocument: No Document object found for iframe element") } function w(a) { if (typeof a.contentWindow != c) return a.contentWindow; if (typeof a.contentDocument != c) return a.contentDocument.defaultView; throw b.createError("getIframeWindow: No Window object found for iframe element") } function x(a) { return a && d.isHostMethod(a, "setTimeout") && d.isHostObject(a, "document") } function y(a, b, c) { var e; a ? d.isHostProperty(a, "nodeType") ? e = a.nodeType == 1 && a.tagName.toLowerCase() == "iframe" ? v(a) : t(a) : x(a) && (e = a.document) : e = document; if (!e) throw b.createError(c + "(): Parameter must be a Window object or DOM node"); return e } function z(a) { var b; while (b = a.parentNode) a = b; return a } function A(a, c, d, e) { var f, g, h, i, k; if (a == d) return c === e ? 0 : c < e ? -1 : 1; if (f = o(d, a, !0)) return c <= j(f) ? -1 : 1; if (f = o(a, d, !0)) return j(f) < e ? -1 : 1; g = l(a, d), h = a === g ? g : o(a, g, !0), i = d === g ? g : o(d, g, !0); if (h === i) throw b.createError("comparePoints got to case 4 and childA and childB are the same!"); k = g.firstChild; while (k) { if (k === h) return -1; if (k === i) return 1; k = k.nextSibling } } function C(a) { try { return a.parentNode, !1 } catch (b) { return !0 } } function D(a) { if (!a) return "[No node]"; if (B && C(a)) return "[Broken node]"; if (p(a)) return '"' + a.data + '"'; if (a.nodeType == 1) { var b = a.id ? ' id="' + a.id + '"' : ""; return "<" + a.nodeName + b + ">[" + a.childNodes.length + "][" + a.innerHTML.slice(0, 20) + "]" } return a.nodeName } function E(a) { var b = t(a).createDocumentFragment(), c; while (c = a.firstChild) b.appendChild(c); return b } function G(a) { this.root = a, this._next = a } function H(a) { return new G(a) } function I(a, b) { this.node = a, this.offset = b } function J(a) { this.code = this[a], this.codeName = a, this.message = "DOMException: " + this.codeName } var c = "undefined", d = a.util; d.areHostMethods(document, ["createDocumentFragment", "createElement", "createTextNode"]) || b.fail("document missing a Node creation method"), d.isHostMethod(document, "getElementsByTagName") || b.fail("document missing getElementsByTagName method"); var e = document.createElement("div"); d.areHostMethods(e, ["insertBefore", "appendChild", "cloneNode"] || !d.areHostObjects(e, ["previousSibling", "nextSibling", "childNodes", "parentNode"])) || b.fail("Incomplete Element implementation"), d.isHostProperty(e, "innerHTML") || b.fail("Element is missing innerHTML property"); var f = document.createTextNode("test"); d.areHostMethods(f, ["splitText", "deleteData", "insertData", "appendData", "cloneNode"] || !d.areHostObjects(e, ["previousSibling", "nextSibling", "childNodes", "parentNode"]) || !d.areHostProperties(f, ["data"])) || b.fail("Incomplete Text Node implementation"); var g = function (a, b) { var c = a.length; while (c--) if (a[c] === b) return !0; return !1 }, B = !1; (function () { var b = document.createElement("b"); b.innerHTML = "1"; var c = b.firstChild; b.innerHTML = "<br>", B = C(c), a.features.crashyTextNodes = B })(); var F; typeof window.getComputedStyle != c ? F = function (a, b) { return u(a).getComputedStyle(a, null)[b] } : typeof document.documentElement.currentStyle != c ? F = function (a, b) { return a.currentStyle[b] } : b.fail("No means of obtaining computed style properties found"), G.prototype = { _current: null, hasNext: function () { return !!this._next }, next: function () { var a = this._current = this._next, b, c; if (this._current) { b = a.firstChild; if (b) this._next = b; else { c = null; while (a !== this.root && !(c = a.nextSibling)) a = a.parentNode; this._next = c } } return this._current }, detach: function () { this._current = this._next = this.root = null } }, I.prototype = { equals: function (a) { return !!a && this.node === a.node && this.offset == a.offset }, inspect: function () { return "[DomPosition(" + D(this.node) + ":" + this.offset + ")]" }, toString: function () { return this.inspect() } }, J.prototype = { INDEX_SIZE_ERR: 1, HIERARCHY_REQUEST_ERR: 3, WRONG_DOCUMENT_ERR: 4, NO_MODIFICATION_ALLOWED_ERR: 7, NOT_FOUND_ERR: 8, NOT_SUPPORTED_ERR: 9, INVALID_STATE_ERR: 11 }, J.prototype.toString = function () { return this.message }, a.dom = { arrayContains: g, isHtmlNamespace: h, parentElement: i, getNodeIndex: j, getNodeLength: k, getCommonAncestor: l, isAncestorOf: m, isOrIsAncestorOf: n, getClosestAncestorIn: o, isCharacterDataNode: p, isTextOrCommentNode: q, insertAfter: r, splitDataNode: s, getDocument: t, getWindow: u, getIframeWindow: w, getIframeDocument: v, getBody: d.getBody, isWindow: x, getContentDocument: y, getRootContainer: z, comparePoints: A, isBrokenNode: C, inspectNode: D, getComputedStyleProperty: F, fragmentFromNodeChildren: E, createIterator: H, DomPosition: I }, a.DOMException = J }), rangy.createModule("DomRange", function (a, b) { function r(a, b) { return a.nodeType != 3 && (i(a, b.startContainer) || i(a, b.endContainer)) } function s(a) { return a.document || j(a.startContainer) } function t(a) { return new e(a.parentNode, h(a)) } function u(a) { return new e(a.parentNode, h(a) + 1) } function v(a, b, d) { var e = a.nodeType == 11 ? a.firstChild : a; return g(b) ? d == b.length ? c.insertAfter(a, b) : b.parentNode.insertBefore(a, d == 0 ? b : l(b, d)) : d >= b.childNodes.length ? b.appendChild(a) : b.insertBefore(a, b.childNodes[d]), e } function w(a, b, c) { Y(a), Y(b); var d = k(a.startContainer, a.startOffset, b.endContainer, b.endOffset), e = k(a.endContainer, a.endOffset, b.startContainer, b.startOffset); return c ? d <= 0 && e >= 0 : d < 0 && e > 0 } function x(a) { var b; for (var c, d = s(a.range).createDocumentFragment(), e; c = a.next() ;) { b = a.isPartiallySelectedSubtree(), c = c.cloneNode(!b), b && (e = a.getSubtreeIterator(), c.appendChild(x(e)), e.detach(!0)); d.appendChild(c) } return d } function y(a, b, d) { var e, f; d = d || { stop: !1 }; for (var g, h; g = a.next() ;) if (a.isPartiallySelectedSubtree()) { if (b(g) === !1) { d.stop = !0; return } h = a.getSubtreeIterator(), y(h, b, d), h.detach(!0); if (d.stop) return } else { e = c.createIterator(g); while (f = e.next()) if (b(f) === !1) { d.stop = !0; return } } } function z(a) { var b; while (a.next()) a.isPartiallySelectedSubtree() ? (b = a.getSubtreeIterator(), z(b), b.detach(!0)) : a.remove() } function A(a) { for (var b, c = s(a.range).createDocumentFragment(), d; b = a.next() ;) { a.isPartiallySelectedSubtree() ? (b = b.cloneNode(!1), d = a.getSubtreeIterator(), b.appendChild(A(d)), d.detach(!0)) : a.remove(); c.appendChild(b) } return c } function B(a, b, c) { var d = !!b && !!b.length, e, f = !!c; d && (e = new RegExp("^(" + b.join("|") + ")$")); var g = []; return y(new D(a, !1), function (a) { (!d || e.test(a.nodeType)) && (!f || c(a)) && g.push(a) }), g } function C(a) { var b = typeof a.getName == "undefined" ? "Range" : a.getName(); return "[" + b + "(" + c.inspectNode(a.startContainer) + ":" + a.startOffset + ", " + c.inspectNode(a.endContainer) + ":" + a.endOffset + ")]" } function D(a, b) { this.range = a, this.clonePartiallySelectedTextNodes = b; if (!a.collapsed) { this.sc = a.startContainer, this.so = a.startOffset, this.ec = a.endContainer, this.eo = a.endOffset; var c = a.commonAncestorContainer; this.sc === this.ec && g(this.sc) ? (this.isSingleCharacterDataNode = !0, this._first = this._last = this._next = this.sc) : (this._first = this._next = this.sc === c && !g(this.sc) ? this.sc.childNodes[this.so] : m(this.sc, c, !0), this._last = this.ec === c && !g(this.ec) ? this.ec.childNodes[this.eo - 1] : m(this.ec, c, !0)) } } function E(a) { this.code = this[a], this.codeName = a, this.message = "RangeException: " + this.codeName } function K(a) { return function (b, c) { var d, e = c ? b : b.parentNode; while (e) { d = e.nodeType; if (o(a, d)) return e; e = e.parentNode } return null } } function O(a, b) { } function P(a) { } function Q(a, b) { } function R(a, b) { } function S(a, b) { } function T(a) { } function U(a, b) { } function V(a) { return q && c.isBrokenNode(a) || !o(G, a.nodeType) && !L(a, !0) } function W(a, b) { return b <= (g(a) ? a.length : a.childNodes.length) } function X(a) { return !!a.startContainer && !!a.endContainer && !V(a.startContainer) && !V(a.endContainer) && W(a.startContainer, a.startOffset) && W(a.endContainer, a.endOffset) } function Y(a) { P(a); } function bb(a, b) { Y(a); var c = a.startContainer, d = a.startOffset, e = a.endContainer, f = a.endOffset, i = c === e; g(e) && f > 0 && f < e.length && l(e, f, b), g(c) && d > 0 && d < c.length && (c = l(c, d, b), i ? (f -= d, e = c) : e == c.parentNode && f >= h(c) && f++, d = 0), a.setStartAndEnd(c, d, e, f) } function lb() { } function mb(a) { a.START_TO_START = db, a.START_TO_END = eb, a.END_TO_END = fb, a.END_TO_START = gb, a.NODE_BEFORE = hb, a.NODE_AFTER = ib, a.NODE_BEFORE_AND_AFTER = jb, a.NODE_INSIDE = kb } function nb(a) { mb(a), mb(a.prototype) } function ob(a, b) { return function () { Y(this); var c = this.startContainer, d = this.startOffset, e = this.commonAncestorContainer, f = new D(this, !0), g, h; c !== e && (g = m(c, e, !0), h = u(g), c = h.node, d = h.offset), y(f, T), f.reset(); var i = a(f); return f.detach(), b(this, c, d, c, d), i } } function pb(a, b, c) { function e(a, b) { return function (c) { P(this), Q(c, F), Q(p(c), G); var d = (a ? t : u)(c); (b ? f : i)(this, d.node, d.offset) } } function f(a, c, d) { var e = a.endContainer, f = a.endOffset; if (c !== a.startContainer || d !== a.startOffset) { if (p(c) != p(e) || k(c, d, e, f) == 1) e = c, f = d; b(a, c, d, e, f) } } function i(a, c, d) { var e = a.startContainer, f = a.startOffset; if (c !== a.endContainer || d !== a.endOffset) { if (p(c) != p(e) || k(c, d, e, f) == -1) e = c, f = d; b(a, e, f, c, d) } } a.prototype = new lb, d.extend(a.prototype, { setStart: function (a, b) { P(this), O(a, !0), R(a, b), f(this, a, b) }, setEnd: function (a, b) { P(this), O(a, !0), R(a, b), i(this, a, b) }, setStartAndEnd: function () { P(this); var a = arguments, c = a[0], d = a[1], e = c, f = d; switch (a.length) { case 3: f = a[2]; break; case 4: e = a[2], f = a[3] } b(this, c, d, e, f) }, setBoundary: function (a, b, c) { this["set" + (c ? "Start" : "End")](a, b) }, setStartBefore: e(!0, !0), setStartAfter: e(!1, !0), setEndBefore: e(!0, !1), setEndAfter: e(!1, !1), collapse: function (a) { Y(this), a ? b(this, this.startContainer, this.startOffset, this.startContainer, this.startOffset) : b(this, this.endContainer, this.endOffset, this.endContainer, this.endOffset) }, selectNodeContents: function (a) { P(this), O(a, !0), b(this, a, 0, a, n(a)) }, selectNode: function (a) { P(this), O(a, !1), Q(a, F); var c = t(a), d = u(a); b(this, c.node, c.offset, d.node, d.offset) }, extractContents: ob(A, b), deleteContents: ob(z, b), canSurroundContents: function () { Y(this), T(this.startContainer), T(this.endContainer); var a = new D(this, !0), b = a._first && r(a._first, this) || a._last && r(a._last, this); return a.detach(), !b }, detach: function () { c(this) }, splitBoundaries: function () { bb(this) }, splitBoundariesPreservingPositions: function (a) { bb(this, a) }, normalizeBoundaries: function () { Y(this); var a = this.startContainer, c = this.startOffset, d = this.endContainer, e = this.endOffset, f = function (a) { var b = a.nextSibling; b && b.nodeType == a.nodeType && (d = a, e = a.length, a.appendData(b.data), b.parentNode.removeChild(b)) }, i = function (b) { var f = b.previousSibling; if (f && f.nodeType == b.nodeType) { a = b; var g = b.length; c = f.length, b.insertData(0, f.data), f.parentNode.removeChild(f); if (a == d) e += c, d = a; else if (d == b.parentNode) { var i = h(b); e == i ? (d = b, e = g) : e > i && e-- } } }, j = !0; if (g(d)) d.length == e && f(d); else { if (e > 0) { var k = d.childNodes[e - 1]; k && g(k) && f(k) } j = !this.collapsed } if (j) { if (g(a)) c == 0 && i(a); else if (c < a.childNodes.length) { var l = a.childNodes[c]; l && g(l) && i(l) } } else a = d, c = e; b(this, a, c, d, e) }, collapseToPoint: function (a, b) { P(this), O(a, !0), R(a, b), this.setStartAndEnd(a, b) } }), nb(a) } function qb(a) { a.collapsed = a.startContainer === a.endContainer && a.startOffset === a.endOffset, a.commonAncestorContainer = a.collapsed ? a.startContainer : c.getCommonAncestor(a.startContainer, a.endContainer) } function rb(a, b, d, e, f) { a.startContainer = b, a.startOffset = d, a.endContainer = e, a.endOffset = f, a.document = c.getDocument(b), qb(a) } function sb(a) { P(a), a.startContainer = a.startOffset = a.endContainer = a.endOffset = a.document = null, a.collapsed = a.commonAncestorContainer = null } function tb(a) { this.startContainer = a, this.startOffset = 0, this.endContainer = a, this.endOffset = 0, this.document = a, qb(this) } a.requireModules(["DomUtil"]); var c = a.dom, d = a.util, e = c.DomPosition, f = a.DOMException, g = c.isCharacterDataNode, h = c.getNodeIndex, i = c.isOrIsAncestorOf, j = c.getDocument, k = c.comparePoints, l = c.splitDataNode, m = c.getClosestAncestorIn, n = c.getNodeLength, o = c.arrayContains, p = c.getRootContainer, q = a.features.crashyTextNodes; D.prototype = { _current: null, _next: null, _first: null, _last: null, isSingleCharacterDataNode: !1, reset: function () { this._current = null, this._next = this._first }, hasNext: function () { return !!this._next }, next: function () { var a = this._current = this._next; return a && (this._next = a !== this._last ? a.nextSibling : null, g(a) && this.clonePartiallySelectedTextNodes && (a === this.ec && (a = a.cloneNode(!0)).deleteData(this.eo, a.length - this.eo), this._current === this.sc && (a = a.cloneNode(!0)).deleteData(0, this.so))), a }, remove: function () { var a = this._current, b, c; !g(a) || a !== this.sc && a !== this.ec ? a.parentNode && a.parentNode.removeChild(a) : (b = a === this.sc ? this.so : 0, c = a === this.ec ? this.eo : a.length, b != c && a.deleteData(b, c - b)) }, isPartiallySelectedSubtree: function () { var a = this._current; return r(a, this.range) }, getSubtreeIterator: function () { var a; if (this.isSingleCharacterDataNode) a = this.range.cloneRange(), a.collapse(!1); else { a = new tb(s(this.range)); var b = this._current, c = b, d = 0, e = b, f = n(b); i(b, this.sc) && (c = this.sc, d = this.so), i(b, this.ec) && (e = this.ec, f = this.eo), rb(a, c, d, e, f) } return new D(a, this.clonePartiallySelectedTextNodes) }, detach: function (a) { a && this.range.detach(), this.range = this._current = this._next = this._first = this._last = this.sc = this.so = this.ec = this.eo = null } }, E.prototype = { BAD_BOUNDARYPOINTS_ERR: 1, INVALID_NODE_TYPE_ERR: 2 }, E.prototype.toString = function () { return this.message }; var F = [1, 3, 4, 5, 7, 8, 10], G = [2, 9, 11], H = [5, 6, 10, 12], I = [1, 3, 4, 5, 7, 8, 10, 11], J = [1, 3, 4, 5, 7, 8], L = K([9, 11]), M = K(H), N = K([6, 10, 12]), Z = document.createElement("style"), $ = !1; try { Z.innerHTML = "<b>x</b>", $ = Z.firstChild.nodeType == 3 } catch (_) { } a.features.htmlParsingConforms = $; var ab = $ ? function (a) { var b = this.startContainer, d = j(b); var e = null; return b.nodeType == 1 ? e = b : g(b) && (e = c.parentElement(b)), e === null || e.nodeName == "HTML" && c.isHtmlNamespace(j(e).documentElement) && c.isHtmlNamespace(e) ? e = d.createElement("body") : e = e.cloneNode(!1), e.innerHTML = a, c.fragmentFromNodeChildren(e) } : function (a) { P(this); var b = s(this), d = b.createElement("body"); return d.innerHTML = a, c.fragmentFromNodeChildren(d) }, cb = ["startContainer", "startOffset", "endContainer", "endOffset", "collapsed", "commonAncestorContainer"], db = 0, eb = 1, fb = 2, gb = 3, hb = 0, ib = 1, jb = 2, kb = 3; lb.prototype = { compareBoundaryPoints: function (a, b) { Y(this), S(this.startContainer, b.startContainer); var c, d, e, f, g = a == gb || a == db ? "start" : "end", h = a == eb || a == db ? "start" : "end"; return c = this[g + "Container"], d = this[g + "Offset"], e = b[h + "Container"], f = b[h + "Offset"], k(c, d, e, f) }, insertNode: function (a) { Y(this), Q(a, I), T(this.startContainer); var b = v(a, this.startContainer, this.startOffset); this.setStartBefore(b) }, cloneContents: function () { Y(this); var a, b; if (this.collapsed) return s(this).createDocumentFragment(); if (this.startContainer === this.endContainer && g(this.startContainer)) return a = this.startContainer.cloneNode(!0), a.data = a.data.slice(this.startOffset, this.endOffset), b = s(this).createDocumentFragment(), b.appendChild(a), b; var c = new D(this, !0); return a = x(c), c.detach(), a }, canSurroundContents: function () { Y(this), T(this.startContainer), T(this.endContainer); var a = new D(this, !0), b = a._first && r(a._first, this) || a._last && r(a._last, this); return a.detach(), !b }, surroundContents: function (a) { Q(a, J); var b = this.extractContents(); if (a.hasChildNodes()) while (a.lastChild) a.removeChild(a.lastChild); v(a, this.startContainer, this.startOffset), a.appendChild(b), this.selectNode(a) }, cloneRange: function () { Y(this); var a = new tb(s(this)), b = cb.length, c; while (b--) c = cb[b], a[c] = this[c]; return a }, toString: function () { Y(this); var a = this.startContainer; if (a === this.endContainer && g(a)) return a.nodeType == 3 || a.nodeType == 4 ? a.data.slice(this.startOffset, this.endOffset) : ""; var b = [], c = new D(this, !0); return y(c, function (a) { (a.nodeType == 3 || a.nodeType == 4) && b.push(a.data) }), c.detach(), b.join("") }, compareNode: function (a) { Y(this); var b = a.parentNode, c = h(a); var d = this.comparePoint(b, c), e = this.comparePoint(b, c + 1); return d < 0 ? e > 0 ? jb : hb : e > 0 ? ib : kb }, comparePoint: function (a, b) { return Y(this), U(a, "HIERARCHY_REQUEST_ERR"), S(a, this.startContainer), k(a, b, this.startContainer, this.startOffset) < 0 ? -1 : k(a, b, this.endContainer, this.endOffset) > 0 ? 1 : 0 }, createContextualFragment: ab, toHtml: function () { Y(this); var a = this.commonAncestorContainer.parentNode.cloneNode(!1); return a.appendChild(this.cloneContents()), a.innerHTML }, intersectsNode: function (a, b) { Y(this), U(a, "NOT_FOUND_ERR"); if (j(a) !== s(this)) return !1; var c = a.parentNode, d = h(a); U(c, "NOT_FOUND_ERR"); var e = k(c, d, this.endContainer, this.endOffset), f = k(c, d + 1, this.startContainer, this.startOffset); return b ? e <= 0 && f >= 0 : e < 0 && f > 0 }, isPointInRange: function (a, b) { return Y(this), U(a, "HIERARCHY_REQUEST_ERR"), S(a, this.startContainer), k(a, b, this.startContainer, this.startOffset) >= 0 && k(a, b, this.endContainer, this.endOffset) <= 0 }, intersectsRange: function (a) { return w(this, a, !1) }, intersectsOrTouchesRange: function (a) { return w(this, a, !0) }, intersection: function (a) { if (this.intersectsRange(a)) { var b = k(this.startContainer, this.startOffset, a.startContainer, a.startOffset), c = k(this.endContainer, this.endOffset, a.endContainer, a.endOffset), d = this.cloneRange(); return b == -1 && d.setStart(a.startContainer, a.startOffset), c == 1 && d.setEnd(a.endContainer, a.endOffset), d } return null }, union: function (a) { if (this.intersectsOrTouchesRange(a)) { var b = this.cloneRange(); return k(a.startContainer, a.startOffset, this.startContainer, this.startOffset) == -1 && b.setStart(a.startContainer, a.startOffset), k(a.endContainer, a.endOffset, this.endContainer, this.endOffset) == 1 && b.setEnd(a.endContainer, a.endOffset), b } }, containsNode: function (a, b) { return b ? this.intersectsNode(a, !1) : this.compareNode(a) == kb }, containsNodeContents: function (a) { return this.comparePoint(a, 0) >= 0 && this.comparePoint(a, n(a)) <= 0 }, containsRange: function (a) { var b = this.intersection(a); return b !== null && a.equals(b) }, containsNodeText: function (a) { var b = this.cloneRange(); b.selectNode(a); var c = b.getNodes([3]); if (c.length > 0) { b.setStart(c[0], 0); var d = c.pop(); b.setEnd(d, d.length); var e = this.containsRange(b); return b.detach(), e } return this.containsNodeContents(a) }, getNodes: function (a, b) { return Y(this), B(this, a, b) }, getDocument: function () { return s(this) }, collapseBefore: function (a) { P(this), this.setEndBefore(a), this.collapse(!1) }, collapseAfter: function (a) { P(this), this.setStartAfter(a), this.collapse(!0) }, getBookmark: function (b) { var d = s(this), e = a.createRange(d); b = b || c.getBody(d), e.selectNodeContents(b); var f = this.intersection(e), g = 0, h = 0; return f && (e.setEnd(f.startContainer, f.startOffset), g = e.toString().length, h = g + f.toString().length, e.detach()), { start: g, end: h, containerNode: b } }, moveToBookmark: function (a) { var b = a.containerNode, c = 0; this.setStart(b, 0), this.collapse(!0); var d = [b], e, f = !1, g = !1, h, i, j; while (!g && (e = d.pop())) if (e.nodeType == 3) h = c + e.length, !f && a.start >= c && a.start <= h && (this.setStart(e, a.start - c), f = !0), f && a.end >= c && a.end <= h && (this.setEnd(e, a.end - c), g = !0), c = h; else { j = e.childNodes, i = j.length; while (i--) d.push(j[i]) } }, getName: function () { return "DomRange" }, equals: function (a) { return tb.rangesEqual(this, a) }, isValid: function () { return X(this) }, inspect: function () { return C(this) } }, pb(tb, rb, sb), a.rangePrototype = lb.prototype, d.extend(tb, { rangeProperties: cb, RangeIterator: D, copyComparisonConstants: nb, createPrototypeRange: pb, inspect: C, getRangeDocument: s, rangesEqual: function (a, b) { return a.startContainer === b.startContainer && a.startOffset === b.startOffset && a.endContainer === b.endContainer && a.endOffset === b.endOffset } }), a.DomRange = tb, a.RangeException = E }), rangy.createModule("WrappedRange", function (a, b) { a.requireModules(["DomUtil", "DomRange"]); var c, d, e = a.dom, f = a.util, g = e.DomPosition, h = a.DomRange, i = e.getBody, j = e.getContentDocument, k = e.isCharacterDataNode; a.features.implementsDomRange && function () { function k(a) { var b = g.length, c; while (b--) c = g[b], a[c] = a.nativeRange[c]; a.collapsed = a.startContainer === a.endContainer && a.startOffset === a.endOffset } function l(a, b, c, d, e) { var f = a.startContainer !== b || a.startOffset != c, g = a.endContainer !== d || a.endOffset != e, h = !a.equals(a.nativeRange); if (f || g || h) a.setEnd(d, e), a.setStart(b, c) } function m(a) { a.nativeRange.detach(), a.detached = !0; var b = g.length; while (b--) a[g[b]] = null } var d, g = h.rangeProperties, n; c = function (a) { if (!a) throw b.createError("WrappedRange: Range must be specified"); this.nativeRange = a, k(this) }, h.createPrototypeRange(c, l, m), d = c.prototype, d.selectNode = function (a) { this.nativeRange.selectNode(a), k(this) }, d.cloneContents = function () { return this.nativeRange.cloneContents() }, d.surroundContents = function (a) { this.nativeRange.surroundContents(a), k(this) }, d.collapse = function (a) { this.nativeRange.collapse(a), k(this) }, d.cloneRange = function () { return new c(this.nativeRange.cloneRange()) }, d.refresh = function () { k(this) }, d.toString = function () { return this.nativeRange.toString() }; var o = document.createTextNode("test"); i(document).appendChild(o); var p = document.createRange(); p.setStart(o, 0), p.setEnd(o, 0); try { p.setStart(o, 1), d.setStart = function (a, b) { this.nativeRange.setStart(a, b), k(this) }, d.setEnd = function (a, b) { this.nativeRange.setEnd(a, b), k(this) }, n = function (a) { return function (b) { this.nativeRange[a](b), k(this) } } } catch (q) { d.setStart = function (a, b) { try { this.nativeRange.setStart(a, b) } catch (c) { this.nativeRange.setEnd(a, b), this.nativeRange.setStart(a, b) } k(this) }, d.setEnd = function (a, b) { try { this.nativeRange.setEnd(a, b) } catch (c) { this.nativeRange.setStart(a, b), this.nativeRange.setEnd(a, b) } k(this) }, n = function (a, b) { return function (c) { try { this.nativeRange[a](c) } catch (d) { this.nativeRange[b](c), this.nativeRange[a](c) } k(this) } } } d.setStartBefore = n("setStartBefore", "setEndBefore"), d.setStartAfter = n("setStartAfter", "setEndAfter"), d.setEndBefore = n("setEndBefore", "setStartBefore"), d.setEndAfter = n("setEndAfter", "setStartAfter"), p.selectNodeContents(o), p.startContainer == o && p.endContainer == o && p.startOffset == 0 && p.endOffset == o.length ? d.selectNodeContents = function (a) { this.nativeRange.selectNodeContents(a), k(this) } : d.selectNodeContents = function (a) { this.setStartAndEnd(a, 0, e.getNodeLength(a)) }, p.selectNodeContents(o), p.setEnd(o, 3); var r = document.createRange(); r.selectNodeContents(o), r.setEnd(o, 4), r.setStart(o, 2), p.compareBoundaryPoints(p.START_TO_END, r) == -1 && p.compareBoundaryPoints(p.END_TO_START, r) == 1 ? d.compareBoundaryPoints = function (a, b) { return b = b.nativeRange || b, a == b.START_TO_END ? a = b.END_TO_START : a == b.END_TO_START && (a = b.START_TO_END), this.nativeRange.compareBoundaryPoints(a, b) } : d.compareBoundaryPoints = function (a, b) { return this.nativeRange.compareBoundaryPoints(a, b.nativeRange || b) }; var s = document.createElement("div"); s.innerHTML = "123"; var t = s.firstChild, u = i(document); u.appendChild(s), p.setStart(t, 1), p.setEnd(t, 2), p.deleteContents(), t.data == "13" && (d.deleteContents = function () { this.nativeRange.deleteContents(), k(this) }, d.extractContents = function () { var a = this.nativeRange.extractContents(); return k(this), a }), u.removeChild(s), u = null, f.isHostMethod(p, "createContextualFragment") && (d.createContextualFragment = function (a) { return this.nativeRange.createContextualFragment(a) }), i(document).removeChild(o), p.detach(), r.detach(), d.getName = function () { return "WrappedRange" }, a.WrappedRange = c, a.createNativeRange = function (a) { return a = j(a, b, "createNativeRange"), a.createRange() } }(); if (a.features.implementsTextRange) { var l = function (a) { var b = a.parentElement(), c = a.duplicate(); c.collapse(!0); var d = c.parentElement(); c = a.duplicate(), c.collapse(!1); var f = c.parentElement(), g = d == f ? d : e.getCommonAncestor(d, f); return g == b ? g : e.getCommonAncestor(b, g) }, m = function (a) { return a.compareEndPoints("StartToEnd", a) == 0 }, n = function (a, b, c, d, f) { var h = a.duplicate(); h.collapse(c); var i = h.parentElement(); e.isOrIsAncestorOf(b, i) || (i = b); if (!i.canHaveHTML) { var j = new g(i.parentNode, e.getNodeIndex(i)); return { boundaryPosition: j, nodeInfo: { nodeIndex: j.offset, containerElement: j.node } } } var l = e.getDocument(i).createElement("span"); l.parentNode && l.parentNode.removeChild(l); var m, n = c ? "StartToStart" : "StartToEnd", o, p, q, r, s = f && f.containerElement == i ? f.nodeIndex : 0, t = i.childNodes.length, u = t, v = u; for (; ;) { v == t ? i.appendChild(l) : i.insertBefore(l, i.childNodes[v]), h.moveToElementText(l), m = h.compareEndPoints(n, a); if (m == 0 || s == u) break; if (m == -1) { if (u == s + 1) break; s = v } else u = u == s + 1 ? s : v; v = Math.floor((s + u) / 2), i.removeChild(l) } r = l.nextSibling; if (m == -1 && r && k(r)) { h.setEndPoint(c ? "EndToStart" : "EndToEnd", a); var w; if (/[\r\n]/.test(r.data)) { var x = h.duplicate(), y = x.text.replace(/\r\n/g, "\r").length; w = x.moveStart("character", y); while ((m = x.compareEndPoints("StartToEnd", x)) == -1) w++, x.moveStart("character", 1) } else w = h.text.length; q = new g(r, w) } else o = (d || !c) && l.previousSibling, p = (d || c) && l.nextSibling, p && k(p) ? q = new g(p, 0) : o && k(o) ? q = new g(o, o.data.length) : q = new g(i, e.getNodeIndex(l)); return l.parentNode.removeChild(l), { boundaryPosition: q, nodeInfo: { nodeIndex: v, containerElement: i } } }, o = function (a, b) { var c, d, f = a.offset, g = e.getDocument(a.node), h, j, l = i(g).createTextRange(), m = k(a.node); return m ? (c = a.node, d = c.parentNode) : (j = a.node.childNodes, c = f < j.length ? j[f] : null, d = a.node), h = g.createElement("span"), h.innerHTML = "&#feff;", c ? d.insertBefore(h, c) : d.appendChild(h), l.moveToElementText(h), l.collapse(!b), d.removeChild(h), m && l[b ? "moveStart" : "moveEnd"]("character", f), l }; d = function (a) { this.textRange = a, this.refresh() }, d.prototype = new h(document), d.prototype.refresh = function () { var a, b, c, d = l(this.textRange); m(this.textRange) ? b = a = n(this.textRange, d, !0, !0).boundaryPosition : (c = n(this.textRange, d, !0, !1), a = c.boundaryPosition, b = n(this.textRange, d, !1, !1, c.nodeInfo).boundaryPosition), this.setStart(a.node, a.offset), this.setEnd(b.node, b.offset) }, d.prototype.getName = function () { return "WrappedTextRange" }, h.copyComparisonConstants(d), d.rangeToTextRange = function (a) { if (a.collapsed) return o(new g(a.startContainer, a.startOffset), !0); var b = o(new g(a.startContainer, a.startOffset), !0), c = o(new g(a.endContainer, a.endOffset), !1), d = i(h.getRangeDocument(a)).createTextRange(); return d.setEndPoint("StartToStart", b), d.setEndPoint("EndToEnd", c), d }, a.WrappedTextRange = d; if (!a.features.implementsDomRange || a.config.preferTextRange) { var p = function () { return this }(); typeof p.Range == "undefined" && (p.Range = d), a.createNativeRange = function (a) { return a = j(a, b, "createNativeRange"), i(a).createTextRange() }, a.WrappedRange = d } } a.createRange = function (c) { return c = j(c, b, "createRange"), new a.WrappedRange(a.createNativeRange(c)) }, a.createRangyRange = function (a) { return a = j(a, b, "createRangyRange"), new h(a) }, a.createIframeRange = function (c) { return b.deprecationNotice("createIframeRange()", "createRange(iframeEl)"), a.createRange(c) }, a.createIframeRangyRange = function (c) { return b.deprecationNotice("createIframeRangyRange()", "createRangyRange(iframeEl)"), a.createRangyRange(c) }, a.addCreateMissingNativeApiListener(function (b) { var c = b.document; typeof c.createRange == "undefined" && (c.createRange = function () { return a.createRange(c) }), c = b = null }) }), rangy.createModule("WrappedSelection", function (a, b) { function r(a) { return typeof a == "string" ? a == "backward" : !!a } function s(a, c) { if (!a) return window; if (d.isWindow(a)) return a; if (a instanceof T) return a.win; var e = d.getContentDocument(a, b, c); return d.getWindow(e) } function t(a) { return s(a, "getWinSelection").getSelection() } function u(a) { return s(a, "getDocSelection").document.selection } function I(a, b, c) { var d = c ? "end" : "start", e = c ? "start" : "end"; a.anchorNode = b[d + "Container"], a.anchorOffset = b[d + "Offset"], a.focusNode = b[e + "Container"], a.focusOffset = b[e + "Offset"] } function J(a) { var b = a.nativeSelection; a.anchorNode = b.anchorNode, a.anchorOffset = b.anchorOffset, a.focusNode = b.focusNode, a.focusOffset = b.focusOffset } function K(a) { a.anchorNode = a.focusNode = null, a.anchorOffset = a.focusOffset = 0, a.rangeCount = 0, a.isCollapsed = !0, a._ranges.length = 0 } function L(b) { var c; return b instanceof g ? (c = a.createNativeRange(b.getDocument()), c.setEnd(b.endContainer, b.endOffset), c.setStart(b.startContainer, b.startOffset)) : b instanceof h ? c = b.nativeRange : m.implementsDomRange && b instanceof d.getWindow(b.startContainer).Range && (c = b), c } function M(a) { if (!a.length || a[0].nodeType != 1) return !1; for (var b = 1, c = a.length; b < c; ++b) if (!d.isAncestorOf(a[0], a[b])) return !1; return !0 } function N(a) { var c = a.getNodes(); if (!M(c)) throw b.createError("getSingleElementFromRange: range " + a.inspect() + " did not consist of a single element"); return c[0] } function O(a) { return !!a && typeof a.text != "undefined" } function P(a, b) { var c = new h(b); a._ranges = [c], I(a, c, !1), a.rangeCount = 1, a.isCollapsed = c.collapsed } function Q(b) { b._ranges.length = 0; if (b.docSelection.type == "None") K(b); else { var c = b.docSelection.createRange(); if (O(c)) P(b, c); else { b.rangeCount = c.length; var d, e = o(c.item(0)); for (var f = 0; f < b.rangeCount; ++f) d = a.createRange(e), d.selectNode(c.item(f)), b._ranges.push(d); b.isCollapsed = b.rangeCount == 1 && b._ranges[0].collapsed, I(b, b._ranges[b.rangeCount - 1], !1) } } } function R(a, c) { var d = a.docSelection.createRange(), e = N(c), f = o(d.item(0)), g = p(f).createControlRange(); for (var h = 0, i = d.length; h < i; ++h) g.add(d.item(h)); try { g.add(e) } catch (j) { throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)") } g.select(), Q(a) } function T(a, b, c) { this.nativeSelection = a, this.docSelection = b, this._ranges = [], this.win = c, this.refresh() } function U(a) { a.win = a.anchorNode = a.focusNode = a._ranges = null, a.rangeCount = a.anchorOffset = a.focusOffset = 0, a.detached = !0 } function W(a, b) { var c = V.length, d, e; while (c--) { d = V[c], e = d.selection; if (b == "deleteAll") U(e); else if (d.win == a) return b == "delete" ? (V.splice(c, 1), !0) : e } return b == "deleteAll" && (V.length = 0), null } function Z(a, c) { var d = o(c[0].startContainer), e = p(d).createControlRange(); for (var f = 0, g; f < rangeCount; ++f) { g = N(c[f]); try { e.add(g) } catch (h) { throw b.createError("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)") } } e.select(), Q(a) } function cb(a, b) { } function db(b) { return function (c, d) { var e; this.rangeCount ? (e = this.getRangeAt(0), e["set" + (b ? "Start" : "End")](c, d)) : (e = a.createRange(this.win.document), e.setStartAndEnd(c, d)), this.setSingleRange(e, this.isBackward()) } } function eb(a) { var b = [], c = new j(a.anchorNode, a.anchorOffset), d = new j(a.focusNode, a.focusOffset), e = typeof a.getName == "function" ? a.getName() : "Selection"; if (typeof a.rangeCount != "undefined") for (var f = 0, h = a.rangeCount; f < h; ++f) b[f] = g.inspect(a.getRangeAt(f)); return "[" + e + "(Ranges: " + b.join(", ") + ")(anchor: " + c.inspect() + ", focus: " + d.inspect() + "]" } a.requireModules(["DomUtil", "DomRange", "WrappedRange"]), a.config.checkSelectionRanges = !0; var c = "boolean", d = a.dom, e = a.util, f = e.isHostMethod, g = a.DomRange, h = a.WrappedRange, i = a.DOMException, j = d.DomPosition, k, l, m = a.features, n = "Control", o = d.getDocument, p = d.getBody, q = g.rangesEqual, v = f(window, "getSelection"), w = e.isHostObject(document, "selection"); m.implementsWinGetSelection = v, m.implementsDocSelection = w; var x = w && (!v || a.config.preferTextRange); x ? (k = u, a.isSelectionValid = function (a) { var b = s(a, "isSelectionValid").document, c = b.selection; return c.type != "None" || o(c.createRange().parentElement()) == b }) : v ? (k = t, a.isSelectionValid = function () { return !0 }) : b.fail("Neither document.selection or window.getSelection() detected."), a.getNativeSelection = k; var y = k(), z = a.createNativeRange(document), A = p(document), B = e.areHostProperties(y, ["anchorNode", "focusNode", "anchorOffset", "focusOffset"]); m.selectionHasAnchorAndFocus = B; var C = f(y, "extend"); m.selectionHasExtend = C; var D = typeof y.rangeCount == "number"; m.selectionHasRangeCount = D; var E = !1, F = !0; e.areHostMethods(y, ["addRange", "getRangeAt", "removeAllRanges"]) && typeof y.rangeCount == "number" && m.implementsDomRange && function () { var a = window.getSelection(); if (a) { var b = p(document), c = b.appendChild(document.createElement("div")); c.contentEditable = "false"; var d = c.appendChild(document.createTextNode("\u00a0\u00a0\u00a0")), e = document.createRange(); e.setStart(d, 1), e.collapse(!0), a.addRange(e), F = a.rangeCount == 1, a.removeAllRanges(); var f = e.cloneRange(); e.setStart(d, 0), f.setEnd(d, 3), f.setStart(d, 2), a.addRange(e); if (!DEXTTOP.DEXT5.browser.chrome) { a.addRange(f); } E = a.rangeCount == 2, b.removeChild(c), a.removeAllRanges(), e.detach(), f.detach(); } }(), m.selectionSupportsMultipleRanges = E, m.collapsedNonEditableSelectionsSupported = F; var G = !1, H; A && f(A, "createControlRange") && (H = A.createControlRange(), e.areHostProperties(H, ["item", "add"]) && (G = !0)), m.implementsControlRange = G, B ? l = function (a) { return a.anchorNode === a.focusNode && a.anchorOffset === a.focusOffset } : l = function (a) { return a.rangeCount ? a.getRangeAt(a.rangeCount - 1).collapsed : !1 }; var S; f(y, "getRangeAt") ? S = function (a, b) { try { return a.getRangeAt(b) } catch (c) { return null } } : B && (S = function (b) { var c = o(b.anchorNode), d = a.createRange(c); return d.setStartAndEnd(b.anchorNode, b.anchorOffset, b.focusNode, b.focusOffset), d.collapsed !== this.isCollapsed && d.setStartAndEnd(b.focusNode, b.focusOffset, b.anchorNode, b.anchorOffset), d }); var V = [], X = function (a) { if (a && a instanceof T) return a.refresh(), a; a = s(a, "getNativeSelection"); var b = W(a), c = k(a), d = w ? u(a) : null; return b ? (b.nativeSelection = c, b.docSelection = d, b.refresh()) : (b = new T(c, d, a), V.push({ win: a, selection: b })), b }; a.getSelection = X, a.getIframeSelection = function (c) { return b.deprecationNotice("getIframeSelection()", "getSelection(iframeEl)"), a.getSelection(d.getIframeWindow(c)) }; var Y = T.prototype; if (!x && B && e.areHostMethods(y, ["removeAllRanges", "addRange"])) { Y.removeAllRanges = function () { this.nativeSelection.removeAllRanges(), K(this) }; var $ = function (b, c) { var d = g.getRangeDocument(c), e = a.createRange(d); e.collapseToPoint(c.endContainer, c.endOffset), b.nativeSelection.addRange(L(e)), b.nativeSelection.extend(c.startContainer, c.startOffset), b.refresh() }; D ? Y.addRange = function (b, c) { if (G && w && this.docSelection.type == n) R(this, b); else if (r(c) && C) $(this, b); else { var d; E ? d = this.rangeCount : (this.removeAllRanges(), d = 0), this.nativeSelection.addRange(L(b).cloneRange()), this.rangeCount = this.nativeSelection.rangeCount; if (this.rangeCount == d + 1) { if (a.config.checkSelectionRanges) { var e = S(this.nativeSelection, this.rangeCount - 1); e && !q(e, b) && (b = new h(e)) } this._ranges[this.rangeCount - 1] = b, I(this, b, bb(this.nativeSelection)), this.isCollapsed = l(this) } else this.refresh() } } : Y.addRange = function (a, b) { r(b) && C ? $(this, a) : (this.nativeSelection.addRange(L(a)), this.refresh()) }, Y.setRanges = function (a) { if (G && a.length > 1) Z(this, a); else { this.removeAllRanges(); for (var b = 0, c = a.length; b < c; ++b) this.addRange(a[b]) } } } else { if (!(f(y, "empty") && f(z, "select") && G && x)) return b.fail("No means of selecting a Range or TextRange was found"), !1; Y.removeAllRanges = function () { try { this.docSelection.empty(); if (this.docSelection.type != "None") { var a; if (this.anchorNode) a = o(this.anchorNode); else if (this.docSelection.type == n) { var b = this.docSelection.createRange(); b.length && (a = o(b.item(0))) } if (a) { var c = p(a).createTextRange(); c.select(), this.docSelection.empty() } } } catch (d) { } K(this) }, Y.addRange = function (a) { this.docSelection.type == n ? R(this, a) : (h.rangeToTextRange(a).select(), this._ranges[0] = a, this.rangeCount = 1, this.isCollapsed = this._ranges[0].collapsed, I(this, a, !1)) }, Y.setRanges = function (a) { this.removeAllRanges(); var b = a.length; b > 1 ? Z(this, a) : b && this.addRange(a[0]) } } Y.getRangeAt = function (a) { return this._ranges[a].cloneRange() }; var _; if (x) _ = function (b) { var c; a.isSelectionValid(b.win) ? c = b.docSelection.createRange() : (c = p(b.win.document).createTextRange(), c.collapse(!0)), b.docSelection.type == n ? Q(b) : O(c) ? P(b, c) : K(b) }; else if (f(y, "getRangeAt") && typeof y.rangeCount == "number") _ = function (b) { if (G && w && b.docSelection.type == n) Q(b); else { b._ranges.length = b.rangeCount = b.nativeSelection.rangeCount; if (b.rangeCount) { for (var c = 0, d = b.rangeCount; c < d; ++c) b._ranges[c] = new a.WrappedRange(b.nativeSelection.getRangeAt(c)); I(b, b._ranges[b.rangeCount - 1], bb(b.nativeSelection)), b.isCollapsed = l(b) } else K(b) } }; else { if (!B || typeof y.isCollapsed != c || typeof z.collapsed != c || !m.implementsDomRange) return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"), !1; _ = function (a) { var b, c = a.nativeSelection; c.anchorNode ? (b = S(c, 0), a._ranges = [b], a.rangeCount = 1, J(a), a.isCollapsed = l(a)) : K(a) } } Y.refresh = function (a) { var b = a ? this._ranges.slice(0) : null, c = this.anchorNode, d = this.anchorOffset; _(this); if (a) { var e = b.length; if (e != this._ranges.length) return !0; if (this.anchorNode != c || this.anchorOffset != d) return !0; while (e--) if (!q(b[e], this._ranges[e])) return !0; return !1 } }; var ab = function (b, c) { var d = b.getAllRanges(); b.removeAllRanges(); for (var e = 0, f = d.length; e < f; ++e) a.rangesEqual(c, d[e]) || b.addRange(d[e]); b.rangeCount || K(b) }; G ? Y.removeRange = function (a) { if (this.docSelection.type == n) { var b = this.docSelection.createRange(), c = N(a), d = o(b.item(0)), e = p(d).createControlRange(), f, g = !1; for (var h = 0, i = b.length; h < i; ++h) f = b.item(h), f !== c || g ? e.add(b.item(h)) : g = !0; e.select(), Q(this) } else ab(this, a) } : Y.removeRange = function (a) { ab(this, a) }; var bb; !x && B && m.implementsDomRange ? (bb = function (a) { var b = !1; return a.anchorNode && (b = d.comparePoints(a.anchorNode, a.anchorOffset, a.focusNode, a.focusOffset) == 1), b }, Y.isBackward = function () { return bb(this) }) : bb = Y.isBackward = function () { return !1 }, Y.isBackwards = Y.isBackward, Y.toString = function () { var a = []; for (var b = 0, c = this.rangeCount; b < c; ++b) a[b] = "" + this._ranges[b]; return a.join("") }, Y.collapse = function (b, c) { cb(this, b); var d = a.createRange(b); d.collapseToPoint(b, c), this.setSingleRange(d), this.isCollapsed = !0 }, Y.collapseToStart = function () { var a = this._ranges[0]; this.collapse(a.startContainer, a.startOffset) }, Y.collapseToEnd = function () { var a = this._ranges[this.rangeCount - 1]; this.collapse(a.endContainer, a.endOffset) }, Y.selectAllChildren = function (b) { cb(this, b); var c = a.createRange(b); c.selectNodeContents(b), this.removeAllRanges(), this.addRange(c) }, Y.deleteFromDocument = function () { if (G && w && this.docSelection.type == n) { var a = this.docSelection.createRange(), b; while (a.length) b = a.item(0), a.remove(b), b.parentNode.removeChild(b); this.refresh() } else if (this.rangeCount) { var c = this.getAllRanges(); if (c.length) { this.removeAllRanges(); for (var d = 0, e = c.length; d < e; ++d) c[d].deleteContents(); this.addRange(c[e - 1]) } } }, Y.eachRange = function (a, b) { for (var c = 0, d = this._ranges.length; c < d; ++c) if (a(this.getRangeAt(c))) return b }, Y.getAllRanges = function () { var a = []; return this.eachRange(function (b) { a.push(b) }), a }, Y.setSingleRange = function (a, b) { this.removeAllRanges(), this.addRange(a, b) }, Y.callMethodOnEachRange = function (a, b) { var c = []; return this.eachRange(function (d) { c.push(d[a].apply(d, b)) }), c }, Y.setStart = db(!0), Y.setEnd = db(!1), a.rangePrototype.select = function (a) { X(this.getDocument()).setSingleRange(this, a) }, Y.changeEachRange = function (a) { var b = [], c = this.isBackward(); this.eachRange(function (c) { a(c), b.push(c) }), this.removeAllRanges(), c && b.length == 1 ? this.addRange(b[0], "backward") : this.setRanges(b) }, Y.containsNode = function (a, b) { return this.eachRange(function (c) { return c.containsNode(a, b) }, !0) }, Y.getBookmark = function (a) { return { backward: this.isBackward(), rangeBookmarks: this.callMethodOnEachRange("getBookmark", [a]) } }, Y.moveToBookmark = function (b) { var c = []; for (var d = 0, e, f; e = b.rangeBookmarks[d++];) f = a.createRange(this.win), f.moveToBookmark(e), c.push(f); b.backward ? this.setSingleRange(c[0], "backward") : this.setRanges(c) }, Y.toHtml = function () { return this.callMethodOnEachRange("toHtml").join("") }, Y.getName = function () { return "WrappedSelection" }, Y.inspect = function () { return eb(this) }, Y.detach = function () { W(this.win, "delete"), U(this) }, T.detachAll = function () { W(null, "deleteAll") }, T.inspect = eb, T.isDirectionBackward = r, a.Selection = T, a.selectionPrototype = Y, a.addCreateMissingNativeApiListener(function (a) { typeof a.getSelection == "undefined" && (a.getSelection = function () { return X(a) }), a = null }) })

rangy.createModule("TextRange",function(a,b){function t(a,b){function f(b,c,d){var f=a.slice(b,c),g={isWord:d,chars:f,toString:function(){return f.join("")}};for(var h=0,i=f.length;h<i;++h)f[h].token=g;e.push(g)}var c=a.join(""),d,e=[],g=0,h,i;while(d=b.wordRegex.exec(c)){h=d.index,i=h+d[0].length,h>g&&f(g,h,!1);if(b.includeTrailingSpace)while(m.test(a[i]))++i;f(h,i,!0),g=i}return g<a.length&&f(g,a.length,!1),e}function x(a,b){if(!a)return b;var c={};return h(c,b),h(c,a),c}function y(a){var b,c;return a?(b=a.language||o,c={},h(c,w[b]||w[o]),h(c,a),c):w[o]}function z(a){return x(a,u)}function A(a){return x(a,v)}function I(a,b){var c=F(a,"display",b),d=a.tagName.toLowerCase();return c=="block"&&G&&H.hasOwnProperty(d)?H[d]:c}function J(a){var b=P(a);for(var c=0,d=b.length;c<d;++c)if(b[c].nodeType==1&&I(b[c])=="none")return!0;return!1}function K(a){var b;return a.nodeType==3&&(b=a.parentNode)&&F(b,"visibility")=="hidden"}function L(a){return a&&(a.nodeType==1&&!/^(inline(-block|-table)?|none)$/.test(I(a))||a.nodeType==9||a.nodeType==11)}function M(a){var b=a.lastChild;return b?M(b):a}function N(a){return f.isCharacterDataNode(a)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(a.nodeName)}function O(a){var b=[];while(a.parentNode)b.unshift(a.parentNode),a=a.parentNode;return b}function P(a){return O(a).concat([a])}function Q(a){var b;return typeof (b=a.namespaceURI)==c||b===null||b=="http://www.w3.org/1999/xhtml"}function R(a,b){if(!a||a.nodeType!=1||!Q(a))return!1;switch(typeof b){case"string":return a.tagName.toLowerCase()==b.toLowerCase();case"object":return(new RegExp("^("+b.join("|S")+")$","i")).test(a.tagName);default:return!0}}function S(a){while(a&&!a.nextSibling)a=a.parentNode;return a?a.nextSibling:null}function T(a,b){return!b&&a.hasChildNodes()?a.firstChild:S(a)}function U(a){var b=a.previousSibling;if(b){a=b;while(a.hasChildNodes())a=a.lastChild;return a}var c=a.parentNode;return c&&c.nodeType==1?c:null}function V(a){if(!a||a.nodeType!=3)return!1;var b=a.data;if(b==="")return!0;var c=a.parentNode;if(!c||c.nodeType!=1)return!1;var d=F(a.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(b)&&/^(normal|nowrap)$/.test(d)||/^[\t\r ]+$/.test(b)&&d=="pre-line"}function W(a){if(a.data==="")return!0;if(!V(a))return!1;var b=a.parentNode;return b?J(a)?!0:!1:!0}function X(a){var b=a.nodeType;return b==7||b==8||J(a)||/^(script|style)$/i.test(a.nodeName)||K(a)||W(a)}function Y(a,b){var c=a.nodeType;return c==7||c==8||c==1&&I(a,b)=="none"}function Z(){this.store={}}function ab(a,b,c){return function(d){var e=this.cache;if(e.hasOwnProperty(a))return $++,e[a];_++;var f=b.call(this,c?this[c]:this,d);return e[a]=f,f}}function bb(a,b){this.node=a,this.session=b,this.cache=new Z,this.positions=new Z}function kb(a,b){this.offset=b,this.nodeWrapper=a,this.node=a.node,this.session=a.session,this.cache=new Z}function lb(){return"[Position("+f.inspectNode(this.node)+":"+this.offset+")]"}function pb(){return rb(),nb=new ob}function qb(){return nb||pb()}function rb(){nb&&nb.detach(),nb=null}function sb(a,c,d,e){function h(){var a=null,b=null;return c?(b=f,g||(f=f.previousVisible(),g=!f||d&&f.equals(d))):g||(b=f=f.nextVisible(),g=!f||d&&f.equals(d)),g&&(f=null),b}d&&(c?X(d.node)&&(d=a.previousVisible()):X(d.node)&&(d=d.nextVisible()));var f=a,g=!1,i,j=!1;return{next:function(){if(j)return j=!1,i;var a,b;while(a=h()){b=a.getCharacter(e);if(b)return i=a,a}return null},rewind:function(){if(!i)throw b.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");j=!0},dispose:function(){a=d=null}}}function ub(a,b,c){function g(a){var b,c,f=[],g=a?d:e,h=!1,i=!1;while(b=g.next()){c=b.character;if(l.test(c))i&&(i=!1,h=!0);else{if(h){g.rewind();break}i=!0}f.push(b)}return f}function n(a){var b=["["+a.length+"]"];for(var c=0;c<a.length;++c)b.push("(word: "+a[c]+", is word: "+a[c].isWord+")");return b}var d=sb(a,!1,null,b),e=sb(a,!0,null,b),f=c.tokenizer,h=g(!0),i=g(!1).reverse(),j=f(i.concat(h),c),k=h.length?j.slice(tb(j,h[0].token)):[],m=i.length?j.slice(0,tb(j,i.pop().token)+1):[];return{nextEndToken:function(){var a,b;while(k.length==1&&!(a=k[0]).isWord&&(b=g(!0)).length>0)k=f(a.chars.concat(b),c);return k.shift()},previousStartToken:function(){var a,b;while(m.length==1&&!(a=m[0]).isWord&&(b=g(!1)).length>0)m=f(b.reverse().concat(a.chars),c);return m.pop()},dispose:function(){d.dispose(),e.dispose(),k=m=null}}}function vb(a,b,c,f,g){var h=0,i,j=a,k,l,m=Math.abs(c),n;if(c!==0){var o=c<0;switch(b){case d:k=sb(a,o,null,f);while((i=k.next())&&h<m)++h,j=i;l=i,k.dispose();break;case e:var p=ub(a,f,g),q=o?p.previousStartToken:p.nextEndToken;while((n=q())&&h<m)n.isWord&&(++h,j=o?n.chars[0]:n.chars[n.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+b+"' not implemented")}o?(j=j.previousVisible(),h=-h):j&&j.isLeadingSpace&&(b==e&&(k=sb(a,!1,null,f),l=k.next(),k.dispose()),l&&(j=l.previousVisible()))}return{position:j,unitsMoved:h}}function wb(a,b,c,d){var e=a.getRangeBoundaryPosition(b,!0),f=a.getRangeBoundaryPosition(b,!1),g=d?f:e,h=d?e:f;return sb(g,!!d,h,c)}function xb(a,b,c){var d=[],e=wb(a,b,c),f;while(f=e.next())d.push(f);return e.dispose(),d}function yb(b,c,d){var e=a.createRange(b.node);e.setStartAndEnd(b.node,b.offset,c.node,c.offset);var f=!e.expand("word",d);return e.detach(),f}function zb(a,b,c,d,e){function r(a,b){var c=i[a].previousVisible(),d=i[b-1],f=!e.wholeWordsOnly||yb(c,d,e.wordOptions);return{startPos:c,endPos:d,valid:f}}var f=p(e.direction),g=sb(a,f,a.session.getRangeBoundaryPosition(d,f),e),h="",i=[],j,k,l,m,n,o,q=null;while(j=g.next()){k=j.character,!c&&!e.caseSensitive&&(k=k.toLowerCase()),f?(i.unshift(j),h=k+h):(i.push(j),h+=k);if(c){n=b.exec(h);if(n)if(o){l=n.index,m=l+n[0].length;if(!f&&m<h.length||f&&l>0){q=r(l,m);break}}else o=!0}else if((l=h.indexOf(b))!=-1){q=r(l,l+b.length);break}}return o&&(q=r(l,m)),g.dispose(),q}function Ab(a){return function(){var b=!!nb,c=qb(),d=[c].concat(g.toArray(arguments)),e=a.apply(this,d);return b||rb(),e}}function Bb(a,b){return Ab(function(c,e,f,g){typeof f=="undefined"&&(f=e,e=d),g=x(g,C);var h=z(g.characterOptions),i=y(g.wordOptions),j=a;b&&(j=f>=0,this.collapse(!j));var k=vb(c.getRangeBoundaryPosition(this,j),e,f,h,i),l=k.position;return this[j?"setStart":"setEnd"](l.node,l.offset),k.unitsMoved})}function Cb(a){return Ab(function(b,c){c=z(c);var d,e=wb(b,this,c,!a),f=0;while((d=e.next())&&l.test(d.character))++f;e.dispose();var g=f>0;return g&&this[a?"moveStart":"moveEnd"]("character",a?f:-f,{characterOptions:c}),g})}function Db(a){return Ab(function(b,c){var d=!1;return this.changeEachRange(function(b){d=b[a](c)||d}),d})}a.requireModules(["WrappedSelection"]);var c="undefined",d="character",e="word",f=a.dom,g=a.util,h=g.extend,i=f.getBody,j=/^[ \t\f\r\n]+$/,k=/^[ \t\f\r]+$/,l=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,m=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,n=/^[\n-\r\u0085\u2028\u2029]$/,o="en",p=a.Selection.isDirectionBackward,q=!1,r=!1,s=!0;(function(){var b=document.createElement("div");b.contentEditable="true",b.innerHTML="<p>&nbsp; </p><p></p>";var c=i(document),d=b.firstChild,e=a.getSelection();c.appendChild(b),e.collapse(d.lastChild,2),e.setStart(d.firstChild,0),q=(""+e).length==1,b.innerHTML="&nbsp; <br>",e.collapse(b,2),e.setStart(b.firstChild,0),r=(""+e).length==1,c.removeChild(b),e.removeAllRanges()})();var u={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includePreLineTrailingSpace:!0},v={includeBlockContentTrailingSpace:!s,includeSpaceBeforeBr:!r,includePreLineTrailingSpace:!0},w={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:t}},B={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},C={wordOptions:null,characterOptions:null},D={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},E={wordOptions:null,characterOptions:null,direction:"forward"},F=f.getComputedStyleProperty,G;(function(){var a=document.createElement("table"),b=i(document);b.appendChild(a),G=F(a,"display")=="block",b.removeChild(a)})(),a.features.tableCssDisplayBlock=G;var H={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};Z.prototype={get:function(a){return this.store.hasOwnProperty(a)?this.store[a]:null},set:function(a,b){return this.store[a]=b}};var $=0,_=0;a.report=function(){console.log("Cached: "+$+", uncached: "+_)};var cb={getPosition:function(a){var b=this.positions;return b.get(a)||b.set(a,new kb(this,a))},toString:function(){return"[NodeWrapper("+f.inspectNode(this.node)+")]"}};bb.prototype=cb;var db="EMPTY",eb="NON_SPACE",fb="UNCOLLAPSIBLE_SPACE",gb="COLLAPSIBLE_SPACE",hb="TRAILING_SPACE_IN_BLOCK",ib="TRAILING_SPACE_BEFORE_BR",jb="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK";h(cb,{isCharacterDataNode:ab("isCharacterDataNode",f.isCharacterDataNode,"node"),getNodeIndex:ab("nodeIndex",f.getNodeIndex,"node"),getLength:ab("nodeLength",f.getNodeLength,"node"),containsPositions:ab("containsPositions",N,"node"),isWhitespace:ab("isWhitespace",V,"node"),isCollapsedWhitespace:ab("isCollapsedWhitespace",W,"node"),getComputedDisplay:ab("computedDisplay",I,"node"),isCollapsed:ab("collapsed",X,"node"),isIgnored:ab("ignored",Y,"node"),next:ab("nextPos",T,"node"),previous:ab("previous",U,"node"),getTextNodeInfo:ab("textNodeInfo",function(a){var b=null,c=!1,d=F(a.parentNode,"whiteSpace"),e=d=="pre-line";if(e)b=k,c=!0;else if(d=="normal"||d=="nowrap")b=j,c=!0;return{node:a,text:a.data,spaceRegex:b,collapseSpaces:c,preLine:e}},"node"),hasInnerText:ab("hasInnerText",function(a,b){var c=this.session,d=c.getPosition(a.parentNode,this.getNodeIndex()+1),e=c.getPosition(a,0),f=b?d:e,g=b?e:d;while(f!==g){f.prepopulateChar();if(f.isDefinitelyNonEmpty())return!0;f=b?f.previousVisible():f.nextVisible()}return!1},"node"),getTrailingSpace:ab("trailingSpace",function(a){if(a.tagName.toLowerCase()=="br")return"";switch(this.getComputedDisplay()){case"inline":var b=a.lastChild;while(b){if(!Y(b))return b.nodeType==1?this.session.getNodeWrapper(b).getTrailingSpace():"";b=b.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"	";default:return this.hasInnerText(!0)?"\n":""}return""},"node"),getLeadingSpace:ab("leadingSpace",function(a){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.hasInnerText(!1)?"\n":""}return""},"node")});var mb={character:"",characterType:db,isBr:!1,prepopulateChar:function(){var a=this;if(!a.prepopulatedChar){var b=a.node,c=a.offset,d="",e=db,f=!1;if(c>0)if(b.nodeType==3){var g=b.data,h=g.charAt(c-1),i=a.nodeWrapper.getTextNodeInfo(),j=i.spaceRegex;i.collapseSpaces?j.test(h)?c>1&&j.test(g.charAt(c-2))||(i.preLine&&g.charAt(c)==="\n"?(d=" ",e=jb):(d=" ",e=gb)):(d=h,e=eb,f=!0):(d=h,e=fb,f=!0)}else{var k=b.childNodes[c-1];k&&k.nodeType==1&&!X(k)&&(k.tagName.toLowerCase()=="br"?(d="\n",a.isBr=!0,e=gb,f=!1):a.checkForTrailingSpace=!0);if(!d){var l=b.childNodes[c];l&&l.nodeType==1&&!X(l)&&(a.checkForLeadingSpace=!0)}}a.prepopulatedChar=!0,a.character=d,a.characterType=e,a.isCharInvariant=f}},isDefinitelyNonEmpty:function(){var a=this.characterType;return a==eb||a==fb},resolveLeadingAndTrailingSpaces:function(){this.prepopulatedChar||this.prepopulateChar();if(this.checkForTrailingSpace){var a=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();a&&(this.isTrailingSpace=!0,this.character=a,this.characterType=gb),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var b=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();b&&(this.isLeadingSpace=!0,this.character=b,this.characterType=gb),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(a){var b=this,c;while(b=b.previousVisible()){c=b.getCharacter(a);if(c!=="")return b}return null},getCharacter:function(a){function j(){return h||(g=i.getPrecedingUncollapsedPosition(a),h=!0),g}this.resolveLeadingAndTrailingSpaces();if(this.isCharInvariant)return this.character;var b=["character",a.includeSpaceBeforeBr,a.includeBlockContentTrailingSpace,a.includePreLineTrailingSpace].join("_"),c=this.cache.get(b);if(c!==null)return c;var d="",e=this.characterType==gb,f,g,h=!1,i=this;if(e){if(this.character!=" "||!!j()&&!g.isTrailingSpace&&g.character!="\n")if(this.character=="\n"&&this.isLeadingSpace)j()&&g.character!="\n"&&(d="\n");else{f=this.nextUncollapsed();if(f){f.isBr?this.type=ib:f.isTrailingSpace&&f.character=="\n"&&(this.type=hb);if(f.character==="\n"){if(this.type!=ib||!!a.includeSpaceBeforeBr)if(this.type!=hb||!f.isTrailingSpace||!!a.includeBlockContentTrailingSpace)if(this.type!=jb||f.type!=eb||!!a.includePreLineTrailingSpace)this.character==="\n"?f.isTrailingSpace?this.isTrailingSpace||!this.isBr:d="\n":this.character===" "&&(d=" ")}else d=this.character}}}else this.character!=="\n"||!!(f=this.nextUncollapsed())&&!f.isTrailingSpace;return this.cache.set(b,d),d},equals:function(a){return!!a&&this.node===a.node&&this.offset===a.offset},inspect:lb,toString:function(){return this.character}};kb.prototype=mb,h(mb,{next:ab("nextPos",function(a){var b=a.nodeWrapper,c=a.node,d=a.offset,e=b.session;if(!c)return null;var f,g,h;return d==b.getLength()?(f=c.parentNode,g=f?b.getNodeIndex()+1:0):b.isCharacterDataNode()?(f=c,g=d+1):(h=c.childNodes[d],e.getNodeWrapper(h).containsPositions()?(f=h,g=0):(f=c,g=d+1)),f?e.getPosition(f,g):null}),previous:ab("previous",function(a){var b=a.nodeWrapper,c=a.node,d=a.offset,e=b.session,g,h,i;return d==0?(g=c.parentNode,h=g?b.getNodeIndex():0):b.isCharacterDataNode()?(g=c,h=d-1):(i=c.childNodes[d-1],e.getNodeWrapper(i).containsPositions()?(g=i,h=f.getNodeLength(i)):(g=c,h=d-1)),g?e.getPosition(g,h):null}),nextVisible:ab("nextVisible",function(a){var b=a.next();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex()+1)),e}),nextUncollapsed:ab("nextUncollapsed",function(a){var b=a;while(b=b.nextVisible()){b.resolveLeadingAndTrailingSpaces();if(b.character!=="")return b}return null}),previousVisible:ab("previousVisible",function(a){var b=a.previous();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex())),e})});var nb=null,ob=function(){function a(a){var b=new Z;return{get:function(c){var d=b.get(c[a]);if(d)for(var e=0,f;f=d[e++];)if(f.node===c)return f;return null},set:function(c){var d=c.node[a],e=b.get(d)||b.set(d,[]);e.push(c)}}}function c(){this.initCaches()}var b=g.isHostProperty(document.documentElement,"uniqueID");return c.prototype={initCaches:function(){this.elementCache=b?function(){var a=new Z;return{get:function(b){return a.get(b.uniqueID)},set:function(b){a.set(b.node.uniqueID,b)}}}():a("tagName"),this.textNodeCache=a("data"),this.otherNodeCache=a("nodeName")},getNodeWrapper:function(a){var b;switch(a.nodeType){case 1:b=this.elementCache;break;case 3:b=this.textNodeCache;break;default:b=this.otherNodeCache}var c=b.get(a);return c||(c=new bb(a,this),b.set(c)),c},getPosition:function(a,b){return this.getNodeWrapper(a).getPosition(b)},getRangeBoundaryPosition:function(a,b){var c=b?"start":"end";return this.getPosition(a[c+"Container"],a[c+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},c}();h(f,{nextNode:T,previousNode:U});var tb=Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c]===b)return c;return-1};h(a.rangePrototype,{moveStart:Bb(!0,!1),moveEnd:Bb(!1,!1),move:Bb(!0,!0),trimStart:Cb(!0),trimEnd:Cb(!1),trim:Ab(function(a,b){var c=this.trimStart(b),d=this.trimEnd(b);return c||d}),expand:Ab(function(a,b,c){var f=!1;c=x(c,D);var g=z(c.characterOptions);b||(b=d);if(b==e){var h=y(c.wordOptions),i=a.getRangeBoundaryPosition(this,!0),j=a.getRangeBoundaryPosition(this,!1),k=ub(i,g,h),l=k.nextEndToken(),m=l.chars[0].previousVisible(),n,o;if(this.collapsed)n=l;else{var p=ub(j,g,h);n=p.previousStartToken()}return o=n.chars[n.chars.length-1],m.equals(i)||(this.setStart(m.node,m.offset),f=!0),o&&!o.equals(j)&&(this.setEnd(o.node,o.offset),f=!0),c.trim&&(c.trimStart&&(f=this.trimStart(g)||f),c.trimEnd&&(f=this.trimEnd(g)||f)),f}return this.moveEnd(d,1,c)}),text:Ab(function(a,b){return this.collapsed?"":xb(a,this,z(b)).join("")}),selectCharacters:Ab(function(a,b,c,d,e){var f={characterOptions:e};b||(b=i(this.getDocument())),this.selectNodeContents(b),this.collapse(!0),this.moveStart("character",c,f),this.collapse(!0),this.moveEnd("character",d-c,f)}),toCharacterRange:Ab(function(a,b,c){b||(b=i(this.getDocument()));var d=b.parentNode,e=f.getNodeIndex(b),g=f.comparePoints(this.startContainer,this.endContainer,d,e)==-1,h=this.cloneRange(),j,k;return g?(h.setStartAndEnd(this.startContainer,this.startOffset,d,e),j=-h.text(c).length):(h.setStartAndEnd(d,e,this.startContainer,this.startOffset),j=h.text(c).length),k=j+this.text(c).length,{start:j,end:k}}),findText:Ab(function(b,c,d){d=x(d,B),d.wholeWordsOnly&&(d.wordOptions=y(d.wordOptions),d.wordOptions.includeTrailingSpace=!1);var e=p(d.direction),f=d.withinRange;f||(f=a.createRange(),f.selectNodeContents(this.getDocument()));var g=c,h=!1;typeof g=="string"?d.caseSensitive||(g=g.toLowerCase()):h=!0;var i=b.getRangeBoundaryPosition(this,!e),j=f.comparePoint(i.node,i.offset);j===-1?i=b.getRangeBoundaryPosition(f,!0):j===1&&(i=b.getRangeBoundaryPosition(f,!1));var k=i,l=!1,m;for(;;){m=zb(k,g,h,f,d);if(m){if(m.valid)return this.setStartAndEnd(m.startPos.node,m.startPos.offset,m.endPos.node,m.endPos.offset),!0;k=e?m.startPos:m.endPos}else{if(!d.wrap||!!l)return!1;f=f.cloneRange(),k=b.getRangeBoundaryPosition(f,!e),f.setBoundary(i.node,i.offset,e),l=!0}}}),pasteHtml:function(a){this.deleteContents();if(a){var b=this.createContextualFragment(a),c=b.lastChild;this.insertNode(b),this.collapseAfter(c)}}}),h(a.selectionPrototype,{expand:Ab(function(a,b,c){this.changeEachRange(function(a){a.expand(b,c)})}),move:Ab(function(a,b,c,d){var e=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var f=this.getRangeAt(0);d||(d={}),d.characterOptions=A(d.characterOptions),e=f.move(b,c,d),this.setSingleRange(f)}return e}),trimStart:Db("trimStart"),trimEnd:Db("trimEnd"),trim:Db("trim"),selectCharacters:Ab(function(b,c,d,e,f,g){var h=a.createRange(c);h.selectCharacters(c,d,e,g),this.setSingleRange(h,f)}),saveCharacterRanges:Ab(function(a,b,c){var d=this.getAllRanges(),e=d.length,f=[],g=e==1&&this.isBackward();for(var h=0,i=d.length;h<i;++h)f[h]={characterRange:d[h].toCharacterRange(b,c),backward:g,characterOptions:c};return f}),restoreCharacterRanges:Ab(function(b,c,d){this.removeAllRanges();for(var e=0,f=d.length,g,h,i;e<f;++e)h=d[e],i=h.characterRange,g=a.createRange(c),g.selectCharacters(c,i.start,i.end,h.characterOptions),this.addRange(g,h.backward)}),text:Ab(function(a,b){var c=[];for(var d=0,e=this.rangeCount;d<e;++d)c[d]=this.getRangeAt(d).text(b);return c.join("")})}),a.innerText=function(b,c){var d=a.createRange(b);d.selectNodeContents(b);var e=d.text(c);return d.detach(),e},a.createWordIterator=function(a,b,c){var d=qb();c=x(c,E);var e=z(c.characterOptions),f=y(c.wordOptions),g=d.getPosition(a,b),h=ub(g,e,f),i=p(c.direction);return{next:function(){return i?h.previousStartToken():h.nextEndToken()},dispose:function(){h.dispose(),this.next=function(){}}}},a.noMutation=function(a){var b=qb();a(b),rb()},a.noMutation.createEntryPointFunction=Ab,a.textRange={isBlockNode:L,isCollapsedWhitespaceNode:W,createPosition:Ab(function(a,b,c){return a.getPosition(b,c)})}})

rangy.createModule("CssClassApplier",function(i,v){function r(a,b){return a.className&&RegExp("(?:^|\\s)"+b+"(?:\\s|$)").test(a.className)}function s(a,b){if(a.className)r(a,b)||(a.className+=" "+b);else a.className=b}function o(a){return a.split(/\s+/).sort().join(" ")}function w(a,b){return o(a.className)==o(b.className)}function x(a){for(var b=a.parentNode;a.hasChildNodes();)b.insertBefore(a.firstChild,a);b.removeChild(a)}function y(a,b){var c=a.cloneRange();c.selectNodeContents(b);var d=c.intersection(a);
d=d?d.toString():"";c.detach();return d!=""}function z(a){return a.getNodes([3],function(b){return y(a,b)})}function A(a,b){if(a.attributes.length!=b.attributes.length)return false;for(var c=0,d=a.attributes.length,e,f;c<d;++c){e=a.attributes[c];f=e.name;if(f!="class"){f=b.attributes.getNamedItem(f);if(e.specified!=f.specified)return false;if(e.specified&&e.nodeValue!==f.nodeValue)return false}}return true}function B(a,b){for(var c=0,d=a.attributes.length,e;c<d;++c){e=a.attributes[c].name;if(!(b&&
h.arrayContains(b,e))&&a.attributes[c].specified&&e!="class")return true}return false}function C(a){var b;return a&&a.nodeType==1&&((b=a.parentNode)&&b.nodeType==9&&b.designMode=="on"||k(a)&&!k(a.parentNode))}function D(a){return(k(a)||a.nodeType!=1&&k(a.parentNode))&&!C(a)}function E(a){return a&&a.nodeType==1&&!M.test(p(a,"display"))}function N(a){if(a.data.length==0)return true;if(O.test(a.data))return false;switch(p(a.parentNode,"whiteSpace")){case "pre":case "pre-wrap":case "-moz-pre-wrap":return false;
case "pre-line":if(/[\r\n]/.test(a.data))return false}return E(a.previousSibling)||E(a.nextSibling)}function m(a,b,c,d){var e,f=c==0;if(h.isAncestorOf(b,a))return a;if(h.isCharacterDataNode(b))if(c==0){c=h.getNodeIndex(b);b=b.parentNode}else if(c==b.length){c=h.getNodeIndex(b)+1;b=b.parentNode}else throw v.createError("splitNodeAt should not be called with offset in the middle of a data node ("+c+" in "+b.data);var g;g=b;var j=c;g=h.isCharacterDataNode(g)?j==0?!!g.previousSibling:j==g.length?!!g.nextSibling:
true:j>0&&j<g.childNodes.length;if(g){if(!e){e=b.cloneNode(false);for(e.id&&e.removeAttribute("id");f=b.childNodes[c];)e.appendChild(f);h.insertAfter(e,b)}return b==a?e:m(a,e.parentNode,h.getNodeIndex(e),d)}else if(a!=b){e=b.parentNode;b=h.getNodeIndex(b);f||b++;return m(a,e,b,d)}return a}function F(a){var b=a?"nextSibling":"previousSibling";return function(c,d){var e=c.parentNode,f=c[b];if(f){if(f&&f.nodeType==3)return f}else if(d)if((f=e[b])&&f.nodeType==1&&e.tagName==f.tagName&&w(e,f)&&A(e,f))return f[a?
"firstChild":"lastChild"];return null}}function t(a){this.firstTextNode=(this.isElementMerge=a.nodeType==1)?a.lastChild:a;this.textNodes=[this.firstTextNode]}function q(a,b,c){this.cssClass=a;var d,e,f=null;if(typeof b=="object"&&b!==null){c=b.tagNames;f=b.elementProperties;for(d=0;e=P[d++];)if(b.hasOwnProperty(e))this[e]=b[e];d=b.normalize}else d=b;this.normalize=typeof d=="undefined"?true:d;this.attrExceptions=[];d=document.createElement(this.elementTagName);this.elementProperties={};for(var g in f)if(f.hasOwnProperty(g)){if(G.hasOwnProperty(g))g=
G[g];d[g]=f[g];this.elementProperties[g]=d[g];this.attrExceptions.push(g)}this.elementSortedClassName=this.elementProperties.hasOwnProperty("className")?o(this.elementProperties.className+" "+a):a;this.applyToAnyTagName=false;a=typeof c;if(a=="string")if(c=="*")this.applyToAnyTagName=true;else this.tagNames=c.toLowerCase().replace(/^\s\s*/,"").replace(/\s\s*$/,"").split(/\s*,\s*/);else if(a=="object"&&typeof c.length=="number"){this.tagNames=[];d=0;for(a=c.length;d<a;++d)if(c[d]=="*")this.applyToAnyTagName=
true;else this.tagNames.push(c[d].toLowerCase())}else this.tagNames=[this.elementTagName]}i.requireModules(["WrappedSelection","WrappedRange"]);var h=i.dom,H=function(){function a(b,c,d){return c&&d?" ":""}return function(b,c){if(b.className)b.className=b.className.replace(RegExp("(?:^|\\s)"+c+"(?:\\s|$)"),a)}}(),p;if(typeof window.getComputedStyle!="undefined")p=function(a,b){return h.getWindow(a).getComputedStyle(a,null)[b]};else if(typeof document.documentElement.currentStyle!="undefined")p=function(a,
b){return a.currentStyle[b]};else v.fail("No means of obtaining computed style properties found");var k;(function(){k=typeof document.createElement("div").isContentEditable=="boolean"?function(a){return a&&a.nodeType==1&&a.isContentEditable}:function(a){if(!a||a.nodeType!=1||a.contentEditable=="false")return false;return a.contentEditable=="true"||k(a.parentNode)}})();var M=/^inline(-block|-table)?$/i,O=/[^\r\n\t\f \u200B]/,Q=F(false),R=F(true);t.prototype={doMerge:function(){for(var a=[],b,c,d=0,
e=this.textNodes.length;d<e;++d){b=this.textNodes[d];c=b.parentNode;a[d]=b.data;if(d){c.removeChild(b);c.hasChildNodes()||c.parentNode.removeChild(c)}}return this.firstTextNode.data=a=a.join("")},getLength:function(){for(var a=this.textNodes.length,b=0;a--;)b+=this.textNodes[a].length;return b},toString:function(){for(var a=[],b=0,c=this.textNodes.length;b<c;++b)a[b]="'"+this.textNodes[b].data+"'";return"[Merge("+a.join(",")+")]"}};var P=["elementTagName","ignoreWhiteSpace","applyToEditableOnly"],
G={"class":"className"};q.prototype={elementTagName:"span",elementProperties:{},ignoreWhiteSpace:true,applyToEditableOnly:false,hasClass:function(a){return a.nodeType==1&&h.arrayContains(this.tagNames,a.tagName.toLowerCase())&&r(a,this.cssClass)},getSelfOrAncestorWithClass:function(a){for(;a;){if(this.hasClass(a,this.cssClass))return a;a=a.parentNode}return null},isModifiable:function(a){return!this.applyToEditableOnly||D(a)},isIgnorableWhiteSpaceNode:function(a){return this.ignoreWhiteSpace&&a&&
a.nodeType==3&&N(a)},postApply:function(a,b,c){for(var d=a[0],e=a[a.length-1],f=[],g,j=d,I=e,J=0,K=e.length,n,L,l=0,u=a.length;l<u;++l){n=a[l];if(L=Q(n,!c)){if(!g){g=new t(L);f.push(g)}g.textNodes.push(n);if(n===d){j=g.firstTextNode;J=j.length}if(n===e){I=g.firstTextNode;K=g.getLength()}}else g=null}if(a=R(e,!c)){if(!g){g=new t(e);f.push(g)}g.textNodes.push(a)}if(f.length){l=0;for(u=f.length;l<u;++l)f[l].doMerge();b.setStart(j,J);b.setEnd(I,K)}},createContainer:function(a){a=a.createElement(this.elementTagName);
i.util.extend(a,this.elementProperties);s(a,this.cssClass);return a},applyToTextNode:function(a){var b=a.parentNode;if(b.childNodes.length==1&&h.arrayContains(this.tagNames,b.tagName.toLowerCase()))s(b,this.cssClass);else{b=this.createContainer(h.getDocument(a));a.parentNode.insertBefore(b,a);b.appendChild(a)}},isRemovable:function(a){var b;if(b=a.tagName.toLowerCase()==this.elementTagName){if(b=o(a.className)==this.elementSortedClassName){var c;a:{b=this.elementProperties;for(c in b)if(b.hasOwnProperty(c)&&
a[c]!==b[c]){c=false;break a}c=true}b=c&&!B(a,this.attrExceptions)&&this.isModifiable(a)}b=b}return b},undoToTextNode:function(a,b,c){if(!b.containsNode(c)){a=b.cloneRange();a.selectNode(c);if(a.isPointInRange(b.endContainer,b.endOffset)){m(c,b.endContainer,b.endOffset,[b]);b.setEndAfter(c)}if(a.isPointInRange(b.startContainer,b.startOffset))c=m(c,b.startContainer,b.startOffset,[b])}this.isRemovable(c)?x(c):H(c,this.cssClass)},applyToRange:function(a){a.splitBoundaries();var b=z(a);if(b.length){for(var c,
d=0,e=b.length;d<e;++d){c=b[d];!this.isIgnorableWhiteSpaceNode(c)&&!this.getSelfOrAncestorWithClass(c)&&this.isModifiable(c)&&this.applyToTextNode(c)}a.setStart(b[0],0);c=b[b.length-1];a.setEnd(c,c.length);this.normalize&&this.postApply(b,a,false)}},applyToSelection:function(a){a=a||window;a=i.getSelection(a);var b,c=a.getAllRanges();a.removeAllRanges();for(var d=c.length;d--;){b=c[d];this.applyToRange(b);a.addRange(b)}},undoToRange:function(a){a.splitBoundaries();var b=z(a),c,d,e=b[b.length-1];if(b.length){for(var f=
0,g=b.length;f<g;++f){c=b[f];(d=this.getSelfOrAncestorWithClass(c))&&this.isModifiable(c)&&this.undoToTextNode(c,a,d);a.setStart(b[0],0);a.setEnd(e,e.length)}this.normalize&&this.postApply(b,a,true)}},undoToSelection:function(a){a=a||window;a=i.getSelection(a);var b=a.getAllRanges(),c;a.removeAllRanges();for(var d=0,e=b.length;d<e;++d){c=b[d];this.undoToRange(c);a.addRange(c)}},getTextSelectedByRange:function(a,b){var c=b.cloneRange();c.selectNodeContents(a);var d=c.intersection(b);d=d?d.toString():
"";c.detach();return d},isAppliedToRange:function(a){if(a.collapsed)return!!this.getSelfOrAncestorWithClass(a.commonAncestorContainer);else{for(var b=a.getNodes([3]),c=0,d;d=b[c++];)if(!this.isIgnorableWhiteSpaceNode(d)&&y(a,d)&&this.isModifiable(d)&&!this.getSelfOrAncestorWithClass(d))return false;return true}},isAppliedToSelection:function(a){a=a||window;a=i.getSelection(a).getAllRanges();for(var b=a.length;b--;)if(!this.isAppliedToRange(a[b]))return false;return true},toggleRange:function(a){this.isAppliedToRange(a)?
this.undoToRange(a):this.applyToRange(a)},toggleSelection:function(a){this.isAppliedToSelection(a)?this.undoToSelection(a):this.applyToSelection(a)},detach:function(){}};q.util={hasClass:r,addClass:s,removeClass:H,hasSameClasses:w,replaceWithOwnChildren:x,elementsHaveSameNonClassAttributes:A,elementHasNonClassAttributes:B,splitNodeAt:m,isEditableElement:k,isEditingHost:C,isEditable:D};i.CssClassApplier=q;i.createCssClassApplier=function(a,b,c){return new q(a,b,c)}});

rangy.createModule("Commands",function(d,m){function g(k){return k&&1==k.nodeType&&k.isContentEditable}function h(k,a){var c;!(c=!a||!a.applyToEditableOnly)&&(c=g(k)||g(k.parentNode))&&(c=!(k&&(9==k.nodeType&&"on"==k.designMode||g(k)&&!g(k.parentNode))));return c}function f(k,a){var c=r.comparePoints(k,0,a.startContainer,a.startOffset),b=r.comparePoints(k,r.getNodeLength(k),a.endContainer,a.endOffset);return G(k)==G(a.startContainer)&&1==c&&-1==b}function c(k,a){if(f(k,a))return!0;var b=r.isCharacterDataNode(k);
if(k==a.startContainer&&b&&r.getNodeLength(k)!=a.startOffset||k==a.endContainer&&b&&0!=a.endOffset)return!0;var b=k.childNodes,e=b.length;if(0!=e){for(var d=0;d<e;++d)if(!c(b[d],a))return!1;return!0}return!1}function a(k){var a;return"undefined"==typeof(a=k.namespaceURI)||null===a||"http://www.w3.org/1999/xhtml"==a}function b(k){return r.isCharacterDataNode(k)||1==k.nodeType&&p.test(H(k,"display"))}function e(k){return b(k)&&"br"!=k.nodeName.toLowerCase()}function n(k,b){if(!k||1!=k.nodeType||!a(k))return!1;
switch(typeof b){case "string":return k.tagName.toLowerCase()==b.toLowerCase();case "object":return(new RegExp("^("+b.join(",")+")$","i")).test(k.tagName);default:return!0}}function u(k,a){return n(k)?b(k)&&h(k,a)?q.test(k.tagName):!0:!1}function M(k,a){return 8==k.nodeType||3==k.nodeType&&(k.parentNode&&/^(script|style)$/i.test(k.parentNode.tagName)||a.ignoreWhiteSpace&&!/[^\r\n\t ]/.test(k.data)&&(u(k.previousSibling,a)||u(k.nextSibling,a)))?!0:!1}function N(k,a){if(!n(k))return!1;if(a&&a.command.isModifiableElement)return a.command.isModifiableElement(el,
a);var b=k.tagName.toLowerCase();if(x.test(b))b=["style","class"];else if("a"==b)b=["style","class","href"];else if("font"==b)b=["style","class","color","face","size"];else return!1;a:{for(var c=0,e=k.attributes.length,d;c<e;++c)if(d=k.attributes[c].name,k.attributes[c].specified&&(!b||!r.arrayContains(b,d))){b=!1;break a}b=!0}return b}function v(k,a){if(!n(k))return!1;if(a&&a.command.isSimpleModifiableElement)return a.command.isSimpleModifiableElement(k,a);var b=k.tagName.toLowerCase();if(!y.test(b))return!1;
for(var c,e=!1,d=0,l=k.attributes.length;d<l;++d)if(k.attributes[d].specified){if(e)return!1;c=k.attributes[d].name;k.getAttribute(c);e=!0}return!e||"style"==c&&0==k.style.cssText.length||"a"==b&&"href"==c||"font"==b&&/^(color|face|size)$/.test(c)?!0:"style"!=c||"number"==typeof k.style.length&&1<k.style.length||!/^[a-z\-]+:[^;]+;?\s?$/i.test(k.style.cssText)?!1:("b"==b||"strong"==b)&&""!=k.style.fontWeight||("i"==b||"em"==b)&&""!=k.style.fontStyle||("sub"==b||"sup"==b)&&""!=k.style.verticalAlign||
("span"==b||"font"==b)&&""!=k.style.fontSize||("a"==b||"font"==b||"span"==b)&&""==k.style.textDecoration||("h1"==b||"h2"==b||"h3"==b||"p"==b||"td"==b)&&""!=k.style.textAlign||/^(a|font|s|span|strike|u|del)$/.test(b)&&/^(line-through|underline|overline|none)$/.test(k.style.textDecoration)?!0:!1}function B(b,a,c,e){-1==c&&(c=a.childNodes.length);for(var d=b.parentNode,l=r.getNodeIndex(b),f=[],n=0,q=e.length;n<q;++n){var p=e[n],u=p.startContainer,g=p.startOffset,x=p.endContainer,h=p.endOffset,A=u,y=
g,m=x,t=h;u==a&&g>c&&y++;x==a&&h>c&&t++;u!=d||g!=l&&g!=l+1||(A=a,y+=c-l);x!=d||h!=l&&h!=l+1||(m=a,t+=c-l);u==d&&g>l+1&&y--;x==d&&h>l+1&&t--;A==u&&y==g&&m==x&&t==h&&f.push([p,A,y,m,t])}a.childNodes.length==c?a.appendChild(b):a.insertBefore(b,a.childNodes[c]);for(b=0;a=f[b++];){try{a[0].setStart(a[1],a[2])}catch(N){}try{a[0].setEnd(a[3],a[4])}catch(M){}}}function Q(a,b){b=b||[];for(var c;c=a.next();)a.isPartiallySelectedSubtree()?(c=a.getSubtreeIterator(),Q(c,b),c.detach(!0)):b.push(c);return b}function I(a,
b,c,e,d){for(var l,f=[];l=a.firstChild;)B(l,b,c++,d),f.push(l);e&&a.parentNode.removeChild(a);return f}function J(a,b){return I(a,a.parentNode,r.getNodeIndex(a),!0,b)}function P(a,b){for(var c=a.attributes,e=0,d=c.length;e<d;++e)c[e].specified&&("style"==c[e].name?b.style.cssText=b.style.cssText:b.setAttribute(c[e].name,c[e].value))}function O(a,b){var c=b.command,e=b.rangesToPreserve;if(null===c.getSpecifiedValue(a,b))return[];if(v(a,b))return J(a,e);c.clearValue&&c.clearValue(a,b);null!==c.relevantCssProperty&&
(a.style[c.relevantCssProperty]="",""==a.style.cssText&&a.removeAttribute("style"));if(null===c.getSpecifiedValue(a,b))return[];c=r.getDocument(a).createElement("span");P(a,c);a.parentNode.insertBefore(c,a);I(a,c,0,!0,e);return[c]}function t(a,b,c){return null===b||null===c?b===c:a.valuesEqual(b,c)}function w(a,b){var c=1==a.nodeType;return c||a.parentNode&&1==a.parentNode.nodeType?c?b.command.getEffectiveValue(a,b):w(a.parentNode,b):null}function K(a,c,e,d){var l=a[0],f=d.options;d=d.rangesToPreserve;
var q,p;if(!a.length||!h(l,f))return null;var g=a[a.length-1];b(g)&&!n(g,"br")&&n(g.nextSibling,"br")&&a.push(g.nextSibling);var u=l.previousSibling,x=g.nextSibling;e=h(u,f)&&c(u)?u:h(x,f)&&c(x)?x:e();if(!e)return null;var u=r.getDocument(e),A=e.parentNode,x=l.parentNode;if(!A)for(x.insertBefore(e,l),q=0;p=d[q++];)p.startContainer==A&&p.startOffset==r.getNodeIndex(e)&&p.setStart(p.startContainer,p.startOffset+1),p.endContainer==A&&p.endOffset==r.getNodeIndex(e)&&p.setEnd(p.endContainer,p.endOffset+
1);q=e.parentNode;p=l.parentNode;q=q&&p?-1==r.comparePoints(e.parentNode,r.getNodeIndex(e),l.parentNode,r.getNodeIndex(l)):!q;if(q)for(!b(e)&&b(e.lastChild)&&b(l)&&!n(e.lastChild,"br")&&e.appendChild(u.createElement("br")),q=0,l=a.length;q<l;++q)B(a[q],e,-1,d);else for(!b(e)&&b(e.firstChild)&&b(g)&&!n(g,"br")&&e.insertBefore(u.createElement("br"),e.firstChild),q=a.length-1;0<=q;q--)B(a[q],e,0,d);h(x,f)&&!x.hasChildNodes()&&x.parentNode.removeChild(x);a=e.nextSibling;if(h(a,f)&&c(a)){for(!b(e)&&b(e.lastChild)&&
b(a.firstChild)&&!n(e.lastChild,"br")&&e.appendChild(u.createElement("br"));a.hasChildNodes();)B(a.firstChild,e,-1,d);e.parentNode.removeChild(a)}if(e&&1==e.nodeType&&!b(e)){c=e.previousSibling;var y;n(c,"br")&&b(y=e.previousSibling.previousSibling)&&!n(y,"br")&&e.parentNode.removeChild(c)}if(e&&1==e.nodeType&&!b(e)){y=e.lastChild;var m;2<=e.childNodes.length&&n(e.lastChild,"br")&&b(m=e.lastChild.previousSibling)&&!n(m,"br")&&e.removeChild(y)}return e}function z(a,b,c,e,d){for(var l=a[d],f=e.rangesToPreserve;N(l,
e)&&1==l.childNodes.length&&N(l.firstChild,e)&&(!v(l,e)||!t(b,b.getSpecifiedValue(l,e),c));)l=l.firstChild;v(l,e)&&t(b,b.getSpecifiedValue(l,e),c)&&t(b,w(l,e),c)&&l!=a[d]&&(I(l,l.parentNode,r.getNodeIndex(l),!1,f),a.parentNode.insertBefore(l,a[d]),B(l.nextSibling,l,l.childNodes.length,f))}function D(a,b,c){if(-1==",br,".indexOf(","+a.nodeName.toLowerCase()+",")){var e,l,d,f;f=a.nodeType;var n=c.command;e=c.rangesToPreserve;l=c.options;if(a.parentNode&&null!==b){/^(1|3|4|7)$/.test(""+f)&&!u(a,l)&&
(z(a,n,b,c,"previousSibling"),z(a,n,b,c,"nextSibling"),K([a],function(a){return v(a,c)&&t(n,n.getSpecifiedValue(a,c),b)&&t(n,w(a,c),b)},function(){return null},c));var q=!1;try{if("fontSize"==n.relevantCssProperty&&t(n,w(a,c),b)){d=!1;for(var p=a;;)if(3==p.nodeType)p=p.parentNode;else if(1==p.nodeType){if(""!=p.style.fontSize){d=!0;break}if(p.tagName&&"BODY"==p.tagName)break;p=p.parentNode}else break;q=1==d?!1:!0}}catch(g){q=!1}if(q||!t(n,w(a,c),b))if(u(a,l)){if("colgroup"!=a.tagName.toLowerCase()){f=
[];l=0;d=a.childNodes.length;for(p=null;l<d;++l){e=a.childNodes[l];if(1==e.nodeType&&(p=n.getSpecifiedValue(e,c),null!==p&&(q||!t(n,b,p))))continue;f.push(e)}"1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag&&1>=a.childNodes.length&&(""==a.innerHTML||"<br>"==a.innerHTML)&&("<br>"==a.innerHTML?DEXTTOP.DEXT5.browser.safari||"windows"!=DEXTTOP.DEXT5.UserAgent.os.name.toLowerCase()?a.childNodes[0]||(q=document.createElement("br"),a.appendChild(q)):(q=document.createTextNode("\u200b"),a.childNodes[0]?
(e=a.childNodes[0],a.insertBefore(q,e),a.removeChild(e)):a.appendChild(q)):(q=document.createTextNode("\u200b"),a.appendChild(q)),f.push(a.childNodes[0]));for(l=0;e=f[l++];)D(e,b,c)}}else if(4!=f&&7!=f&&(q||!t(n,w(a,c),b)))if(d=null,1==f&&"span"==a.nodeName.toLowerCase()&&n.relevantCssProperty&&-1<",color,backgroundColor,fontFamily,fontSize,".indexOf(","+n.relevantCssProperty+","))a.style[n.relevantCssProperty]=b;else if(!l.styleWithCss&&n.createNonCssElement&&(d=n.createNonCssElement(a,b,c)),d||
(d=n.createCssElement?n.createCssElement(r.getDocument(a),c):r.getDocument(a).createElement("span")),a.parentNode.insertBefore(d,a),l=n.relevantCssProperty,null===l||!q&&t(n,w(d,c),b)||(d.style[l]=b),n.styleCssElement&&n.styleCssElement(d,b),B(a,d,d.childNodes.length,e),1==f&&(q||!t(n,w(a,c),b)))if(B(a,d.parentNode,r.getNodeIndex(d),e),d.parentNode.removeChild(d),"span"==d.tagName.toLowerCase()&&(n.hasSpecialSpanStyling&&n.hasSpecialSpanStyling(b)||null!==l))null!==l&&(a.style[l]=b),n.styleSpanChildElement&&
n.styleSpanChildElement(a,b);else{f=[];l=0;for(d=a.childNodes.length;l<d;++l){e=a.childNodes[l];if(1==e.nodeType&&(p=n.getSpecifiedValue(e,c),null!==p&&(q||!t(n,b,p))))continue;f.push(e)}l=0;for(d=f.length;l<d;++l)D(f[l],b,c)}}}}function L(a,b){for(var c=l(a.childNodes),e=0,d=c.length;e<d;++e)E(c[e],b)}function E(a,b){var c,e;c=a.nodeType;if(9==c)for(c=0;c<a.childNodes.length;++c){if(e=a.childNodes[c],1==e.nodeType){E(e,b);break}}else if(11==c)L(a,b);else if(a.parentNode&&10!=c&&!M(a,b.options)){if(h(a,
b.options)){if(1==c){var d=O(a,b);c=0;for(e=d.length;c<e;++c)E(d[c],b);if(!a.parentNode)return}c=b.command;var n=b.value,d=b.options;if((e=a.parentNode)&&1==e.nodeType&&!t(c,w(a,b),n)){var f=e;for(e=[];h(f,d)&&1==f.nodeType&&!t(c,w(f,b),n);)e.push(f),f=f.parentNode;if(0!=e.length){var d=e[e.length-1],q=c.getSpecifiedValue(d,b);if(null!==q||q==n)if(null===n||t(c,w(d.parentNode,b),n))for(;e.length;){f=e.pop();null!==c.getSpecifiedValue(f,b)&&(q=c.getSpecifiedValue(f,b));n=l(f.childNodes);null!==c.getSpecifiedValue(f,
b)&&O(f,b);for(var f=0,p;p=n[f++];)p!=a&&(1!=p.nodeType||null===c.getSpecifiedValue(p,b)||t(c,q,c.getSpecifiedValue(p,b)))&&p!=d&&D(p,q,b)}}}D(a,b.value,b)}L(a,b)}}function C(){}function F(a){var b=a.toLowerCase();if(A.hasOwnProperty(b))return A[b];throw m.createError("getCommand(): No command registered with the name '"+a+"'");}d.requireModules(["WrappedSelection","WrappedRange"]);var r=d.dom,G=r.getRootContainer,H;"undefined"!=typeof window.getComputedStyle?H=function(a,b){var c=r.getWindow(a).getComputedStyle(a,
null)[b];if("fontSize"==b)try{-1<c.indexOf("px")&&"undefined"!=typeof document.documentElement.currentStyle?c=a.currentStyle[b]:a.style&&a.style.fontSize&&-1<a.style.fontSize.indexOf("pt")&&(c=a.style.fontSize)}catch(e){}else if("backgroundColor"==b&&"transparent"==c&&a.parentNode)try{if(1!=a.nodeType||"html"!=a.nodeName.toLowerCase()&&"body"!=a.nodeName.toLowerCase())c=r.getWindow(a.parentNode).getComputedStyle(a.parentNode,null)[b]}catch(d){}return c}:"undefined"!=typeof document.documentElement.currentStyle?
H=function(a,b){return a.currentStyle[b]}:m.fail("No means of obtaining computed style properties found");var l;(function(){var a=document.createElement("div");a.appendChild(document.createElement("span"));var b=Array.prototype.slice;try{1==b.call(a.childNodes,0)[0].nodeType&&(l=function(a){return b.call(a,0)})}catch(c){}l||(l=function(a){for(var b=0,c=a.length,e=[];b<c;++b)e[b]=a[b];return e})})();var q=/^(h[1-6]|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|div|table|caption|colgroup|col|tbody|thead|tfoot|tr|th|td|address)$/i,
p=/^inline(-block|-table)?$/i,x=/^(b|em|i|s|span|strike|strong|sub|sup|u|del)$/,y=/^(b|em|i|s|span|strike|strong|sub|sup|u|del|a|font|h1|h2|h3|h4|h5|h6|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|div|table|caption|colgroup|col|tbody|thead|tfoot|tr|th|td|address)$/;C.prototype={relevantCssProperty:null,getSpecifiedValue:function(){return null},clearValue:function(){},getEffectiveValue:function(a,b){return H(a,this.relevantCssProperty)},createCssElement:null,createNonCssElement:null,styleCssElement:null,
hasSpecialSpanStyling:null,styleSpanChildElement:null,isSimpleModifiableElement:null,defaultOptions:null,addDefaultOptions:null,valuesEqual:function(a,b){return a===b},createContext:function(a,b,c){var e=this.defaultOptions;if(e)for(var d in e)e.hasOwnProperty(d)&&!c.hasOwnProperty(d)&&(c[d]=e[d]);return{command:this,value:a,rangesToPreserve:b||[],options:c||{}}},getSelectionValue:function(){return null},getNewRangeValue:function(){return null},getNewSelectionValue:function(){return null},applyToRange:function(a,
b,c,e){a=this.createContext(b,[e],c);a.value=this.getNewRangeValue(e,a);this.applyValueToRange(e,a)},applyToSelection:function(a,b,c){a=r.getWindow(a);a=d.getSelection(a);var e=a.getAllRanges();b=this.createContext(b,e,c);b.value=this.getNewSelectionValue(a,b);c=0;for(var l=e.length;c<l;++c)this.applyValueToRange(e[c],b);a.setRanges(e)}};C.util={getComputedStyleProperty:H,getFurthestAncestor:function(a){for(;null!=a.parentNode;)a=a.parentNode;return a},isContained:f,isEffectivelyContained:c,isHtmlNode:a,
isHtmlElement:n,isInlineNode:b,isUnwrappable:u,blockExtend:function(a){for(var b=a.startContainer,c=a.startOffset,d=a.endContainer,l=a.endOffset,f,n;;)if(r.isCharacterDataNode(b)||0==c)c=r.getNodeIndex(b),b=b.parentNode;else if(c==r.getNodeLength(b))c=1+r.getNodeIndex(b),b=b.parentNode;else if((f=b.childNodes[c])&&e(f)&&e(f.previousSibling))c--;else break;for(;;)if(0==l)l=r.getNodeIndex(d),d=d.parentNode;else if(r.isCharacterDataNode(d)||l==r.getNodeLength(d))l=1+r.getNodeIndex(d),d=d.parentNode;
else if((n=d.childNodes[l])&&e(n)&&e(n.previousSibling))l++;else break;a=a.cloneRange();a.setStart(b,c);a.setEnd(d,l);return a},isModifiableElement:N,isSimpleModifiableElement:v,moveChildrenPreservingRanges:I,replaceWithOwnChildren:J,copyAttributes:P,getEffectiveValue:w,getEffectiveTextNodes:function(a,b){return a.getNodes([3],function(e){return c(e,a)&&!M(e,b.options)})},setNodeValue:E,wrap:K,decomposeRange:function(a,b){if(a.startContainer==a.endContainer&&a.startOffset==a.endOffset)return[];a.splitBoundaries(b);
for(var c=a.cloneRange();0==c.startOffset&&c.startContainer.parentNode;)c.setStart(c.startContainer.parentNode,r.getNodeIndex(c.startContainer));for(;c.endOffset==r.getNodeLength(c.endContainer)&&c.endContainer.parentNode;)c.setEnd(c.endContainer.parentNode,1+r.getNodeIndex(c.endContainer));var c=new rangy.DomRange.RangeIterator(c,!1),e=Q(c);c.detach();return e},setGlobalOption:function(a,b){}};C.create=function(a,b){var c=new C;a.prototype=c;if("object"==typeof b)for(var e in b)b.hasOwnProperty(e)&&
(c[e]=b[e])};var A={};d.registerCommand=function(a,b){if(!(b instanceof C))throw m.createError("registerCommand(): Object supplied is not a Command");A[a.toLowerCase()]=b};d.execCommand=function(a,b,c){b=b||{};var e=b.hasOwnProperty("document")?b.document:document,d=b.hasOwnProperty("value")?b.value:null;a=F(a);c?a.applyToRange(e,d,b,c):a.applyToSelection(e,d,b)};d.queryCommandValue=function(a,b,c){b=b||{};var e=b.hasOwnProperty("document")?r.getWindow(b.document):window;c=b.hasOwnProperty("value")?
b.value:null;a=F(a);e=d.getSelection(e);b=a.createContext(c,null,b);return a.getSelectionValue(e,b)};d.getCommand=F;d.Command=C});function getRangeCorrectly(d,m){var g=[];try{for(var h=m.startContainer,f=m.endContainer,c=d.length,a=!1,b=0;b<c;b++)a=!1,0==b&&1<c?3==h.nodeType&&m.startOffset==h.length&&(a=!0):b==c-1&&1<c&&3==f.nodeType&&0==m.endOffset&&(a=!0),0==a&&g.push(d[b])}catch(e){return d}return g}
function convertRgbToHex(d){return"black"==d.toLowerCase()?"#000000":d.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,function(d,g,h,f){d=[g,h,f];for(g=0;3>g;g++)d[g]=("0"+parseInt(d[g],10).toString(16)).slice(-2);return"#"+d.join("")})}function getChildToArray(d){var m=[];d=d.childNodes;for(var g=0,h=d.length;g<h;g++)m.push(d[g]);return m}
function checkSameParent(d){var m=null,g=!1;d&&d[0].parentNode&&"span"==d[0].parentNode.nodeName.toLowerCase()&&(g=!0);if(g)for(var h=0,f=d.length;h<f;++h){if(m&&m!=d[h].parentNode){g=!1;break}m=d[h].parentNode}if(g)for(var c=m.childNodes,h=0,f=c.length;h<f;++h)if((1!=c[h].nodeType||"br"!=c[h].nodeName.toLowerCase())&&-1==d.indexOf(c[h])){g=!1;break}return g?(d=[],d.push(m),d):null}
rangy.createModule("BoldCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"fontWeight",defaultOptions:{tagName:"b",ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.fontWeight||(/^(strong|b)$/i.test(c.tagName)?"bold":null)},valuesEqual:function(c,a){c=(""+c).toLowerCase();a=(""+a).toLowerCase();return c==a||"bold"==c&&"700"==a||"bold"==a&&"700"==c||"normal"==c&&"400"==a||"normal"==a&&"400"==c},createNonCssElement:function(c,
a,b){return"bold"==a||"700"==a?h.getDocument(c).createElement(b.options.tagName):null},isBoldCssValue:function(c){return/^(bold|700|800|900)$/.test(c)},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==b.length)return this.isBoldCssValue(f.getEffectiveValue(c.commonAncestorContainer,a));for(;e--;)if(d=f.getEffectiveValue(b[e],a),!this.isBoldCssValue(d))return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],
a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"normal":"bold"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"normal":"bold"},applyValueToRange:function(c,a){for(var b=f.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=0,d=b.length;e<d;++e)f.setNodeValue(b[e],a)}});d.registerCommand("bold",new g)});
rangy.createModule("ItalicCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"fontStyle",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.fontStyle||(/^(em|i)$/i.test(c.tagName)?"italic":null)},createNonCssElement:function(c,a){return"italic"==a?h.getDocument(c).createElement("i"):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==b.length)return"italic"==
f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),"italic"!=d)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"normal":"italic"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"normal":"italic"},applyValueToRange:function(c,a){for(var b=f.decomposeRange(c,a.rangesToPreserve),
b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=0,d=b.length;e<d;++e)f.setNodeValue(b[e],a)}});d.registerCommand("italic",new g)});
rangy.createModule("UnderlineCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"textDecoration",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.textDecoration||(/^(u)$/i.test(c.tagName)?"underline":null)},createNonCssElement:function(c,a){return"underline"==a?h.getDocument(c).createElement("u"):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==
b.length)return"underline"==f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),"underline"!=d)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"none":"underline"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"none":"underline"},applyValueToRange:function(c,a){for(var b=
f.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=0,d=b.length;e<d;++e)f.setNodeValue(b[e],a)}});d.registerCommand("underline",new g)});
rangy.createModule("StrikeThroughCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"textDecoration",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.textDecoration||(/^(strike|del)$/i.test(c.tagName)?"line-through":null)},createNonCssElement:function(c,a){return"line-through"==a?h.getDocument(c).createElement("strike"):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,
a),e=b.length,d;if(0==b.length)return"line-through"==f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),"line-through"!=d)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"none":"line-through"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"none":"line-through"},applyValueToRange:function(c,
a){for(var b=f.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=0,d=b.length;e<d;++e)f.setNodeValue(b[e],a)}});d.registerCommand("strikeThrough",new g)});
rangy.createModule("SuperScriptCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"verticalAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.verticalAlign||(/^(sup|sub)$/i.test(c.tagName)?"super":null)},createNonCssElement:function(c,a){return"super"==a?h.getDocument(c).createElement("sup"):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==
b.length)return"super"==f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),"super"!=d)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"baseline":"super"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"baseline":"super"},applyValueToRange:function(c,a){for(var b=f.decomposeRange(c,
a.rangesToPreserve),b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=0,d=b.length;e<d;++e)f.setNodeValue(b[e],a)}});d.registerCommand("superscript",new g)});
rangy.createModule("SubScriptCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"verticalAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.verticalAlign||(/^(sub|sup)$/i.test(c.tagName)?"sub":null)},createNonCssElement:function(c,a){return"sub"==a?h.getDocument(c).createElement("sub"):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==b.length)return"sub"==
f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),"sub"!=d)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"baseline":"sub"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"baseline":"sub"},applyValueToRange:function(c,a){for(var b=f.decomposeRange(c,a.rangesToPreserve),
b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=0,d=b.length;e<d;++e)f.setNodeValue(b[e],a)}});d.registerCommand("subscript",new g)});
rangy.createModule("JustifyLeftCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"textAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.textAlign||(/^(p)$/i.test(c.tagName)?"left":null)},createNonCssElement:function(c,a){return"left"==a?h.getDocument(c).createElement("p"):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==b.length)return"left"==
f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),"left"!=d)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"":"left"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"":"left"},applyValueToRange:function(c,a){for(var b=f.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,
a.rangesToPreserve[0]),e=0,d=b.length;e<d;++e)f.setNodeValue(b[e],a)}});d.registerCommand("justifyLeft",new g)});
rangy.createModule("JustifyCenterCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"textAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.textAlign||(/^(p)$/i.test(c.tagName)?"center":null)},createNonCssElement:function(c,a){return"center"==a?h.getDocument(c).createElement("p"):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==b.length)return"center"==
f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),"center"!=d)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"":"center"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"":"center"},applyValueToRange:function(c,a){for(var b=f.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,
a.rangesToPreserve[0]),e=0,d=b.length;e<d;++e)f.setNodeValue(b[e],a)}});d.registerCommand("justifyCenter",new g)});
rangy.createModule("FontsizeCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"fontSize",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.fontSize||(/^(font)$/i.test(c.tagName)?"fontSize":null)},createNonCssElement:function(c,a){return"fontsize"!=a?h.getDocument(c).createElement("span"):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==b.length)return"fontsize"==
f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),d!=a.options.fontsize)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return a.options.fontsize},getNewSelectionValue:function(c,a){return a.options.fontsize},applyValueToRange:function(c,a){if(""!=a.value){var b=f.decomposeRange(c,a.rangesToPreserve);b&&1==b.length&&1==b[0].nodeType&&
"body"==b[0].nodeName.toLowerCase()&&(b=getChildToArray(b[0]));var b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=checkSameParent(b);e&&(b=e);for(var e=0,d=b.length;e<d;++e)if(1==b[e].nodeType&&"p"==b[e].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var g=b[e].innerHTML,g=g.replace(RegExp("(<br)[^>].*?>","gim"),"$1>");if("<br/>"==g||"<br />"==g||"<br>"==g||""==g)b[e].innerHTML="&nbsp;";else for(var h=b[e].childNodes.length,g=0;g<h;++g)if(1==b[e].childNodes[g].nodeType&&
"BR"==b[e].childNodes[g].tagName){var m=b[e].childNodes[g],v=_iframeDoc.createElement("span");m.parentNode.insertBefore(v,m);v.appendChild(m)}}h=getChildToArray(b[e]);g=0;for(m=h.length;g<m;++g)f.setNodeValue(h[g],a)}else f.setNodeValue(b[e],a)}}});d.registerCommand("fontsize",new g)});
rangy.createModule("FontfamilyCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"fontFamily",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.fontFamily||(/^(font)$/i.test(c.tagName)?"fontFamily":null)},createNonCssElement:function(c,a){return"fontFamily"!=a?h.getDocument(c).createElement("span"):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==
b.length)return"fontFamily"==f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),d!=a.options.fontfamily)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return a.options.fontfamily},getNewSelectionValue:function(c,a){return a.options.fontfamily},applyValueToRange:function(c,a){if(""!=a.value){var b=f.decomposeRange(c,a.rangesToPreserve);
b&&1==b.length&&1==b[0].nodeType&&"body"==b[0].nodeName.toLowerCase()&&(b=getChildToArray(b[0]));var b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=checkSameParent(b);e&&(b=e);for(var e=0,d=b.length;e<d;++e)if(1==b[e].nodeType&&"p"==b[e].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var g=b[e].innerHTML,g=g.replace(RegExp("(<br)[^>].*?>","gim"),"$1>");if("<br/>"==g||"<br />"==g||"<br>"==g||""==g)b[e].innerHTML="&nbsp;";else for(var h=b[e].childNodes.length,g=0;g<
h;++g)if(1==b[e].childNodes[g].nodeType&&"BR"==b[e].childNodes[g].tagName){var m=b[e].childNodes[g],v=_iframeDoc.createElement("span");m.parentNode.insertBefore(v,m);v.appendChild(m)}}h=getChildToArray(b[e]);g=0;for(m=h.length;g<m;++g)f.setNodeValue(h[g],a)}else f.setNodeValue(b[e],a)}}});d.registerCommand("fontfamily",new g)});
rangy.createModule("FontcolorCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"color",defaultOptions:{ignoreWhiteSpace:!0},valuesEqual:function(c,a){c=convertRgbToHex(c);a=convertRgbToHex(a);return c==a},getSpecifiedValue:function(c){return c.style.color||(/^(font)$/i.test(c.tagName)?"color":null)},createNonCssElement:function(c,a){return"color"!=a?h.getDocument(c).createElement("span"):null},getRangeValue:function(c,
a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==b.length)return"color"==f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),!this.valuesEqual(d,a.options.fontcolor))return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"":a.options.fontcolor},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,
a)?"":a.options.fontcolor},applyValueToRange:function(c,a){if(""!=a.value){var b=f.decomposeRange(c,a.rangesToPreserve);b&&1==b.length&&1==b[0].nodeType&&"body"==b[0].nodeName.toLowerCase()&&(b=getChildToArray(b[0]));var b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=checkSameParent(b);e&&(b=e);for(var e=0,d=b.length;e<d;++e)if(1==b[e].nodeType&&"p"==b[e].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var g=b[e].innerHTML,g=g.replace(RegExp("(<br)[^>].*?>","gim"),
"$1>");if("<br/>"==g||"<br />"==g||"<br>"==g||""==g)b[e].innerHTML="&nbsp;";else for(var h=b[e].childNodes.length,g=0;g<h;++g)if(1==b[e].childNodes[g].nodeType&&"BR"==b[e].childNodes[g].tagName){var m=b[e].childNodes[g],v=_iframeDoc.createElement("span");m.parentNode.insertBefore(v,m);v.appendChild(m)}}h=getChildToArray(b[e]);g=0;for(m=h.length;g<m;++g)f.setNodeValue(h[g],a)}else f.setNodeValue(b[e],a)}}});d.registerCommand("fontcolor",new g)});
rangy.createModule("FontBgcolorCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"backgroundColor",defaultOptions:{ignoreWhiteSpace:!0},valuesEqual:function(c,a){c=convertRgbToHex(c);a=convertRgbToHex(a);return c==a},getSpecifiedValue:function(c){return c.style.backgroundColor||(/^(font)$/i.test(c.tagName)?"backgroundColor":null)},createNonCssElement:function(c,a){return"backgroundColor"!=a?h.getDocument(c).createElement("span"):
null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==b.length)return"backgroundColor"==f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),!this.valuesEqual(d,a.options.fontcolor))return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"":a.options.fontcolor},getNewSelectionValue:function(c,
a){return this.getSelectionValue(c,a)?"":a.options.fontcolor},applyValueToRange:function(c,a){if(""!=a.value){var b=f.decomposeRange(c,a.rangesToPreserve);b&&1==b.length&&1==b[0].nodeType&&"body"==b[0].nodeName.toLowerCase()&&(b=getChildToArray(b[0]));var b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=checkSameParent(b);e&&(b=e);for(var e=0,d=b.length;e<d;++e)if(1==b[e].nodeType&&"p"==b[e].nodeName.toLowerCase()){if("1"==DEXTTOP.G_CURREDITOR._config.applyStyleEmptyTag){var g=b[e].innerHTML,g=g.replace(RegExp("(<br)[^>].*?>",
"gim"),"$1>");if("<br/>"==g||"<br />"==g||"<br>"==g||""==g)b[e].innerHTML="&nbsp;";else for(var h=b[e].childNodes.length,g=0;g<h;++g)if(1==b[e].childNodes[g].nodeType&&"BR"==b[e].childNodes[g].tagName){var m=b[e].childNodes[g],v=_iframeDoc.createElement("span");m.parentNode.insertBefore(v,m);v.appendChild(m)}}h=getChildToArray(b[e]);g=0;for(m=h.length;g<m;++g)f.setNodeValue(h[g],a)}else f.setNodeValue(b[e],a)}}});d.registerCommand("fontbgcolor",new g)});
rangy.createModule("LineHeightCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{relevantCssProperty:"lineHeight",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return c.style.lineHeight?"lineHeight":null},createNonCssElement:function(c,a){return"lineHeight"!=a?h.getDocument(c).createElement("span"):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==b.length)return"lineHeight"==
f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),d!=a.options.lineheight)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return a.options.lineheight},getNewSelectionValue:function(c,a){return a.options.lineheight},applyValueToRange:function(c,a){for(var b=f.decomposeRange(c,a.rangesToPreserve),b=getRangeCorrectly(b,a.rangesToPreserve[0]),
e=0,d=b.length;e<d;++e)f.setNodeValue(b[e],a)}});d.registerCommand("lineheight",new g)});
rangy.createModule("FormattingCommand",function(d,m){function g(){}d.requireModules(["Commands"]);var h=d.dom,f=d.Command.util;d.Command.create(g,{defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(c){return/^(h1|h2|h3|h4|h5)$/i.test(c.tagName)?"formatting":null},createNonCssElement:function(c,a,b){return"formatting"==a?h.getDocument(c).createElement(b.options.tagName):null},getRangeValue:function(c,a){var b=f.getEffectiveTextNodes(c,a),e=b.length,d;if(0==b.length)return"formatting"==
f.getEffectiveValue(c.commonAncestorContainer,a);for(;e--;)if(d=f.getEffectiveValue(b[e],a),"formatting"!=d)return!1;return!0},getSelectionValue:function(c,a){for(var b=c.getAllRanges(),e=0,d=b.length;e<d;++e)if(!this.getRangeValue(b[e],a))return!1;return 0<d},getNewRangeValue:function(c,a){return this.getRangeValue(c,a)?"":"formatting"},getNewSelectionValue:function(c,a){return this.getSelectionValue(c,a)?"":"formatting"},applyValueToRange:function(c,a){for(var b=f.decomposeRange(c,a.rangesToPreserve),
b=getRangeCorrectly(b,a.rangesToPreserve[0]),e=0,d=b.length;e<d;++e)f.setNodeValue(b[e],a)}});d.registerCommand("formatting",new g)});rangy.createModule("Util",function(d,m){d.requireModules(["WrappedSelection","WrappedRange"]);var g=d.rangePrototype,h=d.selectionPrototype;g.select=function(f){d.getSelection(this.getDocument()).setSingleRange(this,f)};h.pasteText=function(d){this.deleteFromDocument();var c=this.getRangeAt(0);d=c.getDocument().createTextNode(d);c.insertNode(d);this.setSingleRange(c)};g.pasteText=function(d){this.deleteContents();d=this.getDocument().createTextNode(d);this.insertNode(d)};h.pasteHtml=function(d){this.deleteFromDocument();
var c=this.getRangeAt(0);d=this.createContextualFragment(d);var a=d.lastChild;c.insertNode(d);a&&c.setStartAfter(a);this.setSingleRange(c)};g.pasteHtml=function(d){this.deleteContents();d=this.createContextualFragment(d);this.insertNode(d)};h.selectNodeContents=function(f){var c=d.createRange(this.win);c.selectNodeContents(f);this.setSingleRange(c)};d.createRangeFromNode=function(f){var c=d.createRange(f);c.selectNode(f);return c};d.createRangeFromNodeContents=function(f){var c=d.createRange(f);c.selectNodeContents(f);
return c}});rangy.createModule("Position",function(d,m){function g(a){var b=0,c=0;if("number"==typeof a.pageXOffset&&"number"==typeof a.pageYOffset)b=a.pageXOffset,c=a.pageYOffset;else{a=a.document;var d=a.documentElement,e=a.compatMode;if((a="string"==typeof e&&0<=e.indexOf("CSS")&&d?d:t.getBody(a))&&"number"==typeof a.scrollLeft&&"number"==typeof a.scrollTop)try{b=a.scrollLeft,c=a.scrollTop}catch(f){}}return{x:b,y:c}}function h(a,b){for(b=b.toLowerCase();a;){if(1==a.nodeType&&a.tagName.toLowerCase()==b)return a;
a=a.parentNode}return null}function f(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d;this.width=b-d;this.height=c-a}function c(a,b,c){return new f(a.top+c,a.right+b,a.bottom+c,a.left+b)}function a(a,b){var d=0,e=0,f=b.documentElement,g=t.getBody(b),g=0===f.clientWidth&&"number"==typeof g.clientTop?g:f,f=g.clientLeft,g=g.clientTop;f&&(d=-f);g&&(e=-g);return c(a,d,e)}function b(a){for(var b=[],c=[],d=[],e=[],g=0,k=a.length,h;g<k;++g)if(h=a[g])b.push(h.top),c.push(h.bottom),d.push(h.left),
e.push(h.right);return new f(Math.min.apply(Math,b),Math.max.apply(Math,e),Math.max.apply(Math,c),Math.min.apply(Math,d))}function e(a,b,c){a=t.getBody(a).createTextRange();a.moveToPoint(b,c);b=new d.WrappedTextRange(a);return new K(b.startContainer,b.startOffset)}function n(a,b,c){a=a.caretPositionFromPoint(b,c);return new K(a.offsetNode,a.offset)}function u(a,b,c){a=a.caretRangeFromPoint(b,c);return new K(a.startContainer,a.startOffset)}function M(a){a=(a.nativeRange||a).getClientRects();return 0<
a.length?a[a.length-1]:null}function N(a,b,c,e){var g=a.elementFromPoint(b,c);a=d.createRange(a);a.selectNodeContents(g);a.collapse(!0);var f=g.firstChild,k,h,m;if(f){a:for(;f;){if(3==f.nodeType)for(k=0,m=f.length;k<=m;++k){if(a.setEnd(f,k),(h=M(a))&&c<h.bottom&&b>=h.left&&b<=h.right){h.right-b>b-h.left&&--k;break a}}else if(a.setEndAfter(f),(h=M(a))&&c<h.bottom&&b>=h.left&&b<=h.right){k=t.getNodeIndex(f);f=g.parentNode;e||++k;break}f=f.nextSibling}f||(f=g,k=g.childNodes.length)}else f=g.parentNode,
k=t.getNodeIndex(g),e||++k;return new K(f,k)}function v(a){if(d.features.implementsTextRange)return e;if("undefined"!=typeof a.caretPositionFromPoint)return n;if("undefined"!=typeof a.caretRangeFromPoint)return u;if("undefined"!=typeof a.elementFromPoint&&L)return N}function B(a,b,c,e,f){f=t.getContentDocument(f,m,"createRangeFromPoints");var g=v(f);a=g(f,a,b,!1);c=g(f,c,e,!0);f=d.createRange(f);f.setStartAndEnd(a.node,a.offset,c.node,c.offset);return f}function Q(a,b){return a.compareBoundaryPoints(b.START_TO_START,
b)}function I(a){return function(){for(var c="getBounding"+(a?"Document":"Client")+"Rect",d=[],e=0;e<this.rangeCount;++e)d.push(this.getRangeAt(e)[c]());return b(d)}}function J(a,b){return function(){if(0==this.rangeCount)return null;var c=b?"Document":"Client",d=this.getAllRanges();1<d.length&&d.sort(Q);return a?d[0]["getStart"+c+"Pos"]():d[d.length-1]["getEnd"+c+"Pos"]()}}d.requireModules(["WrappedSelection"]);var P=d.WrappedRange,O=d.WrappedTextRange,t=d.dom,w=d.util,K=t.DomPosition,z=document.createElement("span"),
D=w.isHostMethod(z,"getBoundingClientRect"),z=null,L=!1,z=!1;d.features.implementsDomRange&&(z=d.createNativeRange(),L=w.isHostMethod(z,"getClientRects"),z=w.isHostMethod(z,"getBoundingClientRect"));w.extend(d.features,{rangeSupportsGetBoundingClientRect:z,rangeSupportsGetClientRects:L,elementSupportsGetBoundingClientRect:D});var E=function(a){return function(){var b=this.cloneRange();b.collapse(a);b=b.getBoundingClientRect();return{x:b[a?"left":"right"],y:b[a?"top":"bottom"]}}},C=function(a){return function(){var b=
this["get"+(a?"Start":"End")+"ClientPos"](),c=g(t.getWindow(this.startContainer));return{x:b.x+c.x,y:b.y+c.y}}},F=d.rangePrototype;if(d.features.implementsTextRange&&D)F.getBoundingClientRect=function(){var c=O.rangeToTextRange(this),d=this.getNodes([1],function(a){return/^t[dh]$/i.test(a.tagName)}),e=[];if(0<d.length){for(var f=h(this.startContainer,"table"),g=0,m,k,n;m=d[g];++g)k=h(m,"table"),f&&k==f||(n=this.cloneRange(),f&&n.setStartAfter(f),n.setEndBefore(k),e.push(O.rangeToTextRange(n).getBoundingClientRect())),
this.containsNode(m)?e.push(m.getBoundingClientRect()):(f=c.duplicate(),f.moveToElementText(m),-1==f.compareEndPoints("StartToStart",c)?f.setEndPoint("StartToStart",c):1==f.compareEndPoints("EndToEnd",c)&&f.setEndPoint("EndToEnd",c),e.push(f.getBoundingClientRect())),f=k;!h(this.endContainer,"table")&&f&&(n=this.cloneRange(),n.setStartAfter(f),e.push(O.rangeToTextRange(n).getBoundingClientRect()));c=b(e)}else c=c.getBoundingClientRect();return a(c,t.getDocument(this.startContainer))};else if(d.features.implementsDomRange){var r=
function(a){return a instanceof P?a:new P(a)};if(z)F.getBoundingClientRect=function(){var b=r(this).nativeRange,b=b.getBoundingClientRect()||b.getClientRects()[0];return a(b,t.getDocument(this.startContainer))},L&&(E=function(a){return function(){var b;b=r(this).nativeRange.getClientRects();if(0<b.length){if(a)return b=b[0],{x:b.left,y:b.top};b=b[b.length-1];return{x:b.right,y:b.bottom}}}});else{var G=D?function(b){return a(b.getBoundingClientRect(),t.getDocument(b))}:function(b){for(var c=0,d=0,
e=b,g=b.offsetWidth,h=b.offsetHeight;e;)c+=e.offsetLeft,d+=e.offsetTop,e=e.offsetParent;return a(new f(d,c+g,d+h,c),t.getDocument(b))},H=function(a){var c;a.splitBoundaries();var d=document.createElement("span");if(a.collapsed)a.insertNode(d),c=G(d),d.parentNode.removeChild(d);else{var e=a.cloneRange();e.collapse(!0);e.insertNode(d);c=G(d);d.parentNode.removeChild(d);e.collapseToPoint(a.endContainer,a.endOffset);e.insertNode(d);e=G(d);d.parentNode.removeChild(d);d=[c,e];c=a.getNodes([1],function(b){return a.containsNode(b)});
for(var e=0,f=c.length;e<f;++e)d.push(G(c[e]));c=b(d)}a.normalizeBoundaries();return c};F.getBoundingClientRect=function(a){return H(r(a))}}}w.extend(F,{getBoundingDocumentRect:function(){var a=g(t.getWindow(this.startContainer));return c(this.getBoundingClientRect(),a.x,a.y)},getStartClientPos:E(!0),getEndClientPos:E(!1),getStartDocumentPos:C(!0),getEndDocumentPos:C(!1)});w.extend(d.selectionPrototype,{getBoundingClientRect:I(!1),getBoundingDocumentRect:I(!0),getStartClientPos:J(!0,!1),getEndClientPos:J(!1,
!1),getStartDocumentPos:J(!0,!0),getEndDocumentPos:J(!1,!0)});d.positionFromPoint=function(a,b,c){c=t.getContentDocument(c,m,"positionFromPoint");return v(c)(c,a,b)};d.createRangeFromPoints=B;d.moveSelectionToPoints=function(a,b,c,d,e){var f,g;d<b||b==d&&c<a?(f=c,g=d,d=b):(f=a,g=b,a=c);b=rangy.getSelection(e);e=B(f,g,a,d,e);b.setSingleRange(e);return b}});

